## Direct Threshold Signature Ed25519

The signers are Alice and Bob's Threshold Signature Service 'Bob'. Each creates a key pair:

~~~~
ED25519Alice's Key (ED25519)
    UDF:        ZAAA-GTSI-GXED-255X-XALI-CEXS-XKEY
    Scalar:     31219130380639437694769688896227611542048535900134467943432016761653342335248
    Encoded Private
  10 AE C0 C2  16 65 9B 4F  7C 9D DE 82  3E 49 7F D4
  9B 14 BB F8  2D 9F 0C 11  24 D7 15 E3  43 79 57 20
    X: -136976994354060809992511310633440499651405534527523053537148191066469193471600647935063276359543427191442892305566686088586980395284289746495530409889930
    Y: 2787938756106160808441628001858643996255039381575693741747004148457584793312944241473937768317672664875790987675375777043504113387553916769515911310193558
    Encoded Public
  45 16 53 7C  26 50 CF DA  F1 A4 DF 4C  45 DC 3D 95
  4E B6 8E EB  A6 5A 27 D6  CD 5B 43 C5  F4 06 53 ED
ED25519Bob's Key (ED25519)
    UDF:        ZAAA-GTSI-G2ED-255X-XBOB-XSXK-EY
    Scalar:     56721284389150941480030862015889172068550899562072140666211075925337851277632
    Encoded Private
  E5 CD 34 01  FD 8C 0E 27  81 4B 11 DD  12 68 50 A1
  4B 5A D5 E1  E1 41 D7 68  5F 51 ED B4  3A 84 58 5C
    X: -138092824722980844367359878888974235071495809669527917614466708840444339639751784823981446575645652232705885322459642470946347570575475534141406285323257
    Y: 2636842263428719847063174117604230959470680883663935467986023784374327074820898066537558813995929630687517599645362525866308283171284327931970404321458677
    Encoded Public
  F1 5F C0 78  F8 32 49 2C  D9 64 CC 2B  CF 90 5C 4F
  23 EA BB F8  38 99 C5 FE  F3 AA 67 BE  AB EC D2 5E
~~~~

The composite Signature Key A = A<sub>a</sub> + A<sub>b</sub>

~~~~
Aggregate Key = Alice + Bob ()
    UDF:        TBS
    Scalar:     1096347841803232607122312155600852720314039149647717337619681427565742601012
    Encoded Private
  34 33 AB 10  9A 09 A9 61  65 8B 3A EC  58 21 FB 2D
  0D 45 74 49  45 BA E2 CF  A8 98 C2 94  C9 82 6C 02
    X: -83837675294300852842901121613445594296352372347711317409367737761568353629718805151940195325485285476438422923698718220652243749390297055882388709313280
    Y: 1605534229443581447510600098207353220369037738023611170464574768951650597380866633309722638506754532499903010398473811263196653225446124160025082144761534
    Encoded Public
  48 1A 27 66  06 AF 4E 3C  20 A4 02 CD  8A 13 46 99
  02 B7 75 F8  AC D4 7E 89  68 FB 68 EB  D8 EF 4A C7
~~~~

To sign the text "This is a test", Alice first generates her value r
and multiplies it by the base point to obtain the value R<sub>a</sub>:

~~~~
Alice:
r_a =  4622068208338392015782555846019450834959355612525339246168022723618170100478
R_a =  
  BD A0 01 D5  CE 5B F1 B9  D2 02 9D 65  57 8E 63 25
  F2 A6 C2 29  51 B9 78 C1  57 5F C8 5E  AB F3 FD 3F
~~~~

Alice passes her value R<sub>A</sub> to Bob along with the other 
parameters required to calculate i. Bob then calculates his
value R<sub>A</sub> and multiplies it by the base point to obtain 
the value R<sub>b</sub>:

~~~~
Bob:
r_b =  338722730782043607319914095554299828153860812626680294468509377364939990631
R_b =  
  F2 DB 8C 06  05 9C E9 C3  3B E9 F1 1E  74 41 17 8E
  F7 71 7F DE  31 A9 CC EF  38 96 56 2B  2C 49 48 D1
~~~~

Bob can now calculate the composite value R = R<sub>a</sub> + R<sub>b</sub>
and thus the value k.

~~~~
R =  
  39 4E 7B 47  36 A8 2D 73  0A FF 60 85  54 9F 5B BF
  49 A6 89 4B  69 1C 9D 43  E3 4F 62 84  D1 CA 1C D1
k =  1892122820966738598381281463068326949701225651833525426306637171380938299095
~~~~

Bob calculates his signature scalar contribution and returns the value to Alice:

~~~~
Bob:
S_b =  3931922315810810058922399405422052284850969760207596036360792313269275135808
~~~~

Alice can now calculate her signature scalar contribution and thus the signature 
scalar S.

~~~~
Alice:
S_a =  3598559508225920027880458271223137260397109685457871050858748647626831907982
S =  293476246704467872829671113602195304390963086285559481217590022610652792801
~~~~

Alice checks to see that the signature verifies:

~~~~
S.B = R + kA = 
    X: 26661162077967864997817745000145684879899479087592213489239941334643257849063
    Y: 29591668641537991786420212433440113994538785648685164909137908272310138311618
~~~~

## Direct Threshold Signature Ed448

The signers are Alice and Bob's Threshold Signature Service 'Bob'. Each creates a key pair:

~~~~
ED448Alice's Key (ED448)
    UDF:        ZAAA-ITSI-GXED-44XA-LICE-XSXK-EY
    Scalar:     672286477331130983513039743350616227864346753924962787860729757222511999618443513569403793186398096717924945854846544396984088344823264
    Encoded Private
  6F 85 B1 91  9A 37 06 A6  B2 15 79 AD  5B 69 16 6A
  5A CD C8 17  D4 14 1F 68  DA 97 C5 B4  44 79 CE EA
  3C 17 7B E1  29 44 70 DF  41 C8 98 38  1E 7C 9B 3B
  03 63 6F 85  E8 39 31 91
    X: 526046019655043632868470952286947529492283092344122476077151423645243648974512182548405702873560533846673262767064019365470830861106049
    Y: 145374550785380850812934424757986866673485237047938554544492694946608060986459495807055455048208713991919477720250115717234689256856152
    Encoded Public
  59 55 F4 7A  66 08 91 35  F8 15 63 F4  90 91 7F 38
  12 E3 49 22  51 F8 BC 4A  41 C9 44 59  5A 64 9B 40
  0B C5 7E 53  48 0F 32 12  90 32 69 38  47 28 94 BB
  99 D1 16 6F  2D D5 3D 4F  80
ED448Bob's Key (ED448)
    UDF:        ZAAA-ITSI-G2ED-44XB-OBXS-XKEY
    Scalar:     455052626698262385397736547727159423941520792904908612603542850909167215987713902322619933929404455741806848064294945283113799683261212
    Encoded Private
  CA 15 22 BD  F4 0F 9E 0A  EC A7 61 79  BE 9E E3 38
  BF 93 D3 5B  B3 E6 FC F0  A7 5B 7C F0  E7 B5 89 F6
  2E F6 D1 0E  72 49 4D DF  34 5E 2F 7C  9E 42 1D 85
  AB AB 30 BD  68 C6 3E 35
    X: 752024108200272710832187535557164455078689734595171189993383259892607253027500878543439908750525763880661232171322059854852522782265
    Y: 619329873102159676791326142073166790594683111409729383584199833441028484525583699421181422168190856074786324020492214873796495570056511
    Encoded Public
  76 2B FC F8  AC 96 79 DE  1C 72 07 65  DD 49 5B 28
  C7 04 CB A8  A5 96 3D D9  9E 23 FA 05  83 15 33 95
  85 82 F8 CF  A3 7A 2F 24  F8 EB D6 AE  20 0A 25 D0
  44 1A F9 C0  86 D7 87 B7  00
~~~~

The composite Signature Key A = A<sub>a</sub> + A<sub>b</sub>

~~~~
Aggregate Key = Alice + Bob ()
    UDF:        TBS
    Scalar:     37081017585983033086790579245768850275405505798894310042037309360803191836919901594849195365648296679870031664591515851455352870185802
    Encoded Private
  4A AB 7A BB  2D 95 72 75  B1 3A 1D 22  24 17 76 2D
  A1 D5 55 94  67 35 8C E7  A1 A0 ED 0C  E7 88 FF 9F
  6E 2F 70 80  89 F5 01 2A  C0 AD 4C 4E  7B 90 68 6C
  F4 53 BA 32  9B 70 0F 0D
    X: 58324955340769999928415411296483544625241229318885705805155251963990666340677631698415401706202386907579053630514579317017660114474427
    Y: 518040437562811181169413740718290938351269168888257124107164689245721852001077758864406412789756149699111633051823234569886260996269341
    Encoded Public
  34 70 8D 08  DE 63 0B A6  49 2A 33 D8  B7 15 A9 84
  A4 87 F6 B6  C7 4B 1C AE  5A 1F 7C 4B  12 70 FB CF
  5A A9 3C 20  31 BA 9A 53  A0 FE 2A 43  24 97 06 F8
  DA 40 0D 88  E3 D9 DE 2E  00
~~~~

To sign the text "This is a test", Alice first generates her value r
and multiplies it by the base point to obtain the value R<sub>a</sub>:

~~~~
Alice:
r_a =  168773392638296352836534983934229296859166537661212483776785883539430207412278937307386353478843488795563804820276713983408786585749852
R_a =  
  EA C1 92 86  98 7A 6B C9  64 27 CF 2A  67 EB 00 27
  65 A0 67 0E  54 B8 0A C7  EF D9 55 E3  44 70 91 F4
  7B D8 79 4A  8F 5C 0C 54  DB A5 34 DE  58 8C E3 2E
  29 EE 9C CD  68 A0 79 6E  00
~~~~

Alice passes her value R<sub>A</sub> to Bob along with the other 
parameters required to calculate i. Bob then calculates his
value R<sub>A</sub> and multiplies it by the base point to obtain 
the value R<sub>b</sub>:

~~~~
Bob:
r_b =  6291498445665373770646009895509041927993140179702459018549926771320084651015496724586742444490656595949513622948507006543988277344747
R_b =  
  E1 BC DF DD  F0 3D 05 58  D4 F8 4D 28  91 81 ED 48
  8A 0C 8F 06  68 C5 D1 90  53 A3 9C 18  1E 07 37 A0
  5F 7C BB 5A  76 B2 B0 09  57 2B A2 43  35 54 36 35
  D0 E1 5C D6  26 1F 61 C8  00
~~~~

Bob can now calculate the composite value R = R<sub>a</sub> + R<sub>b</sub>
and thus the value k.

~~~~
R =  
  1E 57 EF 14  F5 E4 4B 1D  B5 D3 91 94  8E E6 58 65
  7E 7F AA 9D  A9 CE B7 AD  51 8E 18 63  98 02 55 4D
  F6 41 A1 01  A6 2A D1 F7  8A 0A 0D 75  7F FA 02 57
  A8 BB 21 C4  FA A8 06 32  00
k =  11361586461685815080601976960347085133607678555470073255157787397667330770938446143142921930152837255391329188270947976242509169366191
~~~~

Bob calculates his signature scalar contribution and returns the value to Alice:

~~~~
Bob:
S_b =  114032373188634376267530565971697481048278355240426909765983755266116818238101988091934006157974453792577610980498896330888510052922029
~~~~

Alice can now calculate her signature scalar contribution and thus the signature 
scalar S.

~~~~
Alice:
S_a =  114329430079495591389250182682384490511991651716502904649063033249109025092468728317186472563511614744976911963174695778743397568238086
S =  46652122194228245019449796682080837971859666785100299344674238720079839369031130692924723429793692574244229234581929804858151761510336
~~~~

Alice checks to see that the signature verifies:

~~~~
S.B = R + kA = 
    X: 45319209521898841178828833092467967725909594217015893731199957795498451695299
    Y: 13619323569985223166431759646467630404104280292089266424779463941881854073771
~~~~

## Shamir Threshold Signature Ed25519


The administrator creates the composite key pair

~~~~
ED25519Aggregate Key (ED25519)
    UDF:        ZAAA-GTSI-GQED-255X-XAGG-REGA-TEXK-EY
    Scalar:     36723847059248832646878925210941288936191068022903089760692844779165588879504
    Encoded Private
  FE 48 94 1F  EB 3D 28 E1  61 81 E2 1E  E1 CF F2 1E
  1E 70 91 30  DF 98 9F 1C  34 EB BB 74  C5 C8 07 EB
    X: 143576564277195758046684172284175869008525477709640743490221115123376609940386394888392330104965579307772627313244177612005636942740116142030215202393600
    Y: 844838272625277895849027219595751726665225134917547580682441821283235675507225396641352769322822815561632929543097074319051436285787045255908364074589900
    Encoded Public
  DF E8 0A 2B  E9 6C 53 C0  AB 9B BC BC  39 95 9A 61
  9C 33 2E 22  24 A7 F7 F2  21 06 AC 6D  01 5D 0B E2
~~~~

Three key shares are required for Alice, Bob and Carol with a threshold of two. 
The parameters of the Shamir Secret Sharing polynomial are:

~~~~
a0 = 36723847059248832646878925210941288936191068022903089760692844779165588879504
a1 = 2925968505630882231239091157112089361066395618799482546642276566615280060074
~~~~

The key share values for the participants are

~~~~
xa = 1
ya = 3464787678218403808252083552838407092971881844803034277325366654353597684633

xb = 2
yb = 6390756183849286039491174709950496454038277463602516823967643220968877744707

xc = 3
yc = 2079719112147906056757079304019591574247556723022091764607968849298703553792
~~~~

Alice and Carol are selected to sign the message "This is another test"

The Lagrange coefficients are:

~~~~
la = 3618502788666131106986593281521497120428558179689953803000975469142727125496
lc = 3618502788666131106986593281521497120428558179689953803000975469142727125494
~~~~


Alice and Carol select their values ra, rc

~~~~
ra = 2119145658313369234208483829521507218589063246102670726502452754397368341518
Ra = 
  0A 71 0B BD  08 76 25 F6  38 9B 4F 2F  33 6F 17 4D
  26 1E 12 FC  DA 0D 6E 46  AC 84 3B 8D  50 02 DB 14

rc = 4848170219119830111529503914576338641633246159623821485890096389501850317904
Rc = 
  24 A7 10 07  61 B0 3B DF  C0 7E 97 1D  39 F5 66 9C
  BD 0F 2B F8  2E BD CB F1  1F F8 42 C1  8B E3 55 D6
~~~~

The composite value R = R<sub>a</sub> + R<sub>c</sub>

~~~~
R =  
  D2 11 79 CA  07 17 FC E6  5D 27 3D AE  C7 AE CB 4A
  E7 0D D4 E1  DA 21 FB 91  FD 4C 05 6B  A4 72 05 FD
~~~~

The value k is 

~~~~
k = 1100765426983273212468943856569126177311219471874225314937866563794092923453
~~~~

The values R and k (or the document to be signed) and the 
Lagrange coefficients are passed to Alice and Carol who use them to 
calculate their secret scalar values:

~~~~
sa = 1578678728661474605391532047736113519029264587514597612987074512387669401455;
sc = 6197146021258309185594646911033198453733337997868861723697966513636102474093
~~~~

The signature contributions can now be calulated:

~~~~
Sa = 4108917252129549929347958311955687350041917021126873327386045205869478305465
Sc = 1877441654662846001247957075724815042518651999307233619218055760851829607660
~~~~

The dealer calculates the composite value S = S<sub>a</sub> + S<sub>b</sub>

~~~~
S =  5986358906792395930595915387680502392560569020434106946604100966721307913125
~~~~

The dealer checks to see that the signature verifies:

~~~~
S.B = R + kA = 
    X: 21113029956715258996422530565090074249136090600132741130166962061536982153348
    Y: 40835990650199808425486496918464113786126490040180439914289802911765131183025
~~~~


## Shamir Threshold Signature Ed448


The administrator creates the composite key pair

~~~~
ED448Aggregate Key (ED448)
    UDF:        ZAAA-ITSI-GQED-44XA-GGRE-GATE-XKEY
    Scalar:     723088510822916843359337925516642493307623385482113107480846498794254549074097051759295396782499503452909258978468506553055366989547456
    Encoded Private
  59 DC 8A 5F  5E AF 8C FA  96 19 F8 EE  78 13 00 12
  33 0E 12 80  2D 25 E6 EF  E8 E2 56 B5  83 6A 0C CF
  DC 11 96 A5  A5 D1 39 AA  34 25 0B 52  ED 9F 38 92
  5D 9F 7B BC  B9 BC 86 45
    X: 60016319926021287967102628244022157075254387456927653121329738236593892484559749726458352818527376038303158925167107013312482098672476
    Y: 568007995844826855892481230051783440873263817862016100095069663100696528804467952219402043387612562057320585561865068046226655443122582
    Encoded Public
  ED C3 90 99  38 0B 8F CD  60 29 24 04  6C DE 52 33
  A2 07 3E 56  8D 27 B5 B9  21 60 CF E9  E7 9D D6 4A
  11 47 20 E6  9D FE 75 C7  04 14 70 18  B4 52 10 83
  D0 EC 98 BD  F5 E6 E3 D5  80
~~~~

Three key shares are required for Alice, Bob and Carol with a threshold of two. 
The parameters of the Shamir Secret Sharing polynomial are:

~~~~
a0 = 723088510822916843359337925516642493307623385482113107480846498794254549074097051759295396782499503452909258978468506553055366989547456
a1 = 790191440804569451173633972347657680287886879811610539489477144738365735146685816358886125160120753369369579684453136582972974064474
~~~~

The key share values for the participants are

~~~~
xa = 1
ya = 178749659042016244898518703572986750222680251846436172809218326553554902924624980427067017032582496316347747430877972775317072384662593

xb = 2
yb = 179539850482820814349692337545334407902968138726247783348707803698293268659771666243425903157742617069717117010562425911900045358727067

xc = 3
yc = 180330041923625383800865971517682065583256025606059393888197280843031634394918352059784789282902737823086486590246879048483018332791541
~~~~

Alice and Carol are selected to sign the message "This is another test"

The Lagrange coefficients are:

~~~~
la = 90854840536950861318665475986000566794205170085914757535186274897573001980769792858097877645846187981655146854545831152386877929824891
lc = 90854840536950861318665475986000566794205170085914757535186274897573001980769792858097877645846187981655146854545831152386877929824889
~~~~


Alice and Carol select their values ra, rc

~~~~
ra = 136199126881987448560477789065661226541680080064286688444471569873874512199152830717838014483089141703370212636383432812176457009002447
Ra = 
  4F 61 CD 94  A2 EB E3 B9  82 DF 90 CC  1A 3C 17 39
  64 2A 98 E7  1B F8 8C 36  4B 99 EF CE  BF 7A F2 5D
  65 57 47 BD  D1 0F 9F 25  8F F9 85 A0  53 84 A1 96
  1D 89 33 6C  21 8E 9B 0D  80

rc = 19824669123493855295734889087857761040608035588183665816995229407157720082700431054765177257876995710645773639357838061558510296729824
Rc = 
  1E 11 E2 C8  DB 08 D2 C5  CE BF 1E 6A  34 E0 3F 3D
  B8 70 47 2C  03 3E 01 71  D8 11 EE 16  FE 92 9A 28
  AB 65 26 C5  41 22 CC EF  6E 73 1D A8  23 CC B4 21
  97 C2 FF 3E  65 60 12 F9  00
~~~~

The composite value R = R<sub>a</sub> + R<sub>c</sub>

~~~~
R =  
  26 BF 3B ED  08 D8 84 D1  AE 33 35 23  5E DE A1 A6
  6F 0A AE D2  CF 9E DB 63  20 BB C6 0D  F9 3D C4 B3
  9D 93 77 D3  5B AC B9 EC  E9 6A FF 57  2C 70 3D 7C
  A6 47 D1 E2  84 C9 F7 79  80
~~~~

The value k is 

~~~~
k = 3660313093319108829037413553643730735201853954693031607078365397654239095389367382529274319275622021513315974026867577721171123567357
~~~~

The values R and k (or the document to be signed) and the 
Lagrange coefficients are passed to Alice and Carol who use them to 
calculate their secret scalar values:

~~~~
sa = 177269648026073506029112579373479558539815207683739501678641214932759352406167677782502647903027556492866474291771128010588730647169000;
sc = 689819575138169418232490227159534002577157282885060591087634476057184783310616828205483004394819070111903559422391628145368763429119
~~~~

The signature contributions can now be calulated:

~~~~
Sa = 79891504584509909943203493624399324890729554165322082866229668919161173927338841569474314805671529910928921815828851973185956164136794
Sc = 106016020524942967528932323752234066217079893527814830219004541533513691570584521513312577167472773310148476585149540927268713006581125
~~~~

The dealer calculates the composite value S = S<sub>a</sub> + S<sub>b</sub>

~~~~
S =  4197844035551154834804865404632257519399107521307398014861660657528861536383777366591136681451927257767104691886730595680913311068140
~~~~

The dealer checks to see that the signature verifies:

~~~~
S.B = R + kA = 
    X: 30052606784194383148850549940259477647735529122163745700055019952553554892210
    Y: 44017482173404457260280503030084407882864627945536335898098855358615712747498
~~~~


