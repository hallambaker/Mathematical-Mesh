## Direct Threshold Signature Ed25519

The signers are Alice and Bob's Threshold Signature Service 'Bob'. Each creates a key pair:

~~~~
ED25519Alice's Key (ED25519)
    UDF:        ZAAA-GTSI-GXED-255X-XALI-CEXS-XKEY
    Scalar:     56271244081186130980636545017945156580516101894352492459594967614223399428880
    Encoded Private
  33 40 0E 22  D8 67 17 F4  8A 9F 6A 46  61 B4 0E AD
  8C D0 DD C3  79 CD 85 BD  95 5C 90 B9  6C CB 8C 23
    X: 111167936729704271617902644692802945071890447281405479540710227976454124042406369344932655633664630560242213431409139866940284702002648469365756492647970
    Y: 6165540417161139657302180811910866474957423512534368020645428562991413866150465483230874093885486502722244870898950799705260143544115364878870129761259200
    Encoded Public
  E2 AB 8F 37  62 C8 7B F9  E9 BC 59 0C  2E 99 A5 58
  0C C3 19 D5  CD DA 53 DF  3E C1 F0 C0  FE D3 55 5E
ED25519Bob's Key (ED25519)
    UDF:        ZAAA-GTSI-G2ED-255X-XBOB-XSXK-EY
    Scalar:     54940772670153459146152925564198105262971485730889818986727608573229799020168
    Encoded Private
  68 9A 68 92  8A 06 17 84  35 3C B7 08  F8 56 00 3F
  BA 31 8C 42  B0 42 FE 2D  18 F2 7F AB  CD 10 49 F1
    X: 1427149506934983821637954019626314096403239351290384220616818255188508270988762898008687355222329085197942511309071258786756343411484065706313568410880015
    Y: 2809432894800411242818946622375744088638868429125460535585992362409682297067958252824195942194420746470938513025474524704359438513477629978601366725015573
    Encoded Public
  32 E5 8D 5E  66 B2 F9 E9  14 79 08 71  96 3B 9A 75
  A2 31 59 4B  8E ED 18 EF  BD FF 11 D4  47 2A 8C F4
~~~~

The composite Signature Key A = A<sub>a</sub> + A<sub>b</sub>

~~~~
Aggregate Key = Alice + Bob ()
    UDF:        TBS
    Scalar:     2656933091355656917191672136498348230630842234543697356293312113171384684213
    Encoded Private
  B5 CE 0E B3  9C CF 18 99  CF 8D 4C BB  AE 81 79 1F
  CE 13 AA 3E  63 59 5B AC  8D 2C EB A4  55 C5 DF 05
    X: 678726850438984690124569497732408141216459047361148134558203398688906486811443744733724675994181258029547346985079901494367752381127781166234556148580090
    Y: 3648174005836964548442018097600493206208537594152234405290759401185527921585511971074848922045622908028106552535103024484554128548992118101415797909250954
    Encoded Public
  29 65 63 86  4F FB 10 8D  BA 7A 0A 68  04 6D 00 DA
  9B 1D C3 A4  AF BA 95 B4  5D 27 B4 35  00 2F DF 32
~~~~

To sign the text "This is a test", Alice first generates her value r
and multiplies it by the base point to obtain the value R<sub>a</sub>:

~~~~
Alice:
r_a =  2825229783286095159828068197800792571213424511227976522297089278411772675279
R_a =  
  DF F6 AE B9  4E E4 62 27  14 DC 6C 30  F8 10 2F 14
  5B 82 FA 66  5C AB 85 5B  F9 E1 4D F4  D9 9B 41 91
~~~~

Alice passes her value R<sub>A</sub> to Bob along with the other 
parameters required to calculate i. Bob then calculates his
value R<sub>A</sub> and multiplies it by the base point to obtain 
the value R<sub>b</sub>:

~~~~
Bob:
r_b =  866132636919444858477629932600622616563524230689670235965259062756603651453
R_b =  
  62 41 83 14  F6 F0 7C 00  7C DA 7D B4  8F 48 94 F9
  51 47 DE D4  5D CF 59 0A  2E B1 12 5C  3F 92 C6 B9
~~~~

Bob can now calculate the composite value R = R<sub>a</sub> + R<sub>b</sub>
and thus the value k.

~~~~
R =  
  16 42 B3 D1  E6 0B 28 70  BE 34 FD 96  A3 AE D1 D0
  E3 2C ED D9  7E 0F 0F 7C  49 66 81 07  14 15 F3 D2
k =  2797020107652734706165091555110249145614801643303197520413427535565755125156
~~~~

Bob calculates his signature scalar contribution and returns the value to Alice:

~~~~
Bob:
S_b =  4837585642093088444000719356636283240908441562415903986131976068167612384018
~~~~

Alice can now calculate her signature scalar contribution and thus the signature 
scalar S.

~~~~
Alice:
S_a =  1587732912688356472134514924217506817990753775300581828047524854623296146441
S =  6425318554781444916135234280853790058899195337716485814179500922790908530459
~~~~

Alice checks to see that the signature verifies:

~~~~
S.B = R + kA = 
    X: 14048605832004776210986630920964015464097464636338510135087415397188796127602
    Y: 3617368959770396747906735883214405176735258941225980875423633046649747982388
~~~~

## Direct Threshold Signature Ed448

The signers are Alice and Bob's Threshold Signature Service 'Bob'. Each creates a key pair:

~~~~
ED448Alice's Key (ED448)
    UDF:        ZAAA-ITSI-GXED-44XA-LICE-XSXK-EY
    Scalar:     634958035836588176881104463147860769763472363613540355597788771064742993095132758589292255654895141583596922516472738879360490167934280
    Encoded Private
  A0 53 4C 93  3C 34 00 76  AE 5D B5 4A  C2 71 5F 43
  E1 D6 63 2C  5C 56 53 C8  98 A0 8F 03  FF F5 22 96
  91 45 8C 2B  CF E3 FD 7E  2A 9E 0B D6  F4 CC 66 61
  43 62 72 7B  34 B4 79 92
    X: 247431975092678332621114495565272851208681677122099195708384263466168536901525943558973091346360088759980994772668117646359614426660579
    Y: 213428991205767705376644620496852583908537297883034283490511308752175233505795318243164692156369495328007220135137156078814081547431302
    Encoded Public
  0A 3B F3 27  E7 E1 67 63  2C 59 E2 1C  D1 84 C7 83
  E8 1E D1 68  9F 32 A1 16  99 00 5C DA  29 B9 6C 08
  E4 15 57 7E  E5 63 C2 32  08 23 41 68  5F 49 1F FF
  BC 4D CD 3A  4E A6 85 49  00
ED448Bob's Key (ED448)
    UDF:        ZAAA-ITSI-G2ED-44XB-OBXS-XKEY
    Scalar:     726498037731997515649985438918989048397184093129107800262041941160989643727331987658132182181970054245587322070535846720571414845714224
    Encoded Private
  BC 53 B4 74  3E A7 A7 FA  9F 05 9A BC  8C 22 26 15
  A1 4E BB 10  0E B5 59 6B  DE 9C 1B E9  F2 3C 65 42
  E7 B4 47 18  60 AC 18 A6  D2 78 B8 BC  CE F5 F4 28
  B2 3A FF 08  61 EF 6B 7C
    X: 582358519348086406219208168729590591726924111876409504322030398116748997750134460231406698091317008063030408798536634284207667468558264
    Y: 343907676979092838924957612591865386321204224583921312013722826056455656591826216381185634080685718154852726725624178995827091591132128
    Encoded Public
  93 63 5A 45  2D 4C 94 32  45 23 CD E2  A8 46 E4 78
  A0 80 59 DA  36 CB 6B 0C  06 64 6F BE  51 AB C0 BF
  1E DB A8 3F  2B 3B 80 0F  BF 00 E6 78  DD E0 83 E9
  AC 20 02 55  87 07 39 38  00
~~~~

The composite Signature Key A = A<sub>a</sub> + A<sub>b</sub>

~~~~
Aggregate Key = Alice + Bob ()
    UDF:        TBS
    Scalar:     89488306051273634069773238262841883041784075539841550367222863659710609091687646234054150795018564086012188623366949466515613996100051
    Encoded Private
  D3 29 DD AB  F6 0D 99 8B  75 65 B8 06  36 C9 3A 2C
  D4 08 C3 9B  7C F9 77 8C  68 29 0E 3D  5D C7 3E 00
  92 8B DC AE  26 FB 16 39  CD 25 1B 23  4A 5A 05 61
  1D 5C C4 70  0A C9 84 1F
    X: 179856590986701176171733157630822386857356476268712514680009842080317111091696183607307614171726960576308774975742249260532199160570999
    Y: 315063232248591595943861819956394051706236572739457272887600631624406694682617334725040181287905351066763414658543828623841509161975864
    Encoded Public
  9B 3E DF 49  55 40 9F 7B  EA 0B AA 40  B7 3D 15 82
  60 9F 7C 40  CF 67 DE 56  56 0D 03 87  63 3B 15 F2
  45 33 FE 48  BD 2D A0 A2  8B CC 74 DA  94 0F 39 00
  AC 39 CB 0A  9F A4 EB B0  00
~~~~

To sign the text "This is a test", Alice first generates her value r
and multiplies it by the base point to obtain the value R<sub>a</sub>:

~~~~
Alice:
r_a =  156848299832752889953201861536823153070362764008724863866061402072166399528125106995726644188171942966941181971053097240982129994391377
R_a =  
  86 2D FF 0D  34 FF 93 A2  99 C1 DA 53  7D DE 10 6E
  D6 9D C6 AC  2A 81 F5 AF  EC 41 6B 7E  38 E3 22 1D
  6F C1 55 37  5A 05 87 68  44 76 57 5E  DC 04 8F 93
  72 D7 A8 AD  E8 4D FB F0  00
~~~~

Alice passes her value R<sub>A</sub> to Bob along with the other 
parameters required to calculate i. Bob then calculates his
value R<sub>A</sub> and multiplies it by the base point to obtain 
the value R<sub>b</sub>:

~~~~
Bob:
r_b =  79056431214191269155192383976412419075049008490046667820100793847888956374386701787241561353518102778217220986083734670159884871882910
R_b =  
  E1 0A 96 F3  0E F2 E2 C8  36 E2 8F 35  15 86 9C 91
  AD 9F 1D D0  2D FC 96 F2  D8 E2 C9 BE  13 3B FA 9E
  A1 21 98 28  A0 41 79 B0  E1 EC 2B EE  15 B2 B2 9D
  75 4B 2A 6B  86 68 A9 C2  80
~~~~

Bob can now calculate the composite value R = R<sub>a</sub> + R<sub>b</sub>
and thus the value k.

~~~~
R =  
  2B E8 C1 E1  FA DF 1B 50  27 F4 4C 84  6C B7 4D A9
  C4 EB 4C D0  F6 04 C0 BC  97 53 D6 3F  83 DE EE 36
  13 55 28 07  DA 2B 3A 61  A7 2C 0D 2E  78 23 5C 3F
  A9 4C BD B1  B4 5B 14 B6  80
k =  31040350168947452580205566935597089039017537543951011604437099882054438979188065751089381718439573933543883716847454189233273035538436
~~~~

Bob calculates his signature scalar contribution and returns the value to Alice:

~~~~
Bob:
S_b =  83856930905971738123555179921528993630455764976428992230589064179120809308497387753697763209580570308012751269270294938663620830803528
~~~~

Alice can now calculate her signature scalar contribution and thus the signature 
scalar S.

~~~~
Alice:
S_a =  43099647027479929480177407938099579737460614404521488090665877654415953555738334270132924726379832654788233806296879228442402793663249
S =  126956577933451667603732587859628573367916379380950480321254941833536762864235722023830687935960402962800985075567174167106023624466777
~~~~

Alice checks to see that the signature verifies:

~~~~
S.B = R + kA = 
    X: 27540371650181561163208672964900973729470420238728950478919811969738134199870
    Y: 19755386299771259710738338973799913362714785991218934682176080685883211400359
~~~~

## Shamir Threshold Signature Ed25519


The administrator creates the composite key pair

~~~~
ED25519Aggregate Key (ED25519)
    UDF:        ZAAA-GTSI-GQED-255X-XAGG-REGA-TEXK-EY
    Scalar:     39348647608109113656999806950437958090469802387424444589375066079861075223816
    Encoded Private
  37 39 5E 7A  8B A5 A0 19  46 4B 58 22  EA 24 A5 71
  45 2C 2A AC  7A 3E FB CA  CE 3F D4 12  9A BA EB 70
    X: 1419883775837786745571650427751872907091518324989046123079211599049697167784279959512347660021645117385875752575303887583747824906047250057721855068523970
    Y: 2021102564980207199881041394826674856597514052094792772451795620676255050777515980186295517468245337267098109901934556623856152736116303441031851305458040
    Encoded Public
  6E 13 79 B4  39 DA 97 9C  5A 34 CE 79  CD 1B 50 DF
  A0 76 AD 49  81 6D 52 59  A4 2C DB CE  44 FF 3E F5
~~~~

Three key shares are required for Alice, Bob and Carol with a threshold of two. 
The parameters of the Shamir Secret Sharing polynomial are:

~~~~
a0 = 39348647608109113656999806950437958090469802387424444589375066079861075223816
a1 = 4798362372766583098538153346773251746668866286832200720618642047331470895827
~~~~

The key share values for the participants are

~~~~
xa = 1
ya = 724976516882123471698840918953244391995970517977199673982002497479820613709

xb = 2
yb = 5523338889648706570236994265726496138664836804809400394600644544811291509536

xc = 3
yc = 3084695685083027454801961049456753644476586732261693509217335653857308154374
~~~~

Alice and Carol are selected to sign the message "This is another test"

The Lagrange coefficients are:

~~~~
la = 3618502788666131106986593281521497120428558179689953803000975469142727125496
lc = 3618502788666131106986593281521497120428558179689953803000975469142727125494
~~~~


Alice and Carol select their values ra, rc

~~~~
ra = 6406776677070753991363579376151421775148434886279361733741879781662225472462
Ra = 
  7A 88 15 75  B9 99 00 3E  A8 8D D9 4F  CE 64 67 C0
  71 F6 1A B1  EE 1F 55 A3  71 07 31 BC  FC 5A 49 F1

rc = 5958533895226827077410644846357897216892759391052774026998871424715495190152
Rc = 
  00 89 C9 D9  B8 1C 6B 1D  44 A1 00 9C  16 99 CD AC
  BD FB 0C 0B  F8 65 5C 4A  FE 69 06 2D  58 17 19 A0
~~~~

The composite value R = R<sub>a</sub> + R<sub>c</sub>

~~~~
R =  
  DC 61 8E 8B  C6 A5 1D 2A  31 C0 19 E4  38 E0 C9 D2
  82 E4 E4 B2  53 06 0E A8  0B CE 4C FA  05 2B 74 FB
~~~~

The value k is 

~~~~
k = 5090734069278052398568674412399969210936717979539799439788022265641762483896
~~~~

The values R and k (or the document to be signed) and the 
Lagrange coefficients are passed to Alice and Carol who use them to 
calculate their secret scalar values:

~~~~
sa = 4705967563989316314534854659951363708422513956655753313973979215362458046058;
sc = 5694657734790748486572206038314617418618822993249060851393283111356800173802
~~~~

The signature contributions can now be calulated:

~~~~
Sa = 4584986261294035801359294763213012962375140035136167784561957449592014170956
Sc = 5308862698539411268940165555902442973527213832481365138518280072090984937511
~~~~

The dealer calculates the composite value S = S<sub>a</sub> + S<sub>b</sub>

~~~~
S =  2656843382501184856326273756072461695045237508237625317078286583397544857478
~~~~

The dealer checks to see that the signature verifies:

~~~~
S.B = R + kA = 
    X: 52723037549461607880395142365273697010074587609494537256541757983023705100003
    Y: 28519485444057715694172079072425502571337622066597069911947223402551723626936
~~~~


## Shamir Threshold Signature Ed448


The administrator creates the composite key pair

~~~~
ED448Aggregate Key (ED448)
    UDF:        ZAAA-ITSI-GQED-44XA-GGRE-GATE-XKEY
    Scalar:     508904606564197215312735879582840960158109827605415754207268050539683337837216003977228732536078674802149039736292653681850024283019712
    Encoded Private
  78 22 7E 3B  89 95 80 5D  04 19 DC 27  F1 7F 9B E4
  86 2B 0B DD  55 64 EE 04  19 49 4D DE  B9 04 3B 9E
  8B 7D DC EC  EC 8F DD 1D  E7 88 86 FD  11 FD 78 EF
  1A 8B 84 8F  77 00 73 65
    X: 441091733552781426694844383707249146851763689335471762398096297503768465595321590690311221269514682222687386378631457535068446135118173
    Y: 532194027185357212124609812001044341800778251886758682940700795084662920552823356888138706016038637934794839496624474125511419755284720
    Encoded Public
  43 61 20 A0  B1 DF AA BD  6B 55 00 97  A3 BE CB B8
  09 57 20 88  16 69 E4 B9  E1 7E 9C 13  C0 41 5B CB
  4D 3E E4 99  2E 2D 48 89  1C C0 FB 26  58 C2 DD 5C
  C1 DC 17 82  D7 A0 43 EE  80
~~~~

Three key shares are required for Alice, Bob and Carol with a threshold of two. 
The parameters of the Shamir Secret Sharing polynomial are:

~~~~
a0 = 508904606564197215312735879582840960158109827605415754207268050539683337837216003977228732536078674802149039736292653681850024283019712
a1 = 81763640362632609781245184407039159997924189738600045422528029988419458165806777919226920667788848948699787390681802128722805982483024
~~~~

The key share values for the participants are

~~~~
xa = 1
ya = 45539203705124657181988208073876719390802996828527254418678431142664784118404024747868387328790395860917945999699468896251562686553399

xb = 2
yb = 127302844067757266963233392480915879388727186567127299841206461131084242284210802667095307996579244809617733390381271024974368669036423

xc = 3
yc = 27356803356488154107147624915953905798241036133897830193361941324357696488477994870126473372675717795007227071971410848923418791869668
~~~~

Alice and Carol are selected to sign the message "This is another test"

The Lagrange coefficients are:

~~~~
la = 90854840536950861318665475986000566794205170085914757535186274897573001980769792858097877645846187981655146854545831152386877929824891
lc = 90854840536950861318665475986000566794205170085914757535186274897573001980769792858097877645846187981655146854545831152386877929824889
~~~~


Alice and Carol select their values ra, rc

~~~~
ra = 140602095559799923079202043450472558801821215905773830144701352692279040495252484937852810444924482680594152694241752895011658904370203
Ra = 
  6A B9 49 CA  C0 02 64 DA  7B 1F 8A D4  DA 60 C2 90
  82 6C 6D E7  A3 86 9A 7C  5A 7E BF 40  36 A9 9B 1B
  93 10 63 FE  78 66 AC 25  D7 7A 39 F6  AA D4 9A 7F
  0A B7 0F 74  1F 71 C5 82  00

rc = 165716053544622271241818501763718522875598899258014892642685013795902852868485411394534732568482310440218957473271958755451433805499840
Rc = 
  D8 60 C2 5E  80 7C 2F 72  9F CB 44 A5  8F 0E C5 21
  0E 3B 8F 2B  45 FE F4 EA  82 10 A1 BC  0F 76 B2 F7
  C9 FA F4 6C  FB DC A2 E3  30 1E 32 60  B5 C3 14 21
  B8 64 17 53  AD 69 CF 78  00
~~~~

The composite value R = R<sub>a</sub> + R<sub>c</sub>

~~~~
R =  
  69 61 D0 FE  4A 16 2A C5  27 A2 43 8A  3B C8 FD 74
  E7 5E 59 F3  BA 81 2C 19  C7 1A 06 D3  B1 67 23 56
  20 D5 47 B5  B7 29 32 C3  2A 46 B3 FE  69 F1 0F 68
  B4 96 1D 17  62 28 4F 85  00
~~~~

The value k is 

~~~~
k = 69669457160685458826819431046668880610248418313436871579951643706874289986533341576712239222292680327853609885366701528395671464840010
~~~~

The values R and k (or the document to be signed) and the 
Lagrange coefficients are passed to Alice and Carol who use them to 
calculate their secret scalar values:

~~~~
sa = 159163646094637847091647788096815645880409665328705639163203921611570178158375829979900458639031781773032065854095034496764221959654988;
sc = 168031279395657645583757139514024180689289822104880599973691579132967155717300588281132518605354517065806680173105956880312046463714945
~~~~

The signature contributions can now be calulated:

~~~~
Sa = 99282191570211497978506382148272186286114227996378757084483812847318369563947396286382181212781977090773375935160591156690195433493947
Sc = 66403583839582980951205526601873116440537968767528426705390384040962758446002221640382906132843617110569116575554884834666052343512296
~~~~

The dealer calculates the composite value S = S<sub>a</sub> + S<sub>b</sub>

~~~~
S =  165685775409794478929711908750145302726652196763907183789874196888281128009949617926765087345625594201342492510715475991356247777006243
~~~~

The dealer checks to see that the signature verifies:

~~~~
S.B = R + kA = 
    X: 30591501150335992421374326582040572679060605290754973521167789337999057647193
    Y: 8995421542205063682252153813702991117815238819406285788497204791173545074494
~~~~


