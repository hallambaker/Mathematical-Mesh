<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8">
    <meta content="Common,Latin" name="scripts">
    <meta content="initial-scale=1.0" name="viewport">
    <title>Mathematical Mesh 3.0 Part VI: Reliable Datagram Protocol</title>
    <meta name="author" content="Phillip Hallam-Baker">
    <meta name="description" content="A presentation layer suitable for use in conjunction with HTTP and UDP transports is described. https://mailarchive.ietf.org/arch/browse/mathmesh/Discussion of this draft should take place on the MathMesh mailing list (mathmesh@ietf.org), which is archived at . ">
    <meta content="rfctool 2.0" name="generator">
    <meta content="Threshold Cryptography" name="keyword">
    <meta content="Elliptic Curve" name="keyword">
    <meta content="Threshold Encryption" name="keyword">
    <meta content="Threshold Key Generation" name="keyword">
    <meta content="Ceremony" name="keyword">
    <link href="#copyright" rel="license">
    <style type="text/css">
/* fonts */
@import url('https://fonts.googleapis.com/css?family=Noto+Sans'); /* Sans-serif */
@import url('https://fonts.googleapis.com/css?family=Noto+Serif'); /* Serif (print) */
@import url('https://fonts.googleapis.com/css?family=Roboto+Mono'); /* Monospace */

@viewport {
  zoom: 1.0;
  width: extend-to-zoom;
}
@-ms-viewport {
  width: extend-to-zoom;
  zoom: 1.0;
}
/* general and mobile first */
html {
}
body {
  max-width: 90%;
  margin: 1.5em auto;
  color: #222;
  background-color: #fff;
  font-size: 14px;
  font-family: 'Noto Sans', Arial, Helvetica, sans-serif;
  line-height: 1.6;
  scroll-behavior: smooth;
}
.ears {
  display: none;
}

/* headings */
#title, h1, h2, h3, h4, h5, h6 {
  margin: 1em 0 0.5em;
  font-weight: bold;
  line-height: 1.3;
}
#title {
  clear: both;
  border-bottom: 1px solid #ddd;
  margin: 0 0 0.5em 0;
  padding: 1em 0 0.5em;
}
.filename
{
    font-size: 20px;
    color: darkgray;
}
.author {
  padding-bottom: 4px;
}
h1 {
  font-size: 26px;
  margin: 1em 0;
  color: blueviolet;
}
h2
{
    font-size: 22px;
    margin-top: -20px; /* provide offset for in-page anchors */
    padding-top: 33px;
    color: blueviolet;
}
h3
{
    font-size: 18px;
    margin-top: -36px; /* provide offset for in-page anchors */
    padding-top: 42px;
    color: blueviolet;
}
h4
{
    font-size: 16px;
    margin-top: -36px; /* provide offset for in-page anchors */
    padding-top: 42px;
    color: blueviolet;
}
h5, h6 {
  font-size: 14px;
}
#n-copyright-notice {
  border-bottom: 1px solid #ddd;
  padding-bottom: 1em;
  margin-bottom: 1em;
}
/* general structure */
p {
  padding: 0;
  margin: 0 0 1em 0;
  text-align: left;
}
div, span {
  position: relative;
}
div {
  margin: 0;
}
.alignRight.art-text {
  background-color: #f9f9f9;
  border: 1px solid #eee;
  border-radius: 3px;
  padding: 1em 1em 0;
  margin-bottom: 1.5em;
}
.alignRight.art-text pre {
  padding: 0;
}
.alignRight {
  margin: 1em 0;
}
.alignRight > *:first-child {
  border: none;
  margin: 0;
  float: right;
  clear: both;
}
.alignRight > *:nth-child(2) {
  clear: both;
  display: block;
  border: none;
}
svg {
  display: block;
}
.alignCenter.art-text {
  background-color: #f9f9f9;
  border: 1px solid #eee;
  border-radius: 3px;
  padding: 1em 1em 0;
  margin-bottom: 1.5em;
}
.alignCenter.art-text pre {
  padding: 0;
}
.alignCenter {
  margin: 1em 0;
}
.alignCenter > *:first-child {
  border: none;
  /* this isn't optimal, but it's an existence proof.  PrinceXML doesn't
     support flexbox yet.
  */
  display: table;
  margin: 0 auto;
}

/* lists */
ol, ul {
  padding: 0;
  margin: 0 0 1em 2em;
}
ol ol, ul ul, ol ul, ul ol {
  margin-left: 1em;
}
li {
  margin: 0 0 0.25em 0;
}
.ulCompact li {
  margin: 0;
}
ul.empty, .ulEmpty {
  list-style-type: none;
}
ul.empty li, .ulEmpty li {
  margin-top: 0.5em;
}
ul.compact, .ulCompact,
ol.compact, .olCompact {
  line-height: 100%;
  margin: 0 0 0 2em;
}

/* definition lists */
dl {
}
dl > dt {
  float: left;
  margin-right: 1em;
  font-weight: bold;
}
    dl.nohang > dt
    {
        float: none;
        font-weight: bold;
    }
dl > dd {
  margin-bottom: .8em;
  min-height: 1.3em;
}
dl.compact > dd, dlCompact > dd {
  margin-bottom: 0em;
}
dl > dd > dl {
  margin-top: 0.5em;
  margin-bottom: 0em;
}

/* links */
a {
  text-decoration: none;
}
a[href] {
  color: #3E8EDE;
}
a[href]:hover {
  background-color: #f2f2f2;
}
figcaption a[href],
a[href].selfRef {
  color: blueviolet;
}
/* XXX probably not this:
a.selfRef:hover {
  background-color: transparent;
  cursor: default;
} */

/* Figures */
tt, code, pre, code {
  background-color: #f9f9f9;
  font-family: 'Roboto Mono', monospace;
}
pre {
  border: 1px solid #eee;
  margin: 0;
  padding: 1em;
}
img {
  max-width: 100%;
}
figure {
  margin: 0;
}
figure blockquote {
  margin: 0.8em 0.4em 0.4em;
}
figcaption {
  font-style: italic;
  margin: 0 0 1em 0;
}
@media screen {
  pre {
    overflow-x: auto;
    max-width: 100%;
    max-width: calc(100% - 22px);
  }
}

/* aside, blockquote */
aside, blockquote {
  margin-left: 0;
  padding: 1.2em 2em;
}
blockquote {
  background-color: #f9f9f9;
  border: 1px solid #ddd;
  border-radius: 3px;
  margin: 1em 0;
}
cite {
  display: block;
  text-align: right;
  font-style: italic;
}

/* tables */
table {
  width: 100%;
  margin: 0 0 1em;
  border-collapse: collapse;
  border: 1px solid #eee;
}
th, td {
  text-align: left;
  vertical-align: top;
  padding: 0.5em 0.75em;
}
th {
  text-align: left;
  background-color: #e9e9e9;
}
tr:nth-child(2n+1) > td {
  background-color: #f5f5f5;
}
table caption {
  font-style: italic;
  margin: 0;
  padding: 0;
  text-align: left;
}
table p {
  /* XXX to avoid bottom margin on table row signifiers. If paragraphs should
     be allowed within tables more generally, it would be far better to select on a class. */
  margin: 0;
}

/* pilcrow */
a.pilcrow {
  color: #777;
  text-decoration: none;
  visibility: hidden;
  user-select: none;
  -ms-user-select: none;
  -o-user-select:none;
  -moz-user-select: none;
  -khtml-user-select: none;
  -webkit-user-select: none;
  -webkit-touch-callout: none;
}
@media screen {
  aside:hover > a.pilcrow,
  p:hover > a.pilcrow,
  blockquote:hover > a.pilcrow,
  div:hover > a.pilcrow,
  li:hover > a.pilcrow,
  pre:hover > a.pilcrow {
    visibility: visible;
  }
  a.pilcrow:hover {
    background-color: transparent;
  }
}

/* misc */
hr {
  border: 0;
  border-top: 1px solid #eee;
}
.bcp14 {
  font-variant: small-caps;
}

.role {
  font-variant: all-small-caps;
}

/* info block */
#identifiers {
  margin: 0;
  font-size: 0.9em;
}
#identifiers dt {
  width: 3em;
  clear: left;
}
#identifiers dd {
  float: left;
  margin-bottom: 0;
}
#identifiers .authors .author {
  display: inline-block;
  margin-right: 1.5em;
}
#identifiers .authors .org {
  font-style: italic;
}

/* The prepared/rendered info at the very bottom of the page */
.docInfo {
  color: #999;
  font-size: 0.9em;
  font-style: italic;
  margin-top: 2em;
}
.docInfo .prepared {
  float: left;
}
.docInfo .prepared {
  float: right;
}

/* table of contents */
#toc  {
  padding: 0.75em 0 2em 0;
  margin-bottom: 1em;
}
nav.toc ul {
  margin: 0 0.5em 0 0;
  padding: 0;
  list-style: none;
}
nav.toc li {
  line-height: 1.3em;
  margin: 0.75em 0;
  padding-left: 1.2em;
  text-indent: -1.2em;
}
/* references */
.reference dt {
  text-align: right;
  font-weight: bold;
  min-width: 7em;
}
.reference dd {
  margin-left: 8em;
  overflow: auto;
}

.refInstance {
  margin-bottom: 1.25em;
}

.reference .ascii {
  margin-bottom: 0.25em;
}

/* index */
.index ul {
  margin: 0 0 0 1em;
  padding: 0;
  list-style: none;
}
.index ul ul {
  margin: 0;
}
.index li {
  margin: 0;
  text-indent: -2em;
  padding-left: 2em;
  padding-bottom: 5px;
}
.indexIndex {
  margin: 0.5em 0 1em;
}
.index a {
  font-weight: 700;
}
/* make the index two-column on all but the smallest screens */
@media (min-width: 600px) {
  .index ul {
    -moz-column-count: 2;
    -moz-column-gap: 20px;
  }
  .index ul ul {
    -moz-column-count: 1;
    -moz-column-gap: 0;
  }
}

/* authors */
address.vcard {
  font-style: normal;
  margin: 1em 0;
}

address.vcard .nameRole {
  font-weight: 700;
  margin-left: 0;
}
address.vcard .label {
  font-family: "Noto Sans",Arial,Helvetica,sans-serif;
  margin: 0.5em 0;
}
address.vcard .type {
  display: none;
}
.alternative-contact {
  margin: 1.5em 0 1em;
}
hr.addr {
  border-top: 1px dashed;
  margin: 0;
  color: #ddd;
  max-width: calc(100% - 16px);
}

/* temporary notes */
.rfcEditorRemove::before {
  position: absolute;
  top: 0.2em;
  right: 0.2em;
  padding: 0.2em;
  content: "The RFC Editor will remove this note";
  color: #b76427;
  background-color: rgba(249, 232, 105, 0.3);
}
.rfcEditorRemove {
  position: relative;
  padding-top: 1.8em;
  background-color: rgba(249, 232, 105, 0.3);
  border-radius: 3px;
}
.cref {
  background-color: rgba(249, 232, 105, 0.3);
  padding: 2px 4px;
}
.crefSource {
  font-style: italic;
}
/* alternative layout for smaller screens */
@media screen and (max-width: 1023px) {
  body {
    padding-top: 2em;
  }
  #title {
    padding: 1em 0;
  }
  h1 {
    font-size: 24px;
  }
  h2 {
    font-size: 20px;
    margin-top: -18px;  /* provide offset for in-page anchors */
    padding-top: 38px;
  }
  #identifiers dd {
    max-width: 60%;
  }
  /* Just get rid of the idiot stuff: */
  /*
  #toc {
    position: fixed;
    z-index: 2;
    top: 0;
    right: 0;
    padding: 0;
    margin: 0;
    background-color: inherit;
    border-bottom: 1px solid #ccc;
  }
  #toc h2 {
    margin: -1px 0 0 0;
    padding: 4px 0 4px 6px;
    padding-right: 1em;
    min-width: 190px;
    font-size: 1.1em;
    text-align: right;
    background-color: #444;
    color: white;
    cursor: pointer;
  }
  #toc h2::before { 
    float: right;
    position: relative;
    width: 1em;
    height: 1px;
    left: -164px;
    margin: 6px 0 0 0;
    background: white none repeat scroll 0 0;
    box-shadow: 0 4px 0 0 white, 0 8px 0 0 white;
    content: "";
  }
  #toc nav {
    display: none;
    padding: 0.5em 1em 1em;
    overflow: auto;
    height: calc(100vh - 48px);
    border-left: 1px solid #ddd;
  }*/
}

/* alternative layout for wide screens */
@media screen and (min-width: 1024px) {
  body {
    max-width: 724px;
    margin: 42px auto;
    padding-left: 1.5em;
    padding-right: 29em;
  }
  #toc {
    position: fixed;
    top: 42px;
    right: 42px;
    width: 25%;
    margin: 0;
    padding: 0 1em;
    z-index: 1;
  }
  #toc h2 {
    border-top: none;
    border-bottom: 1px solid #ddd;
    font-size: 1em;
    font-weight: normal;
    margin: 0;
    padding: 0.25em 1em 1em 0;
  }
  #toc nav {
    display: block;
    height: calc(90vh - 84px);
    bottom: 0;
    padding: 0.5em 0 0;
    overflow: auto;
  }
  img { /* future proofing */
    max-width: 100%;
    height: auto;
  }
}

/* pagination */
@media print {
	/*
  body {
    font-family: 'Noto Serif', "Times New Roman", Times, serif;
    width: 100%;
  }*/
  p {
    orphans: 3;
    widows: 3;
  }
  #n-copyright-notice {
    border-bottom: none;
  }
  #toc, #n-introduction {
    page-break-before: always;
  }
  #toc {
    border-top: none;
    padding-top: 0;
  }
  figure, pre {
    page-break-inside: avoid;
  }
  figure {

  }
  h1, h2, h3, h4, h5, h6 {
    page-break-after: avoid;
	break-after: avoid;
  }
  h2+*, h3+*, h4+*, h5+*, h6+* {
    page-break-before: avoid;
  }
  pre {
    white-space: pre-wrap;
    word-wrap: break-word;
    font-size: 10pt;
  }
  table {
    border: 1px solid #ddd;
  }
  td {
    border-top: 1px solid #ddd;
  }
}

.ears thead .left {
  string-set: ears-top-left content();
}

.ears thead .center {
  string-set: ears-top-center content();
}

.ears thead .right {
  string-set: ears-top-right content();
}

.ears tfoot .left {
  string-set: ears-bottom-left content();
}

.ears tfoot .center {
  string-set: ears-bottom-center content();
}

.ears tfoot .right {
  string-set: ears-bottom-right content();
}

@page :first {
  padding-top: 0;
  @top-left {
    content: normal;
    border: none;
  }
  @top-center {
    content: normal;
    border: none;
  }
  @top-right {
    content: normal;
    border: none;
  }
}


@page {
  size: A4;
  margin-bottom: 45mm;
  padding-top: 20px;
  @top-left {
    content: 'Internet-Draft';
    vertical-align: bottom;
    border-bottom: solid 1px #ccc;
  }
  @top-left {
    content: string(ears-top-left);
    vertical-align: bottom;
    border-bottom: solid 1px #ccc;
  }
  @top-center {
    content: string(ears-top-center);
    vertical-align: bottom;
    border-bottom: solid 1px #ccc;
  }
  @top-right {
    content: string(ears-top-right);
    vertical-align: bottom;
    border-bottom: solid 1px #ccc;
  }
  @bottom-left {
    content: string(ears-bottom-left);
    vertical-align: top;
    border-top: solid 1px #ccc;
  }
  @bottom-center {
    content: string(ears-bottom-center);
    vertical-align: top;
    border-top: solid 1px #ccc;
  }
  @bottom-right {
      content: '[Page ' counter(page) ']';
      vertical-align: top;
      border-top: solid 1px #ccc;
  }
}
    </style>
    <link href="rfc-local.css" rel="stylesheet" type="text/css">
    <link href="urn:issn:2070-1721" rel="alternate">
<link rel="icon" href="data:image/svg+xml;base64,iVBORw0KGgoAAAANSUhEUgAAALQAAAC0CAYAAAA9zQYyAAAABHNCSVQICAgIfAhkiAAAAAlwSFlzAAAJuwAACbsBBxD8PQAAABl0RVh0U29mdHdhcmUAd3d3Lmlua3NjYXBlLm9yZ5vuPBoAAA6LSURBVHic7d1rcFTlGQfw/9lLkk0IuUBQNjEQyIUEAkUIkg7UcFMJ4I3BQpR2xo626nSmln5o7XQInY52OtTp1H5wEMapMxVEKGgCKpchCKKIgEruN5bcISG3zW2zl9MPKWjMbrK72XPe97zn+X3MnssD85/d57znnPeV8H+FKHwIwG8BLAcQA0L41wPgcwnS6zux8yQAGAFgF3btBLAPQCqACHb1ERKQCIxk9pk85MklKDkr7cKuDTLkYtaVETJZEqR8gwx5B+tCCAkFGfIOA4Ac1oUQEiLLDACmsK6CkBCJNrCugJBQokAToVCgiVAo0EQoFGgiFAo0EQoFmgiFAk2EQoEmQqFAE6FQoIlQKNBEKBRoIhQKNBEKBZoIhQJNhEKBJkKhQBOhUKCJUCjQRCgUaCIUCjQRCgWaCIUCTYRCgSZCoUAToVCgiVAo0EQoFGgiFBPrAu4wmAyIT4tHREwEwqaEsS5nFOeAE40XGlU9pzHMiFk/maXqOf3h6HXA3mJH/61+uIfdrMsZg3mgY5JjsPovq5G5ORPmSDPrcrzyuDx4Pel19N/sV+2c4THh2H5yu2rnC5TsltH4eSPOvXoOtR/Vsi7nLqYtR9zcODz/1fNYuH0ht2EGRn49FmxdwLoMrkhGCckrklFwrACLfraIdTl3MQ10XmEeIhMiWZbgt4XPLGRdApckScKaV9cAEutKRjAN9H2597E8fUCsS62YnjmddRlcik6MhiXewroMADTKERD6lvbO4/LA0etgXQYAxoFuON/A8vQByy7I5uanlScN5xrgcXpYlwGAcaDP/vksBjsHWZYQkNjZsZi1kr+hNJaGuodw4ncnWJdxF9NAd9V34e2Vb6PlUgvLMgJCbccIj8uD0gOl2Lt8L1qvtLIu5y7m49Dt5e1464G3kLgsEfMen4f0jemYsWAG67J8ytqSheO/Pg63g7+bCkqTZRmNnzWidH8pyt4vw0D7AOuSxmAeaACADDRfbEbzxWac/sNpRCdGI/PJTKx8ZSWm3MvXMooRsRFI35iOisMVrEtRleyWceDxA6gurmZdyri4HOWwN9vx5RtfYs+SPeiq62Jdzhh6bDu+eecb7sMMcBroO+wtdux/dD93P+9p+WncjLuqpez9MtYl+IXrQAMjPfaF3RdYlzGKMcyI+T+dz7oMVfXc6GFdgl+4DzQAXPj7BW4G7u9Y+LS+2g57q511CX7RRKCHuoZwdd9V1mWMkvTjJMTNiWNdhmp4a/t80USgAeDynsuQZZl1GXdJkqTLi0PeaSbQHZUd3N2AoUDzRzOBBoDS/aWsSxglPi0eicsSWZdBvkdbgX6vFLKbn7YDoG9p3mgq0H2tfbjx6Q3WZYyyYOsCGMzB/zcaw4whrIZoKtAAUHqAr7YjMiESqQ+nBrWvyWKCNcca4or0TXOBLnu/jLu3jYNtO1JWpSAsiq833LVOc4Ee6hpC/cl61mWMkvFYBsJjwgPeL21DmgLV6JvmAg0A1/ZfY13CKKYIEzKfzAx4v7R8CnSoaTLQlUcr4ex3si5jlEDbjhnZMxA7O1ahavRLk4F29jtRc7yGdRmjzM6bjan3TfV7+/SN6QpWo1+aDDTAX9shGaSRl2j9lL6BAq0EzQa65ngNhrqHWJcxir8zCFniLUh8gO4wKkGzgXY73Kg8Wsm6jFESshJw74/unXC7tPw0GEya/a/nmqb/V3m7yQIA2U9P3HbQcJ1yNB3o66evqzojqD+yC7IhGX3PRiMZJcxdN1fFivRF04H2uDwoP1zOuoxRoq3RSFmd4vPz5BXJsEzT1/uIatJ0oAH+HikFxh+TptENZWk+0A2fNXD3AmfW5iyfqxBQ/6wszQcaMn+v2JujzMh4NGPM32NTYpGQlcCgIv3QVKB9vZTKZduxfWzbQe2G8jQVaF9DYq1XWtFR0aFyNeObs3bOmGnM6Ha38jQV6PlPzYfJ4n06vrKDfLUdP1yXxRxlxqwHaSpepWkq0OFTw33+bPN4k+X7ox1z182FKYKPuTFFpqlAA76HxDoqO9D2dZvK1Yxv5pKZSJg/chFIoxvq0Fyg0/LTEDnd+8pZPF4c3lnGIm09BVoNmgu0wWxA1pYsr59d23+Nq9mVgJFfFOsSK6ITo1mXoguaCzQALNru/THN3sZeNF1oUrma8cUkx2DNa2tYl6Ebmgx0Um4SpqVP8/oZjxeHc9bOYV2Cbmgy0ACwYJv3pYpL3yuFx8XHEmNEfZoN9MKnF3pdM3CgfQC2MzbV6wlWTwNfz6FonWYDPd5EiTy2Hd501naio5KvO5xap9lAA77HpMsPlcM15FK5msBVHuHrFTIRaDrQ2duyvU526Oh1oO6TOgYVBabqwyrWJQhH04G2TLNg7sPeX2fibZqDHxq8PYjGzxtZlyEcTQca8L14T3VRNYb7hlWuxn9VRVXczXUtAs0HOuOxDETERoz5u3PAieoifheKpHZDGZoP9HgTJfLadrgdbtSf4msGVVFoPtCA79GO2o9rMXh7UOVqJlZ/qh7Ddn7bIS0TItCzHpzldaJEj9ODiiP8LTJP7YZyhAj0eBMl8naTRZZlVB/jt7fXOiECDfieKNF2xgZ7Cz/L+rZ82QJ7Mz/1iEaYQPuaKFH2yCg/xM/sStRuKEuYQAO+l3jgqe2oKqJAK0moQPta86/piyZ0X+9WuZqxuuq7cOvaLdZlCE2oQPskjzwnzVrVB/TtrDR9BBp8vEBL/bPydBPom9/eRHtZO7PzD3YOouF8A7Pz64VuAg2wbTtqjtfQq2Eq0FWgr73LbpoDajfUoatAd9V1ofVyq+rndTvcmnjhQAS6CjTA5uLw+pnrcPQ6VD+vHukv0AdKIXvUbTuo3VCP7gJtb7GrOtogyzLXLxqIRneBBtRtO9qutKG3qVe18+mdLgNdfqgcHqc6Q2jUbqhLl4Ee6BhQ7RWoyg9o7g016TLQgDpP4PU09ODmtzcVPw/5jm4DXXGkAq5BZWdXqvqgCqCZClSl20AP24dRc7xG0XNQ/6w+3QYaULbtcPQ4cOPTG4odn3in60BXF1fD0aPMHbya4zVwD7sVOTbxTdeBdg25FGsLqN1gQ9eBBpSZXcnj9KD249qQH5dMTPeBrj9Zj/5b/SE9pu2sDUPdQyE9JvGP7gPtcXlCPvE4tRvsaCrQksHLoiohEOq2gx5GYkdTgQ6bEjbu5wZTcP+chnMNIXuAqO3rNnTb2E+ZoFdiBdoc3D9H9sgoO1gW1L4/RO0GW5oJtCXeMuE3sCncFPTxQ3WThdoNtjQT6OmZ0yfcxtei9v5oudSCzprOoPcHAHuzHS2XWyZ1DDI5mgl0QmbChNtMdoH4yU5zUFVEDyOxpplAp6xJmXCbpOVJMEeagz7Htf9MbrSj8ig9+8yaJgJtMBmQ+nDqhNuZIkzIeCwj6PN0VHYE/fzysH0YthJb0OcmoaGJQKdvTEdE3NiVrrzJfTl3UucK9uKw9pNauB30MBJrmgh07g7/Q2rNsU7qW7r0QGlQsyuFerjOaPY+NTAzytzTCjnuA526PhXJK5ID2ueh3Q/BHBVcL919vRvNF5sD2sfj8qDmWGhfFrDEW0J6vMmKnBb8CJKauA50WHQYNr65MeD94lPjsWnPpqDPG2jb0fhZIwY7Q7t83IzsGSE93mRNmTmFdQl+4TbQklHCE/9+AjHJMUHtn12Qjfx/5Qf1U1l2sCygZYuVeLN7/lPzQ37MybAutbIuwS98BloC8t/Ix7wn5k3qMDkv5aCguCDgb5e+1j7Yztr83j7U/XPGoxmTug5QQu7LuQiLHv/RAx5wF2hzlBlbDm7B0heWhuR4aflpeLH0RSx+dnFA39b+zq7UXtaOrrquIKv7TtiUMKSuT8Uj/3gEWw5ugSTxdRUWNzcOBcUFsOZYub5AlApRyM29raTlSdi0Z5Ni/aOtxIbiXxbjdvXtCbe1xFuwo3WHz4WI7jj/2nmcfuV0UPXEpsQiuyAb6RvSYc2xBv20oNp6GnpQ8d8KXNl7hemqCN5wEeiI2Ais/eta3P/c/Yo983yHa9CFU78/hYv/vDjhttuKtiF9Y/q42+zL3YemL5oCrmP5b5Zj3d/WBf2EIA9kWcbVvVdx7MVj3KxOYMxDXiHLAhKXJeLZc89idt5sVX5mDWYDUtenwmA0wHbGNu62kiQhc3Omz8/72vpwYseJgJ/fSFmdgs3vboZk5Pi32w+SJGHmkpmADG7ukjL9ejCGGbH16FYmQ0Ir/7gS9yy6Z9xtqj6sgnPA6fPz6qLqoOaaXvyLxQHvw7Ocl3JYl3AX00DHpsQyG9+UDNKEz4cM9w2P+3xzsKMbcSlxQe3Hq8jpkYiI9e/RBKUxDTTriVjczonP7+smi7PfifrTwc1g2nezL6j9eOVxeeAaUnaeQH8xDXT39W5ms3O6h91+vV1S81GN1ykJ6k7WBT3Z41dvfsVsNS4lVH1YRYG+49DWQ34No4XSsH0YR39+FJ21E7+h4na4vU5zMJlljus+qUPRc0VCzN3RcL4Bxb8qZl3GXVwM2xlMIyMPScuTEG2NRtSMqAnHfwMiA/23+tF/qx+3ym6h8khlQM9eJK9IxoM7Hxz1t8MFhzHQPjCpssxRZsxZOwcz75+JqIQoRN0ThfCp4ZM6ptJcQy70tfWht6kXthLbyISUzBP0HS4CTUioMG85CAklCjQRCgWaCIUCTYRCgSZCoUAToVCgiVAo0EQoFGgiFAo0EQoFmgiFAk2EQoEmQqFAE6FQoIlQKNBEKBRoIhQKNBEKBZoIhQJNhEKBJkKhQBOhUKCJUCjQRCgUaCIUCjQRCgWaCIUCTYRCgSZCoUAToVCgiVAo0EQoFGgiFAMAO+siCAmRHgOAS6yrICRELhkkSLtZV0FIKEiQdhtLUFK7Cqs8APIAaHvxaaJXsgTpTzux820jAJSg5NNVWHUeQAKA6QAsTMsjxD9dAM4AeKEQhe8AwP8A7VA52MoWrGIAAAAASUVORK5CYII=">  </head>
  <body>
    <table class="ears">
      <thead>
        <tr>
          <td class="left"/>
          <td class="center">Reliable Datagram Protocol</td>
          <td class="right">April 2021</td>
        </tr>
      </thead>
      <tfoot>
        <tr>
          <td class="left">Hallam-Baker</td>
          <td class="center">Expires October 15, 2021</td>
          <td class="right">[Page]</td>
        </tr>
      </tfoot>
    </table>

    <div id="external-metadata" class="document-information">
    </div>
    <div id="internal-metadata" class="document-information">
      <dl id="identifiers">
        <dt class="label-workgroup">Workgroup:</dt>
        <dd class="workgroup">Network Working Group</dd>
        <dt class="label-stream">Stream:</dt>
        <dd class="stream">Internet-Draft</dd>
        <dt class="label-category">Intended status:</dt>
        <dd class="category">Informational</dd>
        <dt>Published:</dt>
        <dd>
          <time class="published" datetime="2021-04-13">13 April 2021</time>
        </dd>
        <dt class="label-issn">ISSN:</dt>
        <dd class="issn">2070-1721</dd>
        <dt>Expires</dt>
        <dd>
          <time class="expires" datetime="2021-10-15">15 October 2021</time>
        </dd>
        <dt>Authors:</dt>
        <dd class="authors">
          <div class="author">
<div class="author-name">Phillip Hallam-Baker</div><div class="org">ThresholdSecrets.com</div>          </div>
        </dd>
      </dl>
    </div>
    <h1 id="title">
      Mathematical Mesh 3.0 Part VI: Reliable Datagram Protocol
      <h1 id="idnum">draft-hallambaker-mesh-rdp-00</h1>
    </h1>
    <section id="abstract">
      <h3>
        <a class="selfRef" href="#abstract">Abstract</a>
      </h3>
      <p id="s-abstract-1">A presentation layer suitable for use in conjunction with HTTP and UDP transports is described.<a class="pilcrow" href="#s-abstract-1">&para;</a></p>
      <p id="s-abstract-2"><a class="eref" href="http://whatever">https://mailarchive.ietf.org/arch/browse/mathmesh/</a>Discussion of this draft should take place on the MathMesh mailing list (mathmesh@ietf.org), which is archived at .<a class="pilcrow" href="#s-abstract-2">&para;</a></p>
    </section>
    
    <section id="n-status-of-this-memo">
      <h3 id="bp-1">
        <a class="selfRef" href="#bp-1"></a>
        <a class="selfRef" href="#n-status-of-this-memo">Status of This Memo</a>
      </h3>
      <p id="bp-1-1">This Internet-Draft is submitted in full conformance with the provisions of BCP 78 and BCP 79.<a class="pilcrow" href="#bp-1-1">&para;</a></p>
      <p id="bp-1-2">Internet-Drafts are working documents of the Internet Engineering Task Force (IETF).  Note that other groups may also distribute working documents as Internet-Drafts. The list of current Internet-Drafts is at <a class="eref" href="http://datatracker.ietf.org/drafts/current/">http://datatracker.ietf.org/drafts/current/</a>.<a class="pilcrow" href="#bp-1-2">&para;</a></p>
      <p id="bp-1-3">Internet-Drafts are draft documents valid for a maximum of six months and may be updated, replaced, or obsoleted by other documents at any time.It is inappropriate to use Internet-Drafts as reference material or to cite them other than as "work in progress."<a class="pilcrow" href="#bp-1-3">&para;</a></p>
      <p id="bp-1-4">This Internet-Draft will expire on October 15, 2021<a class="pilcrow" href="#bp-1-4">&para;</a></p>
    </section>
    
    <section id="n-copyright-notice">
      <h3 id="bp-2">
        <a class="selfRef" href="#bp-2"></a>
        <a class="selfRef" href="#n-copyright-notice">Copyright Notice</a>
      </h3>
      <p id="bp-2-1">Copyright (c) IETF Trust and the persons identified as the document authors. All rights reserved.<a class="pilcrow" href="#bp-2-1">&para;</a></p>
      <p id="bp-2-2">This document is subject to BCP 78 and the IETF Trust’s Legal Provisions Relating to IETF Documents (http://trustee.ietf.org/license-info) in effect on the date of publication of this document. Please review these documents carefully, as they describe your rights and restrictions with respect to this document.<a class="pilcrow" href="#bp-2-2">&para;</a></p>
    </section>
    
    <section id="toc">
      <h3>
        <a class="selfRef" href="#toc">Table of Contents</a>
      </h3>
      <nav class="toc">
        <ul class="toc">
          <li class="toc">
            <a href="#s-1">1.</a><a href="#n-introduction">Introduction</a>
            <ul class="toc">
              <li class="toc">
                <a href="#s-1_1">1.1.</a><a href="#n-background">Background</a>
                <ul class="toc">
                  <li class="toc">
                    <a href="#s-1_1_1">1.1.1.</a><a href="#n-protocol-elements">Protocol Elements</a>
                  </li>
                  <li class="toc">
                    <a href="#s-1_1_2">1.1.2.</a><a href="#n-application-interface">Application Interface</a>
                  </li>
                </ul>
              </li>
              <li class="toc">
                <a href="#s-1_2">1.2.</a><a href="#n-use-cases">Use Cases</a>
                <ul class="toc">
                  <li class="toc">
                    <a href="#s-1_2_1">1.2.1.</a><a href="#n-network-agility">Network Agility</a>
                  </li>
                  <li class="toc">
                    <a href="#s-1_2_2">1.2.2.</a><a href="#n-connection-transfer-and-delegation">Connection Transfer and Delegation</a>
                  </li>
                  <li class="toc">
                    <a href="#s-1_2_3">1.2.3.</a><a href="#n-presence">Presence</a>
                  </li>
                  <li class="toc">
                    <a href="#s-1_2_4">1.2.4.</a><a href="#n-nat-transit">NAT Transit</a>
                  </li>
                  <li class="toc">
                    <a href="#s-1_2_5">1.2.5.</a><a href="#n-ipv6-agility">IPv6 Agility</a>
                  </li>
                  <li class="toc">
                    <a href="#s-1_2_6">1.2.6.</a><a href="#n-tunneling">Tunneling</a>
                  </li>
                </ul>
              </li>
            </ul>
          </li>
          <li class="toc">
            <a href="#s-2">2.</a><a href="#n-definitions">Definitions</a>
            <ul class="toc">
              <li class="toc">
                <a href="#s-2_1">2.1.</a><a href="#n-requirements-language">Requirements Language</a>
              </li>
              <li class="toc">
                <a href="#s-2_2">2.2.</a><a href="#n-defined-terms">Defined Terms</a>
              </li>
              <li class="toc">
                <a href="#s-2_3">2.3.</a><a href="#n-related-specifications">Related Specifications</a>
              </li>
              <li class="toc">
                <a href="#s-2_4">2.4.</a><a href="#n-implementation-status">Implementation Status</a>
              </li>
            </ul>
          </li>
          <li class="toc">
            <a href="#s-3">3.</a><a href="#n-architecture">Architecture</a>
            <ul class="toc">
              <li class="toc">
                <a href="#s-3_1">3.1.</a><a href="#n-connections">Connections</a>
              </li>
              <li class="toc">
                <a href="#s-3_2">3.2.</a><a href="#n-ports">Ports</a>
              </li>
              <li class="toc">
                <a href="#s-3_3">3.3.</a><a href="#n-stream">Stream</a>
                <ul class="toc">
                  <li class="toc">
                    <a href="#s-3_3_1">3.3.1.</a><a href="#n-transactional-stream">Transactional stream</a>
                  </li>
                  <li class="toc">
                    <a href="#s-3_3_2">3.3.2.</a><a href="#n-asynchronous-stream">Asynchronous stream</a>
                  </li>
                </ul>
              </li>
              <li class="toc">
                <a href="#s-3_4">3.4.</a><a href="#n-credentials">Credentials</a>
                <ul class="toc">
                  <li class="toc">
                    <a href="#s-3_4_1">3.4.1.</a><a href="#n-device">Device</a>
                  </li>
                  <li class="toc">
                    <a href="#s-3_4_2">3.4.2.</a><a href="#n-principal">Principal</a>
                  </li>
                </ul>
              </li>
              <li class="toc">
                <a href="#s-3_5">3.5.</a><a href="#n-datagram-format">Datagram Format</a>
                <ul class="toc">
                  <li class="toc">
                    <a href="#s-3_5_1">3.5.1.</a><a href="#n-stream-identifier">Stream Identifier</a>
                  </li>
                  <li class="toc">
                    <a href="#s-3_5_2">3.5.2.</a><a href="#n-nonce">Nonce</a>
                  </li>
                  <li class="toc">
                    <a href="#s-3_5_3">3.5.3.</a><a href="#n-ciphertext">Ciphertext</a>
                  </li>
                  <li class="toc">
                    <a href="#s-3_5_4">3.5.4.</a><a href="#n-authentication-tag">Authentication Tag</a>
                  </li>
                </ul>
              </li>
              <li class="toc">
                <a href="#s-3_6">3.6.</a><a href="#n-packet-format-and-packetized-datagrams">Packet Format and Packetized Datagrams</a>
                <ul class="toc">
                  <li class="toc">
                    <a href="#s-3_6_1">3.6.1.</a><a href="#n-packet-header">Packet Header</a>
                  </li>
                  <li class="toc">
                    <a href="#s-3_6_2">3.6.2.</a><a href="#n-flow-control">Flow Control</a>
                  </li>
                </ul>
              </li>
              <li class="toc">
                <a href="#s-3_7">3.7.</a><a href="#n-connection-datagrams">Connection Datagrams</a>
              </li>
            </ul>
          </li>
          <li class="toc">
            <a href="#s-4">4.</a><a href="#n-connection-establishment-and-maintenance">Connection Establishment and Maintenance</a>
            <ul class="toc">
              <li class="toc">
                <a href="#s-4_1">4.1.</a><a href="#n-key-exchange-modes">Key Exchange modes</a>
                <ul class="toc">
                  <li class="toc">
                    <a href="#s-4_1_1">4.1.1.</a><a href="#n-first-contact">First Contact</a>
                  </li>
                  <li class="toc">
                    <a href="#s-4_1_2">4.1.2.</a><a href="#n-immediate">Immediate</a>
                  </li>
                  <li class="toc">
                    <a href="#s-4_1_3">4.1.3.</a><a href="#n-deferred-trip">Deferred Trip</a>
                  </li>
                </ul>
              </li>
              <li class="toc">
                <a href="#s-4_2">4.2.</a><a href="#n-ticketed-connection">Ticketed Connection</a>
              </li>
              <li class="toc">
                <a href="#s-4_3">4.3.</a><a href="#n-connection-forward-secrecy-rekeying">Connection Forward Secrecy Rekeying</a>
              </li>
            </ul>
          </li>
          <li class="toc">
            <a href="#s-5">5.</a><a href="#n-stream-establishment-and-maintenance">Stream Establishment and Maintenance</a>
            <ul class="toc">
              <li class="toc">
                <a href="#s-5_1">5.1.</a><a href="#n-stream-creation-and-binding">Stream Creation and Binding</a>
              </li>
              <li class="toc">
                <a href="#s-5_2">5.2.</a><a href="#n-stream-close">Stream Close</a>
              </li>
              <li class="toc">
                <a href="#s-5_3">5.3.</a><a href="#n-one-time-stream-identifier">One Time Stream Identifier</a>
              </li>
              <li class="toc">
                <a href="#s-5_4">5.4.</a><a href="#n-stream-rekey">Stream Rekey</a>
              </li>
            </ul>
          </li>
          <li class="toc">
            <a href="#s-6">6.</a><a href="#n-schema">Schema</a>
            <ul class="toc">
              <li class="toc">
                <a href="#s-6_1">6.1.</a><a href="#n-connection-datagrams-0">Connection Datagrams</a>
              </li>
              <li class="toc">
                <a href="#s-6_2">6.2.</a><a href="#n-packet-extensions">Packet Extensions</a>
              </li>
            </ul>
          </li>
          <li class="toc">
            <a href="#s-7">7.</a><a href="#n-security-considerations">Security Considerations</a>
          </li>
          <li class="toc">
            <a href="#s-8">8.</a><a href="#n-iana-considerations">IANA Considerations</a>
          </li>
          <li class="toc">
            <a href="#s-9">9.</a><a href="#n-acknowledgements">Acknowledgements</a>
          </li>
          <li class="toc">
<a href="#n-references">References</a>
            <ul class="toc">
              <li class="toc">
<a href="#n-normative">Normative References</a>
              </li>
              <li class="toc">
<a href="#n-informative">Informative References</a>
              </li>
            </ul>
          </li>
        </ul>
        <ul class="toc">
          <li class="toc">
            <a href="#"></a><a href="#n-authors">Author's Address</a>
          </li>
        </ul>
        <h3 id="tof">
          <a class="selfRef" href="#tof">Table of Figures</a>
        </h3>
        <ul class="toc">
          <li class="toc">
            <a href="#n-an-rdp-connection-comprises-one-or-more-streams-and-one-or-more-ports">Figure 1</a>: <a href="#n-an-rdp-connection-comprises-one-or-more-streams-and-one-or-more-ports">An RDP connection comprises one or more streams and one or more ports.</a>
          </li>
          <li class="toc">
            <a href="#n-an-rdp-stream-presents-a-sequence-of-datagrams-each-of-which-may-span-multiple-packets">Figure 2</a>: <a href="#n-an-rdp-stream-presents-a-sequence-of-datagrams-each-of-which-may-span-multiple-packets">An RDP stream presents a sequence of datagrams, each of which may span multiple packets.</a>
          </li>
          <li class="toc">
            <a href="#n-alice-maintains-connection-to-her-conference-call-when-moving-from-her-home-to-her-office">Figure 3</a>: <a href="#n-alice-maintains-connection-to-her-conference-call-when-moving-from-her-home-to-her-office">Alice maintains connection to her conference call when moving from her home to her office.</a>
          </li>
          <li class="toc">
            <a href="#n-connection-establishment-by-means-of-a-discovery-service">Figure 4</a>: <a href="#n-connection-establishment-by-means-of-a-discovery-service">Connection establishment by means of a discovery service.</a>
          </li>
          <li class="toc">
            <a href="#n-alice-contacts-bob-through-a-presence-service">Figure 5</a>: <a href="#n-alice-contacts-bob-through-a-presence-service">Alice contacts Bob through a presence service.</a>
          </li>
          <li class="toc">
            <a href="#n-wide-cone-nat-configuration">Figure 6</a>: <a href="#n-wide-cone-nat-configuration">Wide cone NAT configuration.</a>
          </li>
          <li class="toc">
            <a href="#n-brokered-nat-transit">Figure 7</a>: <a href="#n-brokered-nat-transit">Brokered NAT transit.</a>
          </li>
          <li class="toc">
            <a href="#n-rdp-tunnelling">Figure 8</a>: <a href="#n-rdp-tunnelling">RDP Tunnelling.</a>
          </li>
          <li class="toc">
            <a href="#n-mesh-presentation-layer-provides-a-combination-of-necessary-functionality-from-tcp-tls-http-and-web-sockets">Figure 9</a>: <a href="#n-mesh-presentation-layer-provides-a-combination-of-necessary-functionality-from-tcp-tls-http-and-web-sockets">Mesh Presentation Layer provides a combination of necessary functionality from TCP, TLS, HTTP and Web Sockets.</a>
          </li>
          <li class="toc">
            <a href="#n-limiting-communications-to-a-requestresponse-communication-requires-inefficient-polling-for-updates">Figure 10</a>: <a href="#n-limiting-communications-to-a-requestresponse-communication-requires-inefficient-polling-for-updates">Limiting communications to a request/response communication requires inefficient polling for updates.</a>
          </li>
          <li class="toc">
            <a href="#n-rdp-supports-asynchronous-streaming-of-updates-as-they-occur">Figure 11</a>: <a href="#n-rdp-supports-asynchronous-streaming-of-updates-as-they-occur">RDP supports asynchronous streaming of updates as they occur.</a>
          </li>
          <li class="toc">
            <a href="#n-transactional-stream-characteristic">Figure 12</a>: <a href="#n-transactional-stream-characteristic">Transactional stream characteristic.</a>
          </li>
          <li class="toc">
            <a href="#n-asynchronous-stream-characteristic">Figure 13</a>: <a href="#n-asynchronous-stream-characteristic">Asynchronous stream characteristic.</a>
          </li>
          <li class="toc">
            <a href="#n-mesh-layered-credential-model">Figure 14</a>: <a href="#n-mesh-layered-credential-model">Mesh Layered Credential Model.</a>
          </li>
          <li class="toc">
            <a href="#n-datagram-format">Figure 15</a>: <a href="#n-datagram-format">Datagram format.</a>
          </li>
          <li class="toc">
            <a href="#n-flow-control-packet-header">Figure 16</a>: <a href="#n-flow-control-packet-header">Flow control packet header</a>
          </li>
          <li class="toc">
            <a href="#n-datagram-packetization-across-multiple-packets">Figure 17</a>: <a href="#n-datagram-packetization-across-multiple-packets">Datagram packetization across multiple packets.</a>
          </li>
          <li class="toc">
            <a href="#n-connection-datagram-format">Figure 18</a>: <a href="#n-connection-datagram-format">Connection Datagram Format.</a>
          </li>
          <li class="toc">
            <a href="#n-use-of-one-time-stream-identifiers">Figure 19</a>: <a href="#n-use-of-one-time-stream-identifiers">Use of one time Stream identifiers.</a>
          </li>
          <li class="toc">
            <a href="#n-use-of-a-block-cipher-to-create-stateless-stream-identifiers">Figure 20</a>: <a href="#n-use-of-a-block-cipher-to-create-stateless-stream-identifiers">Use of a block cipher to create stateless stream identifiers.</a>
          </li>
        </ul>
      </nav>
    </section>
    
    <section id="n-introduction">
      <h3 id="s-1">
        <a class="selfRef" href="#s-1">1.</a>
        <a class="selfRef" href="#n-introduction">Introduction</a>
      </h3>
      <p id="s-1-1">The Reliable Datagram Protocol (RDP) is a lightweight key exchange, authentication and encryption protocol that provides a transactional presentation when layered over a HTTP transport and transactional and streaming presentations when layered over a UDP transport.<a class="pilcrow" href="#s-1-1">&para;</a></p>
      <p id="s-1-2">The UDP binding of RDP provides much of the functionality normally provided through use of TCP, TLS, HTTP and Web Sockets with considerably less complexity. RDP does not attempt to reproduce all the functionality of these protocols, only the functionality required by Web Services and streaming applications is provided.<a class="pilcrow" href="#s-1-2">&para;</a></p>
      <figure id="f-9">
        <div class="artwork art-svg" id="n-mesh-presentation-layer-provides-a-combination-of-necessary-functionality-from-tcp-tls-http-and-web-sockets">
          <a class="pilcrow" href="#n-mesh-presentation-layer-provides-a-combination-of-necessary-functionality-from-tcp-tls-http-and-web-sockets">&para;</a>
<svg width="464" height="249" xmlns="http://www.w3.org/2000/svg" >
<g transform="translate(8,16)">
  <path d="M 0,0 L 160,0" fill="none" stroke="black" />
  <path d="M 288,0 L 448,0" fill="none" stroke="black" />
  <path d="M 160,16 L 280,16" fill="none" stroke="black" />
  <path d="M 0,32 L 160,32" fill="none" stroke="black" />
  <path d="M 0,64 L 160,64" fill="none" stroke="black" />
  <path d="M 160,80 L 280,80" fill="none" stroke="black" />
  <path d="M 0,96 L 160,96" fill="none" stroke="black" />
  <path d="M 0,128 L 160,128" fill="none" stroke="black" />
  <path d="M 160,144 L 280,144" fill="none" stroke="black" />
  <path d="M 0,160 L 160,160" fill="none" stroke="black" />
  <path d="M 0,192 L 160,192" fill="none" stroke="black" />
  <path d="M 160,208 L 280,208" fill="none" stroke="black" />
  <path d="M 0,224 L 160,224" fill="none" stroke="black" />
  <path d="M 288,224 L 448,224" fill="none" stroke="black" />
  <path d="M 0,0 L 0,32" fill="none" stroke="black" />
  <path d="M 0,64 L 0,96" fill="none" stroke="black" />
  <path d="M 0,128 L 0,160" fill="none" stroke="black" />
  <path d="M 0,192 L 0,224" fill="none" stroke="black" />
  <path d="M 160,0 L 160,16" fill="none" stroke="black" />
  <path d="M 160,16 L 160,32" fill="none" stroke="black" />
  <path d="M 160,64 L 160,80" fill="none" stroke="black" />
  <path d="M 160,80 L 160,96" fill="none" stroke="black" />
  <path d="M 160,128 L 160,144" fill="none" stroke="black" />
  <path d="M 160,144 L 160,160" fill="none" stroke="black" />
  <path d="M 160,192 L 160,208" fill="none" stroke="black" />
  <path d="M 160,208 L 160,224" fill="none" stroke="black" />
  <path d="M 288,0 L 288,224" fill="none" stroke="black" />
  <path d="M 448,0 L 448,224" fill="none" stroke="black" />
  <polygon points="288.000000,16.000000 276.000000,10.400000 276.000000,21.600000" fill="black" transform="rotate(0.000000, 280.000000, 16.000000)" />
  <polygon points="288.000000,80.000000 276.000000,74.400002 276.000000,85.599998" fill="black" transform="rotate(0.000000, 280.000000, 80.000000)" />
  <polygon points="288.000000,144.000000 276.000000,138.399994 276.000000,149.600006" fill="black" transform="rotate(0.000000, 280.000000, 144.000000)" />
  <polygon points="288.000000,208.000000 276.000000,202.399994 276.000000,213.600006" fill="black" transform="rotate(0.000000, 280.000000, 208.000000)" />
  <text text-anchor="middle" font-family="sans-serif" x="80" y="84">L</text>
  <text text-anchor="middle" font-family="sans-serif" x="360" y="100">e</text>
  <text text-anchor="middle" font-family="sans-serif" x="88" y="20">P</text>
  <text text-anchor="middle" font-family="sans-serif" x="88" y="84">S</text>
  <text text-anchor="middle" font-family="sans-serif" x="336" y="116">r</text>
  <text text-anchor="middle" font-family="sans-serif" x="368" y="116">n</text>
  <text text-anchor="middle" font-family="sans-serif" x="72" y="212">S</text>
  <text text-anchor="middle" font-family="sans-serif" x="112" y="212">t</text>
  <text text-anchor="middle" font-family="sans-serif" x="72" y="84">T</text>
  <text text-anchor="middle" font-family="sans-serif" x="80" y="20">C</text>
  <text text-anchor="middle" font-family="sans-serif" x="376" y="116">t</text>
  <text text-anchor="middle" font-family="sans-serif" x="392" y="116">t</text>
  <text text-anchor="middle" font-family="sans-serif" x="56" y="212">b</text>
  <text text-anchor="middle" font-family="sans-serif" x="96" y="212">k</text>
  <text text-anchor="middle" font-family="sans-serif" x="72" y="20">T</text>
  <text text-anchor="middle" font-family="sans-serif" x="360" y="132">a</text>
  <text text-anchor="middle" font-family="sans-serif" x="376" y="132">e</text>
  <text text-anchor="middle" font-family="sans-serif" x="80" y="148">T</text>
  <text text-anchor="middle" font-family="sans-serif" x="88" y="212">c</text>
  <text text-anchor="middle" font-family="sans-serif" x="104" y="212">e</text>
  <text text-anchor="middle" font-family="sans-serif" x="416" y="116">n</text>
  <text text-anchor="middle" font-family="sans-serif" x="352" y="116">s</text>
  <text text-anchor="middle" font-family="sans-serif" x="352" y="132">L</text>
  <text text-anchor="middle" font-family="sans-serif" x="368" y="132">y</text>
  <text text-anchor="middle" font-family="sans-serif" x="64" y="148">H</text>
  <text text-anchor="middle" font-family="sans-serif" x="48" y="212">e</text>
  <text text-anchor="middle" font-family="sans-serif" x="376" y="100">h</text>
  <text text-anchor="middle" font-family="sans-serif" x="360" y="116">e</text>
  <text text-anchor="middle" font-family="sans-serif" x="400" y="116">i</text>
  <text text-anchor="middle" font-family="sans-serif" x="72" y="148">T</text>
  <text text-anchor="middle" font-family="sans-serif" x="88" y="148">P</text>
  <text text-anchor="middle" font-family="sans-serif" x="80" y="212">o</text>
  <text text-anchor="middle" font-family="sans-serif" x="368" y="100">s</text>
  <text text-anchor="middle" font-family="sans-serif" x="408" y="116">o</text>
  <text text-anchor="middle" font-family="sans-serif" x="40" y="212">W</text>
  <text text-anchor="middle" font-family="sans-serif" x="352" y="100">M</text>
  <text text-anchor="middle" font-family="sans-serif" x="344" y="116">e</text>
  <text text-anchor="middle" font-family="sans-serif" x="384" y="116">a</text>
  <text text-anchor="middle" font-family="sans-serif" x="384" y="132">r</text>
  <text text-anchor="middle" font-family="sans-serif" x="120" y="212">s</text>
  <text text-anchor="middle" font-family="sans-serif" x="328" y="116">P</text>
</g></svg>
          <figcaption>
            <a href="n-mesh-presentation-layer-provides-a-combination-of-necessary-functionality-from-tcp-tls-http-and-web-sockets">Figure 9</a>
:            <a href="null" id="null" class="selfRef">Mesh Presentation Layer provides a combination of necessary functionality from TCP, TLS, HTTP and Web Sockets.</a>
          </figcaption>
        </div>
        <p id="s-1-4">As recognized in the design of QUIC, combining these protocols allows greater efficiency and security. But QUIC is the product of one set of design choices optimized to meet an important but specific set of needs. RDP makes a different set of choices to meet a different set of needs. A natural consequence of moving TCP functionality from a platform capability implemented in the OS kernel to an application level resource it that applications are now free to chose the transport and security capabilities that best fit their needs rather than being limited to a single size fits all.<a class="pilcrow" href="#s-1-4">&para;</a></p>
        <p id="s-1-5">The reduction in complexity afforded by combining four protocols into one allows entirely new communications patterns to be supported that are poorly supported by traditional approaches. HTTP is built on the Remote Procedure Call model of transactions that consist of a single request followed by a response. Using this communication pattern, a device attempting to synchronize a local store with a store at a remote service is required to periodically poll the service for updates:<a class="pilcrow" href="#s-1-5">&para;</a></p>
        <figure id="f-10">
          <div class="artwork art-svg" id="n-limiting-communications-to-a-requestresponse-communication-requires-inefficient-polling-for-updates">
            <a class="pilcrow" href="#n-limiting-communications-to-a-requestresponse-communication-requires-inefficient-polling-for-updates">&para;</a>
<svg width="464" height="233" xmlns="http://www.w3.org/2000/svg" >
<g transform="translate(8,16)">
  <path d="M 0,16 L 160,16" fill="none" stroke="black" />
  <path d="M 288,16 L 448,16" fill="none" stroke="black" />
  <path d="M 0,48 L 80,48" fill="none" stroke="black" />
  <path d="M 80,48 L 160,48" fill="none" stroke="black" />
  <path d="M 288,48 L 376,48" fill="none" stroke="black" />
  <path d="M 376,48 L 448,48" fill="none" stroke="black" />
  <path d="M 80,80 L 200,80" fill="none" stroke="black" />
  <path d="M 256,80 L 368,80" fill="none" stroke="black" />
  <path d="M 88,96 L 176,96" fill="none" stroke="black" />
  <path d="M 272,96 L 376,96" fill="none" stroke="black" />
  <path d="M 80,128 L 200,128" fill="none" stroke="black" />
  <path d="M 256,128 L 368,128" fill="none" stroke="black" />
  <path d="M 88,144 L 176,144" fill="none" stroke="black" />
  <path d="M 272,144 L 376,144" fill="none" stroke="black" />
  <path d="M 80,176 L 200,176" fill="none" stroke="black" />
  <path d="M 256,176 L 368,176" fill="none" stroke="black" />
  <path d="M 88,192 L 192,192" fill="none" stroke="black" />
  <path d="M 264,192 L 376,192" fill="none" stroke="black" />
  <path d="M 0,16 L 0,48" fill="none" stroke="black" />
  <path d="M 80,48 L 80,80" fill="none" stroke="black" />
  <path d="M 80,80 L 80,128" fill="none" stroke="black" />
  <path d="M 80,128 L 80,176" fill="none" stroke="black" />
  <path d="M 80,176 L 80,208" fill="none" stroke="black" />
  <path d="M 160,16 L 160,48" fill="none" stroke="black" />
  <path d="M 288,16 L 288,48" fill="none" stroke="black" />
  <path d="M 376,48 L 376,96" fill="none" stroke="black" />
  <path d="M 376,96 L 376,144" fill="none" stroke="black" />
  <path d="M 376,144 L 376,192" fill="none" stroke="black" />
  <path d="M 376,192 L 376,208" fill="none" stroke="black" />
  <path d="M 448,16 L 448,48" fill="none" stroke="black" />
  <polygon points="96.000000,96.000000 84.000000,90.400002 84.000000,101.599998" fill="black" transform="rotate(180.000000, 88.000000, 96.000000)" />
  <polygon points="96.000000,144.000000 84.000000,138.399994 84.000000,149.600006" fill="black" transform="rotate(180.000000, 88.000000, 144.000000)" />
  <polygon points="96.000000,192.000000 84.000000,186.399994 84.000000,197.600006" fill="black" transform="rotate(180.000000, 88.000000, 192.000000)" />
  <polygon points="376.000000,80.000000 364.000000,74.400002 364.000000,85.599998" fill="black" transform="rotate(0.000000, 368.000000, 80.000000)" />
  <polygon points="376.000000,128.000000 364.000000,122.400002 364.000000,133.600006" fill="black" transform="rotate(0.000000, 368.000000, 128.000000)" />
  <polygon points="376.000000,176.000000 364.000000,170.399994 364.000000,181.600006" fill="black" transform="rotate(0.000000, 368.000000, 176.000000)" />
  <text text-anchor="middle" font-family="sans-serif" x="256" y="100">e</text>
  <text text-anchor="middle" font-family="sans-serif" x="240" y="132">l</text>
  <text text-anchor="middle" font-family="sans-serif" x="232" y="148">a</text>
  <text text-anchor="middle" font-family="sans-serif" x="88" y="36">c</text>
  <text text-anchor="middle" font-family="sans-serif" x="376" y="36">i</text>
  <text text-anchor="middle" font-family="sans-serif" x="232" y="84">l</text>
  <text text-anchor="middle" font-family="sans-serif" x="240" y="84">l</text>
  <text text-anchor="middle" font-family="sans-serif" x="248" y="100">g</text>
  <text text-anchor="middle" font-family="sans-serif" x="232" y="180">l</text>
  <text text-anchor="middle" font-family="sans-serif" x="80" y="36">i</text>
  <text text-anchor="middle" font-family="sans-serif" x="216" y="100">C</text>
  <text text-anchor="middle" font-family="sans-serif" x="216" y="148">C</text>
  <text text-anchor="middle" font-family="sans-serif" x="248" y="148">g</text>
  <text text-anchor="middle" font-family="sans-serif" x="96" y="36">e</text>
  <text text-anchor="middle" font-family="sans-serif" x="216" y="84">P</text>
  <text text-anchor="middle" font-family="sans-serif" x="192" y="148">N</text>
  <text text-anchor="middle" font-family="sans-serif" x="232" y="100">a</text>
  <text text-anchor="middle" font-family="sans-serif" x="240" y="180">l</text>
  <text text-anchor="middle" font-family="sans-serif" x="208" y="196">U</text>
  <text text-anchor="middle" font-family="sans-serif" x="224" y="180">o</text>
  <text text-anchor="middle" font-family="sans-serif" x="248" y="196">e</text>
  <text text-anchor="middle" font-family="sans-serif" x="344" y="36">S</text>
  <text text-anchor="middle" font-family="sans-serif" x="368" y="36">v</text>
  <text text-anchor="middle" font-family="sans-serif" x="392" y="36">e</text>
  <text text-anchor="middle" font-family="sans-serif" x="192" y="100">N</text>
  <text text-anchor="middle" font-family="sans-serif" x="232" y="132">l</text>
  <text text-anchor="middle" font-family="sans-serif" x="240" y="196">t</text>
  <text text-anchor="middle" font-family="sans-serif" x="352" y="36">e</text>
  <text text-anchor="middle" font-family="sans-serif" x="224" y="84">o</text>
  <text text-anchor="middle" font-family="sans-serif" x="200" y="100">o</text>
  <text text-anchor="middle" font-family="sans-serif" x="224" y="148">h</text>
  <text text-anchor="middle" font-family="sans-serif" x="240" y="148">n</text>
  <text text-anchor="middle" font-family="sans-serif" x="224" y="132">o</text>
  <text text-anchor="middle" font-family="sans-serif" x="216" y="180">P</text>
  <text text-anchor="middle" font-family="sans-serif" x="56" y="36">D</text>
  <text text-anchor="middle" font-family="sans-serif" x="64" y="36">e</text>
  <text text-anchor="middle" font-family="sans-serif" x="72" y="36">v</text>
  <text text-anchor="middle" font-family="sans-serif" x="224" y="100">h</text>
  <text text-anchor="middle" font-family="sans-serif" x="240" y="100">n</text>
  <text text-anchor="middle" font-family="sans-serif" x="216" y="196">p</text>
  <text text-anchor="middle" font-family="sans-serif" x="224" y="196">d</text>
  <text text-anchor="middle" font-family="sans-serif" x="232" y="196">a</text>
  <text text-anchor="middle" font-family="sans-serif" x="360" y="36">r</text>
  <text text-anchor="middle" font-family="sans-serif" x="384" y="36">c</text>
  <text text-anchor="middle" font-family="sans-serif" x="216" y="132">P</text>
  <text text-anchor="middle" font-family="sans-serif" x="200" y="148">o</text>
  <text text-anchor="middle" font-family="sans-serif" x="256" y="148">e</text>
</g></svg>
            <figcaption>
              <a href="n-limiting-communications-to-a-requestresponse-communication-requires-inefficient-polling-for-updates">Figure 10</a>
:              <a href="null" id="null" class="selfRef">Limiting communications to a request/response communication requires inefficient polling for updates.</a>
            </figcaption>
          </div>
          <p id="s-1-7">RDP allows a client device with this particular requirement to subscribe to a continuous stream of updates. There is no need for the device to poll the remote store for updates as it will be notified every time an update occurs.<a class="pilcrow" href="#s-1-7">&para;</a></p>
          <figure id="f-11">
            <div class="artwork art-svg" id="n-rdp-supports-asynchronous-streaming-of-updates-as-they-occur">
              <a class="pilcrow" href="#n-rdp-supports-asynchronous-streaming-of-updates-as-they-occur">&para;</a>
<svg width="464" height="249" xmlns="http://www.w3.org/2000/svg" >
<g transform="translate(8,16)">
  <path d="M 0,0 L 160,0" fill="none" stroke="black" />
  <path d="M 288,0 L 448,0" fill="none" stroke="black" />
  <path d="M 0,32 L 80,32" fill="none" stroke="black" />
  <path d="M 80,32 L 160,32" fill="none" stroke="black" />
  <path d="M 288,32 L 376,32" fill="none" stroke="black" />
  <path d="M 376,32 L 448,32" fill="none" stroke="black" />
  <path d="M 88,64 L 176,64" fill="none" stroke="black" />
  <path d="M 272,64 L 368,64" fill="none" stroke="black" />
  <path d="M 88,80 L 168,80" fill="none" stroke="black" />
  <path d="M 280,80 L 368,80" fill="none" stroke="black" />
  <path d="M 88,144 L 192,144" fill="none" stroke="black" />
  <path d="M 264,144 L 368,144" fill="none" stroke="black" />
  <path d="M 88,192 L 192,192" fill="none" stroke="black" />
  <path d="M 264,192 L 368,192" fill="none" stroke="black" />
  <path d="M 88,208 L 192,208" fill="none" stroke="black" />
  <path d="M 264,208 L 368,208" fill="none" stroke="black" />
  <path d="M 0,0 L 0,32" fill="none" stroke="black" />
  <path d="M 80,32 L 80,224" fill="none" stroke="black" />
  <path d="M 160,0 L 160,32" fill="none" stroke="black" />
  <path d="M 288,0 L 288,32" fill="none" stroke="black" />
  <path d="M 376,32 L 376,224" fill="none" stroke="black" />
  <path d="M 448,0 L 448,32" fill="none" stroke="black" />
  <polygon points="96.000000,80.000000 84.000000,74.400002 84.000000,85.599998" fill="black" transform="rotate(180.000000, 88.000000, 80.000000)" />
  <polygon points="96.000000,144.000000 84.000000,138.399994 84.000000,149.600006" fill="black" transform="rotate(180.000000, 88.000000, 144.000000)" />
  <polygon points="96.000000,192.000000 84.000000,186.399994 84.000000,197.600006" fill="black" transform="rotate(180.000000, 88.000000, 192.000000)" />
  <polygon points="96.000000,208.000000 84.000000,202.399994 84.000000,213.600006" fill="black" transform="rotate(180.000000, 88.000000, 208.000000)" />
  <polygon points="376.000000,64.000000 364.000000,58.400002 364.000000,69.599998" fill="black" transform="rotate(0.000000, 368.000000, 64.000000)" />
  <text text-anchor="middle" font-family="sans-serif" x="384" y="20">c</text>
  <text text-anchor="middle" font-family="sans-serif" x="224" y="148">d</text>
  <text text-anchor="middle" font-family="sans-serif" x="232" y="148">a</text>
  <text text-anchor="middle" font-family="sans-serif" x="224" y="196">d</text>
  <text text-anchor="middle" font-family="sans-serif" x="240" y="84">e</text>
  <text text-anchor="middle" font-family="sans-serif" x="208" y="148">U</text>
  <text text-anchor="middle" font-family="sans-serif" x="80" y="20">i</text>
  <text text-anchor="middle" font-family="sans-serif" x="88" y="20">c</text>
  <text text-anchor="middle" font-family="sans-serif" x="96" y="20">e</text>
  <text text-anchor="middle" font-family="sans-serif" x="200" y="68">u</text>
  <text text-anchor="middle" font-family="sans-serif" x="208" y="68">b</text>
  <text text-anchor="middle" font-family="sans-serif" x="248" y="68">b</text>
  <text text-anchor="middle" font-family="sans-serif" x="248" y="148">e</text>
  <text text-anchor="middle" font-family="sans-serif" x="232" y="212">a</text>
  <text text-anchor="middle" font-family="sans-serif" x="248" y="212">e</text>
  <text text-anchor="middle" font-family="sans-serif" x="72" y="20">v</text>
  <text text-anchor="middle" font-family="sans-serif" x="192" y="68">S</text>
  <text text-anchor="middle" font-family="sans-serif" x="224" y="84">w</text>
  <text text-anchor="middle" font-family="sans-serif" x="232" y="84">l</text>
  <text text-anchor="middle" font-family="sans-serif" x="208" y="196">U</text>
  <text text-anchor="middle" font-family="sans-serif" x="216" y="196">p</text>
  <text text-anchor="middle" font-family="sans-serif" x="56" y="20">D</text>
  <text text-anchor="middle" font-family="sans-serif" x="360" y="20">r</text>
  <text text-anchor="middle" font-family="sans-serif" x="216" y="68">s</text>
  <text text-anchor="middle" font-family="sans-serif" x="192" y="84">c</text>
  <text text-anchor="middle" font-family="sans-serif" x="208" y="84">n</text>
  <text text-anchor="middle" font-family="sans-serif" x="216" y="212">p</text>
  <text text-anchor="middle" font-family="sans-serif" x="368" y="20">v</text>
  <text text-anchor="middle" font-family="sans-serif" x="240" y="68">i</text>
  <text text-anchor="middle" font-family="sans-serif" x="200" y="84">k</text>
  <text text-anchor="middle" font-family="sans-serif" x="256" y="84">g</text>
  <text text-anchor="middle" font-family="sans-serif" x="232" y="196">a</text>
  <text text-anchor="middle" font-family="sans-serif" x="344" y="20">S</text>
  <text text-anchor="middle" font-family="sans-serif" x="224" y="68">c</text>
  <text text-anchor="middle" font-family="sans-serif" x="264" y="84">e</text>
  <text text-anchor="middle" font-family="sans-serif" x="216" y="148">p</text>
  <text text-anchor="middle" font-family="sans-serif" x="240" y="212">t</text>
  <text text-anchor="middle" font-family="sans-serif" x="352" y="20">e</text>
  <text text-anchor="middle" font-family="sans-serif" x="376" y="20">i</text>
  <text text-anchor="middle" font-family="sans-serif" x="256" y="68">e</text>
  <text text-anchor="middle" font-family="sans-serif" x="216" y="84">o</text>
  <text text-anchor="middle" font-family="sans-serif" x="248" y="84">d</text>
  <text text-anchor="middle" font-family="sans-serif" x="208" y="212">U</text>
  <text text-anchor="middle" font-family="sans-serif" x="248" y="196">e</text>
  <text text-anchor="middle" font-family="sans-serif" x="224" y="212">d</text>
  <text text-anchor="middle" font-family="sans-serif" x="64" y="20">e</text>
  <text text-anchor="middle" font-family="sans-serif" x="392" y="20">e</text>
  <text text-anchor="middle" font-family="sans-serif" x="232" y="68">r</text>
  <text text-anchor="middle" font-family="sans-serif" x="184" y="84">A</text>
  <text text-anchor="middle" font-family="sans-serif" x="240" y="148">t</text>
  <text text-anchor="middle" font-family="sans-serif" x="240" y="196">t</text>
</g></svg>
              <figcaption>
                <a href="n-rdp-supports-asynchronous-streaming-of-updates-as-they-occur">Figure 11</a>
:                <a href="null" id="null" class="selfRef">RDP supports asynchronous streaming of updates as they occur.</a>
              </figcaption>
            </div>
            <p id="s-1-9">While it is possible to achieve the same functionality in TCP, this requires that the device and service maintain a TCP connection for the duration of the connection. This consumes communication resources and operating system resources.<a class="pilcrow" href="#s-1-9">&para;</a></p>
            <p id="s-1-10">As is shown in later sections, the 'blank slate' design approach of RDP allows completely new approaches to service discovery, network agility, presence, NAT tunneling and many other requirements that are critical in modern network use.<a class="pilcrow" href="#s-1-10">&para;</a></p>
          </figure>
          
          <section id="n-background">
            <h4 id="s-1_1">
              <a class="selfRef" href="#s-1_1">1.1.</a>
              <a class="selfRef" href="#n-background">Background</a>
            </h4>
            <p id="s-1_1-1">Web Services have traditionally made use of HTTP bindings over TCP or TLS transports. While this approach is functional, it is less than satisfactory. The HTTP and TLS stacks are designed to meet the needs of Web browsing but fail to provide significant capabilities required by a service. Modern implementations of these stacks are large and cumbersome but little of that complexity addresses needs relevant to Web Services.<a class="pilcrow" href="#s-1_1-1">&para;</a></p>
            <p id="s-1_1-2">A basic requirement for a Web Service is the need to authenticate requests and the party making them. In particular, a Web Service requires the ability to authenticate the source of a request and verify that authentication of the request data is complete before acting on it. As its original name, 'Secure Socket Layer' implies, TLS is designed to present an abstract socket layer that hides this information from the application layer. In many large enterprise deployments, TLS processing and Web Service transactions are performed on separate machines and information from the TLS session is only visible to the transaction processor if special provision is made.<a class="pilcrow" href="#s-1_1-2">&para;</a></p>
            <p id="s-1_1-3">HTTP provides a wide range of protocol capabilities but almost none of this complexity is relevant to Web Services needs. <a class="pilcrow" href="#s-1_1-3">&para;</a></p>
            <ul id="s-1_1-4-">
              <li id="s-1_1-4">Providing access to multiple Web Services through a single TCP/IP port.<a class="pilcrow" href="#s-1_1-4">&para;</a></li>
              <li id="s-1_1-5">Delineating the beginning and end of request and response data.<a class="pilcrow" href="#s-1_1-5">&para;</a></li>
            </ul>
            <p id="s-1_1-6">Recognizing these needs, the DARE envelope format was originally conceived as a JSON equivalent of the XML Signature and Encryption protocols applied to provide message layer security in the WS-Security stack. Consideration of the resource requirements needed to verify each transaction request and sign each response led to the need for a key exchange mechanism and that this should be separate from the Mesh Service Protocol. This in turn led to the realization that in most circumstances, an AEAD scheme such as AES-GCM or AES-CFB would provide encryption with the same or less overhead than use of a MAC.<a class="pilcrow" href="#s-1_1-6">&para;</a></p>
            <p id="s-1_1-7">Having taken these considerations into account, a new lightweight envelope format was designed to allow authentication and encryption of Web Services messages as the payload of HTTP requests and responses. The success of this approach led to the realization that the same format could be modified to enable direct binding to UDP, allowing provision of HTTP support to be made optional.<a class="pilcrow" href="#s-1_1-7">&para;</a></p>
          </section>
          
          <section id="n-protocol-elements">
            <h5 id="s-1_1_1">
              <a class="selfRef" href="#s-1_1_1">1.1.1.</a>
              <a class="selfRef" href="#n-protocol-elements">Protocol Elements</a>
            </h5>
            <p id="s-1_1_1-1">A TCP connection provides a single pair of bidirectional communication streams between two devices connected to the network. While the TCP connection is symmetric from the application layer point of view, the HTTP presentation layer is not. HTTP limits communications to a request/response communication pattern in which the initiator device makes all the requests and the responder device makes all the responses.<a class="pilcrow" href="#s-1_1_1-1">&para;</a></p>
            <p id="s-1_1_1-2">RDP affords greater communication flexibility requiring distinctions to be made between terms which may be used interchangeably in the HTTP over TCP/IP case.<a class="pilcrow" href="#s-1_1_1-2">&para;</a></p>
            <dl id="s-1_1_1-3-" class="nohang">
              <dt id="s-1_1_1-3">Connection<a class="pilcrow" href="#s-1_1_1-3">&para;</a></dt>
              <dd id="null">An RDP connection is a bidirectional relationship between a pair of endpoints established through a cryptographic key exchange establishing a shared secret called the Connection Origin Key.<a class="pilcrow" href="#">&para;</a></dd>
              <dt id="s-1_1_1-4">Stream<a class="pilcrow" href="#s-1_1_1-4">&para;</a></dt>
              <dd id="null">An RDP stream is an individual communication channel established within a connection. An RDP connection comprises one or more streams.<a class="pilcrow" href="#">&para;</a></dd>
              <dt id="s-1_1_1-5">Port<a class="pilcrow" href="#s-1_1_1-5">&para;</a></dt>
              <dd id="null">An RDP port is a network interface through which data is exchanged. Currently only UDP and HTTP ports are supported. Each end of an RDP Connection accepts packets through one or more ports.<a class="pilcrow" href="#">&para;</a></dd>
            </dl>
            <p id="s-1_1_1-6">The distinction between connections and streams is analogous to that made between processes and threads. While any task that is performed by a separate thread may be performed by a separate process, use of threads consumes fewer platform resources and greater convenience to the programmer.<a class="pilcrow" href="#s-1_1_1-6">&para;</a></p>
            <p id="s-1_1_1-7">In the TCP/IP model, each stream is bound to a single pair of IP port. In the RDP model, any stream <span class="bcp14">MAY</span> make use of any available destination port to send traffic. This allows Alice to move from her home to her car to her office without dropping the connection to her conference call.<a class="pilcrow" href="#s-1_1_1-7">&para;</a></p>
            <figure id="f-1">
              <div class="artwork art-svg" id="n-an-rdp-connection-comprises-one-or-more-streams-and-one-or-more-ports">
                <a class="pilcrow" href="#n-an-rdp-connection-comprises-one-or-more-streams-and-one-or-more-ports">&para;</a>
<svg width="528" height="217" xmlns="http://www.w3.org/2000/svg" >
<g transform="translate(8,16)">
  <path d="M 0,0 L 512,0" fill="none" stroke="black" />
  <path d="M 24,48 L 144,48" fill="none" stroke="black" />
  <path d="M 168,48 L 288,48" fill="none" stroke="black" />
  <path d="M 368,48 L 488,48" fill="none" stroke="black" />
  <path d="M 304,80 L 312,80" fill="none" stroke="black" />
  <path d="M 320,80 L 328,80" fill="none" stroke="black" />
  <path d="M 336,80 L 344,80" fill="none" stroke="black" />
  <path d="M 352,80 L 360,80" fill="none" stroke="black" />
  <path d="M 24,112 L 144,112" fill="none" stroke="black" />
  <path d="M 168,112 L 288,112" fill="none" stroke="black" />
  <path d="M 368,112 L 488,112" fill="none" stroke="black" />
  <path d="M 0,128 L 128,128" fill="none" stroke="black" />
  <path d="M 128,128 L 256,128" fill="none" stroke="black" />
  <path d="M 256,128 L 384,128" fill="none" stroke="black" />
  <path d="M 384,128 L 512,128" fill="none" stroke="black" />
  <path d="M 0,192 L 128,192" fill="none" stroke="black" />
  <path d="M 128,192 L 256,192" fill="none" stroke="black" />
  <path d="M 256,192 L 384,192" fill="none" stroke="black" />
  <path d="M 384,192 L 512,192" fill="none" stroke="black" />
  <path d="M 0,0 L 0,128" fill="none" stroke="black" />
  <path d="M 0,128 L 0,192" fill="none" stroke="black" />
  <path d="M 24,48 L 24,112" fill="none" stroke="black" />
  <path d="M 128,128 L 128,192" fill="none" stroke="black" />
  <path d="M 144,48 L 144,112" fill="none" stroke="black" />
  <path d="M 168,48 L 168,112" fill="none" stroke="black" />
  <path d="M 256,128 L 256,192" fill="none" stroke="black" />
  <path d="M 288,48 L 288,112" fill="none" stroke="black" />
  <path d="M 368,48 L 368,112" fill="none" stroke="black" />
  <path d="M 384,128 L 384,192" fill="none" stroke="black" />
  <path d="M 488,48 L 488,112" fill="none" stroke="black" />
  <path d="M 512,0 L 512,128" fill="none" stroke="black" />
  <path d="M 512,128 L 512,192" fill="none" stroke="black" />
  <text text-anchor="middle" font-family="sans-serif" x="328" y="164">t</text>
  <text text-anchor="middle" font-family="sans-serif" x="72" y="84">t</text>
  <text text-anchor="middle" font-family="sans-serif" x="88" y="84">e</text>
  <text text-anchor="middle" font-family="sans-serif" x="208" y="84">S</text>
  <text text-anchor="middle" font-family="sans-serif" x="416" y="84">t</text>
  <text text-anchor="middle" font-family="sans-serif" x="56" y="164">o</text>
  <text text-anchor="middle" font-family="sans-serif" x="64" y="164">r</text>
  <text text-anchor="middle" font-family="sans-serif" x="304" y="164">P</text>
  <text text-anchor="middle" font-family="sans-serif" x="432" y="164">P</text>
  <text text-anchor="middle" font-family="sans-serif" x="448" y="164">r</text>
  <text text-anchor="middle" font-family="sans-serif" x="288" y="20">o</text>
  <text text-anchor="middle" font-family="sans-serif" x="248" y="84">m</text>
  <text text-anchor="middle" font-family="sans-serif" x="48" y="164">P</text>
  <text text-anchor="middle" font-family="sans-serif" x="312" y="164">o</text>
  <text text-anchor="middle" font-family="sans-serif" x="320" y="164">r</text>
  <text text-anchor="middle" font-family="sans-serif" x="440" y="164">o</text>
  <text text-anchor="middle" font-family="sans-serif" x="216" y="84">t</text>
  <text text-anchor="middle" font-family="sans-serif" x="240" y="84">a</text>
  <text text-anchor="middle" font-family="sans-serif" x="440" y="84">a</text>
  <text text-anchor="middle" font-family="sans-serif" x="72" y="164">t</text>
  <text text-anchor="middle" font-family="sans-serif" x="448" y="84">m</text>
  <text text-anchor="middle" font-family="sans-serif" x="232" y="20">o</text>
  <text text-anchor="middle" font-family="sans-serif" x="248" y="20">n</text>
  <text text-anchor="middle" font-family="sans-serif" x="272" y="20">t</text>
  <text text-anchor="middle" font-family="sans-serif" x="280" y="20">i</text>
  <text text-anchor="middle" font-family="sans-serif" x="64" y="84">S</text>
  <text text-anchor="middle" font-family="sans-serif" x="104" y="84">m</text>
  <text text-anchor="middle" font-family="sans-serif" x="424" y="84">r</text>
  <text text-anchor="middle" font-family="sans-serif" x="408" y="84">S</text>
  <text text-anchor="middle" font-family="sans-serif" x="96" y="84">a</text>
  <text text-anchor="middle" font-family="sans-serif" x="224" y="84">r</text>
  <text text-anchor="middle" font-family="sans-serif" x="232" y="84">e</text>
  <text text-anchor="middle" font-family="sans-serif" x="184" y="164">o</text>
  <text text-anchor="middle" font-family="sans-serif" x="192" y="164">r</text>
  <text text-anchor="middle" font-family="sans-serif" x="456" y="164">t</text>
  <text text-anchor="middle" font-family="sans-serif" x="240" y="20">n</text>
  <text text-anchor="middle" font-family="sans-serif" x="256" y="20">e</text>
  <text text-anchor="middle" font-family="sans-serif" x="296" y="20">n</text>
  <text text-anchor="middle" font-family="sans-serif" x="80" y="84">r</text>
  <text text-anchor="middle" font-family="sans-serif" x="176" y="164">P</text>
  <text text-anchor="middle" font-family="sans-serif" x="200" y="164">t</text>
  <text text-anchor="middle" font-family="sans-serif" x="224" y="20">C</text>
  <text text-anchor="middle" font-family="sans-serif" x="264" y="20">c</text>
  <text text-anchor="middle" font-family="sans-serif" x="432" y="84">e</text>
</g></svg>
                <figcaption>
                  <a href="n-an-rdp-connection-comprises-one-or-more-streams-and-one-or-more-ports">Figure 1</a>
:                  <a href="null" id="null" class="selfRef">An RDP connection comprises one or more streams and one or more ports.</a>
                </figcaption>
              </div>
              <p id="s-1_1_1-9">New streams may be created at any time by either party in a connection for many different reasons:<a class="pilcrow" href="#s-1_1_1-9">&para;</a></p>
              <ul id="s-1_1_1-10-">
                <li id="s-1_1_1-10">To establish a client/service relationship to a different Web Service.<a class="pilcrow" href="#s-1_1_1-10">&para;</a></li>
                <li id="s-1_1_1-11">To establish a new asynchronous streaming relationship<a class="pilcrow" href="#s-1_1_1-11">&para;</a></li>
                <li id="s-1_1_1-12">To signal changes to the cryptographic context (e.g., forward secrecy rachet operation).<a class="pilcrow" href="#s-1_1_1-12">&para;</a></li>
                <li id="s-1_1_1-13">Exhaustion of the datagram counter identifier space.<a class="pilcrow" href="#s-1_1_1-13">&para;</a></li>
                <li id="s-1_1_1-14">To make use of traffic analysis avoidance techniques.<a class="pilcrow" href="#s-1_1_1-14">&para;</a></li>
                <li id="s-1_1_1-15">To enable datagrams to be sent at different priorities.<a class="pilcrow" href="#s-1_1_1-15">&para;</a></li>
              </ul>
              <p id="s-1_1_1-16"> A device connected to three separate Web Services provided by the same host establishes a separate stream for each service. This enables the device to present different application-level credentials top the different services. If permitted by the service, separate tasks on the same device <span class="bcp14">MAY</span> establish separate streams to the same service. This allows separate threads to wait on transactions taking a long time to complete without contention.<a class="pilcrow" href="#s-1_1_1-16">&para;</a></p>
              <p id="s-1_1_1-17">Each stream presents a sequence of datagrams spanning one or more packets according to a declared characteristic. The datagram represents the unit of payload data that is authenticated and thus the unit of payload data that is presented to the calling API.<a class="pilcrow" href="#s-1_1_1-17">&para;</a></p>
              <figure id="f-2">
                <div class="artwork art-svg" id="n-an-rdp-stream-presents-a-sequence-of-datagrams-each-of-which-may-span-multiple-packets">
                  <a class="pilcrow" href="#n-an-rdp-stream-presents-a-sequence-of-datagrams-each-of-which-may-span-multiple-packets">&para;</a>
<svg width="552" height="121" xmlns="http://www.w3.org/2000/svg" >
<g transform="translate(8,16)">
  <path d="M 0,0 L 536,0" fill="none" stroke="black" />
  <path d="M 0,32 L 72,32" fill="none" stroke="black" />
  <path d="M 72,32 L 144,32" fill="none" stroke="black" />
  <path d="M 144,32 L 216,32" fill="none" stroke="black" />
  <path d="M 216,32 L 288,32" fill="none" stroke="black" />
  <path d="M 288,32 L 360,32" fill="none" stroke="black" />
  <path d="M 360,32 L 432,32" fill="none" stroke="black" />
  <path d="M 432,32 L 504,32" fill="none" stroke="black" />
  <path d="M 504,32 L 536,32" fill="none" stroke="black" />
  <path d="M 0,64 L 72,64" fill="none" stroke="black" />
  <path d="M 72,64 L 144,64" fill="none" stroke="black" />
  <path d="M 144,64 L 216,64" fill="none" stroke="black" />
  <path d="M 216,64 L 288,64" fill="none" stroke="black" />
  <path d="M 288,64 L 360,64" fill="none" stroke="black" />
  <path d="M 360,64 L 432,64" fill="none" stroke="black" />
  <path d="M 432,64 L 504,64" fill="none" stroke="black" />
  <path d="M 504,64 L 536,64" fill="none" stroke="black" />
  <path d="M 0,96 L 72,96" fill="none" stroke="black" />
  <path d="M 72,96 L 144,96" fill="none" stroke="black" />
  <path d="M 144,96 L 216,96" fill="none" stroke="black" />
  <path d="M 216,96 L 288,96" fill="none" stroke="black" />
  <path d="M 288,96 L 360,96" fill="none" stroke="black" />
  <path d="M 360,96 L 432,96" fill="none" stroke="black" />
  <path d="M 432,96 L 504,96" fill="none" stroke="black" />
  <path d="M 504,96 L 536,96" fill="none" stroke="black" />
  <path d="M 0,0 L 0,32" fill="none" stroke="black" />
  <path d="M 0,32 L 0,64" fill="none" stroke="black" />
  <path d="M 0,64 L 0,96" fill="none" stroke="black" />
  <path d="M 72,64 L 72,96" fill="none" stroke="black" />
  <path d="M 144,64 L 144,96" fill="none" stroke="black" />
  <path d="M 216,32 L 216,64" fill="none" stroke="black" />
  <path d="M 216,64 L 216,96" fill="none" stroke="black" />
  <path d="M 288,32 L 288,64" fill="none" stroke="black" />
  <path d="M 288,64 L 288,96" fill="none" stroke="black" />
  <path d="M 360,64 L 360,96" fill="none" stroke="black" />
  <path d="M 432,32 L 432,64" fill="none" stroke="black" />
  <path d="M 432,64 L 432,96" fill="none" stroke="black" />
  <path d="M 504,64 L 504,96" fill="none" stroke="black" />
  <polygon points="544.000000,0.000000 532.000000,-5.600000 532.000000,5.600000" fill="black" transform="rotate(0.000000, 536.000000, 0.000000)" />
  <polygon points="544.000000,32.000000 532.000000,26.400000 532.000000,37.599998" fill="black" transform="rotate(0.000000, 536.000000, 32.000000)" />
  <polygon points="544.000000,64.000000 532.000000,58.400002 532.000000,69.599998" fill="black" transform="rotate(0.000000, 536.000000, 64.000000)" />
  <polygon points="544.000000,96.000000 532.000000,90.400002 532.000000,101.599998" fill="black" transform="rotate(0.000000, 536.000000, 96.000000)" />
  <text text-anchor="middle" font-family="sans-serif" x="264" y="20">e</text>
  <text text-anchor="middle" font-family="sans-serif" x="520" y="52">4</text>
  <text text-anchor="middle" font-family="sans-serif" x="240" y="84">a</text>
  <text text-anchor="middle" font-family="sans-serif" x="400" y="84">k</text>
  <text text-anchor="middle" font-family="sans-serif" x="88" y="52">t</text>
  <text text-anchor="middle" font-family="sans-serif" x="224" y="52">D</text>
  <text text-anchor="middle" font-family="sans-serif" x="320" y="52">D</text>
  <text text-anchor="middle" font-family="sans-serif" x="328" y="52">a</text>
  <text text-anchor="middle" font-family="sans-serif" x="32" y="84">c</text>
  <text text-anchor="middle" font-family="sans-serif" x="200" y="84">t</text>
  <text text-anchor="middle" font-family="sans-serif" x="336" y="84">e</text>
  <text text-anchor="middle" font-family="sans-serif" x="376" y="84">P</text>
  <text text-anchor="middle" font-family="sans-serif" x="480" y="84">e</text>
  <text text-anchor="middle" font-family="sans-serif" x="280" y="20">m</text>
  <text text-anchor="middle" font-family="sans-serif" x="120" y="52">a</text>
  <text text-anchor="middle" font-family="sans-serif" x="344" y="52">a</text>
  <text text-anchor="middle" font-family="sans-serif" x="96" y="84">a</text>
  <text text-anchor="middle" font-family="sans-serif" x="184" y="84">k</text>
  <text text-anchor="middle" font-family="sans-serif" x="256" y="84">k</text>
  <text text-anchor="middle" font-family="sans-serif" x="392" y="84">c</text>
  <text text-anchor="middle" font-family="sans-serif" x="272" y="52">2</text>
  <text text-anchor="middle" font-family="sans-serif" x="480" y="52">g</text>
  <text text-anchor="middle" font-family="sans-serif" x="16" y="84">P</text>
  <text text-anchor="middle" font-family="sans-serif" x="336" y="52">t</text>
  <text text-anchor="middle" font-family="sans-serif" x="472" y="52">a</text>
  <text text-anchor="middle" font-family="sans-serif" x="128" y="84">t</text>
  <text text-anchor="middle" font-family="sans-serif" x="472" y="84">k</text>
  <text text-anchor="middle" font-family="sans-serif" x="128" y="52">m</text>
  <text text-anchor="middle" font-family="sans-serif" x="104" y="84">c</text>
  <text text-anchor="middle" font-family="sans-serif" x="192" y="84">e</text>
  <text text-anchor="middle" font-family="sans-serif" x="112" y="52">r</text>
  <text text-anchor="middle" font-family="sans-serif" x="392" y="52">3</text>
  <text text-anchor="middle" font-family="sans-serif" x="488" y="52">r</text>
  <text text-anchor="middle" font-family="sans-serif" x="320" y="84">c</text>
  <text text-anchor="middle" font-family="sans-serif" x="408" y="84">e</text>
  <text text-anchor="middle" font-family="sans-serif" x="248" y="20">t</text>
  <text text-anchor="middle" font-family="sans-serif" x="96" y="52">a</text>
  <text text-anchor="middle" font-family="sans-serif" x="256" y="52">m</text>
  <text text-anchor="middle" font-family="sans-serif" x="360" y="52">r</text>
  <text text-anchor="middle" font-family="sans-serif" x="368" y="52">a</text>
  <text text-anchor="middle" font-family="sans-serif" x="112" y="84">k</text>
  <text text-anchor="middle" font-family="sans-serif" x="344" y="84">t</text>
  <text text-anchor="middle" font-family="sans-serif" x="464" y="84">c</text>
  <text text-anchor="middle" font-family="sans-serif" x="144" y="52">1</text>
  <text text-anchor="middle" font-family="sans-serif" x="504" y="52">m</text>
  <text text-anchor="middle" font-family="sans-serif" x="248" y="84">c</text>
  <text text-anchor="middle" font-family="sans-serif" x="416" y="84">t</text>
  <text text-anchor="middle" font-family="sans-serif" x="488" y="84">t</text>
  <text text-anchor="middle" font-family="sans-serif" x="72" y="52">D</text>
  <text text-anchor="middle" font-family="sans-serif" x="496" y="52">a</text>
  <text text-anchor="middle" font-family="sans-serif" x="40" y="84">k</text>
  <text text-anchor="middle" font-family="sans-serif" x="176" y="84">c</text>
  <text text-anchor="middle" font-family="sans-serif" x="448" y="84">P</text>
  <text text-anchor="middle" font-family="sans-serif" x="240" y="20">S</text>
  <text text-anchor="middle" font-family="sans-serif" x="272" y="20">a</text>
  <text text-anchor="middle" font-family="sans-serif" x="80" y="52">a</text>
  <text text-anchor="middle" font-family="sans-serif" x="456" y="52">a</text>
  <text text-anchor="middle" font-family="sans-serif" x="168" y="84">a</text>
  <text text-anchor="middle" font-family="sans-serif" x="256" y="20">r</text>
  <text text-anchor="middle" font-family="sans-serif" x="48" y="84">e</text>
  <text text-anchor="middle" font-family="sans-serif" x="232" y="84">P</text>
  <text text-anchor="middle" font-family="sans-serif" x="272" y="84">t</text>
  <text text-anchor="middle" font-family="sans-serif" x="328" y="84">k</text>
  <text text-anchor="middle" font-family="sans-serif" x="264" y="84">e</text>
  <text text-anchor="middle" font-family="sans-serif" x="248" y="52">a</text>
  <text text-anchor="middle" font-family="sans-serif" x="352" y="52">g</text>
  <text text-anchor="middle" font-family="sans-serif" x="56" y="84">t</text>
  <text text-anchor="middle" font-family="sans-serif" x="456" y="84">a</text>
  <text text-anchor="middle" font-family="sans-serif" x="104" y="52">g</text>
  <text text-anchor="middle" font-family="sans-serif" x="240" y="52">r</text>
  <text text-anchor="middle" font-family="sans-serif" x="448" y="52">D</text>
  <text text-anchor="middle" font-family="sans-serif" x="24" y="84">a</text>
  <text text-anchor="middle" font-family="sans-serif" x="232" y="52">g</text>
  <text text-anchor="middle" font-family="sans-serif" x="376" y="52">m</text>
  <text text-anchor="middle" font-family="sans-serif" x="464" y="52">t</text>
  <text text-anchor="middle" font-family="sans-serif" x="88" y="84">P</text>
  <text text-anchor="middle" font-family="sans-serif" x="120" y="84">e</text>
  <text text-anchor="middle" font-family="sans-serif" x="160" y="84">P</text>
  <text text-anchor="middle" font-family="sans-serif" x="304" y="84">P</text>
  <text text-anchor="middle" font-family="sans-serif" x="312" y="84">a</text>
  <text text-anchor="middle" font-family="sans-serif" x="384" y="84">a</text>
</g></svg>
                  <figcaption>
                    <a href="n-an-rdp-stream-presents-a-sequence-of-datagrams-each-of-which-may-span-multiple-packets">Figure 2</a>
:                    <a href="null" id="null" class="selfRef">An RDP stream presents a sequence of datagrams, each of which may span multiple packets.</a>
                  </figcaption>
                </div>
                <p id="s-1_1_1-19">Two stream characteristics are currently defined, both of which are asymmetric.<a class="pilcrow" href="#s-1_1_1-19">&para;</a></p>
                <dl id="s-1_1_1-20-" class="nohang">
                  <dt id="s-1_1_1-20">Transactional Stream<a class="pilcrow" href="#s-1_1_1-20">&para;</a></dt>
                  <dd id="null">Each request sent in the forward direction is followed by a response returned in the reverse direction.<a class="pilcrow" href="#">&para;</a></dd>
                  <dt id="s-1_1_1-21">Asynchronous Stream<a class="pilcrow" href="#s-1_1_1-21">&para;</a></dt>
                  <dd id="null">A sequence of frames is received in the forward direction as directed by control messages sent in the reverse direction.<a class="pilcrow" href="#">&para;</a></dd>
                </dl>
                <p id="s-1_1_1-22">Thus, a bidirectional voice call between Alice and Bob requires a minimum of two Asynchronous Content streams, from Alice to Bob and from Bob to Alice.<a class="pilcrow" href="#s-1_1_1-22">&para;</a></p>
              </figure>
              
              <section id="n-application-interface">
                <h5 id="s-1_1_2">
                  <a class="selfRef" href="#s-1_1_2">1.1.2.</a>
                  <a class="selfRef" href="#n-application-interface">Application Interface</a>
                </h5>
                <p id="s-1_1_2-1">The traditional TCP/IP programming API exposes only an undifferentiated stream of bytes to the application program context. Information such as packet latency, packet loss rate, error rate, etc. are only available through proprietary platform specific APIs, if at all.<a class="pilcrow" href="#s-1_1_2-1">&para;</a></p>
                <p id="s-1_1_2-2">RDP is designed to provide application programs with relevant connection information including:<a class="pilcrow" href="#s-1_1_2-2">&para;</a></p>
                <ul id="s-1_1_2-3-">
                  <li id="s-1_1_2-3">Time since the most recent forward secrecy exchange<a class="pilcrow" href="#s-1_1_2-3">&para;</a></li>
                  <li id="s-1_1_2-4">Average round trip latency (per port)<a class="pilcrow" href="#s-1_1_2-4">&para;</a></li>
                  <li id="s-1_1_2-5">Packet loss (per port)<a class="pilcrow" href="#s-1_1_2-5">&para;</a></li>
                </ul>
                <p id="s-1_1_2-6">Providing this information allows applications to adapt to changing network conditions.<a class="pilcrow" href="#s-1_1_2-6">&para;</a></p>
                <ul id="s-1_1_2-7-">
                  <li id="s-1_1_2-7">Forcing a forward secrecy exchange when a participant leaves a shared chat context<a class="pilcrow" href="#s-1_1_2-7">&para;</a></li>
                  <li id="s-1_1_2-8">Making use of an outbound port with a different physical network connection.<a class="pilcrow" href="#s-1_1_2-8">&para;</a></li>
                  <li id="s-1_1_2-9">Establishing communication to a different host.<a class="pilcrow" href="#s-1_1_2-9">&para;</a></li>
                  <li id="s-1_1_2-10">Pre-empt (i.e. abandon) transfer of large datagrams in mid transfer.<a class="pilcrow" href="#s-1_1_2-10">&para;</a></li>
                </ul>
                <p id="s-1_1_2-11">The API exposes the following object classes:<a class="pilcrow" href="#s-1_1_2-11">&para;</a></p>
                <dl id="s-1_1_2-12-" class="nohang">
                  <dt id="s-1_1_2-12">Connection<a class="pilcrow" href="#s-1_1_2-12">&para;</a></dt>
                  <dd id="null">Reports the connection status, supports creation of new Streams.<a class="pilcrow" href="#">&para;</a></dd>
                  <dt id="s-1_1_2-13">Transactional Stream Initiator<a class="pilcrow" href="#s-1_1_2-13">&para;</a></dt>
                  <dd id="null">Supports the Post method comprising sending a request to the service to which the stream is bound and waiting for a response.<a class="pilcrow" href="#">&para;</a></dd>
                  <dt id="s-1_1_2-14">Transactional Stream Responder<a class="pilcrow" href="#s-1_1_2-14">&para;</a></dt>
                  <dd id="null">Is generated on receipt of a service request to which it is dispatched to obtain the service response.<a class="pilcrow" href="#">&para;</a></dd>
                  <dt id="s-1_1_2-15">Asynchronous Stream Sender<a class="pilcrow" href="#s-1_1_2-15">&para;</a></dt>
                  <dd id="null">Allows transmission of a sequence of datagrams to a receiver. Reports stream properties set by the receiver.<a class="pilcrow" href="#">&para;</a></dd>
                  <dt id="s-1_1_2-16">Asynchronous Stream Receiver<a class="pilcrow" href="#s-1_1_2-16">&para;</a></dt>
                  <dd id="null">Receives a continuous sequence of datagrams from the sender. Allows setting of stream properties.<a class="pilcrow" href="#">&para;</a></dd>
                  <dt id="s-1_1_2-17">Datagram<a class="pilcrow" href="#s-1_1_2-17">&para;</a></dt>
                  <dd id="null">Exposes the packet data relevant transmission information.<a class="pilcrow" href="#">&para;</a></dd>
                  <dt id="s-1_1_2-18">Stream Creation Ticket<a class="pilcrow" href="#s-1_1_2-18">&para;</a></dt>
                  <dd id="null">A stream creation ticket is a record created by an issuer device consisting of a stream identifier, a set of network endpoints, a shared secret and the issuer device's credential.<a class="pilcrow" href="#">&para;</a></dd>
                </dl>
                <p id="s-1_1_2-19">The details of the RDP API are out of scope for this specification.<a class="pilcrow" href="#s-1_1_2-19">&para;</a></p>
              </section>
              
              <section id="n-use-cases">
                <h4 id="s-1_2">
                  <a class="selfRef" href="#s-1_2">1.2.</a>
                  <a class="selfRef" href="#n-use-cases">Use Cases</a>
                </h4>
                <p id="s-1_2-1">Despite representing a modest incremental advance on the complexity of TCP and a substantial reduction in complexity compared to TLS, RDP provides support for a wide range of use cases outside the scope of either.<a class="pilcrow" href="#s-1_2-1">&para;</a></p>
              </section>
              
              <section id="n-network-agility">
                <h5 id="s-1_2_1">
                  <a class="selfRef" href="#s-1_2_1">1.2.1.</a>
                  <a class="selfRef" href="#n-network-agility">Network Agility</a>
                </h5>
                <p id="s-1_2_1-1">The separation of RDP streams from the network ports through which they are realized allows network agility to be supported without any additional complexity.<a class="pilcrow" href="#s-1_2_1-1">&para;</a></p>
                <p id="s-1_2_1-2">For example, Alice joins a conference call from her mobile phone in her home office. When she leaves for work in her car, the connection to her conference call is transferred seamlessly from hew home WiFi service to her mobile carrier.<a class="pilcrow" href="#s-1_2_1-2">&para;</a></p>
                <figure id="f-3">
                  <div class="artwork art-svg" id="n-alice-maintains-connection-to-her-conference-call-when-moving-from-her-home-to-her-office">
                    <a class="pilcrow" href="#n-alice-maintains-connection-to-her-conference-call-when-moving-from-her-home-to-her-office">&para;</a>
<svg width="512" height="345" xmlns="http://www.w3.org/2000/svg" >
<g transform="translate(8,16)">
  <path d="M 0,0 L 160,0" fill="none" stroke="black" />
  <path d="M 336,0 L 496,0" fill="none" stroke="black" />
  <path d="M 32,48 L 128,48" fill="none" stroke="black" />
  <path d="M 368,48 L 464,48" fill="none" stroke="black" />
  <path d="M 216,64 L 280,64" fill="none" stroke="black" />
  <path d="M 32,80 L 128,80" fill="none" stroke="black" />
  <path d="M 368,80 L 464,80" fill="none" stroke="black" />
  <path d="M 32,112 L 80,112" fill="none" stroke="black" />
  <path d="M 80,112 L 128,112" fill="none" stroke="black" />
  <path d="M 368,112 L 416,112" fill="none" stroke="black" />
  <path d="M 416,112 L 464,112" fill="none" stroke="black" />
  <path d="M 0,128 L 80,128" fill="none" stroke="black" />
  <path d="M 80,128 L 160,128" fill="none" stroke="black" />
  <path d="M 336,128 L 416,128" fill="none" stroke="black" />
  <path d="M 416,128 L 496,128" fill="none" stroke="black" />
  <path d="M 80,160 L 224,160" fill="none" stroke="black" />
  <path d="M 280,160 L 416,160" fill="none" stroke="black" />
  <path d="M 168,192 L 224,192" fill="none" stroke="black" />
  <path d="M 224,192 L 280,192" fill="none" stroke="black" />
  <path d="M 280,192 L 328,192" fill="none" stroke="black" />
  <path d="M 200,208 L 224,208" fill="none" stroke="black" />
  <path d="M 224,208 L 280,208" fill="none" stroke="black" />
  <path d="M 280,208 L 296,208" fill="none" stroke="black" />
  <path d="M 200,240 L 296,240" fill="none" stroke="black" />
  <path d="M 200,272 L 248,272" fill="none" stroke="black" />
  <path d="M 248,272 L 296,272" fill="none" stroke="black" />
  <path d="M 168,320 L 328,320" fill="none" stroke="black" />
  <path d="M 0,0 L 0,128" fill="none" stroke="black" />
  <path d="M 32,48 L 32,80" fill="none" stroke="black" />
  <path d="M 32,80 L 32,112" fill="none" stroke="black" />
  <path d="M 80,112 L 80,128" fill="none" stroke="black" />
  <path d="M 80,128 L 80,160" fill="none" stroke="black" />
  <path d="M 128,48 L 128,80" fill="none" stroke="black" />
  <path d="M 128,80 L 128,112" fill="none" stroke="black" />
  <path d="M 160,0 L 160,128" fill="none" stroke="black" />
  <path d="M 168,192 L 168,320" fill="none" stroke="black" />
  <path d="M 200,208 L 200,240" fill="none" stroke="black" />
  <path d="M 200,240 L 200,272" fill="none" stroke="black" />
  <path d="M 224,160 L 224,192" fill="none" stroke="black" />
  <path d="M 224,192 L 224,208" fill="none" stroke="black" />
  <path d="M 280,160 L 280,192" fill="none" stroke="black" />
  <path d="M 280,192 L 280,208" fill="none" stroke="black" />
  <path d="M 296,208 L 296,240" fill="none" stroke="black" />
  <path d="M 296,240 L 296,272" fill="none" stroke="black" />
  <path d="M 328,192 L 328,320" fill="none" stroke="black" />
  <path d="M 336,0 L 336,128" fill="none" stroke="black" />
  <path d="M 368,48 L 368,80" fill="none" stroke="black" />
  <path d="M 368,80 L 368,112" fill="none" stroke="black" />
  <path d="M 416,112 L 416,128" fill="none" stroke="black" />
  <path d="M 416,128 L 416,160" fill="none" stroke="black" />
  <path d="M 464,48 L 464,80" fill="none" stroke="black" />
  <path d="M 464,80 L 464,112" fill="none" stroke="black" />
  <path d="M 496,0 L 496,128" fill="none" stroke="black" />
  <polygon points="288.000000,64.000000 276.000000,58.400002 276.000000,69.599998" fill="black" transform="rotate(0.000000, 280.000000, 64.000000)" />
  <text text-anchor="middle" font-family="sans-serif" x="432" y="36">a</text>
  <text text-anchor="middle" font-family="sans-serif" x="216" y="52">e</text>
  <text text-anchor="middle" font-family="sans-serif" x="104" y="36">e</text>
  <text text-anchor="middle" font-family="sans-serif" x="400" y="36">I</text>
  <text text-anchor="middle" font-family="sans-serif" x="448" y="36">)</text>
  <text text-anchor="middle" font-family="sans-serif" x="208" y="52">L</text>
  <text text-anchor="middle" font-family="sans-serif" x="64" y="100">F</text>
  <text text-anchor="middle" font-family="sans-serif" x="264" y="228">o</text>
  <text text-anchor="middle" font-family="sans-serif" x="280" y="260">9</text>
  <text text-anchor="middle" font-family="sans-serif" x="408" y="36">n</text>
  <text text-anchor="middle" font-family="sans-serif" x="400" y="100">G</text>
  <text text-anchor="middle" font-family="sans-serif" x="272" y="228">r</text>
  <text text-anchor="middle" font-family="sans-serif" x="224" y="260">S</text>
  <text text-anchor="middle" font-family="sans-serif" x="416" y="20">i</text>
  <text text-anchor="middle" font-family="sans-serif" x="232" y="52">v</text>
  <text text-anchor="middle" font-family="sans-serif" x="72" y="68">r</text>
  <text text-anchor="middle" font-family="sans-serif" x="416" y="100">P</text>
  <text text-anchor="middle" font-family="sans-serif" x="96" y="36">m</text>
  <text text-anchor="middle" font-family="sans-serif" x="64" y="68">t</text>
  <text text-anchor="middle" font-family="sans-serif" x="96" y="20">e</text>
  <text text-anchor="middle" font-family="sans-serif" x="432" y="68">m</text>
  <text text-anchor="middle" font-family="sans-serif" x="56" y="100">i</text>
  <text text-anchor="middle" font-family="sans-serif" x="224" y="228">L</text>
  <text text-anchor="middle" font-family="sans-serif" x="240" y="308">B</text>
  <text text-anchor="middle" font-family="sans-serif" x="48" y="36">(</text>
  <text text-anchor="middle" font-family="sans-serif" x="392" y="36">(</text>
  <text text-anchor="middle" font-family="sans-serif" x="280" y="52">m</text>
  <text text-anchor="middle" font-family="sans-serif" x="288" y="52">e</text>
  <text text-anchor="middle" font-family="sans-serif" x="88" y="68">a</text>
  <text text-anchor="middle" font-family="sans-serif" x="48" y="100">W</text>
  <text text-anchor="middle" font-family="sans-serif" x="248" y="260">e</text>
  <text text-anchor="middle" font-family="sans-serif" x="56" y="36">A</text>
  <text text-anchor="middle" font-family="sans-serif" x="440" y="36">r</text>
  <text text-anchor="middle" font-family="sans-serif" x="392" y="68">S</text>
  <text text-anchor="middle" font-family="sans-serif" x="96" y="100">o</text>
  <text text-anchor="middle" font-family="sans-serif" x="232" y="260">t</text>
  <text text-anchor="middle" font-family="sans-serif" x="256" y="260">a</text>
  <text text-anchor="middle" font-family="sans-serif" x="400" y="20">A</text>
  <text text-anchor="middle" font-family="sans-serif" x="64" y="36">t</text>
  <text text-anchor="middle" font-family="sans-serif" x="240" y="52">e</text>
  <text text-anchor="middle" font-family="sans-serif" x="272" y="52">o</text>
  <text text-anchor="middle" font-family="sans-serif" x="408" y="68">r</text>
  <text text-anchor="middle" font-family="sans-serif" x="416" y="68">e</text>
  <text text-anchor="middle" font-family="sans-serif" x="424" y="68">a</text>
  <text text-anchor="middle" font-family="sans-serif" x="104" y="100">r</text>
  <text text-anchor="middle" font-family="sans-serif" x="264" y="260">m</text>
  <text text-anchor="middle" font-family="sans-serif" x="72" y="20">l</text>
  <text text-anchor="middle" font-family="sans-serif" x="408" y="20">l</text>
  <text text-anchor="middle" font-family="sans-serif" x="424" y="36">c</text>
  <text text-anchor="middle" font-family="sans-serif" x="224" y="52">a</text>
  <text text-anchor="middle" font-family="sans-serif" x="448" y="68">3</text>
  <text text-anchor="middle" font-family="sans-serif" x="392" y="100">4</text>
  <text text-anchor="middle" font-family="sans-serif" x="240" y="228">N</text>
  <text text-anchor="middle" font-family="sans-serif" x="248" y="52">s</text>
  <text text-anchor="middle" font-family="sans-serif" x="96" y="68">m</text>
  <text text-anchor="middle" font-family="sans-serif" x="440" y="100">t</text>
  <text text-anchor="middle" font-family="sans-serif" x="256" y="228">P</text>
  <text text-anchor="middle" font-family="sans-serif" x="88" y="20">c</text>
  <text text-anchor="middle" font-family="sans-serif" x="112" y="68">3</text>
  <text text-anchor="middle" font-family="sans-serif" x="72" y="100">i</text>
  <text text-anchor="middle" font-family="sans-serif" x="424" y="100">o</text>
  <text text-anchor="middle" font-family="sans-serif" x="248" y="308">o</text>
  <text text-anchor="middle" font-family="sans-serif" x="64" y="20">A</text>
  <text text-anchor="middle" font-family="sans-serif" x="424" y="20">c</text>
  <text text-anchor="middle" font-family="sans-serif" x="432" y="20">e</text>
  <text text-anchor="middle" font-family="sans-serif" x="80" y="36">h</text>
  <text text-anchor="middle" font-family="sans-serif" x="112" y="36">)</text>
  <text text-anchor="middle" font-family="sans-serif" x="240" y="260">r</text>
  <text text-anchor="middle" font-family="sans-serif" x="88" y="36">o</text>
  <text text-anchor="middle" font-family="sans-serif" x="264" y="52">h</text>
  <text text-anchor="middle" font-family="sans-serif" x="112" y="100">t</text>
  <text text-anchor="middle" font-family="sans-serif" x="432" y="100">r</text>
  <text text-anchor="middle" font-family="sans-serif" x="280" y="228">t</text>
  <text text-anchor="middle" font-family="sans-serif" x="80" y="20">i</text>
  <text text-anchor="middle" font-family="sans-serif" x="56" y="68">S</text>
  <text text-anchor="middle" font-family="sans-serif" x="80" y="68">e</text>
  <text text-anchor="middle" font-family="sans-serif" x="400" y="68">t</text>
  <text text-anchor="middle" font-family="sans-serif" x="88" y="100">P</text>
  <text text-anchor="middle" font-family="sans-serif" x="232" y="228">A</text>
  <text text-anchor="middle" font-family="sans-serif" x="256" y="308">b</text>
</g></svg>
                    <figcaption>
                      <a href="n-alice-maintains-connection-to-her-conference-call-when-moving-from-her-home-to-her-office">Figure 3</a>
:                      <a href="null" id="null" class="selfRef">Alice maintains connection to her conference call when moving from her home to her office.</a>
                    </figcaption>
                  </div>
                  <p id="s-1_2_1-4">The same approach <span class="bcp14">MAY</span> be employed to provide fault tolerance in an enterprise server hosting environment.<a class="pilcrow" href="#s-1_2_1-4">&para;</a></p>
                </figure>
                
                <section id="n-connection-transfer-and-delegation">
                  <h5 id="s-1_2_2">
                    <a class="selfRef" href="#s-1_2_2">1.2.2.</a>
                    <a class="selfRef" href="#n-connection-transfer-and-delegation">Connection Transfer and Delegation</a>
                  </h5>
                  <p id="s-1_2_2-1">It is frequently desirable for a device to negotiate delivery of a service with one host that will ultimately be delivered by another. RDP supports the issue of a 'ticket' credential by a host providing a discovery service that <span class="bcp14">MAY</span> be used to establish a connection with the host that will deliver the requested service:<a class="pilcrow" href="#s-1_2_2-1">&para;</a></p>
                  <figure id="f-4">
                    <div class="artwork art-svg" id="n-connection-establishment-by-means-of-a-discovery-service">
                      <a class="pilcrow" href="#n-connection-establishment-by-means-of-a-discovery-service">&para;</a>
<svg width="552" height="185" xmlns="http://www.w3.org/2000/svg" >
<g transform="translate(8,16)">
  <path d="M 0,0 L 128,0" fill="none" stroke="black" />
  <path d="M 208,0 L 336,0" fill="none" stroke="black" />
  <path d="M 400,0 L 528,0" fill="none" stroke="black" />
  <path d="M 0,48 L 64,48" fill="none" stroke="black" />
  <path d="M 64,48 L 128,48" fill="none" stroke="black" />
  <path d="M 208,48 L 272,48" fill="none" stroke="black" />
  <path d="M 272,48 L 336,48" fill="none" stroke="black" />
  <path d="M 400,48 L 464,48" fill="none" stroke="black" />
  <path d="M 464,48 L 528,48" fill="none" stroke="black" />
  <path d="M 64,80 L 72,80" fill="none" stroke="black" />
  <path d="M 256,80 L 264,80" fill="none" stroke="black" />
  <path d="M 72,96 L 104,96" fill="none" stroke="black" />
  <path d="M 224,96 L 272,96" fill="none" stroke="black" />
  <path d="M 64,128 L 168,128" fill="none" stroke="black" />
  <path d="M 368,128 L 472,128" fill="none" stroke="black" />
  <path d="M 72,144 L 184,144" fill="none" stroke="black" />
  <path d="M 360,144 L 480,144" fill="none" stroke="black" />
  <path d="M 0,0 L 0,48" fill="none" stroke="black" />
  <path d="M 64,48 L 64,80" fill="none" stroke="black" />
  <path d="M 64,80 L 64,128" fill="none" stroke="black" />
  <path d="M 64,128 L 64,160" fill="none" stroke="black" />
  <path d="M 128,0 L 128,48" fill="none" stroke="black" />
  <path d="M 208,0 L 208,48" fill="none" stroke="black" />
  <path d="M 272,48 L 272,96" fill="none" stroke="black" />
  <path d="M 272,96 L 272,112" fill="none" stroke="black" />
  <path d="M 272,152 L 272,168" fill="none" stroke="black" />
  <path d="M 336,0 L 336,48" fill="none" stroke="black" />
  <path d="M 400,0 L 400,48" fill="none" stroke="black" />
  <path d="M 480,64 L 480,144" fill="none" stroke="black" />
  <path d="M 480,144 L 480,160" fill="none" stroke="black" />
  <path d="M 528,0 L 528,48" fill="none" stroke="black" />
  <path d="M 480,56 L 480,64" fill="none" stroke="black" />
  <polygon points="80.000000,96.000000 68.000000,90.400002 68.000000,101.599998" fill="black" transform="rotate(180.000000, 72.000000, 96.000000)" />
  <polygon points="80.000000,144.000000 68.000000,138.399994 68.000000,149.600006" fill="black" transform="rotate(180.000000, 72.000000, 144.000000)" />
  <polygon points="272.000000,80.000000 260.000000,74.400002 260.000000,85.599998" fill="black" transform="rotate(0.000000, 264.000000, 80.000000)" />
  <polygon points="480.000000,128.000000 468.000000,122.400002 468.000000,133.600006" fill="black" transform="rotate(0.000000, 472.000000, 128.000000)" />
  <text text-anchor="middle" font-family="sans-serif" x="224" y="84">i</text>
  <text text-anchor="middle" font-family="sans-serif" x="160" y="100">t</text>
  <text text-anchor="middle" font-family="sans-serif" x="240" y="148">l</text>
  <text text-anchor="middle" font-family="sans-serif" x="160" y="84">A</text>
  <text text-anchor="middle" font-family="sans-serif" x="184" y="84">l</text>
  <text text-anchor="middle" font-family="sans-serif" x="192" y="132">i</text>
  <text text-anchor="middle" font-family="sans-serif" x="280" y="20">o</text>
  <text text-anchor="middle" font-family="sans-serif" x="440" y="20">p</text>
  <text text-anchor="middle" font-family="sans-serif" x="248" y="36">S</text>
  <text text-anchor="middle" font-family="sans-serif" x="448" y="36">e</text>
  <text text-anchor="middle" font-family="sans-serif" x="128" y="84">v</text>
  <text text-anchor="middle" font-family="sans-serif" x="48" y="20">D</text>
  <text text-anchor="middle" font-family="sans-serif" x="440" y="36">S</text>
  <text text-anchor="middle" font-family="sans-serif" x="200" y="84">c</text>
  <text text-anchor="middle" font-family="sans-serif" x="208" y="148">C</text>
  <text text-anchor="middle" font-family="sans-serif" x="312" y="132">h</text>
  <text text-anchor="middle" font-family="sans-serif" x="328" y="132">n</text>
  <text text-anchor="middle" font-family="sans-serif" x="296" y="36">e</text>
  <text text-anchor="middle" font-family="sans-serif" x="72" y="20">i</text>
  <text text-anchor="middle" font-family="sans-serif" x="288" y="36">c</text>
  <text text-anchor="middle" font-family="sans-serif" x="144" y="84">r</text>
  <text text-anchor="middle" font-family="sans-serif" x="248" y="132">(</text>
  <text text-anchor="middle" font-family="sans-serif" x="304" y="132">c</text>
  <text text-anchor="middle" font-family="sans-serif" x="264" y="36">r</text>
  <text text-anchor="middle" font-family="sans-serif" x="272" y="36">v</text>
  <text text-anchor="middle" font-family="sans-serif" x="152" y="100">e</text>
  <text text-anchor="middle" font-family="sans-serif" x="288" y="148">x</text>
  <text text-anchor="middle" font-family="sans-serif" x="256" y="20">i</text>
  <text text-anchor="middle" font-family="sans-serif" x="272" y="20">c</text>
  <text text-anchor="middle" font-family="sans-serif" x="312" y="20">y</text>
  <text text-anchor="middle" font-family="sans-serif" x="488" y="20">i</text>
  <text text-anchor="middle" font-family="sans-serif" x="232" y="84">o</text>
  <text text-anchor="middle" font-family="sans-serif" x="128" y="100">i</text>
  <text text-anchor="middle" font-family="sans-serif" x="304" y="20">r</text>
  <text text-anchor="middle" font-family="sans-serif" x="432" y="20">p</text>
  <text text-anchor="middle" font-family="sans-serif" x="120" y="100">T</text>
  <text text-anchor="middle" font-family="sans-serif" x="208" y="100">t</text>
  <text text-anchor="middle" font-family="sans-serif" x="264" y="148">e</text>
  <text text-anchor="middle" font-family="sans-serif" x="320" y="148">n</text>
  <text text-anchor="middle" font-family="sans-serif" x="248" y="148">e</text>
  <text text-anchor="middle" font-family="sans-serif" x="184" y="100">P</text>
  <text text-anchor="middle" font-family="sans-serif" x="288" y="132">E</text>
  <text text-anchor="middle" font-family="sans-serif" x="336" y="132">g</text>
  <text text-anchor="middle" font-family="sans-serif" x="456" y="20">i</text>
  <text text-anchor="middle" font-family="sans-serif" x="256" y="36">e</text>
  <text text-anchor="middle" font-family="sans-serif" x="280" y="148">E</text>
  <text text-anchor="middle" font-family="sans-serif" x="288" y="20">v</text>
  <text text-anchor="middle" font-family="sans-serif" x="104" y="84">s</text>
  <text text-anchor="middle" font-family="sans-serif" x="192" y="84">i</text>
  <text text-anchor="middle" font-family="sans-serif" x="352" y="132">)</text>
  <text text-anchor="middle" font-family="sans-serif" x="496" y="20">o</text>
  <text text-anchor="middle" font-family="sans-serif" x="456" y="36">r</text>
  <text text-anchor="middle" font-family="sans-serif" x="472" y="36">i</text>
  <text text-anchor="middle" font-family="sans-serif" x="296" y="20">e</text>
  <text text-anchor="middle" font-family="sans-serif" x="168" y="84">p</text>
  <text text-anchor="middle" font-family="sans-serif" x="136" y="100">c</text>
  <text text-anchor="middle" font-family="sans-serif" x="208" y="132">k</text>
  <text text-anchor="middle" font-family="sans-serif" x="480" y="36">c</text>
  <text text-anchor="middle" font-family="sans-serif" x="216" y="132">e</text>
  <text text-anchor="middle" font-family="sans-serif" x="216" y="148">o</text>
  <text text-anchor="middle" font-family="sans-serif" x="256" y="148">t</text>
  <text text-anchor="middle" font-family="sans-serif" x="464" y="20">c</text>
  <text text-anchor="middle" font-family="sans-serif" x="216" y="84">t</text>
  <text text-anchor="middle" font-family="sans-serif" x="264" y="132">e</text>
  <text text-anchor="middle" font-family="sans-serif" x="296" y="148">c</text>
  <text text-anchor="middle" font-family="sans-serif" x="336" y="148">e</text>
  <text text-anchor="middle" font-family="sans-serif" x="488" y="36">e</text>
  <text text-anchor="middle" font-family="sans-serif" x="312" y="148">a</text>
  <text text-anchor="middle" font-family="sans-serif" x="200" y="100">r</text>
  <text text-anchor="middle" font-family="sans-serif" x="272" y="132">y</text>
  <text text-anchor="middle" font-family="sans-serif" x="448" y="20">l</text>
  <text text-anchor="middle" font-family="sans-serif" x="96" y="84">i</text>
  <text text-anchor="middle" font-family="sans-serif" x="112" y="84">c</text>
  <text text-anchor="middle" font-family="sans-serif" x="256" y="132">K</text>
  <text text-anchor="middle" font-family="sans-serif" x="344" y="148">)</text>
  <text text-anchor="middle" font-family="sans-serif" x="424" y="20">A</text>
  <text text-anchor="middle" font-family="sans-serif" x="88" y="84">D</text>
  <text text-anchor="middle" font-family="sans-serif" x="136" y="84">e</text>
  <text text-anchor="middle" font-family="sans-serif" x="168" y="100">,</text>
  <text text-anchor="middle" font-family="sans-serif" x="320" y="132">a</text>
  <text text-anchor="middle" font-family="sans-serif" x="240" y="84">n</text>
  <text text-anchor="middle" font-family="sans-serif" x="144" y="100">k</text>
  <text text-anchor="middle" font-family="sans-serif" x="184" y="132">T</text>
  <text text-anchor="middle" font-family="sans-serif" x="232" y="148">p</text>
  <text text-anchor="middle" font-family="sans-serif" x="120" y="84">o</text>
  <text text-anchor="middle" font-family="sans-serif" x="208" y="84">a</text>
  <text text-anchor="middle" font-family="sans-serif" x="192" y="100">o</text>
  <text text-anchor="middle" font-family="sans-serif" x="200" y="132">c</text>
  <text text-anchor="middle" font-family="sans-serif" x="80" y="20">c</text>
  <text text-anchor="middle" font-family="sans-serif" x="464" y="36">v</text>
  <text text-anchor="middle" font-family="sans-serif" x="304" y="148">h</text>
  <text text-anchor="middle" font-family="sans-serif" x="224" y="132">t</text>
  <text text-anchor="middle" font-family="sans-serif" x="296" y="132">x</text>
  <text text-anchor="middle" font-family="sans-serif" x="56" y="20">e</text>
  <text text-anchor="middle" font-family="sans-serif" x="480" y="20">t</text>
  <text text-anchor="middle" font-family="sans-serif" x="280" y="36">i</text>
  <text text-anchor="middle" font-family="sans-serif" x="176" y="84">p</text>
  <text text-anchor="middle" font-family="sans-serif" x="504" y="20">n</text>
  <text text-anchor="middle" font-family="sans-serif" x="200" y="148">(</text>
  <text text-anchor="middle" font-family="sans-serif" x="224" y="148">m</text>
  <text text-anchor="middle" font-family="sans-serif" x="344" y="132">e</text>
  <text text-anchor="middle" font-family="sans-serif" x="328" y="148">g</text>
  <text text-anchor="middle" font-family="sans-serif" x="64" y="20">v</text>
  <text text-anchor="middle" font-family="sans-serif" x="88" y="20">e</text>
  <text text-anchor="middle" font-family="sans-serif" x="248" y="20">D</text>
  <text text-anchor="middle" font-family="sans-serif" x="264" y="20">s</text>
  <text text-anchor="middle" font-family="sans-serif" x="472" y="20">a</text>
  <text text-anchor="middle" font-family="sans-serif" x="232" y="132">,</text>
</g></svg>
                      <figcaption>
                        <a href="n-connection-establishment-by-means-of-a-discovery-service">Figure 4</a>
:                        <a href="null" id="null" class="selfRef">Connection establishment by means of a discovery service.</a>
                      </figcaption>
                    </div>
                    <p id="s-1_2_2-3">The same capability <span class="bcp14">MAY</span> be applied to enable hosts to direct connected devices to seek service from a different host, either immediately or in case of service interruption. This allows for greater flexibility in configuring systems to provide fault tolerance and to effect load balancing strategies.<a class="pilcrow" href="#s-1_2_2-3">&para;</a></p>
                  </figure>
                  
                  <section id="n-presence">
                    <h5 id="s-1_2_3">
                      <a class="selfRef" href="#s-1_2_3">1.2.3.</a>
                      <a class="selfRef" href="#n-presence">Presence</a>
                    </h5>
                    <p id="s-1_2_3-1">Presence is a particular form of connection transfer. A presence service facilitates creation of a voice or video connection between the device used by the initiator to make the request to one of the multiple receiver devices on which it might be accepted.<a class="pilcrow" href="#s-1_2_3-1">&para;</a></p>
                    <p id="s-1_2_3-2">Each receiver device maintains a connection to the presence service that is active whenever the receiver device is available to accept calls. To request a connection, the initiator device contacts the presence service which determines if the request is authorized and if so, returns the ticket and network endpoint information required to  establish a connection.<a class="pilcrow" href="#s-1_2_3-2">&para;</a></p>
                    <p id="s-1_2_3-3">For example, Bob's phone connects to the presence service and provides a ticket and network endpoint information to enable calls to be placed. When Alice attempts to place a call, her device contacts the presence service, which checks that Bob has authorized Alice to interrupt her work. Alice's device uses the information from the presence service to perform a forward secrecy operation against Bob's phone and thus achieve full end-to-end secure communication. <a class="pilcrow" href="#s-1_2_3-3">&para;</a></p>
                    <figure id="f-5">
                      <div class="artwork art-svg" id="n-alice-contacts-bob-through-a-presence-service">
                        <a class="pilcrow" href="#n-alice-contacts-bob-through-a-presence-service">&para;</a>
<svg width="536" height="281" xmlns="http://www.w3.org/2000/svg" >
<g transform="translate(8,16)">
  <path d="M 0,0 L 128,0" fill="none" stroke="black" />
  <path d="M 192,0 L 320,0" fill="none" stroke="black" />
  <path d="M 384,0 L 512,0" fill="none" stroke="black" />
  <path d="M 0,48 L 64,48" fill="none" stroke="black" />
  <path d="M 64,48 L 128,48" fill="none" stroke="black" />
  <path d="M 192,48 L 256,48" fill="none" stroke="black" />
  <path d="M 256,48 L 320,48" fill="none" stroke="black" />
  <path d="M 384,48 L 448,48" fill="none" stroke="black" />
  <path d="M 448,48 L 512,48" fill="none" stroke="black" />
  <path d="M 264,80 L 288,80" fill="none" stroke="black" />
  <path d="M 64,96 L 88,96" fill="none" stroke="black" />
  <path d="M 192,128 L 256,128" fill="none" stroke="black" />
  <path d="M 256,128 L 320,128" fill="none" stroke="black" />
  <path d="M 192,160 L 256,160" fill="none" stroke="black" />
  <path d="M 256,160 L 320,160" fill="none" stroke="black" />
  <path d="M 72,192 L 96,192" fill="none" stroke="black" />
  <path d="M 64,224 L 160,224" fill="none" stroke="black" />
  <path d="M 72,240 L 176,240" fill="none" stroke="black" />
  <path d="M 0,0 L 0,48" fill="none" stroke="black" />
  <path d="M 64,48 L 64,96" fill="none" stroke="black" />
  <path d="M 64,96 L 64,224" fill="none" stroke="black" />
  <path d="M 64,224 L 64,256" fill="none" stroke="black" />
  <path d="M 128,0 L 128,48" fill="none" stroke="black" />
  <path d="M 192,0 L 192,48" fill="none" stroke="black" />
  <path d="M 192,128 L 192,160" fill="none" stroke="black" />
  <path d="M 256,48 L 256,128" fill="none" stroke="black" />
  <path d="M 256,160 L 256,192" fill="none" stroke="black" />
  <path d="M 256,192 L 256,208" fill="none" stroke="black" />
  <path d="M 256,248 L 256,264" fill="none" stroke="black" />
  <path d="M 320,0 L 320,48" fill="none" stroke="black" />
  <path d="M 320,128 L 320,160" fill="none" stroke="black" />
  <path d="M 384,0 L 384,48" fill="none" stroke="black" />
  <path d="M 448,48 L 448,80" fill="none" stroke="black" />
  <path d="M 448,80 L 448,240" fill="none" stroke="black" />
  <path d="M 448,240 L 448,256" fill="none" stroke="black" />
  <path d="M 512,0 L 512,48" fill="none" stroke="black" />
  <polygon points="80.000000,192.000000 68.000000,186.399994 68.000000,197.600006" fill="black" transform="rotate(180.000000, 72.000000, 192.000000)" />
  <polygon points="80.000000,240.000000 68.000000,234.399994 68.000000,245.600006" fill="black" transform="rotate(180.000000, 72.000000, 240.000000)" />
  <polygon points="272.000000,80.000000 260.000000,74.400002 260.000000,85.599998" fill="black" transform="rotate(180.000000, 264.000000, 80.000000)" />
  <text text-anchor="middle" font-family="sans-serif" x="192" y="244">C</text>
  <text text-anchor="middle" font-family="sans-serif" x="224" y="244">l</text>
  <text text-anchor="middle" font-family="sans-serif" x="112" y="100">r</text>
  <text text-anchor="middle" font-family="sans-serif" x="288" y="148">r</text>
  <text text-anchor="middle" font-family="sans-serif" x="208" y="196">-</text>
  <text text-anchor="middle" font-family="sans-serif" x="192" y="228">c</text>
  <text text-anchor="middle" font-family="sans-serif" x="376" y="228">-</text>
  <text text-anchor="middle" font-family="sans-serif" x="392" y="228">-</text>
  <text text-anchor="middle" font-family="sans-serif" x="192" y="100">o</text>
  <text text-anchor="middle" font-family="sans-serif" x="232" y="100">-</text>
  <text text-anchor="middle" font-family="sans-serif" x="240" y="100">-</text>
  <text text-anchor="middle" font-family="sans-serif" x="248" y="196">-</text>
  <text text-anchor="middle" font-family="sans-serif" x="264" y="36">i</text>
  <text text-anchor="middle" font-family="sans-serif" x="328" y="84">k</text>
  <text text-anchor="middle" font-family="sans-serif" x="344" y="84">t</text>
  <text text-anchor="middle" font-family="sans-serif" x="224" y="100">-</text>
  <text text-anchor="middle" font-family="sans-serif" x="176" y="228">T</text>
  <text text-anchor="middle" font-family="sans-serif" x="280" y="228">x</text>
  <text text-anchor="middle" font-family="sans-serif" x="152" y="196">t</text>
  <text text-anchor="middle" font-family="sans-serif" x="48" y="20">A</text>
  <text text-anchor="middle" font-family="sans-serif" x="288" y="228">c</text>
  <text text-anchor="middle" font-family="sans-serif" x="440" y="228">&gt;</text>
  <text text-anchor="middle" font-family="sans-serif" x="304" y="244">n</text>
  <text text-anchor="middle" font-family="sans-serif" x="256" y="36">v</text>
  <text text-anchor="middle" font-family="sans-serif" x="152" y="100">c</text>
  <text text-anchor="middle" font-family="sans-serif" x="184" y="196">o</text>
  <text text-anchor="middle" font-family="sans-serif" x="224" y="228">,</text>
  <text text-anchor="middle" font-family="sans-serif" x="424" y="244">-</text>
  <text text-anchor="middle" font-family="sans-serif" x="432" y="244">-</text>
  <text text-anchor="middle" font-family="sans-serif" x="128" y="100">s</text>
  <text text-anchor="middle" font-family="sans-serif" x="216" y="148">c</text>
  <text text-anchor="middle" font-family="sans-serif" x="296" y="148">o</text>
  <text text-anchor="middle" font-family="sans-serif" x="272" y="36">c</text>
  <text text-anchor="middle" font-family="sans-serif" x="336" y="84">e</text>
  <text text-anchor="middle" font-family="sans-serif" x="224" y="196">-</text>
  <text text-anchor="middle" font-family="sans-serif" x="280" y="148">t</text>
  <text text-anchor="middle" font-family="sans-serif" x="304" y="148">l</text>
  <text text-anchor="middle" font-family="sans-serif" x="120" y="196">i</text>
  <text text-anchor="middle" font-family="sans-serif" x="424" y="228">-</text>
  <text text-anchor="middle" font-family="sans-serif" x="352" y="244">-</text>
  <text text-anchor="middle" font-family="sans-serif" x="408" y="244">-</text>
  <text text-anchor="middle" font-family="sans-serif" x="64" y="20">i</text>
  <text text-anchor="middle" font-family="sans-serif" x="416" y="84">-</text>
  <text text-anchor="middle" font-family="sans-serif" x="136" y="100">e</text>
  <text text-anchor="middle" font-family="sans-serif" x="272" y="228">E</text>
  <text text-anchor="middle" font-family="sans-serif" x="296" y="244">a</text>
  <text text-anchor="middle" font-family="sans-serif" x="312" y="244">g</text>
  <text text-anchor="middle" font-family="sans-serif" x="112" y="196">T</text>
  <text text-anchor="middle" font-family="sans-serif" x="304" y="228">a</text>
  <text text-anchor="middle" font-family="sans-serif" x="264" y="244">E</text>
  <text text-anchor="middle" font-family="sans-serif" x="288" y="244">h</text>
  <text text-anchor="middle" font-family="sans-serif" x="392" y="84">t</text>
  <text text-anchor="middle" font-family="sans-serif" x="208" y="100">)</text>
  <text text-anchor="middle" font-family="sans-serif" x="272" y="244">x</text>
  <text text-anchor="middle" font-family="sans-serif" x="408" y="84">-</text>
  <text text-anchor="middle" font-family="sans-serif" x="184" y="100">B</text>
  <text text-anchor="middle" font-family="sans-serif" x="240" y="148">s</text>
  <text text-anchor="middle" font-family="sans-serif" x="136" y="196">k</text>
  <text text-anchor="middle" font-family="sans-serif" x="240" y="228">K</text>
  <text text-anchor="middle" font-family="sans-serif" x="320" y="228">g</text>
  <text text-anchor="middle" font-family="sans-serif" x="80" y="20">e</text>
  <text text-anchor="middle" font-family="sans-serif" x="312" y="84">i</text>
  <text text-anchor="middle" font-family="sans-serif" x="336" y="228">-</text>
  <text text-anchor="middle" font-family="sans-serif" x="368" y="228">-</text>
  <text text-anchor="middle" font-family="sans-serif" x="336" y="244">-</text>
  <text text-anchor="middle" font-family="sans-serif" x="344" y="244">-</text>
  <text text-anchor="middle" font-family="sans-serif" x="96" y="100">-</text>
  <text text-anchor="middle" font-family="sans-serif" x="104" y="100">P</text>
  <text text-anchor="middle" font-family="sans-serif" x="160" y="196">,</text>
  <text text-anchor="middle" font-family="sans-serif" x="184" y="228">i</text>
  <text text-anchor="middle" font-family="sans-serif" x="216" y="228">t</text>
  <text text-anchor="middle" font-family="sans-serif" x="312" y="228">n</text>
  <text text-anchor="middle" font-family="sans-serif" x="248" y="20">e</text>
  <text text-anchor="middle" font-family="sans-serif" x="320" y="84">c</text>
  <text text-anchor="middle" font-family="sans-serif" x="352" y="84">,</text>
  <text text-anchor="middle" font-family="sans-serif" x="224" y="148">e</text>
  <text text-anchor="middle" font-family="sans-serif" x="296" y="228">h</text>
  <text text-anchor="middle" font-family="sans-serif" x="328" y="244">-</text>
  <text text-anchor="middle" font-family="sans-serif" x="384" y="84">r</text>
  <text text-anchor="middle" font-family="sans-serif" x="248" y="100">&gt;</text>
  <text text-anchor="middle" font-family="sans-serif" x="208" y="228">e</text>
  <text text-anchor="middle" font-family="sans-serif" x="184" y="244">-</text>
  <text text-anchor="middle" font-family="sans-serif" x="56" y="20">l</text>
  <text text-anchor="middle" font-family="sans-serif" x="168" y="228">-</text>
  <text text-anchor="middle" font-family="sans-serif" x="384" y="228">-</text>
  <text text-anchor="middle" font-family="sans-serif" x="416" y="228">-</text>
  <text text-anchor="middle" font-family="sans-serif" x="280" y="20">c</text>
  <text text-anchor="middle" font-family="sans-serif" x="424" y="84">-</text>
  <text text-anchor="middle" font-family="sans-serif" x="440" y="84">-</text>
  <text text-anchor="middle" font-family="sans-serif" x="200" y="148">A</text>
  <text text-anchor="middle" font-family="sans-serif" x="232" y="148">s</text>
  <text text-anchor="middle" font-family="sans-serif" x="216" y="196">-</text>
  <text text-anchor="middle" font-family="sans-serif" x="432" y="228">-</text>
  <text text-anchor="middle" font-family="sans-serif" x="208" y="244">m</text>
  <text text-anchor="middle" font-family="sans-serif" x="440" y="20">B</text>
  <text text-anchor="middle" font-family="sans-serif" x="376" y="84">o</text>
  <text text-anchor="middle" font-family="sans-serif" x="208" y="148">c</text>
  <text text-anchor="middle" font-family="sans-serif" x="200" y="228">k</text>
  <text text-anchor="middle" font-family="sans-serif" x="320" y="244">e</text>
  <text text-anchor="middle" font-family="sans-serif" x="128" y="196">c</text>
  <text text-anchor="middle" font-family="sans-serif" x="176" y="196">P</text>
  <text text-anchor="middle" font-family="sans-serif" x="232" y="20">P</text>
  <text text-anchor="middle" font-family="sans-serif" x="448" y="20">o</text>
  <text text-anchor="middle" font-family="sans-serif" x="296" y="84">-</text>
  <text text-anchor="middle" font-family="sans-serif" x="304" y="84">T</text>
  <text text-anchor="middle" font-family="sans-serif" x="432" y="84">-</text>
  <text text-anchor="middle" font-family="sans-serif" x="120" y="100">e</text>
  <text text-anchor="middle" font-family="sans-serif" x="240" y="196">-</text>
  <text text-anchor="middle" font-family="sans-serif" x="352" y="228">-</text>
  <text text-anchor="middle" font-family="sans-serif" x="392" y="244">-</text>
  <text text-anchor="middle" font-family="sans-serif" x="376" y="244">-</text>
  <text text-anchor="middle" font-family="sans-serif" x="416" y="244">-</text>
  <text text-anchor="middle" font-family="sans-serif" x="232" y="36">S</text>
  <text text-anchor="middle" font-family="sans-serif" x="368" y="84">P</text>
  <text text-anchor="middle" font-family="sans-serif" x="400" y="84">-</text>
  <text text-anchor="middle" font-family="sans-serif" x="200" y="244">o</text>
  <text text-anchor="middle" font-family="sans-serif" x="280" y="244">c</text>
  <text text-anchor="middle" font-family="sans-serif" x="400" y="244">-</text>
  <text text-anchor="middle" font-family="sans-serif" x="240" y="20">r</text>
  <text text-anchor="middle" font-family="sans-serif" x="104" y="196">-</text>
  <text text-anchor="middle" font-family="sans-serif" x="408" y="228">-</text>
  <text text-anchor="middle" font-family="sans-serif" x="176" y="100">(</text>
  <text text-anchor="middle" font-family="sans-serif" x="200" y="100">b</text>
  <text text-anchor="middle" font-family="sans-serif" x="256" y="148">C</text>
  <text text-anchor="middle" font-family="sans-serif" x="248" y="228">e</text>
  <text text-anchor="middle" font-family="sans-serif" x="232" y="244">e</text>
  <text text-anchor="middle" font-family="sans-serif" x="368" y="244">-</text>
  <text text-anchor="middle" font-family="sans-serif" x="272" y="20">n</text>
  <text text-anchor="middle" font-family="sans-serif" x="456" y="20">b</text>
  <text text-anchor="middle" font-family="sans-serif" x="240" y="36">e</text>
  <text text-anchor="middle" font-family="sans-serif" x="144" y="196">e</text>
  <text text-anchor="middle" font-family="sans-serif" x="328" y="228">e</text>
  <text text-anchor="middle" font-family="sans-serif" x="400" y="228">-</text>
  <text text-anchor="middle" font-family="sans-serif" x="256" y="20">s</text>
  <text text-anchor="middle" font-family="sans-serif" x="192" y="196">r</text>
  <text text-anchor="middle" font-family="sans-serif" x="200" y="196">t</text>
  <text text-anchor="middle" font-family="sans-serif" x="440" y="244">-</text>
  <text text-anchor="middle" font-family="sans-serif" x="384" y="244">-</text>
  <text text-anchor="middle" font-family="sans-serif" x="72" y="20">c</text>
  <text text-anchor="middle" font-family="sans-serif" x="264" y="20">e</text>
  <text text-anchor="middle" font-family="sans-serif" x="144" y="100">n</text>
  <text text-anchor="middle" font-family="sans-serif" x="264" y="148">o</text>
  <text text-anchor="middle" font-family="sans-serif" x="344" y="228">-</text>
  <text text-anchor="middle" font-family="sans-serif" x="248" y="244">e</text>
  <text text-anchor="middle" font-family="sans-serif" x="360" y="228">-</text>
  <text text-anchor="middle" font-family="sans-serif" x="216" y="244">p</text>
  <text text-anchor="middle" font-family="sans-serif" x="288" y="20">e</text>
  <text text-anchor="middle" font-family="sans-serif" x="248" y="36">r</text>
  <text text-anchor="middle" font-family="sans-serif" x="160" y="100">e</text>
  <text text-anchor="middle" font-family="sans-serif" x="216" y="100">-</text>
  <text text-anchor="middle" font-family="sans-serif" x="232" y="196">-</text>
  <text text-anchor="middle" font-family="sans-serif" x="256" y="228">y</text>
  <text text-anchor="middle" font-family="sans-serif" x="240" y="244">t</text>
  <text text-anchor="middle" font-family="sans-serif" x="360" y="244">-</text>
  <text text-anchor="middle" font-family="sans-serif" x="280" y="36">e</text>
  <text text-anchor="middle" font-family="sans-serif" x="272" y="148">n</text>
</g></svg>
                        <figcaption>
                          <a href="n-alice-contacts-bob-through-a-presence-service">Figure 5</a>
:                          <a href="null" id="null" class="selfRef">Alice contacts Bob through a presence service.</a>
                        </figcaption>
                      </div>
                      <p id="s-1_2_3-5">Contrawise, when Suzy spammer attempts to contact Bob to tell him the warranty on his rocket ship is about to expire, the presence service notes that Suzy spammer is not in Bob's contact list and refuses to allow the interruption. Bob's access control policy may allow Suzy spammer to make a contact exchange request, but it is rather likely that her reputation for wasting people's time will result in that request being rejected.<a class="pilcrow" href="#s-1_2_3-5">&para;</a></p>
                    </figure>
                    
                    <section id="n-nat-transit">
                      <h5 id="s-1_2_4">
                        <a class="selfRef" href="#s-1_2_4">1.2.4.</a>
                        <a class="selfRef" href="#n-nat-transit">NAT Transit</a>
                      </h5>
                      <p id="s-1_2_4-1">The deployment of Network Address Translation (NAT) devices in the network represents a real world constraint that every modern network application has to work around if it is to be successful. NAT devices may be broadly regarded as belonging to two distinct categories.<a class="pilcrow" href="#s-1_2_4-1">&para;</a></p>
                      <dl id="s-1_2_4-2-" class="nohang">
                        <dt id="s-1_2_4-2">Wide Cone NAT<a class="pilcrow" href="#s-1_2_4-2">&para;</a></dt>
                        <dd id="null">When a device inside the network attempts to establish a UDP connection to a remote device, the NAT selects an outbound UDP source port for forwarding. All inbound UDP packets specifying that port are forwarded to that device regardless of the source address.<a class="pilcrow" href="#">&para;</a></dd>
                        <dt id="s-1_2_4-3">Narrow Cone NAT + Firewall NAT<a class="pilcrow" href="#s-1_2_4-3">&para;</a></dt>
                        <dd id="null">All NAT devices that present a more restrictive policy. These include enterprise firewalls that require devices inside the network to explicitly request forwarding from external UDP ports (pinhole routing). <a class="pilcrow" href="#">&para;</a></dd>
                      </dl>
                      <p id="s-1_2_4-4">Since the protocols used to support NAT devices other than Wide Cone are typically proprietary, these are outside the scope of this specification.<a class="pilcrow" href="#s-1_2_4-4">&para;</a></p>
                      <p id="s-1_2_4-5">One of the many inconveniences of being required to support NAT is that the external port binding may change without notice. In some cases, an external port is only kept open for as long as it is in use with timeouts of a second or less being common. <a class="pilcrow" href="#s-1_2_4-5">&para;</a></p>
                      <p id="s-1_2_4-6">Enabling NAT transit during reconfiguration represents a special case of network agility. The network endpoint can change but the stream identifiers remain constant. A change to the NAT configuration causes inbound packets to be dropped temporarily but the stream is quickly re-established when an outbound packet is sent.<a class="pilcrow" href="#s-1_2_4-6">&para;</a></p>
                      <figure id="f-6">
                        <div class="artwork art-svg" id="n-wide-cone-nat-configuration">
                          <a class="pilcrow" href="#n-wide-cone-nat-configuration">&para;</a>
<svg width="528" height="281" xmlns="http://www.w3.org/2000/svg" >
<g transform="translate(8,16)">
  <path d="M 0,0 L 128,0" fill="none" stroke="black" />
  <path d="M 152,0 L 216,0" fill="none" stroke="black" />
  <path d="M 384,0 L 512,0" fill="none" stroke="black" />
  <path d="M 0,32 L 64,32" fill="none" stroke="black" />
  <path d="M 64,32 L 128,32" fill="none" stroke="black" />
  <path d="M 152,32 L 184,32" fill="none" stroke="black" />
  <path d="M 184,32 L 216,32" fill="none" stroke="black" />
  <path d="M 384,32 L 448,32" fill="none" stroke="black" />
  <path d="M 448,32 L 512,32" fill="none" stroke="black" />
  <path d="M 64,64 L 136,64" fill="none" stroke="black" />
  <path d="M 168,64 L 176,64" fill="none" stroke="black" />
  <path d="M 192,64 L 400,64" fill="none" stroke="black" />
  <path d="M 432,64 L 440,64" fill="none" stroke="black" />
  <path d="M 72,80 L 80,80" fill="none" stroke="black" />
  <path d="M 112,80 L 176,80" fill="none" stroke="black" />
  <path d="M 192,80 L 200,80" fill="none" stroke="black" />
  <path d="M 232,80 L 448,80" fill="none" stroke="black" />
  <path d="M 64,96 L 136,96" fill="none" stroke="black" />
  <path d="M 168,96 L 176,96" fill="none" stroke="black" />
  <path d="M 192,96 L 400,96" fill="none" stroke="black" />
  <path d="M 432,96 L 440,96" fill="none" stroke="black" />
  <path d="M 72,112 L 80,112" fill="none" stroke="black" />
  <path d="M 112,112 L 176,112" fill="none" stroke="black" />
  <path d="M 192,112 L 200,112" fill="none" stroke="black" />
  <path d="M 232,112 L 448,112" fill="none" stroke="black" />
  <path d="M 72,128 L 80,128" fill="none" stroke="black" />
  <path d="M 112,128 L 176,128" fill="none" stroke="black" />
  <path d="M 192,128 L 200,128" fill="none" stroke="black" />
  <path d="M 232,128 L 448,128" fill="none" stroke="black" />
  <path d="M 192,192 L 200,192" fill="none" stroke="black" />
  <path d="M 232,192 L 448,192" fill="none" stroke="black" />
  <path d="M 192,208 L 200,208" fill="none" stroke="black" />
  <path d="M 232,208 L 448,208" fill="none" stroke="black" />
  <path d="M 64,224 L 136,224" fill="none" stroke="black" />
  <path d="M 168,224 L 176,224" fill="none" stroke="black" />
  <path d="M 192,224 L 400,224" fill="none" stroke="black" />
  <path d="M 432,224 L 440,224" fill="none" stroke="black" />
  <path d="M 72,240 L 80,240" fill="none" stroke="black" />
  <path d="M 112,240 L 176,240" fill="none" stroke="black" />
  <path d="M 192,240 L 200,240" fill="none" stroke="black" />
  <path d="M 232,240 L 448,240" fill="none" stroke="black" />
  <path d="M 0,0 L 0,32" fill="none" stroke="black" />
  <path d="M 64,32 L 64,64" fill="none" stroke="black" />
  <path d="M 64,64 L 64,96" fill="none" stroke="black" />
  <path d="M 64,96 L 64,224" fill="none" stroke="black" />
  <path d="M 64,224 L 64,256" fill="none" stroke="black" />
  <path d="M 128,0 L 128,32" fill="none" stroke="black" />
  <path d="M 152,0 L 152,32" fill="none" stroke="black" />
  <path d="M 184,32 L 184,144" fill="none" stroke="black" />
  <path d="M 184,176 L 184,256" fill="none" stroke="black" />
  <path d="M 216,0 L 216,32" fill="none" stroke="black" />
  <path d="M 384,0 L 384,32" fill="none" stroke="black" />
  <path d="M 448,32 L 448,80" fill="none" stroke="black" />
  <path d="M 448,80 L 448,112" fill="none" stroke="black" />
  <path d="M 448,112 L 448,128" fill="none" stroke="black" />
  <path d="M 448,128 L 448,192" fill="none" stroke="black" />
  <path d="M 448,192 L 448,208" fill="none" stroke="black" />
  <path d="M 448,208 L 448,240" fill="none" stroke="black" />
  <path d="M 448,240 L 448,256" fill="none" stroke="black" />
  <path d="M 512,0 L 512,32" fill="none" stroke="black" />
  <polygon points="80.000000,80.000000 68.000000,74.400002 68.000000,85.599998" fill="black" transform="rotate(180.000000, 72.000000, 80.000000)" />
  <polygon points="80.000000,112.000000 68.000000,106.400002 68.000000,117.599998" fill="black" transform="rotate(180.000000, 72.000000, 112.000000)" />
  <polygon points="80.000000,128.000000 68.000000,122.400002 68.000000,133.600006" fill="black" transform="rotate(180.000000, 72.000000, 128.000000)" />
  <polygon points="80.000000,240.000000 68.000000,234.399994 68.000000,245.600006" fill="black" transform="rotate(180.000000, 72.000000, 240.000000)" />
  <polygon points="184.000000,64.000000 172.000000,58.400002 172.000000,69.599998" fill="black" transform="rotate(0.000000, 176.000000, 64.000000)" />
  <polygon points="184.000000,96.000000 172.000000,90.400002 172.000000,101.599998" fill="black" transform="rotate(0.000000, 176.000000, 96.000000)" />
  <polygon points="184.000000,224.000000 172.000000,218.399994 172.000000,229.600006" fill="black" transform="rotate(0.000000, 176.000000, 224.000000)" />
  <polygon points="200.000000,80.000000 188.000000,74.400002 188.000000,85.599998" fill="black" transform="rotate(180.000000, 192.000000, 80.000000)" />
  <polygon points="200.000000,112.000000 188.000000,106.400002 188.000000,117.599998" fill="black" transform="rotate(180.000000, 192.000000, 112.000000)" />
  <polygon points="200.000000,128.000000 188.000000,122.400002 188.000000,133.600006" fill="black" transform="rotate(180.000000, 192.000000, 128.000000)" />
  <polygon points="200.000000,192.000000 188.000000,186.399994 188.000000,197.600006" fill="black" transform="rotate(180.000000, 192.000000, 192.000000)" />
  <polygon points="200.000000,208.000000 188.000000,202.399994 188.000000,213.600006" fill="black" transform="rotate(180.000000, 192.000000, 208.000000)" />
  <polygon points="200.000000,240.000000 188.000000,234.399994 188.000000,245.600006" fill="black" transform="rotate(180.000000, 192.000000, 240.000000)" />
  <polygon points="448.000000,64.000000 436.000000,58.400002 436.000000,69.599998" fill="black" transform="rotate(0.000000, 440.000000, 64.000000)" />
  <polygon points="448.000000,96.000000 436.000000,90.400002 436.000000,101.599998" fill="black" transform="rotate(0.000000, 440.000000, 96.000000)" />
  <polygon points="448.000000,224.000000 436.000000,218.399994 436.000000,229.600006" fill="black" transform="rotate(0.000000, 440.000000, 224.000000)" />
  <text text-anchor="middle" font-family="sans-serif" x="152" y="100">4</text>
  <text text-anchor="middle" font-family="sans-serif" x="416" y="228">4</text>
  <text text-anchor="middle" font-family="sans-serif" x="64" y="20">v</text>
  <text text-anchor="middle" font-family="sans-serif" x="80" y="20">c</text>
  <text text-anchor="middle" font-family="sans-serif" x="424" y="20">S</text>
  <text text-anchor="middle" font-family="sans-serif" x="152" y="68">4</text>
  <text text-anchor="middle" font-family="sans-serif" x="416" y="68">4</text>
  <text text-anchor="middle" font-family="sans-serif" x="176" y="20">N</text>
  <text text-anchor="middle" font-family="sans-serif" x="448" y="20">v</text>
  <text text-anchor="middle" font-family="sans-serif" x="472" y="20">e</text>
  <text text-anchor="middle" font-family="sans-serif" x="96" y="132">9</text>
  <text text-anchor="middle" font-family="sans-serif" x="216" y="164">g</text>
  <text text-anchor="middle" font-family="sans-serif" x="72" y="20">i</text>
  <text text-anchor="middle" font-family="sans-serif" x="184" y="20">A</text>
  <text text-anchor="middle" font-family="sans-serif" x="456" y="20">i</text>
  <text text-anchor="middle" font-family="sans-serif" x="96" y="84">9</text>
  <text text-anchor="middle" font-family="sans-serif" x="216" y="116">9</text>
  <text text-anchor="middle" font-family="sans-serif" x="96" y="116">9</text>
  <text text-anchor="middle" font-family="sans-serif" x="208" y="164">n</text>
  <text text-anchor="middle" font-family="sans-serif" x="224" y="164">e</text>
  <text text-anchor="middle" font-family="sans-serif" x="216" y="196">9</text>
  <text text-anchor="middle" font-family="sans-serif" x="88" y="20">e</text>
  <text text-anchor="middle" font-family="sans-serif" x="192" y="20">T</text>
  <text text-anchor="middle" font-family="sans-serif" x="152" y="164">N</text>
  <text text-anchor="middle" font-family="sans-serif" x="168" y="164">T</text>
  <text text-anchor="middle" font-family="sans-serif" x="192" y="164">h</text>
  <text text-anchor="middle" font-family="sans-serif" x="56" y="20">e</text>
  <text text-anchor="middle" font-family="sans-serif" x="464" y="20">c</text>
  <text text-anchor="middle" font-family="sans-serif" x="216" y="84">9</text>
  <text text-anchor="middle" font-family="sans-serif" x="216" y="132">9</text>
  <text text-anchor="middle" font-family="sans-serif" x="160" y="164">A</text>
  <text text-anchor="middle" font-family="sans-serif" x="152" y="228">4</text>
  <text text-anchor="middle" font-family="sans-serif" x="216" y="244">9</text>
  <text text-anchor="middle" font-family="sans-serif" x="432" y="20">e</text>
  <text text-anchor="middle" font-family="sans-serif" x="440" y="20">r</text>
  <text text-anchor="middle" font-family="sans-serif" x="416" y="100">4</text>
  <text text-anchor="middle" font-family="sans-serif" x="200" y="164">a</text>
  <text text-anchor="middle" font-family="sans-serif" x="216" y="212">9</text>
  <text text-anchor="middle" font-family="sans-serif" x="48" y="20">D</text>
  <text text-anchor="middle" font-family="sans-serif" x="184" y="164">C</text>
  <text text-anchor="middle" font-family="sans-serif" x="96" y="244">9</text>
</g></svg>
                          <figcaption>
                            <a href="n-wide-cone-nat-configuration">Figure 6</a>
:                            <a href="null" id="null" class="selfRef">Wide cone NAT configuration.</a>
                          </figcaption>
                        </div>
                        <p id="s-1_2_4-8">The interaction of NAT transit with presence service presents a particular concern when interactions between the parties are infrequent. <a class="pilcrow" href="#s-1_2_4-8">&para;</a></p>
                        <p id="s-1_2_4-9">For example, consider the case in which a digital camera is connected to a photo archive on a remote host that is behind a NAT device. This would commonly occur in situations in which Alice wants photographs to be automatically uploaded to the file storage in her house as soon as they are captured.<a class="pilcrow" href="#s-1_2_4-9">&para;</a></p>
                        <p id="s-1_2_4-10">Rather than requiring the Archive device to maintain a constant RDP stream to every device that might possibly require access, the Archive device maintains a constant stream to the presence service which can then provide devices it has helped establish a connection with the necessary information to resume the stream:<a class="pilcrow" href="#s-1_2_4-10">&para;</a></p>
                        <figure id="f-7">
                          <div class="artwork art-svg" id="n-brokered-nat-transit">
                            <a class="pilcrow" href="#n-brokered-nat-transit">&para;</a>
<svg width="536" height="265" xmlns="http://www.w3.org/2000/svg" >
<g transform="translate(8,16)">
  <path d="M 0,0 L 128,0" fill="none" stroke="black" />
  <path d="M 192,0 L 320,0" fill="none" stroke="black" />
  <path d="M 384,0 L 512,0" fill="none" stroke="black" />
  <path d="M 0,48 L 64,48" fill="none" stroke="black" />
  <path d="M 64,48 L 128,48" fill="none" stroke="black" />
  <path d="M 192,48 L 256,48" fill="none" stroke="black" />
  <path d="M 256,48 L 320,48" fill="none" stroke="black" />
  <path d="M 384,48 L 448,48" fill="none" stroke="black" />
  <path d="M 448,48 L 512,48" fill="none" stroke="black" />
  <path d="M 264,80 L 320,80" fill="none" stroke="black" />
  <path d="M 376,80 L 448,80" fill="none" stroke="black" />
  <path d="M 72,112 L 88,112" fill="none" stroke="black" />
  <path d="M 240,112 L 248,112" fill="none" stroke="black" />
  <path d="M 72,128 L 168,128" fill="none" stroke="black" />
  <path d="M 328,128 L 440,128" fill="none" stroke="black" />
  <path d="M 264,192 L 320,192" fill="none" stroke="black" />
  <path d="M 376,192 L 448,192" fill="none" stroke="black" />
  <path d="M 72,208 L 128,208" fill="none" stroke="black" />
  <path d="M 184,208 L 256,208" fill="none" stroke="black" />
  <path d="M 72,224 L 168,224" fill="none" stroke="black" />
  <path d="M 328,224 L 440,224" fill="none" stroke="black" />
  <path d="M 0,0 L 0,48" fill="none" stroke="black" />
  <path d="M 64,48 L 64,240" fill="none" stroke="black" />
  <path d="M 128,0 L 128,48" fill="none" stroke="black" />
  <path d="M 192,0 L 192,48" fill="none" stroke="black" />
  <path d="M 256,48 L 256,112" fill="none" stroke="black" />
  <path d="M 256,144 L 256,208" fill="none" stroke="black" />
  <path d="M 256,232 L 256,248" fill="none" stroke="black" />
  <path d="M 320,0 L 320,48" fill="none" stroke="black" />
  <path d="M 384,0 L 384,48" fill="none" stroke="black" />
  <path d="M 448,48 L 448,80" fill="none" stroke="black" />
  <path d="M 448,80 L 448,144" fill="none" stroke="black" />
  <path d="M 448,176 L 448,192" fill="none" stroke="black" />
  <path d="M 448,192 L 448,240" fill="none" stroke="black" />
  <path d="M 512,0 L 512,48" fill="none" stroke="black" />
  <polygon points="80.000000,112.000000 68.000000,106.400002 68.000000,117.599998" fill="black" transform="rotate(180.000000, 72.000000, 112.000000)" />
  <polygon points="80.000000,128.000000 68.000000,122.400002 68.000000,133.600006" fill="black" transform="rotate(180.000000, 72.000000, 128.000000)" />
  <polygon points="80.000000,208.000000 68.000000,202.399994 68.000000,213.600006" fill="black" transform="rotate(180.000000, 72.000000, 208.000000)" />
  <polygon points="80.000000,224.000000 68.000000,218.399994 68.000000,229.600006" fill="black" transform="rotate(180.000000, 72.000000, 224.000000)" />
  <polygon points="256.000000,112.000000 244.000000,106.400002 244.000000,117.599998" fill="black" transform="rotate(0.000000, 248.000000, 112.000000)" />
  <polygon points="272.000000,80.000000 260.000000,74.400002 260.000000,85.599998" fill="black" transform="rotate(180.000000, 264.000000, 80.000000)" />
  <polygon points="272.000000,192.000000 260.000000,186.399994 260.000000,197.600006" fill="black" transform="rotate(180.000000, 264.000000, 192.000000)" />
  <polygon points="448.000000,128.000000 436.000000,122.400002 436.000000,133.600006" fill="black" transform="rotate(0.000000, 440.000000, 128.000000)" />
  <polygon points="448.000000,224.000000 436.000000,218.399994 436.000000,229.600006" fill="black" transform="rotate(0.000000, 440.000000, 224.000000)" />
  <text text-anchor="middle" font-family="sans-serif" x="280" y="132">c</text>
  <text text-anchor="middle" font-family="sans-serif" x="288" y="132">t</text>
  <text text-anchor="middle" font-family="sans-serif" x="288" y="228">t</text>
  <text text-anchor="middle" font-family="sans-serif" x="248" y="20">e</text>
  <text text-anchor="middle" font-family="sans-serif" x="352" y="84">r</text>
  <text text-anchor="middle" font-family="sans-serif" x="216" y="116">c</text>
  <text text-anchor="middle" font-family="sans-serif" x="240" y="20">r</text>
  <text text-anchor="middle" font-family="sans-serif" x="168" y="212">t</text>
  <text text-anchor="middle" font-family="sans-serif" x="240" y="228">C</text>
  <text text-anchor="middle" font-family="sans-serif" x="416" y="164">A</text>
  <text text-anchor="middle" font-family="sans-serif" x="440" y="164">C</text>
  <text text-anchor="middle" font-family="sans-serif" x="200" y="228">r</text>
  <text text-anchor="middle" font-family="sans-serif" x="224" y="228">t</text>
  <text text-anchor="middle" font-family="sans-serif" x="280" y="36">e</text>
  <text text-anchor="middle" font-family="sans-serif" x="128" y="116">u</text>
  <text text-anchor="middle" font-family="sans-serif" x="208" y="132">e</text>
  <text text-anchor="middle" font-family="sans-serif" x="352" y="196">r</text>
  <text text-anchor="middle" font-family="sans-serif" x="192" y="132">i</text>
  <text text-anchor="middle" font-family="sans-serif" x="256" y="132">n</text>
  <text text-anchor="middle" font-family="sans-serif" x="408" y="164">N</text>
  <text text-anchor="middle" font-family="sans-serif" x="168" y="116">P</text>
  <text text-anchor="middle" font-family="sans-serif" x="256" y="20">s</text>
  <text text-anchor="middle" font-family="sans-serif" x="448" y="20">h</text>
  <text text-anchor="middle" font-family="sans-serif" x="344" y="84">o</text>
  <text text-anchor="middle" font-family="sans-serif" x="240" y="36">e</text>
  <text text-anchor="middle" font-family="sans-serif" x="296" y="132">i</text>
  <text text-anchor="middle" font-family="sans-serif" x="304" y="132">o</text>
  <text text-anchor="middle" font-family="sans-serif" x="448" y="164">h</text>
  <text text-anchor="middle" font-family="sans-serif" x="160" y="212">r</text>
  <text text-anchor="middle" font-family="sans-serif" x="64" y="20">e</text>
  <text text-anchor="middle" font-family="sans-serif" x="72" y="20">r</text>
  <text text-anchor="middle" font-family="sans-serif" x="232" y="36">S</text>
  <text text-anchor="middle" font-family="sans-serif" x="312" y="132">n</text>
  <text text-anchor="middle" font-family="sans-serif" x="424" y="164">T</text>
  <text text-anchor="middle" font-family="sans-serif" x="360" y="196">t</text>
  <text text-anchor="middle" font-family="sans-serif" x="336" y="84">P</text>
  <text text-anchor="middle" font-family="sans-serif" x="152" y="116">t</text>
  <text text-anchor="middle" font-family="sans-serif" x="224" y="116">e</text>
  <text text-anchor="middle" font-family="sans-serif" x="144" y="212">P</text>
  <text text-anchor="middle" font-family="sans-serif" x="192" y="228">i</text>
  <text text-anchor="middle" font-family="sans-serif" x="56" y="20">m</text>
  <text text-anchor="middle" font-family="sans-serif" x="272" y="132">e</text>
  <text text-anchor="middle" font-family="sans-serif" x="344" y="196">o</text>
  <text text-anchor="middle" font-family="sans-serif" x="216" y="228">c</text>
  <text text-anchor="middle" font-family="sans-serif" x="288" y="20">e</text>
  <text text-anchor="middle" font-family="sans-serif" x="112" y="116">e</text>
  <text text-anchor="middle" font-family="sans-serif" x="224" y="132">t</text>
  <text text-anchor="middle" font-family="sans-serif" x="472" y="164">g</text>
  <text text-anchor="middle" font-family="sans-serif" x="264" y="20">e</text>
  <text text-anchor="middle" font-family="sans-serif" x="120" y="116">q</text>
  <text text-anchor="middle" font-family="sans-serif" x="240" y="132">C</text>
  <text text-anchor="middle" font-family="sans-serif" x="472" y="20">e</text>
  <text text-anchor="middle" font-family="sans-serif" x="264" y="36">i</text>
  <text text-anchor="middle" font-family="sans-serif" x="152" y="212">o</text>
  <text text-anchor="middle" font-family="sans-serif" x="256" y="228">n</text>
  <text text-anchor="middle" font-family="sans-serif" x="272" y="20">n</text>
  <text text-anchor="middle" font-family="sans-serif" x="280" y="20">c</text>
  <text text-anchor="middle" font-family="sans-serif" x="424" y="20">A</text>
  <text text-anchor="middle" font-family="sans-serif" x="440" y="20">c</text>
  <text text-anchor="middle" font-family="sans-serif" x="248" y="36">r</text>
  <text text-anchor="middle" font-family="sans-serif" x="200" y="132">r</text>
  <text text-anchor="middle" font-family="sans-serif" x="216" y="132">c</text>
  <text text-anchor="middle" font-family="sans-serif" x="264" y="132">n</text>
  <text text-anchor="middle" font-family="sans-serif" x="40" y="20">C</text>
  <text text-anchor="middle" font-family="sans-serif" x="232" y="20">P</text>
  <text text-anchor="middle" font-family="sans-serif" x="432" y="20">r</text>
  <text text-anchor="middle" font-family="sans-serif" x="312" y="228">n</text>
  <text text-anchor="middle" font-family="sans-serif" x="264" y="228">n</text>
  <text text-anchor="middle" font-family="sans-serif" x="272" y="228">e</text>
  <text text-anchor="middle" font-family="sans-serif" x="280" y="228">c</text>
  <text text-anchor="middle" font-family="sans-serif" x="304" y="228">o</text>
  <text text-anchor="middle" font-family="sans-serif" x="48" y="20">a</text>
  <text text-anchor="middle" font-family="sans-serif" x="464" y="20">v</text>
  <text text-anchor="middle" font-family="sans-serif" x="336" y="196">P</text>
  <text text-anchor="middle" font-family="sans-serif" x="480" y="164">e</text>
  <text text-anchor="middle" font-family="sans-serif" x="208" y="228">e</text>
  <text text-anchor="middle" font-family="sans-serif" x="360" y="84">t</text>
  <text text-anchor="middle" font-family="sans-serif" x="200" y="116">e</text>
  <text text-anchor="middle" font-family="sans-serif" x="456" y="164">a</text>
  <text text-anchor="middle" font-family="sans-serif" x="176" y="116">r</text>
  <text text-anchor="middle" font-family="sans-serif" x="192" y="116">s</text>
  <text text-anchor="middle" font-family="sans-serif" x="208" y="116">n</text>
  <text text-anchor="middle" font-family="sans-serif" x="184" y="132">D</text>
  <text text-anchor="middle" font-family="sans-serif" x="464" y="164">n</text>
  <text text-anchor="middle" font-family="sans-serif" x="80" y="20">a</text>
  <text text-anchor="middle" font-family="sans-serif" x="456" y="20">i</text>
  <text text-anchor="middle" font-family="sans-serif" x="104" y="116">R</text>
  <text text-anchor="middle" font-family="sans-serif" x="184" y="228">D</text>
  <text text-anchor="middle" font-family="sans-serif" x="248" y="228">o</text>
  <text text-anchor="middle" font-family="sans-serif" x="296" y="228">i</text>
  <text text-anchor="middle" font-family="sans-serif" x="144" y="116">s</text>
  <text text-anchor="middle" font-family="sans-serif" x="184" y="116">e</text>
  <text text-anchor="middle" font-family="sans-serif" x="248" y="132">o</text>
  <text text-anchor="middle" font-family="sans-serif" x="256" y="36">v</text>
  <text text-anchor="middle" font-family="sans-serif" x="272" y="36">c</text>
  <text text-anchor="middle" font-family="sans-serif" x="136" y="116">e</text>
</g></svg>
                            <figcaption>
                              <a href="n-brokered-nat-transit">Figure 7</a>
:                              <a href="null" id="null" class="selfRef">Brokered NAT transit.</a>
                            </figcaption>
                          </div>
                          <p id="s-1_2_4-12">Another important concern is the interaction between network agility and NAT transit. Mobile devices frequently operate inside and outside a NAT gated network. Care is required to ensure that a device that establishes a direct connection to another device within the same NAT gated local area network can maintain that connection when it moves to a different network.<a class="pilcrow" href="#s-1_2_4-12">&para;</a></p>
                        </figure>
                        
                        <section id="n-ipv6-agility">
                          <h5 id="s-1_2_5">
                            <a class="selfRef" href="#s-1_2_5">1.2.5.</a>
                            <a class="selfRef" href="#n-ipv6-agility">IPv6 Agility</a>
                          </h5>
                          <p id="s-1_2_5-1">RDP makes no distinction between IPv4 and IPv6 transport. In normal circumstances, an application program does not need to be aware of either the initiator or receiver's address(es).<a class="pilcrow" href="#s-1_2_5-1">&para;</a></p>
                          <p id="s-1_2_5-2">RDP connections <span class="bcp14">MAY</span> be established against either or both simultaneously. RDP is equally tolerant of 4-to-6 and 6-to-4 transmission gateways. <a class="pilcrow" href="#s-1_2_5-2">&para;</a></p>
                          <p id="s-1_2_5-3">In the interest of reducing the impact of IPv4 address exhaustion, public facing RDP services <span class="bcp14">SHOULD</span> provide discovery and service to initiators that only have connection to an IPv6 network.<a class="pilcrow" href="#s-1_2_5-3">&para;</a></p>
                        </section>
                        
                        <section id="n-tunneling">
                          <h5 id="s-1_2_6">
                            <a class="selfRef" href="#s-1_2_6">1.2.6.</a>
                            <a class="selfRef" href="#n-tunneling">Tunneling</a>
                          </h5>
                          <p id="s-1_2_6-1">Establishment of an IP tunnel connecting one device to another is required for applications such as onion routing and VPN access.<a class="pilcrow" href="#s-1_2_6-1">&para;</a></p>
                          <p id="s-1_2_6-2">While the broader requirements of these applications is outside the scope of RDP, consideration has been given for allowing this use case to be supported without causing 'packet inflation' in which every packet submitted as an input results in multiple packets being sent over the network.<a class="pilcrow" href="#s-1_2_6-2">&para;</a></p>
                          <p id="s-1_2_6-3">Provision for onion routing is likely to be of particular interest. The RDP packet format allows for every bit of the UDP payload to be either encrypted data or an opaque authentication tag.<a class="pilcrow" href="#s-1_2_6-3">&para;</a></p>
                          <p id="s-1_2_6-4">For example, an observer tapping the network at point A, point B or point C gains no information that allows them to determine that Alice is communicating with Bob. Even correlation of data from all three locations provides limited information through the timing of arrival and almost none that is likely to be of any benefit to the observer.<a class="pilcrow" href="#s-1_2_6-4">&para;</a></p>
                          <figure id="f-8">
                            <div class="artwork art-svg" id="n-rdp-tunnelling">
                              <a class="pilcrow" href="#n-rdp-tunnelling">&para;</a>
<svg width="544" height="185" xmlns="http://www.w3.org/2000/svg" >
<g transform="translate(8,16)">
  <path d="M 0,0 L 96,0" fill="none" stroke="black" />
  <path d="M 144,0 L 240,0" fill="none" stroke="black" />
  <path d="M 288,0 L 384,0" fill="none" stroke="black" />
  <path d="M 432,0 L 528,0" fill="none" stroke="black" />
  <path d="M 0,32 L 48,32" fill="none" stroke="black" />
  <path d="M 48,32 L 96,32" fill="none" stroke="black" />
  <path d="M 144,32 L 192,32" fill="none" stroke="black" />
  <path d="M 192,32 L 240,32" fill="none" stroke="black" />
  <path d="M 288,32 L 336,32" fill="none" stroke="black" />
  <path d="M 336,32 L 384,32" fill="none" stroke="black" />
  <path d="M 432,32 L 480,32" fill="none" stroke="black" />
  <path d="M 480,32 L 528,32" fill="none" stroke="black" />
  <path d="M 56,96 L 184,96" fill="none" stroke="black" />
  <path d="M 344,144 L 472,144" fill="none" stroke="black" />
  <path d="M 0,0 L 0,32" fill="none" stroke="black" />
  <path d="M 48,32 L 48,160" fill="none" stroke="black" />
  <path d="M 96,0 L 96,32" fill="none" stroke="black" />
  <path d="M 144,0 L 144,32" fill="none" stroke="black" />
  <path d="M 192,32 L 192,160" fill="none" stroke="black" />
  <path d="M 240,0 L 240,32" fill="none" stroke="black" />
  <path d="M 288,0 L 288,32" fill="none" stroke="black" />
  <path d="M 336,32 L 336,160" fill="none" stroke="black" />
  <path d="M 384,0 L 384,32" fill="none" stroke="black" />
  <path d="M 432,0 L 432,32" fill="none" stroke="black" />
  <path d="M 480,32 L 480,160" fill="none" stroke="black" />
  <path d="M 528,0 L 528,32" fill="none" stroke="black" />
  <polygon points="192.000000,96.000000 180.000000,90.400002 180.000000,101.599998" fill="black" transform="rotate(0.000000, 184.000000, 96.000000)" />
  <polygon points="480.000000,144.000000 468.000000,138.399994 468.000000,149.600006" fill="black" transform="rotate(0.000000, 472.000000, 144.000000)" />
  <text text-anchor="middle" font-family="sans-serif" x="408" y="132">C</text>
  <text text-anchor="middle" font-family="sans-serif" x="344" y="20">o</text>
  <text text-anchor="middle" font-family="sans-serif" x="472" y="20">B</text>
  <text text-anchor="middle" font-family="sans-serif" x="264" y="100">B</text>
  <text text-anchor="middle" font-family="sans-serif" x="208" y="116">=</text>
  <text text-anchor="middle" font-family="sans-serif" x="264" y="132">=</text>
  <text text-anchor="middle" font-family="sans-serif" x="224" y="132">=</text>
  <text text-anchor="middle" font-family="sans-serif" x="240" y="132">=</text>
  <text text-anchor="middle" font-family="sans-serif" x="248" y="132">=</text>
  <text text-anchor="middle" font-family="sans-serif" x="320" y="20">O</text>
  <text text-anchor="middle" font-family="sans-serif" x="216" y="116">=</text>
  <text text-anchor="middle" font-family="sans-serif" x="272" y="116">=</text>
  <text text-anchor="middle" font-family="sans-serif" x="288" y="116">=</text>
  <text text-anchor="middle" font-family="sans-serif" x="200" y="132">=</text>
  <text text-anchor="middle" font-family="sans-serif" x="208" y="164">=</text>
  <text text-anchor="middle" font-family="sans-serif" x="312" y="164">=</text>
  <text text-anchor="middle" font-family="sans-serif" x="312" y="132">=</text>
  <text text-anchor="middle" font-family="sans-serif" x="320" y="164">=</text>
  <text text-anchor="middle" font-family="sans-serif" x="216" y="164">=</text>
  <text text-anchor="middle" font-family="sans-serif" x="232" y="164">=</text>
  <text text-anchor="middle" font-family="sans-serif" x="264" y="164">=</text>
  <text text-anchor="middle" font-family="sans-serif" x="272" y="164">=</text>
  <text text-anchor="middle" font-family="sans-serif" x="304" y="164">=</text>
  <text text-anchor="middle" font-family="sans-serif" x="200" y="20">o</text>
  <text text-anchor="middle" font-family="sans-serif" x="280" y="68">=</text>
  <text text-anchor="middle" font-family="sans-serif" x="48" y="20">i</text>
  <text text-anchor="middle" font-family="sans-serif" x="352" y="20">n</text>
  <text text-anchor="middle" font-family="sans-serif" x="256" y="68">=</text>
  <text text-anchor="middle" font-family="sans-serif" x="256" y="116">=</text>
  <text text-anchor="middle" font-family="sans-serif" x="264" y="116">=</text>
  <text text-anchor="middle" font-family="sans-serif" x="208" y="132">=</text>
  <text text-anchor="middle" font-family="sans-serif" x="64" y="20">e</text>
  <text text-anchor="middle" font-family="sans-serif" x="480" y="20">o</text>
  <text text-anchor="middle" font-family="sans-serif" x="312" y="68">=</text>
  <text text-anchor="middle" font-family="sans-serif" x="320" y="68">=</text>
  <text text-anchor="middle" font-family="sans-serif" x="120" y="84">A</text>
  <text text-anchor="middle" font-family="sans-serif" x="272" y="132">=</text>
  <text text-anchor="middle" font-family="sans-serif" x="280" y="132">=</text>
  <text text-anchor="middle" font-family="sans-serif" x="200" y="68">=</text>
  <text text-anchor="middle" font-family="sans-serif" x="216" y="68">=</text>
  <text text-anchor="middle" font-family="sans-serif" x="304" y="68">=</text>
  <text text-anchor="middle" font-family="sans-serif" x="296" y="116">=</text>
  <text text-anchor="middle" font-family="sans-serif" x="312" y="116">=</text>
  <text text-anchor="middle" font-family="sans-serif" x="248" y="68">=</text>
  <text text-anchor="middle" font-family="sans-serif" x="272" y="68">=</text>
  <text text-anchor="middle" font-family="sans-serif" x="40" y="20">l</text>
  <text text-anchor="middle" font-family="sans-serif" x="184" y="20">n</text>
  <text text-anchor="middle" font-family="sans-serif" x="208" y="20">n</text>
  <text text-anchor="middle" font-family="sans-serif" x="328" y="20">n</text>
  <text text-anchor="middle" font-family="sans-serif" x="336" y="20">i</text>
  <text text-anchor="middle" font-family="sans-serif" x="304" y="116">=</text>
  <text text-anchor="middle" font-family="sans-serif" x="256" y="132">=</text>
  <text text-anchor="middle" font-family="sans-serif" x="248" y="164">=</text>
  <text text-anchor="middle" font-family="sans-serif" x="32" y="20">A</text>
  <text text-anchor="middle" font-family="sans-serif" x="208" y="68">=</text>
  <text text-anchor="middle" font-family="sans-serif" x="200" y="116">=</text>
  <text text-anchor="middle" font-family="sans-serif" x="224" y="116">=</text>
  <text text-anchor="middle" font-family="sans-serif" x="240" y="116">=</text>
  <text text-anchor="middle" font-family="sans-serif" x="288" y="132">=</text>
  <text text-anchor="middle" font-family="sans-serif" x="320" y="132">=</text>
  <text text-anchor="middle" font-family="sans-serif" x="240" y="164">=</text>
  <text text-anchor="middle" font-family="sans-serif" x="488" y="20">b</text>
  <text text-anchor="middle" font-family="sans-serif" x="264" y="68">=</text>
  <text text-anchor="middle" font-family="sans-serif" x="296" y="68">=</text>
  <text text-anchor="middle" font-family="sans-serif" x="320" y="116">=</text>
  <text text-anchor="middle" font-family="sans-serif" x="216" y="132">=</text>
  <text text-anchor="middle" font-family="sans-serif" x="232" y="116">=</text>
  <text text-anchor="middle" font-family="sans-serif" x="328" y="68">&gt;</text>
  <text text-anchor="middle" font-family="sans-serif" x="296" y="132">=</text>
  <text text-anchor="middle" font-family="sans-serif" x="200" y="164">=</text>
  <text text-anchor="middle" font-family="sans-serif" x="288" y="164">=</text>
  <text text-anchor="middle" font-family="sans-serif" x="296" y="164">=</text>
  <text text-anchor="middle" font-family="sans-serif" x="224" y="68">=</text>
  <text text-anchor="middle" font-family="sans-serif" x="232" y="68">=</text>
  <text text-anchor="middle" font-family="sans-serif" x="248" y="116">=</text>
  <text text-anchor="middle" font-family="sans-serif" x="280" y="116">=</text>
  <text text-anchor="middle" font-family="sans-serif" x="280" y="164">=</text>
  <text text-anchor="middle" font-family="sans-serif" x="56" y="20">c</text>
  <text text-anchor="middle" font-family="sans-serif" x="192" y="20">i</text>
  <text text-anchor="middle" font-family="sans-serif" x="240" y="68">=</text>
  <text text-anchor="middle" font-family="sans-serif" x="288" y="68">=</text>
  <text text-anchor="middle" font-family="sans-serif" x="256" y="164">=</text>
  <text text-anchor="middle" font-family="sans-serif" x="224" y="164">=</text>
  <text text-anchor="middle" font-family="sans-serif" x="328" y="164">&gt;</text>
  <text text-anchor="middle" font-family="sans-serif" x="176" y="20">O</text>
  <text text-anchor="middle" font-family="sans-serif" x="328" y="116">&gt;</text>
  <text text-anchor="middle" font-family="sans-serif" x="232" y="132">=</text>
  <text text-anchor="middle" font-family="sans-serif" x="304" y="132">=</text>
  <text text-anchor="middle" font-family="sans-serif" x="328" y="132">&gt;</text>
</g></svg>
                              <figcaption>
                                <a href="n-rdp-tunnelling">Figure 8</a>
:                                <a href="null" id="null" class="selfRef">RDP Tunnelling.</a>
                              </figcaption>
                            </div>
                          </figure>
                          
                          <section id="n-definitions">
                            <h3 id="s-2">
                              <a class="selfRef" href="#s-2">2.</a>
                              <a class="selfRef" href="#n-definitions">Definitions</a>
                            </h3>
                            <p id="s-2-1">This section presents the related specifications and standard, the terms that are used as terms of art within the documents and the terms used as requirements language.<a class="pilcrow" href="#s-2-1">&para;</a></p>
                          </section>
                          
                          <section id="n-requirements-language">
                            <h4 id="s-2_1">
                              <a class="selfRef" href="#s-2_1">2.1.</a>
                              <a class="selfRef" href="#n-requirements-language">Requirements Language</a>
                            </h4>
                            <p id="s-2_1-1">The key words "<span class="bcp14">MUST</span>", "<span class="bcp14">MUST NOT</span>", "<span class="bcp14">REQUIRED</span>", "<span class="bcp14">SHALL</span>", "<span class="bcp14">SHALL NOT</span>", "<span class="bcp14">SHOULD</span>", "<span class="bcp14">SHOULD NOT</span>", "<span class="bcp14">RECOMMENDED</span>", "<span class="bcp14">MAY</span>", and "<span class="bcp14">OPTIONAL</span>" in this document are to be interpreted as described in <a class="xref" href="#RFC2119">[RFC2119]</a>.<a class="pilcrow" href="#s-2_1-1">&para;</a></p>
                          </section>
                          
                          <section id="n-defined-terms">
                            <h4 id="s-2_2">
                              <a class="selfRef" href="#s-2_2">2.2.</a>
                              <a class="selfRef" href="#n-defined-terms">Defined Terms</a>
                            </h4>
                          </section>
                          
                          <section id="n-related-specifications">
                            <h4 id="s-2_3">
                              <a class="selfRef" href="#s-2_3">2.3.</a>
                              <a class="selfRef" href="#n-related-specifications">Related Specifications</a>
                            </h4>
                          </section>
                          
                          <section id="n-implementation-status">
                            <h4 id="s-2_4">
                              <a class="selfRef" href="#s-2_4">2.4.</a>
                              <a class="selfRef" href="#n-implementation-status">Implementation Status</a>
                            </h4>
                            <p id="s-2_4-1">The implementation status of the reference code base is described in the companion document <a class="xref" href="#draft-hallambaker-mesh-developer">[draft-hallambaker-mesh-developer]</a>.<a class="pilcrow" href="#s-2_4-1">&para;</a></p>
                          </section>
                          
                          <section id="n-architecture">
                            <h3 id="s-3">
                              <a class="selfRef" href="#s-3">3.</a>
                              <a class="selfRef" href="#n-architecture">Architecture</a>
                            </h3>
                            <p id="s-3-1">Data Encoding<a class="pilcrow" href="#s-3-1">&para;</a></p>
                            <p id="s-3-2">[This part of the specification describes the encodings to be used in the next release. The data encodings in the current reference code used to generate the examples do not match. These should be aligned with QUIC where appropriate.  ]<a class="pilcrow" href="#s-3-2">&para;</a></p>
                            <p id="s-3-3">Encoding at the packet level presents different requirements to those at higher levels. These needs are better met by the compactness afforded by a place-value approach than the JSON/JSON-B Tag-Value encoding used in the upper layers of the Mesh specifications.<a class="pilcrow" href="#s-3-3">&para;</a></p>
                            <p id="s-3-4">As at the application layer, the use of nested length encodings is avoided on account of the risk that bounds overflow vulnerabilities are introduced into applications.<a class="pilcrow" href="#s-3-4">&para;</a></p>
                            <p id="s-3-5">Integer<a class="pilcrow" href="#s-3-5">&para;</a></p>
                            <p id="s-3-6">Integer values are presented using the same variable length encoding described in section 16 <a class="xref" href="#draft-ietf-quic-transport"> </a><a class="pilcrow" href="#s-3-6">&para;</a></p>
                            <p id="s-3-7">The first two most significant bits of the first byte are reserved to encode the base 2 logarithm of the integer encoding length in bytes. The integer value is encoded on the remaining bits, in network byte order.<a class="pilcrow" href="#s-3-7">&para;</a></p>
                            <table id="s-3-8">
                              <thead>
                                <tr>
                                  <th>2 Bit</th>
                                  <th>Length</th>
                                  <th>Usable Bits</th>
                                  <th>Range</th>
                                </tr>
                              </thead>
                              <tbody>
                                <tr>
                                  <td>00</td>
                                  <td>1</td>
                                  <td>6</td>
                                  <td>0-63</td>
                                </tr>
                                <tr>
                                  <td>01</td>
                                  <td>2</td>
                                  <td>14</td>
                                  <td>0-16383</td>
                                </tr>
                                <tr>
                                  <td>10</td>
                                  <td>4</td>
                                  <td>30</td>
                                  <td>0-1073741823</td>
                                </tr>
                                <tr>
                                  <td>11</td>
                                  <td>8</td>
                                  <td>62</td>
                                  <td>0-4611686018427387903</td>
                                </tr>
                              </tbody>
                            </table>
                            <p id="s-3-9">Values do not need to be encoded on the minimum number of bytes necessary.<a class="pilcrow" href="#s-3-9">&para;</a></p>
                            <p id="s-3-10">String<a class="pilcrow" href="#s-3-10">&para;</a></p>
                            <p id="s-3-11">String values are Unicode strings encoded as a sequence of UTF-8 bytes preceded by an integer length specifier. <a class="pilcrow" href="#s-3-11">&para;</a></p>
                            <p id="s-3-12">Binary data<a class="pilcrow" href="#s-3-12">&para;</a></p>
                            <p id="s-3-13">Binary data consists of a sequence of opaque bytes encoded as the sequence of byte values preceded by  an integer length specifier.<a class="pilcrow" href="#s-3-13">&para;</a></p>
                            <p id="s-3-14">Packet Extension List<a class="pilcrow" href="#s-3-14">&para;</a></p>
                            <p id="s-3-15">Packet extensions <span class="bcp14">MAY</span> be specified in any data section of a datagram.<a class="pilcrow" href="#s-3-15">&para;</a></p>
                            <p id="s-3-16">Each extension is a tag-length-value sequence:<a class="pilcrow" href="#s-3-16">&para;</a></p>
                            <dl id="s-3-17-" class="nohang">
                              <dt id="s-3-17">Tag<a class="pilcrow" href="#s-3-17">&para;</a></dt>
                              <dd id="null">A sequence of 1 to 16 octets, the leading octets of which are in the range 0-127 and the final octet of which is in the range 128-255.<a class="pilcrow" href="#">&para;</a></dd>
                              <dt id="s-3-18">Length <a class="pilcrow" href="#s-3-18">&para;</a></dt>
                              <dd id="null">The number of octets in the Value encoded as an Integer.<a class="pilcrow" href="#">&para;</a></dd>
                              <dt id="s-3-19">Value<a class="pilcrow" href="#s-3-19">&para;</a></dt>
                              <dd id="null">An opaque sequence of the specified number of octets.<a class="pilcrow" href="#">&para;</a></dd>
                            </dl>
                            <p id="s-3-20">The tag 255 is reserved to signal the end of the packet extension list.<a class="pilcrow" href="#s-3-20">&para;</a></p>
                            <p id="s-3-21">Stream Identifier<a class="pilcrow" href="#s-3-21">&para;</a></p>
                            <p id="s-3-22">Every RDP packet begins with a <b>stream identifier</b>. Stream identifiers consist of an opaque sequence of zero to 16 bytes.<a class="pilcrow" href="#s-3-22">&para;</a></p>
                            <p id="s-3-23">Stream identifiers are used to allow their issuer to distinguish packets arriving from different streams in circumstances where the stream cannot be inferred from the port. Initiators and responders both issue stream identifiers for their own use during Connection Establishment. Additional stream identifiers <span class="bcp14">MAY</span> be issued as a means of defeating some forms of traffic analysis attack. <a class="pilcrow" href="#s-3-23">&para;</a></p>
                            <p id="s-3-24">The semantics and encoding of stream identifiers including determining the length of the stream identifier is sole concern of the issuer which <span class="bcp14">MUST</span> ensure that it can correctly interpret the stream identifiers they issue for streams received on a specified port without ambiguity.<a class="pilcrow" href="#s-3-24">&para;</a></p>
                            <p id="s-3-25">Stream identifiers are issued as binary data sequences specified in Connection Establishment packets and as Packet Extensions in Data Packets.<a class="pilcrow" href="#s-3-25">&para;</a></p>
                            <p id="s-3-26">Issuers <span class="bcp14">MUST</span> accept every stream identifier issued as a valid identifier for that stream for the lifetime of the connection in which the stream was created.<a class="pilcrow" href="#s-3-26">&para;</a></p>
                          </section>
                          
                          <section id="n-connections">
                            <h4 id="s-3_1">
                              <a class="selfRef" href="#s-3_1">3.1.</a>
                              <a class="selfRef" href="#n-connections">Connections</a>
                            </h4>
                            <p id="s-3_1-1">An RDP connection is a bidirectional relationship between two devices secured by a <i>Connection Shared Secret</i> established through a key agreement between the devices. Once established a connection <span class="bcp14">MAY</span> be persisted for as long as the devices are willing to assign memory resources at each end. Unlike TCP connections, maintaining an RDP connection does not require communication overhead (but maintaining a NAT transit capability might).<a class="pilcrow" href="#s-3_1-1">&para;</a></p>
                          </section>
                          
                          <section id="n-ports">
                            <h4 id="s-3_2">
                              <a class="selfRef" href="#s-3_2">3.2.</a>
                              <a class="selfRef" href="#n-ports">Ports</a>
                            </h4>
                            <p id="s-3_2-1">An RDP port is a synonym for network endpoint. Only ports at which traffic is received are of concern.<a class="pilcrow" href="#s-3_2-1">&para;</a></p>
                            <p id="s-3_2-2">Currently two port types are defined:<a class="pilcrow" href="#s-3_2-2">&para;</a></p>
                            <dl id="s-3_2-3-" class="nohang">
                              <dt id="s-3_2-3">HTTP Web Service Endpoint<a class="pilcrow" href="#s-3_2-3">&para;</a></dt>
                              <dd id="null">A port type that is limited to supporting transactional streams<a class="pilcrow" href="#">&para;</a></dd>
                              <dt id="s-3_2-4">UDP Network Endpoint<a class="pilcrow" href="#s-3_2-4">&para;</a></dt>
                              <dd id="null">A network endpoint that receives Internet communications directed at a particular IP Address and Port.<a class="pilcrow" href="#">&para;</a></dd>
                            </dl>
                            <p id="s-3_2-5">The collection of ports associated with a connection <span class="bcp14">MAY</span> change over time. Connections <span class="bcp14">MAY</span> make use of multiple ports simultaneously. <a class="pilcrow" href="#s-3_2-5">&para;</a></p>
                            <p id="s-3_2-6">For example, a virtual reality streaming game might establish a single connection to a game coordination host and make use of separate ports to achieve the desired latency and bandwidth characteristics.<a class="pilcrow" href="#s-3_2-6">&para;</a></p>
                          </section>
                          
                          <section id="n-stream">
                            <h4 id="s-3_3">
                              <a class="selfRef" href="#s-3_3">3.3.</a>
                              <a class="selfRef" href="#n-stream">Stream</a>
                            </h4>
                            <p id="s-3_3-1">An RDP stream is an asymmetric bidirectional channel that transmits a sequence of datagrams according to a defined characteristic. Two characteristics are currently defined:<a class="pilcrow" href="#s-3_3-1">&para;</a></p>
                            <dl id="s-3_3-2-" class="nohang">
                              <dt id="s-3_3-2">Transactional Stream<a class="pilcrow" href="#s-3_3-2">&para;</a></dt>
                              <dt id="s-3_3-3">Asynchronous Stream<a class="pilcrow" href="#s-3_3-3">&para;</a></dt>
                            </dl>
                            <p id="s-3_3-4">The stream characteristic and cryptographic parameters of a stream are immutable for the lifetime of a stream. To effect a forward secrecy exchange, a new stream is created and the existing stream closed.<a class="pilcrow" href="#s-3_3-4">&para;</a></p>
                            <p id="s-3_3-5">Each stream is separately identified by one or more Stream Identifiers at each end specified by the party that receives data at that end.<a class="pilcrow" href="#s-3_3-5">&para;</a></p>
                            <p id="s-3_3-6">Stream identifiers <span class="bcp14">MUST</span> be unique for the lifetime of a stream. Stream identifiers <span class="bcp14">MAY</span> be reused after the stream has been closed.<a class="pilcrow" href="#s-3_3-6">&para;</a></p>
                          </section>
                          
                          <section id="n-transactional-stream">
                            <h5 id="s-3_3_1">
                              <a class="selfRef" href="#s-3_3_1">3.3.1.</a>
                              <a class="selfRef" href="#n-transactional-stream">Transactional stream</a>
                            </h5>
                            <p id="s-3_3_1-1">Streams with a transactional characteristic are used to engage in a request/response communication pattern with a service specified during stream negotiation:<a class="pilcrow" href="#s-3_3_1-1">&para;</a></p>
                            <figure id="f-12">
                              <div class="artwork art-svg" id="n-transactional-stream-characteristic">
                                <a class="pilcrow" href="#n-transactional-stream-characteristic">&para;</a>
<svg width="464" height="233" xmlns="http://www.w3.org/2000/svg" >
<g transform="translate(8,16)">
  <path d="M 0,0 L 160,0" fill="none" stroke="black" />
  <path d="M 288,0 L 448,0" fill="none" stroke="black" />
  <path d="M 0,32 L 80,32" fill="none" stroke="black" />
  <path d="M 80,32 L 160,32" fill="none" stroke="black" />
  <path d="M 288,32 L 376,32" fill="none" stroke="black" />
  <path d="M 376,32 L 448,32" fill="none" stroke="black" />
  <path d="M 80,64 L 184,64" fill="none" stroke="black" />
  <path d="M 264,64 L 368,64" fill="none" stroke="black" />
  <path d="M 88,80 L 184,80" fill="none" stroke="black" />
  <path d="M 272,80 L 376,80" fill="none" stroke="black" />
  <path d="M 80,112 L 184,112" fill="none" stroke="black" />
  <path d="M 264,112 L 368,112" fill="none" stroke="black" />
  <path d="M 88,128 L 184,128" fill="none" stroke="black" />
  <path d="M 272,128 L 376,128" fill="none" stroke="black" />
  <path d="M 80,176 L 184,176" fill="none" stroke="black" />
  <path d="M 264,176 L 368,176" fill="none" stroke="black" />
  <path d="M 88,192 L 184,192" fill="none" stroke="black" />
  <path d="M 272,192 L 376,192" fill="none" stroke="black" />
  <path d="M 0,0 L 0,32" fill="none" stroke="black" />
  <path d="M 80,32 L 80,64" fill="none" stroke="black" />
  <path d="M 80,64 L 80,112" fill="none" stroke="black" />
  <path d="M 80,112 L 80,176" fill="none" stroke="black" />
  <path d="M 80,176 L 80,208" fill="none" stroke="black" />
  <path d="M 160,0 L 160,32" fill="none" stroke="black" />
  <path d="M 288,0 L 288,32" fill="none" stroke="black" />
  <path d="M 376,32 L 376,80" fill="none" stroke="black" />
  <path d="M 376,80 L 376,128" fill="none" stroke="black" />
  <path d="M 376,128 L 376,192" fill="none" stroke="black" />
  <path d="M 376,192 L 376,208" fill="none" stroke="black" />
  <path d="M 448,0 L 448,32" fill="none" stroke="black" />
  <polygon points="96.000000,80.000000 84.000000,74.400002 84.000000,85.599998" fill="black" transform="rotate(180.000000, 88.000000, 80.000000)" />
  <polygon points="96.000000,128.000000 84.000000,122.400002 84.000000,133.600006" fill="black" transform="rotate(180.000000, 88.000000, 128.000000)" />
  <polygon points="96.000000,192.000000 84.000000,186.399994 84.000000,197.600006" fill="black" transform="rotate(180.000000, 88.000000, 192.000000)" />
  <polygon points="376.000000,64.000000 364.000000,58.400002 364.000000,69.599998" fill="black" transform="rotate(0.000000, 368.000000, 64.000000)" />
  <polygon points="376.000000,112.000000 364.000000,106.400002 364.000000,117.599998" fill="black" transform="rotate(0.000000, 368.000000, 112.000000)" />
  <polygon points="376.000000,176.000000 364.000000,170.399994 364.000000,181.600006" fill="black" transform="rotate(0.000000, 368.000000, 176.000000)" />
  <text text-anchor="middle" font-family="sans-serif" x="64" y="20">C</text>
  <text text-anchor="middle" font-family="sans-serif" x="224" y="84">p</text>
  <text text-anchor="middle" font-family="sans-serif" x="200" y="116">R</text>
  <text text-anchor="middle" font-family="sans-serif" x="224" y="116">u</text>
  <text text-anchor="middle" font-family="sans-serif" x="208" y="196">e</text>
  <text text-anchor="middle" font-family="sans-serif" x="240" y="68">s</text>
  <text text-anchor="middle" font-family="sans-serif" x="240" y="180">s</text>
  <text text-anchor="middle" font-family="sans-serif" x="232" y="196">o</text>
  <text text-anchor="middle" font-family="sans-serif" x="72" y="20">l</text>
  <text text-anchor="middle" font-family="sans-serif" x="248" y="84">s</text>
  <text text-anchor="middle" font-family="sans-serif" x="208" y="116">e</text>
  <text text-anchor="middle" font-family="sans-serif" x="240" y="196">n</text>
  <text text-anchor="middle" font-family="sans-serif" x="232" y="116">e</text>
  <text text-anchor="middle" font-family="sans-serif" x="224" y="132">p</text>
  <text text-anchor="middle" font-family="sans-serif" x="80" y="20">i</text>
  <text text-anchor="middle" font-family="sans-serif" x="104" y="20">t</text>
  <text text-anchor="middle" font-family="sans-serif" x="208" y="84">e</text>
  <text text-anchor="middle" font-family="sans-serif" x="248" y="132">s</text>
  <text text-anchor="middle" font-family="sans-serif" x="224" y="180">u</text>
  <text text-anchor="middle" font-family="sans-serif" x="200" y="180">R</text>
  <text text-anchor="middle" font-family="sans-serif" x="208" y="180">e</text>
  <text text-anchor="middle" font-family="sans-serif" x="208" y="68">e</text>
  <text text-anchor="middle" font-family="sans-serif" x="256" y="84">e</text>
  <text text-anchor="middle" font-family="sans-serif" x="248" y="116">t</text>
  <text text-anchor="middle" font-family="sans-serif" x="200" y="132">R</text>
  <text text-anchor="middle" font-family="sans-serif" x="96" y="20">n</text>
  <text text-anchor="middle" font-family="sans-serif" x="216" y="180">q</text>
  <text text-anchor="middle" font-family="sans-serif" x="248" y="180">t</text>
  <text text-anchor="middle" font-family="sans-serif" x="216" y="196">s</text>
  <text text-anchor="middle" font-family="sans-serif" x="224" y="196">p</text>
  <text text-anchor="middle" font-family="sans-serif" x="88" y="20">e</text>
  <text text-anchor="middle" font-family="sans-serif" x="384" y="20">c</text>
  <text text-anchor="middle" font-family="sans-serif" x="256" y="196">e</text>
  <text text-anchor="middle" font-family="sans-serif" x="344" y="20">S</text>
  <text text-anchor="middle" font-family="sans-serif" x="208" y="132">e</text>
  <text text-anchor="middle" font-family="sans-serif" x="216" y="132">s</text>
  <text text-anchor="middle" font-family="sans-serif" x="368" y="20">v</text>
  <text text-anchor="middle" font-family="sans-serif" x="224" y="68">u</text>
  <text text-anchor="middle" font-family="sans-serif" x="240" y="116">s</text>
  <text text-anchor="middle" font-family="sans-serif" x="360" y="20">r</text>
  <text text-anchor="middle" font-family="sans-serif" x="232" y="68">e</text>
  <text text-anchor="middle" font-family="sans-serif" x="248" y="68">t</text>
  <text text-anchor="middle" font-family="sans-serif" x="216" y="84">s</text>
  <text text-anchor="middle" font-family="sans-serif" x="232" y="84">o</text>
  <text text-anchor="middle" font-family="sans-serif" x="216" y="68">q</text>
  <text text-anchor="middle" font-family="sans-serif" x="216" y="116">q</text>
  <text text-anchor="middle" font-family="sans-serif" x="200" y="68">R</text>
  <text text-anchor="middle" font-family="sans-serif" x="232" y="132">o</text>
  <text text-anchor="middle" font-family="sans-serif" x="240" y="132">n</text>
  <text text-anchor="middle" font-family="sans-serif" x="248" y="196">s</text>
  <text text-anchor="middle" font-family="sans-serif" x="376" y="20">i</text>
  <text text-anchor="middle" font-family="sans-serif" x="200" y="84">R</text>
  <text text-anchor="middle" font-family="sans-serif" x="256" y="132">e</text>
  <text text-anchor="middle" font-family="sans-serif" x="200" y="196">R</text>
  <text text-anchor="middle" font-family="sans-serif" x="352" y="20">e</text>
  <text text-anchor="middle" font-family="sans-serif" x="392" y="20">e</text>
  <text text-anchor="middle" font-family="sans-serif" x="240" y="84">n</text>
  <text text-anchor="middle" font-family="sans-serif" x="232" y="180">e</text>
</g></svg>
                                <figcaption>
                                  <a href="n-transactional-stream-characteristic">Figure 12</a>
:                                  <a href="null" id="null" class="selfRef">Transactional stream characteristic.</a>
                                </figcaption>
                              </div>
                              <p id="s-3_3_1-3">Each transactional stream is asymmetric, but a connection <span class="bcp14">MAY</span> contain separate transactional streams going in each direction.<a class="pilcrow" href="#s-3_3_1-3">&para;</a></p>
                              <p id="s-3_3_1-4">For example, in a notary application, two hosts might offer notary service to the other through the same connection but through separate streams.<a class="pilcrow" href="#s-3_3_1-4">&para;</a></p>
                            </figure>
                            
                            <section id="n-asynchronous-stream">
                              <h5 id="s-3_3_2">
                                <a class="selfRef" href="#s-3_3_2">3.3.2.</a>
                                <a class="selfRef" href="#n-asynchronous-stream">Asynchronous stream</a>
                              </h5>
                              <p id="s-3_3_2-1">Streams with an asynchronous characteristic deliver a stream of datagrams created by the stream originator to the stream receiver. Datagrams carrying control information sent in the reverse direction <span class="bcp14">MAY</span> be used to control the flow.<a class="pilcrow" href="#s-3_3_2-1">&para;</a></p>
                              <figure id="f-13">
                                <div class="artwork art-svg" id="n-asynchronous-stream-characteristic">
                                  <a class="pilcrow" href="#n-asynchronous-stream-characteristic">&para;</a>
<svg width="464" height="281" xmlns="http://www.w3.org/2000/svg" >
<g transform="translate(8,16)">
  <path d="M 0,0 L 160,0" fill="none" stroke="black" />
  <path d="M 288,0 L 448,0" fill="none" stroke="black" />
  <path d="M 0,48 L 80,48" fill="none" stroke="black" />
  <path d="M 80,48 L 160,48" fill="none" stroke="black" />
  <path d="M 288,48 L 376,48" fill="none" stroke="black" />
  <path d="M 376,48 L 448,48" fill="none" stroke="black" />
  <path d="M 80,80 L 176,80" fill="none" stroke="black" />
  <path d="M 272,80 L 368,80" fill="none" stroke="black" />
  <path d="M 88,96 L 168,96" fill="none" stroke="black" />
  <path d="M 280,96 L 376,96" fill="none" stroke="black" />
  <path d="M 88,128 L 184,128" fill="none" stroke="black" />
  <path d="M 264,128 L 376,128" fill="none" stroke="black" />
  <path d="M 88,144 L 184,144" fill="none" stroke="black" />
  <path d="M 264,144 L 376,144" fill="none" stroke="black" />
  <path d="M 88,160 L 184,160" fill="none" stroke="black" />
  <path d="M 264,160 L 376,160" fill="none" stroke="black" />
  <path d="M 88,176 L 184,176" fill="none" stroke="black" />
  <path d="M 264,176 L 376,176" fill="none" stroke="black" />
  <path d="M 80,208 L 176,208" fill="none" stroke="black" />
  <path d="M 272,208 L 368,208" fill="none" stroke="black" />
  <path d="M 88,240 L 184,240" fill="none" stroke="black" />
  <path d="M 264,240 L 376,240" fill="none" stroke="black" />
  <path d="M 88,256 L 184,256" fill="none" stroke="black" />
  <path d="M 264,256 L 376,256" fill="none" stroke="black" />
  <path d="M 0,0 L 0,48" fill="none" stroke="black" />
  <path d="M 80,48 L 80,80" fill="none" stroke="black" />
  <path d="M 80,80 L 80,208" fill="none" stroke="black" />
  <path d="M 80,208 L 80,256" fill="none" stroke="black" />
  <path d="M 160,0 L 160,48" fill="none" stroke="black" />
  <path d="M 288,0 L 288,48" fill="none" stroke="black" />
  <path d="M 376,48 L 376,96" fill="none" stroke="black" />
  <path d="M 376,96 L 376,128" fill="none" stroke="black" />
  <path d="M 376,128 L 376,144" fill="none" stroke="black" />
  <path d="M 376,144 L 376,160" fill="none" stroke="black" />
  <path d="M 376,160 L 376,176" fill="none" stroke="black" />
  <path d="M 376,176 L 376,240" fill="none" stroke="black" />
  <path d="M 376,240 L 376,256" fill="none" stroke="black" />
  <path d="M 448,0 L 448,48" fill="none" stroke="black" />
  <polygon points="96.000000,96.000000 84.000000,90.400002 84.000000,101.599998" fill="black" transform="rotate(180.000000, 88.000000, 96.000000)" />
  <polygon points="96.000000,128.000000 84.000000,122.400002 84.000000,133.600006" fill="black" transform="rotate(180.000000, 88.000000, 128.000000)" />
  <polygon points="96.000000,144.000000 84.000000,138.399994 84.000000,149.600006" fill="black" transform="rotate(180.000000, 88.000000, 144.000000)" />
  <polygon points="96.000000,160.000000 84.000000,154.399994 84.000000,165.600006" fill="black" transform="rotate(180.000000, 88.000000, 160.000000)" />
  <polygon points="96.000000,176.000000 84.000000,170.399994 84.000000,181.600006" fill="black" transform="rotate(180.000000, 88.000000, 176.000000)" />
  <polygon points="96.000000,240.000000 84.000000,234.399994 84.000000,245.600006" fill="black" transform="rotate(180.000000, 88.000000, 240.000000)" />
  <polygon points="96.000000,256.000000 84.000000,250.399994 84.000000,261.600006" fill="black" transform="rotate(180.000000, 88.000000, 256.000000)" />
  <polygon points="376.000000,80.000000 364.000000,74.400002 364.000000,85.599998" fill="black" transform="rotate(0.000000, 368.000000, 80.000000)" />
  <polygon points="376.000000,208.000000 364.000000,202.399994 364.000000,213.600006" fill="black" transform="rotate(0.000000, 368.000000, 208.000000)" />
  <text text-anchor="middle" font-family="sans-serif" x="376" y="20">i</text>
  <text text-anchor="middle" font-family="sans-serif" x="216" y="260">a</text>
  <text text-anchor="middle" font-family="sans-serif" x="224" y="260">m</text>
  <text text-anchor="middle" font-family="sans-serif" x="200" y="100">k</text>
  <text text-anchor="middle" font-family="sans-serif" x="208" y="180">r</text>
  <text text-anchor="middle" font-family="sans-serif" x="224" y="180">m</text>
  <text text-anchor="middle" font-family="sans-serif" x="232" y="180">e</text>
  <text text-anchor="middle" font-family="sans-serif" x="248" y="212">r</text>
  <text text-anchor="middle" font-family="sans-serif" x="392" y="36">a</text>
  <text text-anchor="middle" font-family="sans-serif" x="216" y="84">s</text>
  <text text-anchor="middle" font-family="sans-serif" x="184" y="100">A</text>
  <text text-anchor="middle" font-family="sans-serif" x="200" y="260">F</text>
  <text text-anchor="middle" font-family="sans-serif" x="392" y="20">e</text>
  <text text-anchor="middle" font-family="sans-serif" x="352" y="36">C</text>
  <text text-anchor="middle" font-family="sans-serif" x="256" y="84">e</text>
  <text text-anchor="middle" font-family="sans-serif" x="224" y="148">m</text>
  <text text-anchor="middle" font-family="sans-serif" x="248" y="180">4</text>
  <text text-anchor="middle" font-family="sans-serif" x="360" y="20">A</text>
  <text text-anchor="middle" font-family="sans-serif" x="216" y="100">o</text>
  <text text-anchor="middle" font-family="sans-serif" x="232" y="132">e</text>
  <text text-anchor="middle" font-family="sans-serif" x="208" y="244">r</text>
  <text text-anchor="middle" font-family="sans-serif" x="360" y="36">a</text>
  <text text-anchor="middle" font-family="sans-serif" x="240" y="100">e</text>
  <text text-anchor="middle" font-family="sans-serif" x="200" y="148">F</text>
  <text text-anchor="middle" font-family="sans-serif" x="224" y="244">m</text>
  <text text-anchor="middle" font-family="sans-serif" x="232" y="260">e</text>
  <text text-anchor="middle" font-family="sans-serif" x="248" y="260">6</text>
  <text text-anchor="middle" font-family="sans-serif" x="384" y="20">c</text>
  <text text-anchor="middle" font-family="sans-serif" x="200" y="84">u</text>
  <text text-anchor="middle" font-family="sans-serif" x="208" y="84">b</text>
  <text text-anchor="middle" font-family="sans-serif" x="64" y="36">P</text>
  <text text-anchor="middle" font-family="sans-serif" x="256" y="100">g</text>
  <text text-anchor="middle" font-family="sans-serif" x="200" y="180">F</text>
  <text text-anchor="middle" font-family="sans-serif" x="216" y="180">a</text>
  <text text-anchor="middle" font-family="sans-serif" x="200" y="212">o</text>
  <text text-anchor="middle" font-family="sans-serif" x="64" y="20">A</text>
  <text text-anchor="middle" font-family="sans-serif" x="88" y="20">c</text>
  <text text-anchor="middle" font-family="sans-serif" x="96" y="20">e</text>
  <text text-anchor="middle" font-family="sans-serif" x="200" y="244">F</text>
  <text text-anchor="middle" font-family="sans-serif" x="192" y="212">C</text>
  <text text-anchor="middle" font-family="sans-serif" x="208" y="212">n</text>
  <text text-anchor="middle" font-family="sans-serif" x="248" y="100">d</text>
  <text text-anchor="middle" font-family="sans-serif" x="264" y="100">e</text>
  <text text-anchor="middle" font-family="sans-serif" x="248" y="164">3</text>
  <text text-anchor="middle" font-family="sans-serif" x="216" y="164">a</text>
  <text text-anchor="middle" font-family="sans-serif" x="224" y="164">m</text>
  <text text-anchor="middle" font-family="sans-serif" x="232" y="212">g</text>
  <text text-anchor="middle" font-family="sans-serif" x="208" y="100">n</text>
  <text text-anchor="middle" font-family="sans-serif" x="232" y="100">l</text>
  <text text-anchor="middle" font-family="sans-serif" x="200" y="132">F</text>
  <text text-anchor="middle" font-family="sans-serif" x="192" y="84">S</text>
  <text text-anchor="middle" font-family="sans-serif" x="216" y="148">a</text>
  <text text-anchor="middle" font-family="sans-serif" x="232" y="164">e</text>
  <text text-anchor="middle" font-family="sans-serif" x="216" y="212">f</text>
  <text text-anchor="middle" font-family="sans-serif" x="216" y="244">a</text>
  <text text-anchor="middle" font-family="sans-serif" x="72" y="20">l</text>
  <text text-anchor="middle" font-family="sans-serif" x="80" y="36">o</text>
  <text text-anchor="middle" font-family="sans-serif" x="96" y="36">e</text>
  <text text-anchor="middle" font-family="sans-serif" x="240" y="84">i</text>
  <text text-anchor="middle" font-family="sans-serif" x="224" y="100">w</text>
  <text text-anchor="middle" font-family="sans-serif" x="216" y="132">a</text>
  <text text-anchor="middle" font-family="sans-serif" x="248" y="132">1</text>
  <text text-anchor="middle" font-family="sans-serif" x="248" y="148">2</text>
  <text text-anchor="middle" font-family="sans-serif" x="80" y="20">i</text>
  <text text-anchor="middle" font-family="sans-serif" x="88" y="36">n</text>
  <text text-anchor="middle" font-family="sans-serif" x="384" y="36">r</text>
  <text text-anchor="middle" font-family="sans-serif" x="208" y="148">r</text>
  <text text-anchor="middle" font-family="sans-serif" x="232" y="148">e</text>
  <text text-anchor="middle" font-family="sans-serif" x="224" y="212">i</text>
  <text text-anchor="middle" font-family="sans-serif" x="256" y="212">e</text>
  <text text-anchor="middle" font-family="sans-serif" x="232" y="244">e</text>
  <text text-anchor="middle" font-family="sans-serif" x="368" y="36">m</text>
  <text text-anchor="middle" font-family="sans-serif" x="224" y="84">c</text>
  <text text-anchor="middle" font-family="sans-serif" x="192" y="100">c</text>
  <text text-anchor="middle" font-family="sans-serif" x="208" y="260">r</text>
  <text text-anchor="middle" font-family="sans-serif" x="368" y="20">l</text>
  <text text-anchor="middle" font-family="sans-serif" x="248" y="84">b</text>
  <text text-anchor="middle" font-family="sans-serif" x="224" y="132">m</text>
  <text text-anchor="middle" font-family="sans-serif" x="72" y="36">h</text>
  <text text-anchor="middle" font-family="sans-serif" x="376" y="36">e</text>
  <text text-anchor="middle" font-family="sans-serif" x="248" y="244">5</text>
  <text text-anchor="middle" font-family="sans-serif" x="208" y="164">r</text>
  <text text-anchor="middle" font-family="sans-serif" x="240" y="212">u</text>
  <text text-anchor="middle" font-family="sans-serif" x="232" y="84">r</text>
  <text text-anchor="middle" font-family="sans-serif" x="208" y="132">r</text>
  <text text-anchor="middle" font-family="sans-serif" x="200" y="164">F</text>
</g></svg>
                                  <figcaption>
                                    <a href="n-asynchronous-stream-characteristic">Figure 13</a>
:                                    <a href="null" id="null" class="selfRef">Asynchronous stream characteristic.</a>
                                  </figcaption>
                                </div>
                                <p id="s-3_3_2-3">Asynchronous streams <span class="bcp14">MAY</span> be used for intermittent communications as well as real time streaming media. For example, a network server might use an asynchronous stream to log transaction data to another machine.<a class="pilcrow" href="#s-3_3_2-3">&para;</a></p>
                              </figure>
                              
                              <section id="n-credentials">
                                <h4 id="s-3_4">
                                  <a class="selfRef" href="#s-3_4">3.4.</a>
                                  <a class="selfRef" href="#n-credentials">Credentials</a>
                                </h4>
                                <p id="s-3_4-1">RDP follows the Mesh approach of using separate credentials for devices and principals. <a class="pilcrow" href="#s-3_4-1">&para;</a></p>
                                <p id="s-3_4-2">For example, the service offered by provider (@provider) is delivered by a fault tolerant collection of three separate hosts. Alice (@alice) can access those services through any one of her four personal devices.<a class="pilcrow" href="#s-3_4-2">&para;</a></p>
                                <figure id="f-14">
                                  <div class="artwork art-svg" id="n-mesh-layered-credential-model">
                                    <a class="pilcrow" href="#n-mesh-layered-credential-model">&para;</a>
<svg width="520" height="185" xmlns="http://www.w3.org/2000/svg" >
<g transform="translate(8,16)">
  <path d="M 0,0 L 160,0" fill="none" stroke="black" />
  <path d="M 296,0 L 456,0" fill="none" stroke="black" />
  <path d="M 168,16 L 288,16" fill="none" stroke="black" />
  <path d="M 0,32 L 80,32" fill="none" stroke="black" />
  <path d="M 80,32 L 160,32" fill="none" stroke="black" />
  <path d="M 296,32 L 384,32" fill="none" stroke="black" />
  <path d="M 384,32 L 456,32" fill="none" stroke="black" />
  <path d="M 0,80 L 496,80" fill="none" stroke="black" />
  <path d="M 0,128 L 80,128" fill="none" stroke="black" />
  <path d="M 80,128 L 160,128" fill="none" stroke="black" />
  <path d="M 296,128 L 384,128" fill="none" stroke="black" />
  <path d="M 384,128 L 456,128" fill="none" stroke="black" />
  <path d="M 168,144 L 288,144" fill="none" stroke="black" />
  <path d="M 0,160 L 160,160" fill="none" stroke="black" />
  <path d="M 296,160 L 456,160" fill="none" stroke="black" />
  <path d="M 0,0 L 0,32" fill="none" stroke="black" />
  <path d="M 0,128 L 0,160" fill="none" stroke="black" />
  <path d="M 160,0 L 160,32" fill="none" stroke="black" />
  <path d="M 160,128 L 160,160" fill="none" stroke="black" />
  <path d="M 296,0 L 296,32" fill="none" stroke="black" />
  <path d="M 296,128 L 296,160" fill="none" stroke="black" />
  <path d="M 456,0 L 456,32" fill="none" stroke="black" />
  <path d="M 456,128 L 456,160" fill="none" stroke="black" />
  <polygon points="176.000000,16.000000 164.000000,10.400000 164.000000,21.600000" fill="black" transform="rotate(180.000000, 168.000000, 16.000000)" />
  <polygon points="176.000000,144.000000 164.000000,138.399994 164.000000,149.600006" fill="black" transform="rotate(180.000000, 168.000000, 144.000000)" />
  <polygon points="296.000000,16.000000 284.000000,10.400000 284.000000,21.600000" fill="black" transform="rotate(0.000000, 288.000000, 16.000000)" />
  <polygon points="296.000000,144.000000 284.000000,138.399994 284.000000,149.600006" fill="black" transform="rotate(0.000000, 288.000000, 144.000000)" />
  <text text-anchor="middle" font-family="sans-serif" x="360" y="20">S</text>
  <text text-anchor="middle" font-family="sans-serif" x="384" y="20">v</text>
  <text text-anchor="middle" font-family="sans-serif" x="80" y="68">:</text>
  <text text-anchor="middle" font-family="sans-serif" x="264" y="132">l</text>
  <text text-anchor="middle" font-family="sans-serif" x="88" y="20">c</text>
  <text text-anchor="middle" font-family="sans-serif" x="384" y="116">:</text>
  <text text-anchor="middle" font-family="sans-serif" x="96" y="20">e</text>
  <text text-anchor="middle" font-family="sans-serif" x="80" y="100">:</text>
  <text text-anchor="middle" font-family="sans-serif" x="208" y="132">e</text>
  <text text-anchor="middle" font-family="sans-serif" x="424" y="68">p</text>
  <text text-anchor="middle" font-family="sans-serif" x="80" y="52">:</text>
  <text text-anchor="middle" font-family="sans-serif" x="384" y="68">:</text>
  <text text-anchor="middle" font-family="sans-serif" x="416" y="68">A</text>
  <text text-anchor="middle" font-family="sans-serif" x="472" y="100">a</text>
  <text text-anchor="middle" font-family="sans-serif" x="200" y="4">r</text>
  <text text-anchor="middle" font-family="sans-serif" x="64" y="148">D</text>
  <text text-anchor="middle" font-family="sans-serif" x="368" y="148">H</text>
  <text text-anchor="middle" font-family="sans-serif" x="440" y="68">l</text>
  <text text-anchor="middle" font-family="sans-serif" x="80" y="116">:</text>
  <text text-anchor="middle" font-family="sans-serif" x="80" y="148">v</text>
  <text text-anchor="middle" font-family="sans-serif" x="64" y="20">A</text>
  <text text-anchor="middle" font-family="sans-serif" x="384" y="52">:</text>
  <text text-anchor="middle" font-family="sans-serif" x="224" y="132">e</text>
  <text text-anchor="middle" font-family="sans-serif" x="240" y="132">t</text>
  <text text-anchor="middle" font-family="sans-serif" x="392" y="148">t</text>
  <text text-anchor="middle" font-family="sans-serif" x="504" y="100">n</text>
  <text text-anchor="middle" font-family="sans-serif" x="376" y="20">r</text>
  <text text-anchor="middle" font-family="sans-serif" x="392" y="20">i</text>
  <text text-anchor="middle" font-family="sans-serif" x="432" y="68">p</text>
  <text text-anchor="middle" font-family="sans-serif" x="480" y="68">i</text>
  <text text-anchor="middle" font-family="sans-serif" x="440" y="100">s</text>
  <text text-anchor="middle" font-family="sans-serif" x="96" y="148">c</text>
  <text text-anchor="middle" font-family="sans-serif" x="224" y="4">e</text>
  <text text-anchor="middle" font-family="sans-serif" x="264" y="4">l</text>
  <text text-anchor="middle" font-family="sans-serif" x="80" y="20">i</text>
  <text text-anchor="middle" font-family="sans-serif" x="456" y="68">c</text>
  <text text-anchor="middle" font-family="sans-serif" x="472" y="68">t</text>
  <text text-anchor="middle" font-family="sans-serif" x="496" y="68">n</text>
  <text text-anchor="middle" font-family="sans-serif" x="384" y="148">s</text>
  <text text-anchor="middle" font-family="sans-serif" x="240" y="4">t</text>
  <text text-anchor="middle" font-family="sans-serif" x="400" y="20">c</text>
  <text text-anchor="middle" font-family="sans-serif" x="488" y="68">o</text>
  <text text-anchor="middle" font-family="sans-serif" x="488" y="100">i</text>
  <text text-anchor="middle" font-family="sans-serif" x="72" y="20">l</text>
  <text text-anchor="middle" font-family="sans-serif" x="464" y="100">t</text>
  <text text-anchor="middle" font-family="sans-serif" x="232" y="132">n</text>
  <text text-anchor="middle" font-family="sans-serif" x="376" y="148">o</text>
  <text text-anchor="middle" font-family="sans-serif" x="432" y="100">e</text>
  <text text-anchor="middle" font-family="sans-serif" x="232" y="4">n</text>
  <text text-anchor="middle" font-family="sans-serif" x="248" y="4">i</text>
  <text text-anchor="middle" font-family="sans-serif" x="256" y="4">a</text>
  <text text-anchor="middle" font-family="sans-serif" x="448" y="68">i</text>
  <text text-anchor="middle" font-family="sans-serif" x="424" y="100">r</text>
  <text text-anchor="middle" font-family="sans-serif" x="448" y="100">e</text>
  <text text-anchor="middle" font-family="sans-serif" x="456" y="100">n</text>
  <text text-anchor="middle" font-family="sans-serif" x="208" y="4">e</text>
  <text text-anchor="middle" font-family="sans-serif" x="480" y="100">t</text>
  <text text-anchor="middle" font-family="sans-serif" x="464" y="68">a</text>
  <text text-anchor="middle" font-family="sans-serif" x="72" y="148">e</text>
  <text text-anchor="middle" font-family="sans-serif" x="368" y="20">e</text>
  <text text-anchor="middle" font-family="sans-serif" x="216" y="132">d</text>
  <text text-anchor="middle" font-family="sans-serif" x="248" y="132">i</text>
  <text text-anchor="middle" font-family="sans-serif" x="256" y="132">a</text>
  <text text-anchor="middle" font-family="sans-serif" x="88" y="148">i</text>
  <text text-anchor="middle" font-family="sans-serif" x="104" y="148">e</text>
  <text text-anchor="middle" font-family="sans-serif" x="216" y="4">d</text>
  <text text-anchor="middle" font-family="sans-serif" x="408" y="20">e</text>
  <text text-anchor="middle" font-family="sans-serif" x="384" y="100">:</text>
  <text text-anchor="middle" font-family="sans-serif" x="416" y="100">P</text>
  <text text-anchor="middle" font-family="sans-serif" x="496" y="100">o</text>
  <text text-anchor="middle" font-family="sans-serif" x="192" y="132">C</text>
  <text text-anchor="middle" font-family="sans-serif" x="200" y="132">r</text>
  <text text-anchor="middle" font-family="sans-serif" x="192" y="4">C</text>
</g></svg>
                                    <figcaption>
                                      <a href="n-mesh-layered-credential-model">Figure 14</a>
:                                      <a href="null" id="null" class="selfRef">Mesh Layered Credential Model.</a>
                                    </figcaption>
                                  </div>
                                  <p id="s-3_4-4">RDP makes use of the keys specified in device credentials to perform key agreement and enables user and service credential(s) to be presented for authentication and authorization of the principals.<a class="pilcrow" href="#s-3_4-4">&para;</a></p>
                                </figure>
                                
                                <section id="n-device">
                                  <h5 id="s-3_4_1">
                                    <a class="selfRef" href="#s-3_4_1">3.4.1.</a>
                                    <a class="selfRef" href="#n-device">Device</a>
                                  </h5>
                                  <p id="s-3_4_1-1">An RDP device credential is a credential that specifies a public key of one of the supported key agreement algorithms. Two forms of device credential are currently defined:<a class="pilcrow" href="#s-3_4_1-1">&para;</a></p>
                                  <ul id="s-3_4_1-2-">
                                    <li id="s-3_4_1-2">Raw Key (e.g. X.448 key)<a class="pilcrow" href="#s-3_4_1-2">&para;</a></li>
                                    <li id="s-3_4_1-3">Mesh Device Connection Assertion.<a class="pilcrow" href="#s-3_4_1-3">&para;</a></li>
                                  </ul>
                                  <p id="s-3_4_1-4">It might well be the case that it is more appropriate to pass the Device Connection Assertion as part of the Principal Credential.<a class="pilcrow" href="#s-3_4_1-4">&para;</a></p>
                                </section>
                                
                                <section id="n-principal">
                                  <h5 id="s-3_4_2">
                                    <a class="selfRef" href="#s-3_4_2">3.4.2.</a>
                                    <a class="selfRef" href="#n-principal">Principal</a>
                                  </h5>
                                  <p id="s-3_4_2-1">Principal credentials are used to authenticate and authorize a device to act on behalf of the specified principal. <a class="pilcrow" href="#s-3_4_2-1">&para;</a></p>
                                  <p id="s-3_4_2-2">Presentation of Principal Credentials <span class="bcp14">MAY</span> be performed at the application layer (i.e. by means of credentials carried in an RDP payload) or as an RDP Packet Extension when a <b>stream service binding</b> is requested.<a class="pilcrow" href="#s-3_4_2-2">&para;</a></p>
                                  <p id="s-3_4_2-3">In either case, validation of Principal Credentials is an application concern and thus outside the scope of RDP.<a class="pilcrow" href="#s-3_4_2-3">&para;</a></p>
                                  <p id="s-3_4_2-4">Different streams <span class="bcp14">MAY</span> involve the use of different principal credentials. Alice might be authenticated through her Mesh profile in one stream, a PKIX client cert bound to a smartcard in another and a SAML authorization token in a third.<a class="pilcrow" href="#s-3_4_2-4">&para;</a></p>
                                </section>
                                
                                <section id="n-datagram-format">
                                  <h4 id="s-3_5">
                                    <a class="selfRef" href="#s-3_5">3.5.</a>
                                    <a class="selfRef" href="#n-datagram-format">Datagram Format</a>
                                  </h4>
                                  <p id="s-3_5-1">An RDP Datagram is by definition the smallest unit of payload data passed from the application layer to the presentation layer or vice versa. A Datagram <span class="bcp14">MAY</span> be as large as a complete frame of 4K or 8K video or as small as a single key press or movement of a game controller.<a class="pilcrow" href="#s-3_5-1">&para;</a></p>
                                  <p id="s-3_5-2">Use of HTTP ports places no upper limit on the size of an RDP Datagram but UDP Datagrams are limited to a maximum number of packets. <a class="pilcrow" href="#s-3_5-2">&para;</a></p>
                                  <figure id="f-15">
                                    <div class="artwork art-svg" id="n-datagram-format">
                                      <a class="pilcrow" href="#n-datagram-format">&para;</a>
<svg width="536" height="169" xmlns="http://www.w3.org/2000/svg" >
<g transform="translate(8,16)">
  <path d="M 0,0 L 120,0" fill="none" stroke="black" />
  <path d="M 120,0 L 240,0" fill="none" stroke="black" />
  <path d="M 240,0 L 416,0" fill="none" stroke="black" />
  <path d="M 416,0 L 520,0" fill="none" stroke="black" />
  <path d="M 248,32 L 280,32" fill="none" stroke="black" />
  <path d="M 376,32 L 408,32" fill="none" stroke="black" />
  <path d="M 0,48 L 120,48" fill="none" stroke="black" />
  <path d="M 120,48 L 240,48" fill="none" stroke="black" />
  <path d="M 240,48 L 416,48" fill="none" stroke="black" />
  <path d="M 416,48 L 520,48" fill="none" stroke="black" />
  <path d="M 136,80 L 224,80" fill="none" stroke="black" />
  <path d="M 416,80 L 520,80" fill="none" stroke="black" />
  <path d="M 120,112 L 224,112" fill="none" stroke="black" />
  <path d="M 224,112 L 344,112" fill="none" stroke="black" />
  <path d="M 344,112 L 520,112" fill="none" stroke="black" />
  <path d="M 120,144 L 224,144" fill="none" stroke="black" />
  <path d="M 224,144 L 344,144" fill="none" stroke="black" />
  <path d="M 344,144 L 520,144" fill="none" stroke="black" />
  <path d="M 0,0 L 0,48" fill="none" stroke="black" />
  <path d="M 120,0 L 120,48" fill="none" stroke="black" />
  <path d="M 120,96 L 120,112" fill="none" stroke="black" />
  <path d="M 120,112 L 120,144" fill="none" stroke="black" />
  <path d="M 224,112 L 224,144" fill="none" stroke="black" />
  <path d="M 240,0 L 240,48" fill="none" stroke="black" />
  <path d="M 240,48 L 240,64" fill="none" stroke="black" />
  <path d="M 344,112 L 344,144" fill="none" stroke="black" />
  <path d="M 416,0 L 416,48" fill="none" stroke="black" />
  <path d="M 416,48 L 416,80" fill="none" stroke="black" />
  <path d="M 520,0 L 520,48" fill="none" stroke="black" />
  <path d="M 520,80 L 520,112" fill="none" stroke="black" />
  <path d="M 520,112 L 520,144" fill="none" stroke="black" />
  <polygon points="256.000000,32.000000 244.000000,26.400000 244.000000,37.599998" fill="black" transform="rotate(180.000000, 248.000000, 32.000000)" />
  <path d="M 320,56 L 320,64" fill="none" stroke="black" />
  <polygon points="336.000000,64.000000 324.000000,58.400002 324.000000,69.599998" fill="black" transform="rotate(270.000000, 320.000000, 64.000000)" />
  <path d="M 320,96 L 320,104" fill="none" stroke="black" />
  <polygon points="336.000000,96.000000 324.000000,90.400002 324.000000,101.599998" fill="black" transform="rotate(90.000000, 320.000000, 96.000000)" />
  <polygon points="416.000000,32.000000 404.000000,26.400000 404.000000,37.599998" fill="black" transform="rotate(0.000000, 408.000000, 32.000000)" />
  <path d="M 136,80 A 16,16 0 0,0 120,96" fill="none" stroke="black" />
  <path d="M 240,64 A 16,16 0 0,1 224,80" fill="none" stroke="black" />
  <text text-anchor="middle" font-family="sans-serif" x="496" y="36">s</text>
  <text text-anchor="middle" font-family="sans-serif" x="152" y="132">t</text>
  <text text-anchor="middle" font-family="sans-serif" x="296" y="132">a</text>
  <text text-anchor="middle" font-family="sans-serif" x="408" y="132">o</text>
  <text text-anchor="middle" font-family="sans-serif" x="40" y="20">r</text>
  <text text-anchor="middle" font-family="sans-serif" x="56" y="20">a</text>
  <text text-anchor="middle" font-family="sans-serif" x="160" y="20">N</text>
  <text text-anchor="middle" font-family="sans-serif" x="168" y="20">o</text>
  <text text-anchor="middle" font-family="sans-serif" x="144" y="36">1</text>
  <text text-anchor="middle" font-family="sans-serif" x="200" y="36">e</text>
  <text text-anchor="middle" font-family="sans-serif" x="208" y="36">s</text>
  <text text-anchor="middle" font-family="sans-serif" x="464" y="36">B</text>
  <text text-anchor="middle" font-family="sans-serif" x="64" y="20">m</text>
  <text text-anchor="middle" font-family="sans-serif" x="440" y="20">A</text>
  <text text-anchor="middle" font-family="sans-serif" x="464" y="20">h</text>
  <text text-anchor="middle" font-family="sans-serif" x="80" y="36">t</text>
  <text text-anchor="middle" font-family="sans-serif" x="488" y="36">e</text>
  <text text-anchor="middle" font-family="sans-serif" x="176" y="20">n</text>
  <text text-anchor="middle" font-family="sans-serif" x="272" y="132">y</text>
  <text text-anchor="middle" font-family="sans-serif" x="448" y="132">d</text>
  <text text-anchor="middle" font-family="sans-serif" x="304" y="20">p</text>
  <text text-anchor="middle" font-family="sans-serif" x="320" y="36">a</text>
  <text text-anchor="middle" font-family="sans-serif" x="400" y="132">r</text>
  <text text-anchor="middle" font-family="sans-serif" x="304" y="36">e</text>
  <text text-anchor="middle" font-family="sans-serif" x="360" y="36">r</text>
  <text text-anchor="middle" font-family="sans-serif" x="360" y="20">t</text>
  <text text-anchor="middle" font-family="sans-serif" x="24" y="36">0</text>
  <text text-anchor="middle" font-family="sans-serif" x="480" y="36">t</text>
  <text text-anchor="middle" font-family="sans-serif" x="456" y="132">d</text>
  <text text-anchor="middle" font-family="sans-serif" x="480" y="132">g</text>
  <text text-anchor="middle" font-family="sans-serif" x="184" y="36">y</text>
  <text text-anchor="middle" font-family="sans-serif" x="176" y="132">s</text>
  <text text-anchor="middle" font-family="sans-serif" x="184" y="132">i</text>
  <text text-anchor="middle" font-family="sans-serif" x="264" y="132">a</text>
  <text text-anchor="middle" font-family="sans-serif" x="312" y="36">m</text>
  <text text-anchor="middle" font-family="sans-serif" x="440" y="36">1</text>
  <text text-anchor="middle" font-family="sans-serif" x="392" y="132">e</text>
  <text text-anchor="middle" font-family="sans-serif" x="24" y="20">S</text>
  <text text-anchor="middle" font-family="sans-serif" x="328" y="20">r</text>
  <text text-anchor="middle" font-family="sans-serif" x="72" y="36">y</text>
  <text text-anchor="middle" font-family="sans-serif" x="96" y="36">s</text>
  <text text-anchor="middle" font-family="sans-serif" x="448" y="36">6</text>
  <text text-anchor="middle" font-family="sans-serif" x="168" y="132">n</text>
  <text text-anchor="middle" font-family="sans-serif" x="464" y="132">i</text>
  <text text-anchor="middle" font-family="sans-serif" x="456" y="20">t</text>
  <text text-anchor="middle" font-family="sans-serif" x="48" y="36">6</text>
  <text text-anchor="middle" font-family="sans-serif" x="296" y="36">R</text>
  <text text-anchor="middle" font-family="sans-serif" x="336" y="36">n</text>
  <text text-anchor="middle" font-family="sans-serif" x="88" y="36">e</text>
  <text text-anchor="middle" font-family="sans-serif" x="160" y="36">8</text>
  <text text-anchor="middle" font-family="sans-serif" x="176" y="36">B</text>
  <text text-anchor="middle" font-family="sans-serif" x="352" y="36">e</text>
  <text text-anchor="middle" font-family="sans-serif" x="344" y="20">e</text>
  <text text-anchor="middle" font-family="sans-serif" x="496" y="20">g</text>
  <text text-anchor="middle" font-family="sans-serif" x="32" y="36">-</text>
  <text text-anchor="middle" font-family="sans-serif" x="64" y="36">B</text>
  <text text-anchor="middle" font-family="sans-serif" x="312" y="84">A</text>
  <text text-anchor="middle" font-family="sans-serif" x="200" y="132">n</text>
  <text text-anchor="middle" font-family="sans-serif" x="480" y="20">T</text>
  <text text-anchor="middle" font-family="sans-serif" x="344" y="36">d</text>
  <text text-anchor="middle" font-family="sans-serif" x="144" y="132">x</text>
  <text text-anchor="middle" font-family="sans-serif" x="32" y="20">t</text>
  <text text-anchor="middle" font-family="sans-serif" x="40" y="36">1</text>
  <text text-anchor="middle" font-family="sans-serif" x="320" y="84">E</text>
  <text text-anchor="middle" font-family="sans-serif" x="432" y="132">P</text>
  <text text-anchor="middle" font-family="sans-serif" x="280" y="132">l</text>
  <text text-anchor="middle" font-family="sans-serif" x="48" y="20">e</text>
  <text text-anchor="middle" font-family="sans-serif" x="352" y="20">x</text>
  <text text-anchor="middle" font-family="sans-serif" x="488" y="20">a</text>
  <text text-anchor="middle" font-family="sans-serif" x="328" y="36">i</text>
  <text text-anchor="middle" font-family="sans-serif" x="328" y="84">S</text>
  <text text-anchor="middle" font-family="sans-serif" x="136" y="132">E</text>
  <text text-anchor="middle" font-family="sans-serif" x="160" y="132">e</text>
  <text text-anchor="middle" font-family="sans-serif" x="208" y="132">s</text>
  <text text-anchor="middle" font-family="sans-serif" x="296" y="20">i</text>
  <text text-anchor="middle" font-family="sans-serif" x="448" y="20">u</text>
  <text text-anchor="middle" font-family="sans-serif" x="192" y="36">t</text>
  <text text-anchor="middle" font-family="sans-serif" x="472" y="36">y</text>
  <text text-anchor="middle" font-family="sans-serif" x="384" y="132">Z</text>
  <text text-anchor="middle" font-family="sans-serif" x="320" y="20">e</text>
  <text text-anchor="middle" font-family="sans-serif" x="256" y="132">P</text>
  <text text-anchor="middle" font-family="sans-serif" x="288" y="132">o</text>
  <text text-anchor="middle" font-family="sans-serif" x="304" y="132">d</text>
  <text text-anchor="middle" font-family="sans-serif" x="80" y="20">I</text>
  <text text-anchor="middle" font-family="sans-serif" x="88" y="20">d</text>
  <text text-anchor="middle" font-family="sans-serif" x="184" y="20">c</text>
  <text text-anchor="middle" font-family="sans-serif" x="288" y="20">C</text>
  <text text-anchor="middle" font-family="sans-serif" x="472" y="132">n</text>
  <text text-anchor="middle" font-family="sans-serif" x="192" y="132">o</text>
  <text text-anchor="middle" font-family="sans-serif" x="440" y="132">a</text>
  <text text-anchor="middle" font-family="sans-serif" x="192" y="20">e</text>
  <text text-anchor="middle" font-family="sans-serif" x="312" y="20">h</text>
  <text text-anchor="middle" font-family="sans-serif" x="336" y="20">t</text>
  <text text-anchor="middle" font-family="sans-serif" x="152" y="36">-</text>
</g></svg>
                                      <figcaption>
                                        <a href="n-datagram-format">Figure 15</a>
:                                        <a href="null" id="null" class="selfRef">Datagram format.</a>
                                      </figcaption>
                                    </div>
                                    <p id="s-3_5-4">Requests and Responses <span class="bcp14">MAY</span> be split into multiple Datagrams. In this case every datagram except the final one is marked with the continuation flag.<a class="pilcrow" href="#s-3_5-4">&para;</a></p>
                                    <p id="s-3_5-5">APIs <span class="bcp14">MAY</span> choose to present the individual datagrams to applications or reconstruct the complete datagram according to what best fits their circumstances.<a class="pilcrow" href="#s-3_5-5">&para;</a></p>
                                  </figure>
                                  
                                  <section id="n-stream-identifier">
                                    <h5 id="s-3_5_1">
                                      <a class="selfRef" href="#s-3_5_1">3.5.1.</a>
                                      <a class="selfRef" href="#n-stream-identifier">Stream Identifier</a>
                                    </h5>
                                    <p id="s-3_5_1-1">A sequence of bytes as specified by the recipient during establishment of the connection or stream.<a class="pilcrow" href="#s-3_5_1-1">&para;</a></p>
                                  </section>
                                  
                                  <section id="n-nonce">
                                    <h5 id="s-3_5_2">
                                      <a class="selfRef" href="#s-3_5_2">3.5.2.</a>
                                      <a class="selfRef" href="#n-nonce">Nonce</a>
                                    </h5>
                                    <p id="s-3_5_2-1">The keys used to encrypt and authenticate each datagram are derived by applying a key derivation function to the Stream Primary Key, the Stream identifier and a nonce value specified in the datagram itself.<a class="pilcrow" href="#s-3_5_2-1">&para;</a></p>
                                    <p id="s-3_5_2-2">The nonce is the value of a monotonically increasing datagram counter.<a class="pilcrow" href="#s-3_5_2-2">&para;</a></p>
                                  </section>
                                  
                                  <section id="n-ciphertext">
                                    <h5 id="s-3_5_3">
                                      <a class="selfRef" href="#s-3_5_3">3.5.3.</a>
                                      <a class="selfRef" href="#n-ciphertext">Ciphertext</a>
                                    </h5>
                                    <p id="s-3_5_3-1">Ciphertext is the plaintext payload encrypted under a key derived from the active primary key and the initialization vector. Keys are only used to encrypt a single Datagram or continuation Datagram. <a class="pilcrow" href="#s-3_5_3-1">&para;</a></p>
                                    <p id="s-3_5_3-2">Plaintext of a data Datagram consists of a list of packet extension entries followed by a payload followed by zero padding.<a class="pilcrow" href="#s-3_5_3-2">&para;</a></p>
                                  </section>
                                  
                                  <section id="n-authentication-tag">
                                    <h5 id="s-3_5_4">
                                      <a class="selfRef" href="#s-3_5_4">3.5.4.</a>
                                      <a class="selfRef" href="#n-authentication-tag">Authentication Tag</a>
                                    </h5>
                                    <p id="s-3_5_4-1">Associated data is entire Datagram from the first byte to the start of the Initialization vector.<a class="pilcrow" href="#s-3_5_4-1">&para;</a></p>
                                  </section>
                                  
                                  <section id="n-packet-format-and-packetized-datagrams">
                                    <h4 id="s-3_6">
                                      <a class="selfRef" href="#s-3_6">3.6.</a>
                                      <a class="selfRef" href="#n-packet-format-and-packetized-datagrams">Packet Format and Packetized Datagrams</a>
                                    </h4>
                                    <p id="s-3_6-1">UDP provides unreliable transport of datagrams no larger than the maximum IP payload size of 64KB. In practice the largest datagram payload is typically limited to no more than 1260 bytes because the Ethernet specification is stuck in the Middle Ages. It is thus necessary to split large Datagrams into multiple packets and provide sufficient control information that the receiver can reassemble the packets in the right order and request any lost packets be re-sent.<a class="pilcrow" href="#s-3_6-1">&para;</a></p>
                                    <p id="s-3_6-2">Similar constraints are imposed by a wide range of wireless and wired physical and network transports.<a class="pilcrow" href="#s-3_6-2">&para;</a></p>
                                    <p id="s-3_6-3">When using Packetized Datagrams, each packet in the Datagram specifies the stream identifier and a packet identifier. Only the last packet in the Datagram presents an authentication tag.<a class="pilcrow" href="#s-3_6-3">&para;</a></p>
                                    <figure id="f-17">
                                      <div class="artwork art-svg" id="n-datagram-packetization-across-multiple-packets">
                                        <a class="pilcrow" href="#n-datagram-packetization-across-multiple-packets">&para;</a>
<svg width="504" height="281" xmlns="http://www.w3.org/2000/svg" >
<g transform="translate(8,16)">
  <path d="M 0,16 L 104,16" fill="none" stroke="black" />
  <path d="M 104,16 L 208,16" fill="none" stroke="black" />
  <path d="M 208,16 L 336,16" fill="none" stroke="black" />
  <path d="M 352,16 L 360,16" fill="none" stroke="black" />
  <path d="M 376,16 L 384,16" fill="none" stroke="black" />
  <path d="M 384,16 L 488,16" fill="none" stroke="black" />
  <path d="M 0,48 L 104,48" fill="none" stroke="black" />
  <path d="M 104,48 L 208,48" fill="none" stroke="black" />
  <path d="M 208,48 L 336,48" fill="none" stroke="black" />
  <path d="M 352,48 L 360,48" fill="none" stroke="black" />
  <path d="M 376,48 L 384,48" fill="none" stroke="black" />
  <path d="M 384,48 L 488,48" fill="none" stroke="black" />
  <path d="M 0,96 L 104,96" fill="none" stroke="black" />
  <path d="M 104,96 L 208,96" fill="none" stroke="black" />
  <path d="M 208,96 L 448,96" fill="none" stroke="black" />
  <path d="M 0,128 L 104,128" fill="none" stroke="black" />
  <path d="M 104,128 L 208,128" fill="none" stroke="black" />
  <path d="M 208,128 L 448,128" fill="none" stroke="black" />
  <path d="M 0,160 L 104,160" fill="none" stroke="black" />
  <path d="M 104,160 L 208,160" fill="none" stroke="black" />
  <path d="M 208,160 L 448,160" fill="none" stroke="black" />
  <path d="M 0,192 L 104,192" fill="none" stroke="black" />
  <path d="M 104,192 L 208,192" fill="none" stroke="black" />
  <path d="M 208,192 L 448,192" fill="none" stroke="black" />
  <path d="M 0,224 L 104,224" fill="none" stroke="black" />
  <path d="M 104,224 L 208,224" fill="none" stroke="black" />
  <path d="M 208,224 L 344,224" fill="none" stroke="black" />
  <path d="M 344,224 L 448,224" fill="none" stroke="black" />
  <path d="M 0,256 L 104,256" fill="none" stroke="black" />
  <path d="M 104,256 L 208,256" fill="none" stroke="black" />
  <path d="M 208,256 L 344,256" fill="none" stroke="black" />
  <path d="M 344,256 L 448,256" fill="none" stroke="black" />
  <path d="M 0,16 L 0,48" fill="none" stroke="black" />
  <path d="M 0,96 L 0,128" fill="none" stroke="black" />
  <path d="M 0,160 L 0,192" fill="none" stroke="black" />
  <path d="M 0,224 L 0,256" fill="none" stroke="black" />
  <path d="M 104,16 L 104,48" fill="none" stroke="black" />
  <path d="M 104,96 L 104,128" fill="none" stroke="black" />
  <path d="M 104,160 L 104,192" fill="none" stroke="black" />
  <path d="M 104,224 L 104,256" fill="none" stroke="black" />
  <path d="M 208,16 L 208,48" fill="none" stroke="black" />
  <path d="M 208,96 L 208,128" fill="none" stroke="black" />
  <path d="M 208,160 L 208,192" fill="none" stroke="black" />
  <path d="M 208,224 L 208,256" fill="none" stroke="black" />
  <path d="M 344,224 L 344,256" fill="none" stroke="black" />
  <path d="M 384,16 L 384,48" fill="none" stroke="black" />
  <path d="M 448,96 L 448,128" fill="none" stroke="black" />
  <path d="M 448,160 L 448,192" fill="none" stroke="black" />
  <path d="M 448,224 L 448,256" fill="none" stroke="black" />
  <path d="M 488,16 L 488,48" fill="none" stroke="black" />
  <text text-anchor="middle" font-family="sans-serif" x="48" y="244">a</text>
  <text text-anchor="middle" font-family="sans-serif" x="368" y="244">A</text>
  <text text-anchor="middle" font-family="sans-serif" x="48" y="116">a</text>
  <text text-anchor="middle" font-family="sans-serif" x="56" y="180">m</text>
  <text text-anchor="middle" font-family="sans-serif" x="24" y="244">t</text>
  <text text-anchor="middle" font-family="sans-serif" x="32" y="4">e</text>
  <text text-anchor="middle" font-family="sans-serif" x="304" y="180">t</text>
  <text text-anchor="middle" font-family="sans-serif" x="296" y="244">e</text>
  <text text-anchor="middle" font-family="sans-serif" x="168" y="244">r</text>
  <text text-anchor="middle" font-family="sans-serif" x="312" y="244">t</text>
  <text text-anchor="middle" font-family="sans-serif" x="376" y="244">u</text>
  <text text-anchor="middle" font-family="sans-serif" x="16" y="84">c</text>
  <text text-anchor="middle" font-family="sans-serif" x="40" y="116">e</text>
  <text text-anchor="middle" font-family="sans-serif" x="304" y="116">t</text>
  <text text-anchor="middle" font-family="sans-serif" x="184" y="116">1</text>
  <text text-anchor="middle" font-family="sans-serif" x="168" y="116">r</text>
  <text text-anchor="middle" font-family="sans-serif" x="72" y="180">I</text>
  <text text-anchor="middle" font-family="sans-serif" x="8" y="4">r</text>
  <text text-anchor="middle" font-family="sans-serif" x="264" y="36">i</text>
  <text text-anchor="middle" font-family="sans-serif" x="304" y="36">t</text>
  <text text-anchor="middle" font-family="sans-serif" x="264" y="244">h</text>
  <text text-anchor="middle" font-family="sans-serif" x="280" y="244">r</text>
  <text text-anchor="middle" font-family="sans-serif" x="328" y="36">t</text>
  <text text-anchor="middle" font-family="sans-serif" x="24" y="116">t</text>
  <text text-anchor="middle" font-family="sans-serif" x="280" y="116">h</text>
  <text text-anchor="middle" font-family="sans-serif" x="128" y="116">H</text>
  <text text-anchor="middle" font-family="sans-serif" x="40" y="244">e</text>
  <text text-anchor="middle" font-family="sans-serif" x="272" y="244">e</text>
  <text text-anchor="middle" font-family="sans-serif" x="384" y="244">t</text>
  <text text-anchor="middle" font-family="sans-serif" x="152" y="36">n</text>
  <text text-anchor="middle" font-family="sans-serif" x="168" y="36">e</text>
  <text text-anchor="middle" font-family="sans-serif" x="280" y="36">h</text>
  <text text-anchor="middle" font-family="sans-serif" x="32" y="180">r</text>
  <text text-anchor="middle" font-family="sans-serif" x="48" y="180">a</text>
  <text text-anchor="middle" font-family="sans-serif" x="168" y="180">r</text>
  <text text-anchor="middle" font-family="sans-serif" x="256" y="180">C</text>
  <text text-anchor="middle" font-family="sans-serif" x="456" y="36">a</text>
  <text text-anchor="middle" font-family="sans-serif" x="464" y="36">g</text>
  <text text-anchor="middle" font-family="sans-serif" x="16" y="180">S</text>
  <text text-anchor="middle" font-family="sans-serif" x="272" y="116">p</text>
  <text text-anchor="middle" font-family="sans-serif" x="80" y="180">d</text>
  <text text-anchor="middle" font-family="sans-serif" x="56" y="116">m</text>
  <text text-anchor="middle" font-family="sans-serif" x="184" y="180">2</text>
  <text text-anchor="middle" font-family="sans-serif" x="448" y="36">T</text>
  <text text-anchor="middle" font-family="sans-serif" x="8" y="84">a</text>
  <text text-anchor="middle" font-family="sans-serif" x="16" y="116">S</text>
  <text text-anchor="middle" font-family="sans-serif" x="40" y="84">t</text>
  <text text-anchor="middle" font-family="sans-serif" x="328" y="116">t</text>
  <text text-anchor="middle" font-family="sans-serif" x="72" y="244">I</text>
  <text text-anchor="middle" font-family="sans-serif" x="240" y="244">C</text>
  <text text-anchor="middle" font-family="sans-serif" x="288" y="244">t</text>
  <text text-anchor="middle" font-family="sans-serif" x="24" y="4">m</text>
  <text text-anchor="middle" font-family="sans-serif" x="80" y="36">d</text>
  <text text-anchor="middle" font-family="sans-serif" x="272" y="36">p</text>
  <text text-anchor="middle" font-family="sans-serif" x="128" y="180">H</text>
  <text text-anchor="middle" font-family="sans-serif" x="248" y="244">i</text>
  <text text-anchor="middle" font-family="sans-serif" x="408" y="244">T</text>
  <text text-anchor="middle" font-family="sans-serif" x="24" y="84">k</text>
  <text text-anchor="middle" font-family="sans-serif" x="32" y="84">e</text>
  <text text-anchor="middle" font-family="sans-serif" x="24" y="180">t</text>
  <text text-anchor="middle" font-family="sans-serif" x="392" y="244">h</text>
  <text text-anchor="middle" font-family="sans-serif" x="16" y="36">S</text>
  <text text-anchor="middle" font-family="sans-serif" x="40" y="180">e</text>
  <text text-anchor="middle" font-family="sans-serif" x="256" y="244">p</text>
  <text text-anchor="middle" font-family="sans-serif" x="24" y="36">t</text>
  <text text-anchor="middle" font-family="sans-serif" x="32" y="36">r</text>
  <text text-anchor="middle" font-family="sans-serif" x="256" y="36">C</text>
  <text text-anchor="middle" font-family="sans-serif" x="32" y="244">r</text>
  <text text-anchor="middle" font-family="sans-serif" x="40" y="36">e</text>
  <text text-anchor="middle" font-family="sans-serif" x="136" y="116">e</text>
  <text text-anchor="middle" font-family="sans-serif" x="152" y="180">d</text>
  <text text-anchor="middle" font-family="sans-serif" x="80" y="116">d</text>
  <text text-anchor="middle" font-family="sans-serif" x="288" y="180">e</text>
  <text text-anchor="middle" font-family="sans-serif" x="136" y="244">e</text>
  <text text-anchor="middle" font-family="sans-serif" x="48" y="36">a</text>
  <text text-anchor="middle" font-family="sans-serif" x="312" y="36">e</text>
  <text text-anchor="middle" font-family="sans-serif" x="416" y="36">u</text>
  <text text-anchor="middle" font-family="sans-serif" x="136" y="180">e</text>
  <text text-anchor="middle" font-family="sans-serif" x="184" y="244">3</text>
  <text text-anchor="middle" font-family="sans-serif" x="320" y="36">x</text>
  <text text-anchor="middle" font-family="sans-serif" x="144" y="116">a</text>
  <text text-anchor="middle" font-family="sans-serif" x="328" y="180">t</text>
  <text text-anchor="middle" font-family="sans-serif" x="48" y="84">s</text>
  <text text-anchor="middle" font-family="sans-serif" x="256" y="116">C</text>
  <text text-anchor="middle" font-family="sans-serif" x="264" y="180">i</text>
  <text text-anchor="middle" font-family="sans-serif" x="0" y="4">F</text>
  <text text-anchor="middle" font-family="sans-serif" x="144" y="244">a</text>
  <text text-anchor="middle" font-family="sans-serif" x="152" y="244">d</text>
  <text text-anchor="middle" font-family="sans-serif" x="312" y="116">e</text>
  <text text-anchor="middle" font-family="sans-serif" x="80" y="244">d</text>
  <text text-anchor="middle" font-family="sans-serif" x="160" y="180">e</text>
  <text text-anchor="middle" font-family="sans-serif" x="312" y="180">e</text>
  <text text-anchor="middle" font-family="sans-serif" x="72" y="36">I</text>
  <text text-anchor="middle" font-family="sans-serif" x="152" y="116">d</text>
  <text text-anchor="middle" font-family="sans-serif" x="320" y="116">x</text>
  <text text-anchor="middle" font-family="sans-serif" x="72" y="116">I</text>
  <text text-anchor="middle" font-family="sans-serif" x="16" y="4">a</text>
  <text text-anchor="middle" font-family="sans-serif" x="144" y="36">o</text>
  <text text-anchor="middle" font-family="sans-serif" x="288" y="36">e</text>
  <text text-anchor="middle" font-family="sans-serif" x="296" y="116">r</text>
  <text text-anchor="middle" font-family="sans-serif" x="16" y="244">S</text>
  <text text-anchor="middle" font-family="sans-serif" x="424" y="244">g</text>
  <text text-anchor="middle" font-family="sans-serif" x="408" y="36">A</text>
  <text text-anchor="middle" font-family="sans-serif" x="432" y="36">h</text>
  <text text-anchor="middle" font-family="sans-serif" x="264" y="116">i</text>
  <text text-anchor="middle" font-family="sans-serif" x="296" y="180">r</text>
  <text text-anchor="middle" font-family="sans-serif" x="56" y="244">m</text>
  <text text-anchor="middle" font-family="sans-serif" x="136" y="36">N</text>
  <text text-anchor="middle" font-family="sans-serif" x="0" y="84">P</text>
  <text text-anchor="middle" font-family="sans-serif" x="280" y="180">h</text>
  <text text-anchor="middle" font-family="sans-serif" x="424" y="36">t</text>
  <text text-anchor="middle" font-family="sans-serif" x="304" y="244">x</text>
  <text text-anchor="middle" font-family="sans-serif" x="160" y="244">e</text>
  <text text-anchor="middle" font-family="sans-serif" x="56" y="36">m</text>
  <text text-anchor="middle" font-family="sans-serif" x="32" y="116">r</text>
  <text text-anchor="middle" font-family="sans-serif" x="320" y="180">x</text>
  <text text-anchor="middle" font-family="sans-serif" x="144" y="180">a</text>
  <text text-anchor="middle" font-family="sans-serif" x="128" y="244">H</text>
  <text text-anchor="middle" font-family="sans-serif" x="416" y="244">a</text>
  <text text-anchor="middle" font-family="sans-serif" x="296" y="36">r</text>
  <text text-anchor="middle" font-family="sans-serif" x="288" y="116">e</text>
  <text text-anchor="middle" font-family="sans-serif" x="272" y="180">p</text>
  <text text-anchor="middle" font-family="sans-serif" x="160" y="36">c</text>
  <text text-anchor="middle" font-family="sans-serif" x="160" y="116">e</text>
</g></svg>
                                        <figcaption>
                                          <a href="n-datagram-packetization-across-multiple-packets">Figure 17</a>
:                                          <a href="null" id="null" class="selfRef">Datagram packetization across multiple packets.</a>
                                        </figcaption>
                                      </div>
                                      <p id="s-3_6-5">RDP Datagram packetization is analogous to IP packet fragmentation except that it actually works.<a class="pilcrow" href="#s-3_6-5">&para;</a></p>
                                    </figure>
                                    
                                    <section id="n-packet-header">
                                      <h5 id="s-3_6_1">
                                        <a class="selfRef" href="#s-3_6_1">3.6.1.</a>
                                        <a class="selfRef" href="#n-packet-header">Packet Header</a>
                                      </h5>
                                      <p id="s-3_6_1-1">The packet header block appears immediately after the Stream identifier. It specifies the information used to reassemble packets in order to form a complete datagram, to acknowledge packet receipt, and other control information.<a class="pilcrow" href="#s-3_6_1-1">&para;</a></p>
                                      <dl id="s-3_6_1-2-" class="nohang">
                                        <dt id="s-3_6_1-2">Datagram index<a class="pilcrow" href="#s-3_6_1-2">&para;</a></dt>
                                        <dd id="null">Integer counter beginning at 0 and incremented by 1 for each partial or final datagram sent in the stream.<a class="pilcrow" href="#">&para;</a></dd>
                                        <dt id="s-3_6_1-3">Packet count<a class="pilcrow" href="#s-3_6_1-3">&para;</a></dt>
                                        <dd id="null">Integer specifying the number of packets in the datagram<a class="pilcrow" href="#">&para;</a></dd>
                                        <dt id="s-3_6_1-4">Packet sent index<a class="pilcrow" href="#s-3_6_1-4">&para;</a></dt>
                                        <dd id="null">Integer counter beginning at 0 and incremented by 1 for each packet sent wrapping at 15 bits.<a class="pilcrow" href="#">&para;</a></dd>
                                        <dt id="s-3_6_1-5">Retransmit index<a class="pilcrow" href="#s-3_6_1-5">&para;</a></dt>
                                        <dd id="null">Integer incremented each time a packet is resent. Since the resent data is identical, it is only necessary to acknowledge data once even if multiple copies are received.<a class="pilcrow" href="#">&para;</a></dd>
                                        <dt id="s-3_6_1-6">Continuation Datagram flag.<a class="pilcrow" href="#s-3_6_1-6">&para;</a></dt>
                                        <dd id="null">Integer containing flags information. The low order bit (0) is 0 for a partial datagram and 1 for a final datagram.<a class="pilcrow" href="#">&para;</a></dd>
                                        <dt id="s-3_6_1-7">Received index<a class="pilcrow" href="#s-3_6_1-7">&para;</a></dt>
                                        <dd id="null">Integer index of the first packet being acknowledged.<a class="pilcrow" href="#">&para;</a></dd>
                                        <dt id="s-3_6_1-8">Acknowledgements<a class="pilcrow" href="#s-3_6_1-8">&para;</a></dt>
                                        <dd id="null">Bitfield containing the value 1 for packets that have been received and 0 otherwise. <a class="pilcrow" href="#">&para;</a></dd>
                                      </dl>
                                      <figure id="f-16">
                                        <div class="artwork art-svg" id="n-flow-control-packet-header">
                                          <a class="pilcrow" href="#n-flow-control-packet-header">&para;</a>
<svg width="536" height="217" xmlns="http://www.w3.org/2000/svg" >
<g transform="translate(8,16)">
  <path d="M 0,0 L 80,0" fill="none" stroke="black" />
  <path d="M 80,0 L 160,0" fill="none" stroke="black" />
  <path d="M 160,0 L 240,0" fill="none" stroke="black" />
  <path d="M 240,0 L 320,0" fill="none" stroke="black" />
  <path d="M 320,0 L 400,0" fill="none" stroke="black" />
  <path d="M 400,0 L 520,0" fill="none" stroke="black" />
  <path d="M 0,64 L 80,64" fill="none" stroke="black" />
  <path d="M 80,64 L 160,64" fill="none" stroke="black" />
  <path d="M 160,64 L 240,64" fill="none" stroke="black" />
  <path d="M 240,64 L 264,64" fill="none" stroke="black" />
  <path d="M 264,64 L 320,64" fill="none" stroke="black" />
  <path d="M 320,64 L 400,64" fill="none" stroke="black" />
  <path d="M 400,64 L 520,64" fill="none" stroke="black" />
  <path d="M 0,128 L 520,128" fill="none" stroke="black" />
  <path d="M 0,192 L 520,192" fill="none" stroke="black" />
  <path d="M 0,0 L 0,64" fill="none" stroke="black" />
  <path d="M 0,128 L 0,192" fill="none" stroke="black" />
  <path d="M 80,0 L 80,64" fill="none" stroke="black" />
  <path d="M 160,0 L 160,64" fill="none" stroke="black" />
  <path d="M 240,0 L 240,64" fill="none" stroke="black" />
  <path d="M 264,64 L 264,112" fill="none" stroke="black" />
  <path d="M 320,0 L 320,64" fill="none" stroke="black" />
  <path d="M 400,0 L 400,64" fill="none" stroke="black" />
  <path d="M 520,0 L 520,64" fill="none" stroke="black" />
  <path d="M 520,128 L 520,192" fill="none" stroke="black" />
  <path d="M 264,112 L 264,120" fill="none" stroke="black" />
  <polygon points="280.000000,112.000000 268.000000,106.400002 268.000000,117.599998" fill="black" transform="rotate(90.000000, 264.000000, 112.000000)" />
  <text text-anchor="middle" font-family="sans-serif" x="192" y="52">b</text>
  <text text-anchor="middle" font-family="sans-serif" x="216" y="52">e</text>
  <text text-anchor="middle" font-family="sans-serif" x="56" y="20">e</text>
  <text text-anchor="middle" font-family="sans-serif" x="344" y="20">a</text>
  <text text-anchor="middle" font-family="sans-serif" x="424" y="20">k</text>
  <text text-anchor="middle" font-family="sans-serif" x="480" y="20">e</text>
  <text text-anchor="middle" font-family="sans-serif" x="184" y="36">e</text>
  <text text-anchor="middle" font-family="sans-serif" x="56" y="52">e</text>
  <text text-anchor="middle" font-family="sans-serif" x="280" y="148">k</text>
  <text text-anchor="middle" font-family="sans-serif" x="232" y="180">1</text>
  <text text-anchor="middle" font-family="sans-serif" x="264" y="20">a</text>
  <text text-anchor="middle" font-family="sans-serif" x="296" y="36">x</text>
  <text text-anchor="middle" font-family="sans-serif" x="280" y="100">A</text>
  <text text-anchor="middle" font-family="sans-serif" x="208" y="148">y</text>
  <text text-anchor="middle" font-family="sans-serif" x="288" y="180">s</text>
  <text text-anchor="middle" font-family="sans-serif" x="216" y="20">e</text>
  <text text-anchor="middle" font-family="sans-serif" x="472" y="52">e</text>
  <text text-anchor="middle" font-family="sans-serif" x="216" y="148">p</text>
  <text text-anchor="middle" font-family="sans-serif" x="328" y="148">a</text>
  <text text-anchor="middle" font-family="sans-serif" x="488" y="20">m</text>
  <text text-anchor="middle" font-family="sans-serif" x="264" y="36">I</text>
  <text text-anchor="middle" font-family="sans-serif" x="328" y="100">)</text>
  <text text-anchor="middle" font-family="sans-serif" x="192" y="20">r</text>
  <text text-anchor="middle" font-family="sans-serif" x="200" y="20">a</text>
  <text text-anchor="middle" font-family="sans-serif" x="408" y="20">A</text>
  <text text-anchor="middle" font-family="sans-serif" x="432" y="20">n</text>
  <text text-anchor="middle" font-family="sans-serif" x="208" y="52">t</text>
  <text text-anchor="middle" font-family="sans-serif" x="352" y="52">b</text>
  <text text-anchor="middle" font-family="sans-serif" x="432" y="52">6</text>
  <text text-anchor="middle" font-family="sans-serif" x="240" y="180">6</text>
  <text text-anchor="middle" font-family="sans-serif" x="504" y="20">n</text>
  <text text-anchor="middle" font-family="sans-serif" x="24" y="36">I</text>
  <text text-anchor="middle" font-family="sans-serif" x="360" y="36">e</text>
  <text text-anchor="middle" font-family="sans-serif" x="336" y="52">1</text>
  <text text-anchor="middle" font-family="sans-serif" x="32" y="20">r</text>
  <text text-anchor="middle" font-family="sans-serif" x="256" y="20">P</text>
  <text text-anchor="middle" font-family="sans-serif" x="288" y="20">e</text>
  <text text-anchor="middle" font-family="sans-serif" x="416" y="20">c</text>
  <text text-anchor="middle" font-family="sans-serif" x="240" y="148">d</text>
  <text text-anchor="middle" font-family="sans-serif" x="256" y="180">b</text>
  <text text-anchor="middle" font-family="sans-serif" x="288" y="148">e</text>
  <text text-anchor="middle" font-family="sans-serif" x="272" y="180">t</text>
  <text text-anchor="middle" font-family="sans-serif" x="40" y="20">a</text>
  <text text-anchor="middle" font-family="sans-serif" x="448" y="20">w</text>
  <text text-anchor="middle" font-family="sans-serif" x="48" y="36">e</text>
  <text text-anchor="middle" font-family="sans-serif" x="376" y="52">e</text>
  <text text-anchor="middle" font-family="sans-serif" x="200" y="148">r</text>
  <text text-anchor="middle" font-family="sans-serif" x="184" y="20">F</text>
  <text text-anchor="middle" font-family="sans-serif" x="280" y="20">k</text>
  <text text-anchor="middle" font-family="sans-serif" x="376" y="36">c</text>
  <text text-anchor="middle" font-family="sans-serif" x="360" y="52">y</text>
  <text text-anchor="middle" font-family="sans-serif" x="296" y="52">e</text>
  <text text-anchor="middle" font-family="sans-serif" x="464" y="52">t</text>
  <text text-anchor="middle" font-family="sans-serif" x="344" y="148">e</text>
  <text text-anchor="middle" font-family="sans-serif" x="112" y="20">l</text>
  <text text-anchor="middle" font-family="sans-serif" x="200" y="36">g</text>
  <text text-anchor="middle" font-family="sans-serif" x="488" y="36">d</text>
  <text text-anchor="middle" font-family="sans-serif" x="280" y="52">y</text>
  <text text-anchor="middle" font-family="sans-serif" x="136" y="20">s</text>
  <text text-anchor="middle" font-family="sans-serif" x="120" y="52">y</text>
  <text text-anchor="middle" font-family="sans-serif" x="192" y="148">c</text>
  <text text-anchor="middle" font-family="sans-serif" x="264" y="180">y</text>
  <text text-anchor="middle" font-family="sans-serif" x="496" y="20">e</text>
  <text text-anchor="middle" font-family="sans-serif" x="32" y="36">n</text>
  <text text-anchor="middle" font-family="sans-serif" x="480" y="36">l</text>
  <text text-anchor="middle" font-family="sans-serif" x="312" y="148">H</text>
  <text text-anchor="middle" font-family="sans-serif" x="352" y="20">c</text>
  <text text-anchor="middle" font-family="sans-serif" x="384" y="36">e</text>
  <text text-anchor="middle" font-family="sans-serif" x="288" y="52">t</text>
  <text text-anchor="middle" font-family="sans-serif" x="448" y="52">b</text>
  <text text-anchor="middle" font-family="sans-serif" x="456" y="52">y</text>
  <text text-anchor="middle" font-family="sans-serif" x="320" y="148">e</text>
  <text text-anchor="middle" font-family="sans-serif" x="336" y="20">P</text>
  <text text-anchor="middle" font-family="sans-serif" x="456" y="20">l</text>
  <text text-anchor="middle" font-family="sans-serif" x="424" y="36">b</text>
  <text text-anchor="middle" font-family="sans-serif" x="472" y="36">e</text>
  <text text-anchor="middle" font-family="sans-serif" x="176" y="36">L</text>
  <text text-anchor="middle" font-family="sans-serif" x="128" y="52">t</text>
  <text text-anchor="middle" font-family="sans-serif" x="288" y="100">E</text>
  <text text-anchor="middle" font-family="sans-serif" x="176" y="148">E</text>
  <text text-anchor="middle" font-family="sans-serif" x="48" y="20">m</text>
  <text text-anchor="middle" font-family="sans-serif" x="104" y="20">F</text>
  <text text-anchor="middle" font-family="sans-serif" x="96" y="52">1</text>
  <text text-anchor="middle" font-family="sans-serif" x="264" y="148">a</text>
  <text text-anchor="middle" font-family="sans-serif" x="320" y="100">k</text>
  <text text-anchor="middle" font-family="sans-serif" x="24" y="20">F</text>
  <text text-anchor="middle" font-family="sans-serif" x="296" y="20">t</text>
  <text text-anchor="middle" font-family="sans-serif" x="336" y="36">e</text>
  <text text-anchor="middle" font-family="sans-serif" x="40" y="52">y</text>
  <text text-anchor="middle" font-family="sans-serif" x="128" y="20">g</text>
  <text text-anchor="middle" font-family="sans-serif" x="456" y="36">f</text>
  <text text-anchor="middle" font-family="sans-serif" x="480" y="52">s</text>
  <text text-anchor="middle" font-family="sans-serif" x="272" y="36">n</text>
  <text text-anchor="middle" font-family="sans-serif" x="48" y="52">t</text>
  <text text-anchor="middle" font-family="sans-serif" x="440" y="20">o</text>
  <text text-anchor="middle" font-family="sans-serif" x="464" y="36">i</text>
  <text text-anchor="middle" font-family="sans-serif" x="40" y="36">d</text>
  <text text-anchor="middle" font-family="sans-serif" x="16" y="52">6</text>
  <text text-anchor="middle" font-family="sans-serif" x="312" y="100">(</text>
  <text text-anchor="middle" font-family="sans-serif" x="256" y="148">P</text>
  <text text-anchor="middle" font-family="sans-serif" x="56" y="36">x</text>
  <text text-anchor="middle" font-family="sans-serif" x="272" y="52">b</text>
  <text text-anchor="middle" font-family="sans-serif" x="352" y="148">r</text>
  <text text-anchor="middle" font-family="sans-serif" x="368" y="20">e</text>
  <text text-anchor="middle" font-family="sans-serif" x="512" y="20">t</text>
  <text text-anchor="middle" font-family="sans-serif" x="344" y="36">q</text>
  <text text-anchor="middle" font-family="sans-serif" x="296" y="148">t</text>
  <text text-anchor="middle" font-family="sans-serif" x="208" y="36">t</text>
  <text text-anchor="middle" font-family="sans-serif" x="192" y="36">n</text>
  <text text-anchor="middle" font-family="sans-serif" x="216" y="36">h</text>
  <text text-anchor="middle" font-family="sans-serif" x="328" y="36">S</text>
  <text text-anchor="middle" font-family="sans-serif" x="368" y="52">t</text>
  <text text-anchor="middle" font-family="sans-serif" x="224" y="148">t</text>
  <text text-anchor="middle" font-family="sans-serif" x="272" y="148">c</text>
  <text text-anchor="middle" font-family="sans-serif" x="336" y="148">d</text>
  <text text-anchor="middle" font-family="sans-serif" x="376" y="20">t</text>
  <text text-anchor="middle" font-family="sans-serif" x="288" y="36">e</text>
  <text text-anchor="middle" font-family="sans-serif" x="32" y="52">b</text>
  <text text-anchor="middle" font-family="sans-serif" x="136" y="52">e</text>
  <text text-anchor="middle" font-family="sans-serif" x="280" y="180">e</text>
  <text text-anchor="middle" font-family="sans-serif" x="440" y="36">t</text>
  <text text-anchor="middle" font-family="sans-serif" x="64" y="52">s</text>
  <text text-anchor="middle" font-family="sans-serif" x="200" y="52">y</text>
  <text text-anchor="middle" font-family="sans-serif" x="272" y="20">c</text>
  <text text-anchor="middle" font-family="sans-serif" x="368" y="36">n</text>
  <text text-anchor="middle" font-family="sans-serif" x="176" y="52">1</text>
  <text text-anchor="middle" font-family="sans-serif" x="472" y="20">g</text>
  <text text-anchor="middle" font-family="sans-serif" x="280" y="36">d</text>
  <text text-anchor="middle" font-family="sans-serif" x="432" y="36">i</text>
  <text text-anchor="middle" font-family="sans-serif" x="120" y="20">a</text>
  <text text-anchor="middle" font-family="sans-serif" x="256" y="52">1</text>
  <text text-anchor="middle" font-family="sans-serif" x="232" y="148">e</text>
  <text text-anchor="middle" font-family="sans-serif" x="360" y="20">k</text>
  <text text-anchor="middle" font-family="sans-serif" x="464" y="20">e</text>
  <text text-anchor="middle" font-family="sans-serif" x="112" y="52">b</text>
  <text text-anchor="middle" font-family="sans-serif" x="184" y="148">n</text>
  <text text-anchor="middle" font-family="sans-serif" x="208" y="20">m</text>
  <text text-anchor="middle" font-family="sans-serif" x="352" y="36">u</text>
  <text text-anchor="middle" font-family="sans-serif" x="296" y="100">S</text>
</g></svg>
                                          <figcaption>
                                            <a href="n-flow-control-packet-header">Figure 16</a>
:                                            <a href="null" id="null" class="selfRef">Flow control packet header</a>
                                          </figcaption>
                                        </div>
                                      </figure>
                                      
                                      <section id="n-flow-control">
                                        <h5 id="s-3_6_2">
                                          <a class="selfRef" href="#s-3_6_2">3.6.2.</a>
                                          <a class="selfRef" href="#n-flow-control">Flow Control</a>
                                        </h5>
                                        <p id="s-3_6_2-1">TCP flow control is designed to meet the needs of the day. Modern networks have very different needs.<a class="pilcrow" href="#s-3_6_2-1">&para;</a></p>
                                        <p id="s-3_6_2-2">Congestion avoidance is still important and implementations <span class="bcp14">MUST</span> take steps to avoid overburdening network resources.<a class="pilcrow" href="#s-3_6_2-2">&para;</a></p>
                                        <p id="s-3_6_2-3">May require additional packets that only contain flow control info. This <span class="bcp14">MAY</span> be used to communicate One time Stream IDs.<a class="pilcrow" href="#s-3_6_2-3">&para;</a></p>
                                        <p id="s-3_6_2-4">Congestion control limits <span class="bcp14">MAY</span> be specified for the connection as a whole and for individual ports. In situations where multiple Internet connections are available, applications <span class="bcp14">MUST</span> enforce flow control limits on each port.<a class="pilcrow" href="#s-3_6_2-4">&para;</a></p>
                                        <p id="s-3_6_2-5">[Here describe the feedback characteristics determined through experimentation.]<a class="pilcrow" href="#s-3_6_2-5">&para;</a></p>
                                      </section>
                                      
                                      <section id="n-connection-datagrams">
                                        <h4 id="s-3_7">
                                          <a class="selfRef" href="#s-3_7">3.7.</a>
                                          <a class="selfRef" href="#n-connection-datagrams">Connection Datagrams</a>
                                        </h4>
                                        <p id="s-3_7-1">Connection Datagrams are used during the key exchange used to establish a connection. Unlike data Datagrams in which have a single data section, all of which is encrypted, connection Datagrams may contain three separate types of data section:<a class="pilcrow" href="#s-3_7-1">&para;</a></p>
                                        <dl id="s-3_7-2-" class="nohang">
                                          <dt id="s-3_7-2">Plaintext data<a class="pilcrow" href="#s-3_7-2">&para;</a></dt>
                                          <dd id="null">Unencrypted data section. This is used to pass the information needed to perform the 'mezzanine' key exchange to the responder's credential and to present and respond to challenges.<a class="pilcrow" href="#">&para;</a></dd>
                                          <dt id="s-3_7-3">Mezzanine data<a class="pilcrow" href="#s-3_7-3">&para;</a></dt>
                                          <dd id="null">Data encrypted under 'mezzanine' key exchange authenticated by the responder's credential alone. This is used to pass information related to the initiator credential.<a class="pilcrow" href="#">&para;</a></dd>
                                          <dt id="s-3_7-4">Ciphertext data<a class="pilcrow" href="#s-3_7-4">&para;</a></dt>
                                          <dd id="null">Data encrypted under the mutual key exchange authenticated to the credentials of the initiator and the responder.<a class="pilcrow" href="#">&para;</a></dd>
                                        </dl>
                                        <p id="s-3_7-5">The <code>ClientCompleteDeferred</code> Datagram contains all three data sections. The ciphertext data section is encapsulated inside the Mezzanine data section and is thus encrypted twice. Only the Mezzanine section is padded.<a class="pilcrow" href="#s-3_7-5">&para;</a></p>
                                        <figure id="f-18">
                                          <div class="artwork art-svg" id="n-connection-datagram-format">
                                            <a class="pilcrow" href="#n-connection-datagram-format">&para;</a>
<svg width="536" height="89" xmlns="http://www.w3.org/2000/svg" >
<g transform="translate(8,16)">
  <path d="M 0,0 L 96,0" fill="none" stroke="black" />
  <path d="M 96,0 L 192,0" fill="none" stroke="black" />
  <path d="M 192,0 L 520,0" fill="none" stroke="black" />
  <path d="M 192,32 L 328,32" fill="none" stroke="black" />
  <path d="M 328,32 L 416,32" fill="none" stroke="black" />
  <path d="M 416,32 L 472,32" fill="none" stroke="black" />
  <path d="M 472,32 L 520,32" fill="none" stroke="black" />
  <path d="M 0,64 L 96,64" fill="none" stroke="black" />
  <path d="M 96,64 L 192,64" fill="none" stroke="black" />
  <path d="M 192,64 L 328,64" fill="none" stroke="black" />
  <path d="M 328,64 L 416,64" fill="none" stroke="black" />
  <path d="M 416,64 L 472,64" fill="none" stroke="black" />
  <path d="M 472,64 L 520,64" fill="none" stroke="black" />
  <path d="M 0,0 L 0,64" fill="none" stroke="black" />
  <path d="M 96,0 L 96,64" fill="none" stroke="black" />
  <path d="M 192,0 L 192,32" fill="none" stroke="black" />
  <path d="M 192,32 L 192,64" fill="none" stroke="black" />
  <path d="M 328,32 L 328,64" fill="none" stroke="black" />
  <path d="M 472,32 L 472,64" fill="none" stroke="black" />
  <path d="M 520,0 L 520,32" fill="none" stroke="black" />
  <path d="M 520,32 L 520,64" fill="none" stroke="black" />
  <text text-anchor="middle" font-family="sans-serif" x="376" y="20">n</text>
  <text text-anchor="middle" font-family="sans-serif" x="48" y="36">a</text>
  <text text-anchor="middle" font-family="sans-serif" x="272" y="52">e</text>
  <text text-anchor="middle" font-family="sans-serif" x="384" y="52">r</text>
  <text text-anchor="middle" font-family="sans-serif" x="392" y="20">n</text>
  <text text-anchor="middle" font-family="sans-serif" x="144" y="36">n</text>
  <text text-anchor="middle" font-family="sans-serif" x="288" y="52">D</text>
  <text text-anchor="middle" font-family="sans-serif" x="344" y="52">C</text>
  <text text-anchor="middle" font-family="sans-serif" x="368" y="52">h</text>
  <text text-anchor="middle" font-family="sans-serif" x="448" y="52">t</text>
  <text text-anchor="middle" font-family="sans-serif" x="296" y="52">a</text>
  <text text-anchor="middle" font-family="sans-serif" x="264" y="52">n</text>
  <text text-anchor="middle" font-family="sans-serif" x="384" y="20">i</text>
  <text text-anchor="middle" font-family="sans-serif" x="152" y="36">t</text>
  <text text-anchor="middle" font-family="sans-serif" x="456" y="52">a</text>
  <text text-anchor="middle" font-family="sans-serif" x="24" y="36">t</text>
  <text text-anchor="middle" font-family="sans-serif" x="32" y="36">r</text>
  <text text-anchor="middle" font-family="sans-serif" x="256" y="52">i</text>
  <text text-anchor="middle" font-family="sans-serif" x="408" y="52">x</text>
  <text text-anchor="middle" font-family="sans-serif" x="440" y="52">a</text>
  <text text-anchor="middle" font-family="sans-serif" x="80" y="36">d</text>
  <text text-anchor="middle" font-family="sans-serif" x="112" y="36">P</text>
  <text text-anchor="middle" font-family="sans-serif" x="160" y="36">e</text>
  <text text-anchor="middle" font-family="sans-serif" x="232" y="52">z</text>
  <text text-anchor="middle" font-family="sans-serif" x="304" y="52">t</text>
  <text text-anchor="middle" font-family="sans-serif" x="352" y="52">i</text>
  <text text-anchor="middle" font-family="sans-serif" x="432" y="52">D</text>
  <text text-anchor="middle" font-family="sans-serif" x="352" y="20">z</text>
  <text text-anchor="middle" font-family="sans-serif" x="120" y="36">l</text>
  <text text-anchor="middle" font-family="sans-serif" x="128" y="36">a</text>
  <text text-anchor="middle" font-family="sans-serif" x="376" y="52">e</text>
  <text text-anchor="middle" font-family="sans-serif" x="392" y="52">t</text>
  <text text-anchor="middle" font-family="sans-serif" x="368" y="20">a</text>
  <text text-anchor="middle" font-family="sans-serif" x="248" y="52">n</text>
  <text text-anchor="middle" font-family="sans-serif" x="496" y="52">a</text>
  <text text-anchor="middle" font-family="sans-serif" x="168" y="36">x</text>
  <text text-anchor="middle" font-family="sans-serif" x="240" y="52">a</text>
  <text text-anchor="middle" font-family="sans-serif" x="400" y="20">e</text>
  <text text-anchor="middle" font-family="sans-serif" x="40" y="36">e</text>
  <text text-anchor="middle" font-family="sans-serif" x="136" y="36">i</text>
  <text text-anchor="middle" font-family="sans-serif" x="208" y="52">M</text>
  <text text-anchor="middle" font-family="sans-serif" x="216" y="52">e</text>
  <text text-anchor="middle" font-family="sans-serif" x="400" y="52">e</text>
  <text text-anchor="middle" font-family="sans-serif" x="504" y="52">d</text>
  <text text-anchor="middle" font-family="sans-serif" x="16" y="36">S</text>
  <text text-anchor="middle" font-family="sans-serif" x="56" y="36">m</text>
  <text text-anchor="middle" font-family="sans-serif" x="72" y="36">I</text>
  <text text-anchor="middle" font-family="sans-serif" x="360" y="52">p</text>
  <text text-anchor="middle" font-family="sans-serif" x="344" y="20">e</text>
  <text text-anchor="middle" font-family="sans-serif" x="336" y="20">M</text>
  <text text-anchor="middle" font-family="sans-serif" x="176" y="36">t</text>
  <text text-anchor="middle" font-family="sans-serif" x="224" y="52">z</text>
  <text text-anchor="middle" font-family="sans-serif" x="312" y="52">a</text>
  <text text-anchor="middle" font-family="sans-serif" x="488" y="52">P</text>
  <text text-anchor="middle" font-family="sans-serif" x="360" y="20">z</text>
  <text text-anchor="middle" font-family="sans-serif" x="416" y="52">t</text>
</g></svg>
                                            <figcaption>
                                              <a href="n-connection-datagram-format">Figure 18</a>
:                                              <a href="null" id="null" class="selfRef">Connection Datagram Format.</a>
                                            </figcaption>
                                          </div>
                                          <p id="s-3_7-7">A connection Datagram <span class="bcp14">MAY</span> contain a payload. This is always carried in the last data section.<a class="pilcrow" href="#s-3_7-7">&para;</a></p>
                                          <p id="s-3_7-8">Connection Datagrams that only contain plaintext data <span class="bcp14">MUST NOT</span> contain confidential data. This requirement may be enforced in a future revision of the specification by limiting use to a 'service discovery' protocol.<a class="pilcrow" href="#s-3_7-8">&para;</a></p>
                                        </figure>
                                        
                                        <section id="n-connection-establishment-and-maintenance">
                                          <h3 id="s-4">
                                            <a class="selfRef" href="#s-4">4.</a>
                                            <a class="selfRef" href="#n-connection-establishment-and-maintenance">Connection Establishment and Maintenance</a>
                                          </h3>
                                        </section>
                                        
                                        <section id="n-key-exchange-modes">
                                          <h4 id="s-4_1">
                                            <a class="selfRef" href="#s-4_1">4.1.</a>
                                            <a class="selfRef" href="#n-key-exchange-modes">Key Exchange modes</a>
                                          </h4>
                                          <p id="s-4_1-1">Three key exchange mechanisms are supported. The choice of mechanism depending on whether the initiator knows the credentials of the host and on whether the host is willing to perform a key exchange operation without challenge:<a class="pilcrow" href="#s-4_1-1">&para;</a></p>
                                          <dl id="s-4_1-2-" class="nohang">
                                            <dt id="s-4_1-2">First Contact<a class="pilcrow" href="#s-4_1-2">&para;</a></dt>
                                            <dd id="null">The only key exchange mode supported when the client does not know the responder credential. This is a two-round exchange in which the payload of the first round is limited to plaintext data. <a class="pilcrow" href="#">&para;</a></dd>
                                            <dt id="s-4_1-3">Immediate<a class="pilcrow" href="#s-4_1-3">&para;</a></dt>
                                            <dd id="null">A key exchange in which the initiator knows the responder and offers a complete mutual key exchange in the first message. If accepted by the responder, this exchange requires only a single round which <span class="bcp14">MAY</span> carry ciphertext payload.<a class="pilcrow" href="#">&para;</a></dd>
                                            <dt id="s-4_1-4">Deferred<a class="pilcrow" href="#s-4_1-4">&para;</a></dt>
                                            <dd id="null">A variation of the zero round trip exchange in which the responder returns a plaintext challenge to the initiator instead of immediately accepting the key exchange. This permits mitigation of denial-of-service attacks.<a class="pilcrow" href="#">&para;</a></dd>
                                          </dl>
                                          <p id="s-4_1-5">Unlike other RDP interactions, the response to a connection establishment request <span class="bcp14">MUST</span> be returned to the network endpoint from which it was received.<a class="pilcrow" href="#s-4_1-5">&para;</a></p>
                                          <p id="s-4_1-6">The <code>InitiatorHello</code> datagram and <code>InitiatorExchange</code> datagram are special in that they <span class="bcp14">MUST</span> be presented in a single packet and <span class="bcp14">MUST</span> use the Stream Identifier consisting of sixteen zero bytes.<a class="pilcrow" href="#s-4_1-6">&para;</a></p>
                                        </section>
                                        
                                        <section id="n-first-contact">
                                          <h5 id="s-4_1_1">
                                            <a class="selfRef" href="#s-4_1_1">4.1.1.</a>
                                            <a class="selfRef" href="#n-first-contact">First Contact</a>
                                          </h5>
                                          <p id="s-4_1_1-1">The first contact exchange comprises two round trips:<a class="pilcrow" href="#s-4_1_1-1">&para;</a></p>
                                          <dl id="s-4_1_1-2-" class="nohang">
                                            <dt id="s-4_1_1-2"><code>InitiatorHello</code><a class="pilcrow" href="#s-4_1_1-2">&para;</a></dt>
                                            <dd id="null">[Plaintext] Stream ID, Payload<a class="pilcrow" href="#">&para;</a></dd>
                                            <dt id="s-4_1_1-3"><code>ResponderChallenge</code><a class="pilcrow" href="#s-4_1_1-3">&para;</a></dt>
                                            <dd id="null">[Plaintext] Responder credential, <a class="pilcrow" href="#">&para;</a></dd>
                                            <dd id="null">[Plaintext] Set of responder ephemeral keys<a class="pilcrow" href="#">&para;</a></dd>
                                            <dd id="null">[Plaintext] Challenge<a class="pilcrow" href="#">&para;</a></dd>
                                            <dd id="null">[Plaintext] Stream ID, Payload<a class="pilcrow" href="#">&para;</a></dd>
                                            <dt id="s-4_1_1-4"><code>InitiatorComplete</code><a class="pilcrow" href="#s-4_1_1-4">&para;</a></dt>
                                            <dd id="null">[Plaintext] Responder key identifier<a class="pilcrow" href="#">&para;</a></dd>
                                            <dd id="null">[Plaintext] Initiator Ephemeral<a class="pilcrow" href="#">&para;</a></dd>
                                            <dd id="null">[Plaintext] Response to Challenge<a class="pilcrow" href="#">&para;</a></dd>
                                            <dd id="null">[Mezzanine] Initiator Credential + Initiator key identifier<a class="pilcrow" href="#">&para;</a></dd>
                                            <dd id="null">[Encrypted] Stream ID, Payload<a class="pilcrow" href="#">&para;</a></dd>
                                            <dt id="s-4_1_1-5"><code>Data</code><a class="pilcrow" href="#s-4_1_1-5">&para;</a></dt>
                                            <dd id="null">[Encrypted] Stream ID, Payload<a class="pilcrow" href="#">&para;</a></dd>
                                          </dl>
                                          <p id="s-4_1_1-6">For example…<a class="pilcrow" href="#s-4_1_1-6">&para;</a></p>
                                          <p id="s-4_1_1-7">Key exchange example TBS <a class="pilcrow" href="#s-4_1_1-7">&para;</a></p>
                                          <p id="s-4_1_1-8">Since the InitiatorHello and InitiatorComplete payloads are always sent <i>en clair</i>, these are only available for use in querying the public capabilities exposed by the responder. For example, the set of services offered.<a class="pilcrow" href="#s-4_1_1-8">&para;</a></p>
                                        </section>
                                        
                                        <section id="n-immediate">
                                          <h5 id="s-4_1_2">
                                            <a class="selfRef" href="#s-4_1_2">4.1.2.</a>
                                            <a class="selfRef" href="#n-immediate">Immediate</a>
                                          </h5>
                                          <p id="s-4_1_2-1">The immediate exchange comprises a single round trip:<a class="pilcrow" href="#s-4_1_2-1">&para;</a></p>
                                          <dl id="s-4_1_2-2-" class="nohang">
                                            <dt id="s-4_1_2-2"><code>InitiatorExchange</code><a class="pilcrow" href="#s-4_1_2-2">&para;</a></dt>
                                            <dd id="null">[Plaintext] Responder key identifier<a class="pilcrow" href="#">&para;</a></dd>
                                            <dd id="null">[Plaintext] Initiator Ephemeral<a class="pilcrow" href="#">&para;</a></dd>
                                            <dd id="null">[Mezzanine] Initiator Credential + Initiator key identifier<a class="pilcrow" href="#">&para;</a></dd>
                                            <dd id="null">[Mezzanine] Stream ID, Payload<a class="pilcrow" href="#">&para;</a></dd>
                                            <dt id="s-4_1_2-3"><code>ResponderComplete</code><a class="pilcrow" href="#s-4_1_2-3">&para;</a></dt>
                                            <dd id="null">[Mezzanine] Initiator key identifier<a class="pilcrow" href="#">&para;</a></dd>
                                            <dd id="null">[Mezzanine] Responder Ephemeral<a class="pilcrow" href="#">&para;</a></dd>
                                            <dd id="null">[Encrypted] Stream ID, Payload<a class="pilcrow" href="#">&para;</a></dd>
                                          </dl>
                                          <p id="s-4_1_2-4">Note that in this case the initial initiator payload is only encrypted, it is only authenticated to the responder since the responder has not contributed any form of challenge data to the initiator. <a class="pilcrow" href="#s-4_1_2-4">&para;</a></p>
                                          <p id="s-4_1_2-5">For example…<a class="pilcrow" href="#s-4_1_2-5">&para;</a></p>
                                          <p id="s-4_1_2-6">Key exchange example TBS <a class="pilcrow" href="#s-4_1_2-6">&para;</a></p>
                                          <p id="s-4_1_2-7"><a class="pilcrow" href="#s-4_1_2-7">&para;</a></p>
                                        </section>
                                        
                                        <section id="n-deferred-trip">
                                          <h5 id="s-4_1_3">
                                            <a class="selfRef" href="#s-4_1_3">4.1.3.</a>
                                            <a class="selfRef" href="#n-deferred-trip">Deferred Trip</a>
                                          </h5>
                                          <p id="s-4_1_3-1">The deferred exchange is an alternative to the immediate exchange that is performed at the option of the responder. Instead of accepting the connection request immediately, the initiator defers acceptance of the request until the initiator has given a correct response to a challenge:<a class="pilcrow" href="#s-4_1_3-1">&para;</a></p>
                                          <dl id="s-4_1_3-2-" class="nohang">
                                            <dt id="s-4_1_3-2"><code>InitiatorExchange</code><a class="pilcrow" href="#s-4_1_3-2">&para;</a></dt>
                                            <dd id="null">(As for the Immediate case)<a class="pilcrow" href="#">&para;</a></dd>
                                            <dt id="s-4_1_3-3"><code>ResponderDefer</code><a class="pilcrow" href="#s-4_1_3-3">&para;</a></dt>
                                            <dd id="null">[Plaintext] Responder credential, <a class="pilcrow" href="#">&para;</a></dd>
                                            <dd id="null">[Plaintext] Set of responder ephemeral keys<a class="pilcrow" href="#">&para;</a></dd>
                                            <dd id="null">[Plaintext] Challenge<a class="pilcrow" href="#">&para;</a></dd>
                                            <dd id="null">[Plaintext] Stream ID, Payload<a class="pilcrow" href="#">&para;</a></dd>
                                            <dt id="s-4_1_3-4"><code>InitiatorComplete</code><a class="pilcrow" href="#s-4_1_3-4">&para;</a></dt>
                                            <dd id="null">(As for the First Contact case)<a class="pilcrow" href="#">&para;</a></dd>
                                          </dl>
                                          <p id="s-4_1_3-5">Key exchange example TBS <a class="pilcrow" href="#s-4_1_3-5">&para;</a></p>
                                        </section>
                                        
                                        <section id="n-ticketed-connection">
                                          <h4 id="s-4_2">
                                            <a class="selfRef" href="#s-4_2">4.2.</a>
                                            <a class="selfRef" href="#n-ticketed-connection">Ticketed Connection</a>
                                          </h4>
                                          <p id="s-4_2-1">For supporting presence and discovery services.<a class="pilcrow" href="#s-4_2-1">&para;</a></p>
                                          <p id="s-4_2-2">Ticket specifies a shared secret, session ID, network end point.<a class="pilcrow" href="#s-4_2-2">&para;</a></p>
                                          <p id="s-4_2-3">Example discovery, Alice's device connects to the provider's discovery service, is authenticated and receives a ticket to connect to a specific host. This allows a connection to be established to that host without the need to perform a connection key exchange.<a class="pilcrow" href="#s-4_2-3">&para;</a></p>
                                          <p id="s-4_2-4">Example presence, Alice wants to talk to Bob, contacts his discovery service, gets a ticket back allowing Bob to establish a direct, encrypted connection.<a class="pilcrow" href="#s-4_2-4">&para;</a></p>
                                          <p id="s-4_2-5">In either case, a client <span class="bcp14">SHOULD</span> perform a rekey operation as indicated by requirements for perfect forward secrecy, security policy, yada yada.<a class="pilcrow" href="#s-4_2-5">&para;</a></p>
                                        </section>
                                        
                                        <section id="n-connection-forward-secrecy-rekeying">
                                          <h4 id="s-4_3">
                                            <a class="selfRef" href="#s-4_3">4.3.</a>
                                            <a class="selfRef" href="#n-connection-forward-secrecy-rekeying">Connection Forward Secrecy Rekeying</a>
                                          </h4>
                                          <p id="s-4_3-1">Rekeying is only necessary to provide forward secrecy. The data encrypted under a single symmetric key is a small fraction of the maximum. But a connection that persists for several years still represents a liability.<a class="pilcrow" href="#s-4_3-1">&para;</a></p>
                                          <p id="s-4_3-2">[Should we reintroduce the mezzanine packet so we can use the remainder of a packet without rekeying?]<a class="pilcrow" href="#s-4_3-2">&para;</a></p>
                                          <p id="s-4_3-3">[Packet extension contains the rekey data]<a class="pilcrow" href="#s-4_3-3">&para;</a></p>
                                        </section>
                                        
                                        <section id="n-stream-establishment-and-maintenance">
                                          <h3 id="s-5">
                                            <a class="selfRef" href="#s-5">5.</a>
                                            <a class="selfRef" href="#n-stream-establishment-and-maintenance">Stream Establishment and Maintenance</a>
                                          </h3>
                                        </section>
                                        
                                        <section id="n-stream-creation-and-binding">
                                          <h4 id="s-5_1">
                                            <a class="selfRef" href="#s-5_1">5.1.</a>
                                            <a class="selfRef" href="#n-stream-creation-and-binding">Stream Creation and Binding</a>
                                          </h4>
                                          <p id="s-5_1-1">When a stream is created, it is typically bound to a service.<a class="pilcrow" href="#s-5_1-1">&para;</a></p>
                                          <p id="s-5_1-2">A host might offer Mesh, Callsign and Discovery services. After connecting to the host, a device requests a stream to each of the services in turn. Each stream <span class="bcp14">MAY</span> be separately authorized. <a class="pilcrow" href="#s-5_1-2">&para;</a></p>
                                        </section>
                                        
                                        <section id="n-stream-close">
                                          <h4 id="s-5_2">
                                            <a class="selfRef" href="#s-5_2">5.2.</a>
                                            <a class="selfRef" href="#n-stream-close">Stream Close</a>
                                          </h4>
                                          <p id="s-5_2-1">Streams <span class="bcp14">MAY</span> be closed when no longer needed. This allows reuse of the stream identifier(s) associated with the stream provided that no ambiguity can arise.<a class="pilcrow" href="#s-5_2-1">&para;</a></p>
                                        </section>
                                        
                                        <section id="n-one-time-stream-identifier">
                                          <h4 id="s-5_3">
                                            <a class="selfRef" href="#s-5_3">5.3.</a>
                                            <a class="selfRef" href="#n-one-time-stream-identifier">One Time Stream Identifier</a>
                                          </h4>
                                          <p id="s-5_3-1">In cases where defeating traffic analysis is of particular importance, a recipient <span class="bcp14">MAY</span> assign multiple identifiers to a single stream.<a class="pilcrow" href="#s-5_3-1">&para;</a></p>
                                          <p id="s-5_3-2">For example, a device connecting issues a set of three stream identifiers to a service. The device receives two packets which are acknowledged together with a further three one-time use identifiers.<a class="pilcrow" href="#s-5_3-2">&para;</a></p>
                                          <figure id="f-19">
                                            <div class="artwork art-svg" id="n-use-of-one-time-stream-identifiers">
                                              <a class="pilcrow" href="#n-use-of-one-time-stream-identifiers">&para;</a>
<svg width="464" height="265" xmlns="http://www.w3.org/2000/svg" >
<g transform="translate(8,16)">
  <path d="M 0,0 L 160,0" fill="none" stroke="black" />
  <path d="M 288,0 L 448,0" fill="none" stroke="black" />
  <path d="M 0,32 L 80,32" fill="none" stroke="black" />
  <path d="M 80,32 L 160,32" fill="none" stroke="black" />
  <path d="M 288,32 L 376,32" fill="none" stroke="black" />
  <path d="M 376,32 L 448,32" fill="none" stroke="black" />
  <path d="M 80,64 L 152,64" fill="none" stroke="black" />
  <path d="M 288,64 L 368,64" fill="none" stroke="black" />
  <path d="M 88,96 L 160,96" fill="none" stroke="black" />
  <path d="M 296,96 L 376,96" fill="none" stroke="black" />
  <path d="M 88,128 L 160,128" fill="none" stroke="black" />
  <path d="M 296,128 L 376,128" fill="none" stroke="black" />
  <path d="M 80,160 L 160,160" fill="none" stroke="black" />
  <path d="M 296,160 L 368,160" fill="none" stroke="black" />
  <path d="M 88,192 L 160,192" fill="none" stroke="black" />
  <path d="M 296,192 L 376,192" fill="none" stroke="black" />
  <path d="M 88,224 L 160,224" fill="none" stroke="black" />
  <path d="M 296,224 L 376,224" fill="none" stroke="black" />
  <path d="M 0,0 L 0,32" fill="none" stroke="black" />
  <path d="M 80,32 L 80,64" fill="none" stroke="black" />
  <path d="M 80,64 L 80,160" fill="none" stroke="black" />
  <path d="M 80,160 L 80,240" fill="none" stroke="black" />
  <path d="M 160,0 L 160,32" fill="none" stroke="black" />
  <path d="M 288,0 L 288,32" fill="none" stroke="black" />
  <path d="M 376,32 L 376,96" fill="none" stroke="black" />
  <path d="M 376,96 L 376,128" fill="none" stroke="black" />
  <path d="M 376,128 L 376,192" fill="none" stroke="black" />
  <path d="M 376,192 L 376,224" fill="none" stroke="black" />
  <path d="M 376,224 L 376,240" fill="none" stroke="black" />
  <path d="M 448,0 L 448,32" fill="none" stroke="black" />
  <polygon points="96.000000,96.000000 84.000000,90.400002 84.000000,101.599998" fill="black" transform="rotate(180.000000, 88.000000, 96.000000)" />
  <polygon points="96.000000,128.000000 84.000000,122.400002 84.000000,133.600006" fill="black" transform="rotate(180.000000, 88.000000, 128.000000)" />
  <polygon points="96.000000,192.000000 84.000000,186.399994 84.000000,197.600006" fill="black" transform="rotate(180.000000, 88.000000, 192.000000)" />
  <polygon points="96.000000,224.000000 84.000000,218.399994 84.000000,229.600006" fill="black" transform="rotate(180.000000, 88.000000, 224.000000)" />
  <polygon points="376.000000,64.000000 364.000000,58.400002 364.000000,69.599998" fill="black" transform="rotate(0.000000, 368.000000, 64.000000)" />
  <polygon points="376.000000,160.000000 364.000000,154.399994 364.000000,165.600006" fill="black" transform="rotate(0.000000, 368.000000, 160.000000)" />
  <text text-anchor="middle" font-family="sans-serif" x="360" y="20">e</text>
  <text text-anchor="middle" font-family="sans-serif" x="248" y="68">I</text>
  <text text-anchor="middle" font-family="sans-serif" x="184" y="132">r</text>
  <text text-anchor="middle" font-family="sans-serif" x="192" y="228">a</text>
  <text text-anchor="middle" font-family="sans-serif" x="240" y="164">5</text>
  <text text-anchor="middle" font-family="sans-serif" x="224" y="196">3</text>
  <text text-anchor="middle" font-family="sans-serif" x="272" y="228">5</text>
  <text text-anchor="middle" font-family="sans-serif" x="176" y="228">F</text>
  <text text-anchor="middle" font-family="sans-serif" x="184" y="228">r</text>
  <text text-anchor="middle" font-family="sans-serif" x="240" y="228">(</text>
  <text text-anchor="middle" font-family="sans-serif" x="64" y="20">D</text>
  <text text-anchor="middle" font-family="sans-serif" x="400" y="20">e</text>
  <text text-anchor="middle" font-family="sans-serif" x="176" y="100">F</text>
  <text text-anchor="middle" font-family="sans-serif" x="192" y="100">a</text>
  <text text-anchor="middle" font-family="sans-serif" x="224" y="164">D</text>
  <text text-anchor="middle" font-family="sans-serif" x="272" y="132">2</text>
  <text text-anchor="middle" font-family="sans-serif" x="216" y="164">I</text>
  <text text-anchor="middle" font-family="sans-serif" x="280" y="164">6</text>
  <text text-anchor="middle" font-family="sans-serif" x="248" y="228">I</text>
  <text text-anchor="middle" font-family="sans-serif" x="280" y="132">)</text>
  <text text-anchor="middle" font-family="sans-serif" x="192" y="164">#</text>
  <text text-anchor="middle" font-family="sans-serif" x="184" y="196">r</text>
  <text text-anchor="middle" font-family="sans-serif" x="216" y="68">D</text>
  <text text-anchor="middle" font-family="sans-serif" x="200" y="100">m</text>
  <text text-anchor="middle" font-family="sans-serif" x="248" y="100">I</text>
  <text text-anchor="middle" font-family="sans-serif" x="272" y="100">1</text>
  <text text-anchor="middle" font-family="sans-serif" x="280" y="100">)</text>
  <text text-anchor="middle" font-family="sans-serif" x="256" y="228">D</text>
  <text text-anchor="middle" font-family="sans-serif" x="184" y="100">r</text>
  <text text-anchor="middle" font-family="sans-serif" x="240" y="100">(</text>
  <text text-anchor="middle" font-family="sans-serif" x="264" y="100">#</text>
  <text text-anchor="middle" font-family="sans-serif" x="224" y="100">1</text>
  <text text-anchor="middle" font-family="sans-serif" x="272" y="164">#</text>
  <text text-anchor="middle" font-family="sans-serif" x="176" y="196">F</text>
  <text text-anchor="middle" font-family="sans-serif" x="256" y="196">D</text>
  <text text-anchor="middle" font-family="sans-serif" x="280" y="228">)</text>
  <text text-anchor="middle" font-family="sans-serif" x="88" y="20">i</text>
  <text text-anchor="middle" font-family="sans-serif" x="264" y="132">#</text>
  <text text-anchor="middle" font-family="sans-serif" x="200" y="164">4</text>
  <text text-anchor="middle" font-family="sans-serif" x="240" y="196">(</text>
  <text text-anchor="middle" font-family="sans-serif" x="280" y="196">)</text>
  <text text-anchor="middle" font-family="sans-serif" x="200" y="228">m</text>
  <text text-anchor="middle" font-family="sans-serif" x="176" y="68">D</text>
  <text text-anchor="middle" font-family="sans-serif" x="208" y="68">I</text>
  <text text-anchor="middle" font-family="sans-serif" x="264" y="68">#</text>
  <text text-anchor="middle" font-family="sans-serif" x="208" y="132">e</text>
  <text text-anchor="middle" font-family="sans-serif" x="248" y="132">I</text>
  <text text-anchor="middle" font-family="sans-serif" x="224" y="228">4</text>
  <text text-anchor="middle" font-family="sans-serif" x="72" y="20">e</text>
  <text text-anchor="middle" font-family="sans-serif" x="80" y="20">v</text>
  <text text-anchor="middle" font-family="sans-serif" x="352" y="20">S</text>
  <text text-anchor="middle" font-family="sans-serif" x="376" y="20">v</text>
  <text text-anchor="middle" font-family="sans-serif" x="232" y="164">#</text>
  <text text-anchor="middle" font-family="sans-serif" x="192" y="132">a</text>
  <text text-anchor="middle" font-family="sans-serif" x="200" y="132">m</text>
  <text text-anchor="middle" font-family="sans-serif" x="272" y="196">4</text>
  <text text-anchor="middle" font-family="sans-serif" x="184" y="164">D</text>
  <text text-anchor="middle" font-family="sans-serif" x="368" y="20">r</text>
  <text text-anchor="middle" font-family="sans-serif" x="392" y="20">c</text>
  <text text-anchor="middle" font-family="sans-serif" x="192" y="68">1</text>
  <text text-anchor="middle" font-family="sans-serif" x="176" y="132">F</text>
  <text text-anchor="middle" font-family="sans-serif" x="176" y="164">I</text>
  <text text-anchor="middle" font-family="sans-serif" x="256" y="132">D</text>
  <text text-anchor="middle" font-family="sans-serif" x="264" y="164">D</text>
  <text text-anchor="middle" font-family="sans-serif" x="192" y="196">a</text>
  <text text-anchor="middle" font-family="sans-serif" x="96" y="20">c</text>
  <text text-anchor="middle" font-family="sans-serif" x="384" y="20">i</text>
  <text text-anchor="middle" font-family="sans-serif" x="168" y="68">I</text>
  <text text-anchor="middle" font-family="sans-serif" x="184" y="68">#</text>
  <text text-anchor="middle" font-family="sans-serif" x="272" y="68">3</text>
  <text text-anchor="middle" font-family="sans-serif" x="208" y="196">e</text>
  <text text-anchor="middle" font-family="sans-serif" x="248" y="196">I</text>
  <text text-anchor="middle" font-family="sans-serif" x="264" y="196">#</text>
  <text text-anchor="middle" font-family="sans-serif" x="224" y="68">#</text>
  <text text-anchor="middle" font-family="sans-serif" x="256" y="68">D</text>
  <text text-anchor="middle" font-family="sans-serif" x="224" y="132">2</text>
  <text text-anchor="middle" font-family="sans-serif" x="256" y="164">I</text>
  <text text-anchor="middle" font-family="sans-serif" x="200" y="196">m</text>
  <text text-anchor="middle" font-family="sans-serif" x="104" y="20">e</text>
  <text text-anchor="middle" font-family="sans-serif" x="256" y="100">D</text>
  <text text-anchor="middle" font-family="sans-serif" x="240" y="132">(</text>
  <text text-anchor="middle" font-family="sans-serif" x="232" y="68">2</text>
  <text text-anchor="middle" font-family="sans-serif" x="208" y="100">e</text>
  <text text-anchor="middle" font-family="sans-serif" x="208" y="228">e</text>
  <text text-anchor="middle" font-family="sans-serif" x="264" y="228">#</text>
</g></svg>
                                              <figcaption>
                                                <a href="n-use-of-one-time-stream-identifiers">Figure 19</a>
:                                                <a href="null" id="null" class="selfRef">Use of one time Stream identifiers.</a>
                                              </figcaption>
                                            </div>
                                            <p id="s-5_3-4">A block cipher <span class="bcp14">MAY</span> be employed to construct one time IDs that require no state to interpret. The issuer generates a fixed symmetric key. To create a new one time StreamID, the issuer encrypts a block containing a salt (e.g. a unique sequence number) and the stream ID to which the encrypted Id is to be mapped.<a class="pilcrow" href="#s-5_3-4">&para;</a></p>
                                            <p id="s-5_3-5">To interpret a one time ID, the service simply decrypts the encrypted form to recover the original stream ID, the salt is ignored.<a class="pilcrow" href="#s-5_3-5">&para;</a></p>
                                            <p id="s-5_3-6">Note that when using this approach it is absolutely critical that the cipher used is a block cipher and not a stream cipher or a block cipher used in a streaming mode (e.g. AES-GCM).<a class="pilcrow" href="#s-5_3-6">&para;</a></p>
                                            <figure id="f-20">
                                              <div class="artwork art-svg" id="n-use-of-a-block-cipher-to-create-stateless-stream-identifiers">
                                                <a class="pilcrow" href="#n-use-of-a-block-cipher-to-create-stateless-stream-identifiers">&para;</a>
<svg width="208" height="185" xmlns="http://www.w3.org/2000/svg" >
<g transform="translate(8,16)">
  <path d="M 0,0 L 96,0" fill="none" stroke="black" />
  <path d="M 96,0 L 192,0" fill="none" stroke="black" />
  <path d="M 0,48 L 96,48" fill="none" stroke="black" />
  <path d="M 96,48 L 192,48" fill="none" stroke="black" />
  <path d="M 0,112 L 192,112" fill="none" stroke="black" />
  <path d="M 0,160 L 192,160" fill="none" stroke="black" />
  <path d="M 0,0 L 0,48" fill="none" stroke="black" />
  <path d="M 0,112 L 0,160" fill="none" stroke="black" />
  <path d="M 96,0 L 96,48" fill="none" stroke="black" />
  <path d="M 96,48 L 96,96" fill="none" stroke="black" />
  <path d="M 192,0 L 192,48" fill="none" stroke="black" />
  <path d="M 192,112 L 192,160" fill="none" stroke="black" />
  <path d="M 96,96 L 96,104" fill="none" stroke="black" />
  <polygon points="112.000000,96.000000 100.000000,90.400002 100.000000,101.599998" fill="black" transform="rotate(90.000000, 96.000000, 96.000000)" />
  <text text-anchor="middle" font-family="sans-serif" x="160" y="84">)</text>
  <text text-anchor="middle" font-family="sans-serif" x="56" y="132">T</text>
  <text text-anchor="middle" font-family="sans-serif" x="72" y="148">2</text>
  <text text-anchor="middle" font-family="sans-serif" x="96" y="148">B</text>
  <text text-anchor="middle" font-family="sans-serif" x="56" y="20">m</text>
  <text text-anchor="middle" font-family="sans-serif" x="136" y="20">u</text>
  <text text-anchor="middle" font-family="sans-serif" x="120" y="20">C</text>
  <text text-anchor="middle" font-family="sans-serif" x="128" y="20">o</text>
  <text text-anchor="middle" font-family="sans-serif" x="48" y="20">a</text>
  <text text-anchor="middle" font-family="sans-serif" x="152" y="36">i</text>
  <text text-anchor="middle" font-family="sans-serif" x="40" y="132">e</text>
  <text text-anchor="middle" font-family="sans-serif" x="112" y="148">t</text>
  <text text-anchor="middle" font-family="sans-serif" x="128" y="84">S</text>
  <text text-anchor="middle" font-family="sans-serif" x="24" y="132">O</text>
  <text text-anchor="middle" font-family="sans-serif" x="152" y="132">I</text>
  <text text-anchor="middle" font-family="sans-serif" x="80" y="148">8</text>
  <text text-anchor="middle" font-family="sans-serif" x="32" y="132">n</text>
  <text text-anchor="middle" font-family="sans-serif" x="152" y="20">t</text>
  <text text-anchor="middle" font-family="sans-serif" x="120" y="36">6</text>
  <text text-anchor="middle" font-family="sans-serif" x="160" y="36">t</text>
  <text text-anchor="middle" font-family="sans-serif" x="104" y="132">t</text>
  <text text-anchor="middle" font-family="sans-serif" x="120" y="148">s</text>
  <text text-anchor="middle" font-family="sans-serif" x="160" y="132">d</text>
  <text text-anchor="middle" font-family="sans-serif" x="32" y="20">r</text>
  <text text-anchor="middle" font-family="sans-serif" x="72" y="20">I</text>
  <text text-anchor="middle" font-family="sans-serif" x="144" y="20">n</text>
  <text text-anchor="middle" font-family="sans-serif" x="152" y="84">k</text>
  <text text-anchor="middle" font-family="sans-serif" x="96" y="132">S</text>
  <text text-anchor="middle" font-family="sans-serif" x="120" y="132">e</text>
  <text text-anchor="middle" font-family="sans-serif" x="24" y="20">t</text>
  <text text-anchor="middle" font-family="sans-serif" x="24" y="36">6</text>
  <text text-anchor="middle" font-family="sans-serif" x="56" y="36">i</text>
  <text text-anchor="middle" font-family="sans-serif" x="64" y="132">i</text>
  <text text-anchor="middle" font-family="sans-serif" x="128" y="132">a</text>
  <text text-anchor="middle" font-family="sans-serif" x="168" y="36">s</text>
  <text text-anchor="middle" font-family="sans-serif" x="104" y="148">i</text>
  <text text-anchor="middle" font-family="sans-serif" x="80" y="20">d</text>
  <text text-anchor="middle" font-family="sans-serif" x="32" y="36">4</text>
  <text text-anchor="middle" font-family="sans-serif" x="128" y="36">4</text>
  <text text-anchor="middle" font-family="sans-serif" x="120" y="84">E</text>
  <text text-anchor="middle" font-family="sans-serif" x="16" y="20">S</text>
  <text text-anchor="middle" font-family="sans-serif" x="40" y="20">e</text>
  <text text-anchor="middle" font-family="sans-serif" x="160" y="20">e</text>
  <text text-anchor="middle" font-family="sans-serif" x="168" y="20">r</text>
  <text text-anchor="middle" font-family="sans-serif" x="48" y="36">B</text>
  <text text-anchor="middle" font-family="sans-serif" x="112" y="84">A</text>
  <text text-anchor="middle" font-family="sans-serif" x="72" y="132">m</text>
  <text text-anchor="middle" font-family="sans-serif" x="112" y="132">r</text>
  <text text-anchor="middle" font-family="sans-serif" x="64" y="148">1</text>
  <text text-anchor="middle" font-family="sans-serif" x="64" y="36">t</text>
  <text text-anchor="middle" font-family="sans-serif" x="72" y="36">s</text>
  <text text-anchor="middle" font-family="sans-serif" x="144" y="36">B</text>
  <text text-anchor="middle" font-family="sans-serif" x="144" y="84">(</text>
  <text text-anchor="middle" font-family="sans-serif" x="80" y="132">e</text>
  <text text-anchor="middle" font-family="sans-serif" x="136" y="132">m</text>
</g></svg>
                                                <figcaption>
                                                  <a href="n-use-of-a-block-cipher-to-create-stateless-stream-identifiers">Figure 20</a>
:                                                  <a href="null" id="null" class="selfRef">Use of a block cipher to create stateless stream identifiers.</a>
                                                </figcaption>
                                              </div>
                                            </figure>
                                            
                                            <section id="n-stream-rekey">
                                              <h4 id="s-5_4">
                                                <a class="selfRef" href="#s-5_4">5.4.</a>
                                                <a class="selfRef" href="#n-stream-rekey">Stream Rekey</a>
                                              </h4>
                                              <p id="s-5_4-1">Rekeying the stream requires us to change the stream ID. No other characteristics of the stream are changed.<a class="pilcrow" href="#s-5_4-1">&para;</a></p>
                                              <p id="s-5_4-2">Stream can rekey by specifying its own rekey data or say 'use the same keydata as this stream Id'.<a class="pilcrow" href="#s-5_4-2">&para;</a></p>
                                              <p id="s-5_4-3">Thus, a connection with four separate streams only needs to perform one rekey to refresh the crypto for all four.<a class="pilcrow" href="#s-5_4-3">&para;</a></p>
                                            </section>
                                            
                                            <section id="n-schema">
                                              <h3 id="s-6">
                                                <a class="selfRef" href="#s-6">6.</a>
                                                <a class="selfRef" href="#n-schema">Schema</a>
                                              </h3>
                                            </section>
                                            
                                            <section id="n-connection-datagrams-0">
                                              <h4 id="s-6_1">
                                                <a class="selfRef" href="#s-6_1">6.1.</a>
                                                <a class="selfRef" href="#n-connection-datagrams-0">Connection Datagrams</a>
                                              </h4>
                                            </section>
                                            
                                            <section id="n-packet-extensions">
                                              <h4 id="s-6_2">
                                                <a class="selfRef" href="#s-6_2">6.2.</a>
                                                <a class="selfRef" href="#n-packet-extensions">Packet Extensions</a>
                                              </h4>
                                            </section>
                                            
                                            <section id="n-security-considerations">
                                              <h3 id="s-7">
                                                <a class="selfRef" href="#s-7">7.</a>
                                                <a class="selfRef" href="#n-security-considerations">Security Considerations</a>
                                              </h3>
                                            </section>
                                            
                                            <section id="n-iana-considerations">
                                              <h3 id="s-8">
                                                <a class="selfRef" href="#s-8">8.</a>
                                                <a class="selfRef" href="#n-iana-considerations">IANA Considerations</a>
                                              </h3>
                                              <p id="s-8-1">This document requires no IANA actions.<a class="pilcrow" href="#s-8-1">&para;</a></p>
                                            </section>
                                            
                                            <section id="n-acknowledgements">
                                              <h3 id="s-9">
                                                <a class="selfRef" href="#s-9">9.</a>
                                                <a class="selfRef" href="#n-acknowledgements">Acknowledgements</a>
                                              </h3>
                                              <p id="s-9-1"><a class="pilcrow" href="#s-9-1">&para;</a></p>
                                            </section>
                                            
                                            <section id="n-references">
                                              <h2>
                                                <a class="selfRef" href="#n-references">References</a>
                                              </h2>
                                              <section id="n-normative">
                                                <h3>
                                                  <a class="selfRef" href="#n-normative">Normative References</a>
                                                </h3>
                                                <dl class="reference">
                                                  <dt id="RFC2119">[RFC2119]</dt>
                                                  <dd>
                                                    <span class="refAuthor">S. Bradner</span>
                                                    "<span class="refTitle">Key words for use in RFCs to Indicate Requirement Levels</span>"
                                                    <span Class="refSeries">
                                                      <span class="refSeriesName">BCP</span>
                                                      <span class="refSeriesValue">14</span>
                                                    </span>
                                                    <span Class="refSeries">
                                                      <span class="refSeriesName">RFC</span>
                                                      <span class="refSeriesValue">2119</span>
                                                    </span>
                                                    <span Class="refSeries">
                                                      <span class="refSeriesName">DOI</span>
                                                      <span class="refSeriesValue">10.17487/RFC2119</span>
                                                    </span>
                                                    <time class="refDate" datetime="1997-03">March 1997</time>
                                                  </dd>
                                                  <dt id="draft-ietf-quic-transport">[draft-ietf-quic-transport]</dt>
                                                  <dd>
                                                    <span class="refAuthor">Jana Iyengar</span>
                                                    <span>and</span>
                                                    <span class="refAuthor">Martin Thomson</span>
                                                    "<span class="refTitle">QUIC: A UDP-Based Multiplexed and Secure Transport</span>"
                                                    <span Class="refSeries">
                                                      <span class="refSeriesName">Internet-Draft</span>
                                                      <span class="refSeriesValue">draft-ietf-quic-transport-34</span>
                                                    </span>
                                                    &lt;<a class="refTarget">http://www.ietf.org/internet-drafts/draft-ietf-quic-transport-34.txt</a>&gt;
                                                    <time class="refDate" datetime="2021-01-14">14 January 2021</time>
                                                  </dd>
                                                </dl>
                                              </section>
                                              
                                              <section id="n-informative">
                                                <h3>
                                                  <a class="selfRef" href="#n-informative">Informative References</a>
                                                </h3>
                                                <dl class="reference">
                                                  <dt id="draft-hallambaker-mesh-developer">[draft-hallambaker-mesh-developer]</dt>
                                                  <dd>
                                                    <span class="refAuthor">Phillip Hallam-Baker</span>
                                                    "<span class="refTitle">Mathematical Mesh: Reference Implementation</span>"
                                                    <span Class="refSeries">
                                                      <span class="refSeriesName">Internet-Draft</span>
                                                      <span class="refSeriesValue">draft-hallambaker-mesh-developer-10</span>
                                                    </span>
                                                    &lt;<a class="refTarget">http://www.ietf.org/internet-drafts/draft-hallambaker-mesh-developer-10.txt</a>&gt;
                                                    <time class="refDate" datetime="2020-07-27">27 July 2020</time>
                                                  </dd>
                                                </dl>
                                              </section>
                                              
                                            </section>
                                            
                                            <section id="n-authors">
                                              <h2>
                                                <a class="selfRef" href="#n-authors">Author's Address</a>
                                              </h2>
                                              <hr class="addr"/>
                                              <address class="vcard">
                                                <div class="nameRole">
                                                  <span class="fn">Phillip Hallam-Baker</span>
                                                </div>
                                                <div class="org">ThresholdSecrets.com</div>
                                                <div>
                                                  <span>Email:</span>
                                                  <a class="email" href="mailto:phill@hallambaker.com     ">phill@hallambaker.com     </a>
                                                </div>
                                              </address>
                                            </section>
                                            
                                            <div class="docInfo">
                                              <span class="prepared">
                                                Prepared: 
                                                <time datetime="2021-04-13">2021-04-13</time>
                                              </span>
                                              <span class="rendered">
                                                Rendered: 
                                                <time datetime="2021-04-13">2021-04-13</time>
                                              </span>
                                            </div>
                                            
                                            <script src="xml2rfc.js" type="text/javascript"></script>
                                          </figure>
                                        </section>
