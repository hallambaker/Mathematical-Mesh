<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8">
    <meta content="Common,Latin" name="scripts">
    <meta content="initial-scale=1.0" name="viewport">
    <title>Mathematical Mesh 3.0 Part I: Architecture Guide</title>
    <meta name="author" content="Phillip Hallam-Baker">
    <meta name="description" content="The Mathematical Mesh 'The Mesh' is an end-to-end secure infrastructure that makes computers easier to use by making them more secure. The Mesh provides a set of protocol and cryptographic building blocks that enable encrypted data stored in the cloud to be accessed, managed and exchanged between users with the same or better ease of use than traditional approaches which leave the data vulnerable to attack. This document provides an overview of the Mesh data structures, protocols and examples of its use. [Note to Readers] Discussion of this draft takes place on the MATHMESH mailing list (mathmesh@ietf.org), which is archived at https://mailarchive.ietf.org/arch/search/?email_list=mathmesh. This document is also available online at . ">
    <meta content="rfctool 2.0" name="generator">
    <link href="#copyright" rel="license">
    <style type="text/css">
/* fonts */
@import url('https://fonts.googleapis.com/css?family=Noto+Sans'); /* Sans-serif */
@import url('https://fonts.googleapis.com/css?family=Noto+Serif'); /* Serif (print) */
@import url('https://fonts.googleapis.com/css?family=Roboto+Mono'); /* Monospace */

@viewport {
  zoom: 1.0;
  width: extend-to-zoom;
}
@-ms-viewport {
  width: extend-to-zoom;
  zoom: 1.0;
}
/* general and mobile first */
html {
}
body {
  max-width: 90%;
  margin: 1.5em auto;
  color: #222;
  background-color: #fff;
  font-size: 14px;
  font-family: 'Noto Sans', Arial, Helvetica, sans-serif;
  line-height: 1.6;
  scroll-behavior: smooth;
}
.ears {
  display: none;
}

/* headings */
#title, h1, h2, h3, h4, h5, h6 {
  margin: 1em 0 0.5em;
  font-weight: bold;
  line-height: 1.3;
}
#title {
  clear: both;
  border-bottom: 1px solid #ddd;
  margin: 0 0 0.5em 0;
  padding: 1em 0 0.5em;
}
.filename
{
    font-size: 20px;
    color: darkgray;
}
.author {
  padding-bottom: 4px;
}
h1 {
  font-size: 26px;
  margin: 1em 0;
  color: blueviolet;
}
h2
{
    font-size: 22px;
    margin-top: -20px; /* provide offset for in-page anchors */
    padding-top: 33px;
    color: blueviolet;
}
h3
{
    font-size: 18px;
    margin-top: -36px; /* provide offset for in-page anchors */
    padding-top: 42px;
    color: blueviolet;
}
h4
{
    font-size: 16px;
    margin-top: -36px; /* provide offset for in-page anchors */
    padding-top: 42px;
    color: blueviolet;
}
h5, h6 {
  font-size: 14px;
}
#n-copyright-notice {
  border-bottom: 1px solid #ddd;
  padding-bottom: 1em;
  margin-bottom: 1em;
}
/* general structure */
p {
  padding: 0;
  margin: 0 0 1em 0;
  text-align: left;
}
div, span {
  position: relative;
}
div {
  margin: 0;
}
.alignRight.art-text {
  background-color: #f9f9f9;
  border: 1px solid #eee;
  border-radius: 3px;
  padding: 1em 1em 0;
  margin-bottom: 1.5em;
}
.alignRight.art-text pre {
  padding: 0;
}
.alignRight {
  margin: 1em 0;
}
.alignRight > *:first-child {
  border: none;
  margin: 0;
  float: right;
  clear: both;
}
.alignRight > *:nth-child(2) {
  clear: both;
  display: block;
  border: none;
}
svg {
  display: block;
}
.alignCenter.art-text {
  background-color: #f9f9f9;
  border: 1px solid #eee;
  border-radius: 3px;
  padding: 1em 1em 0;
  margin-bottom: 1.5em;
}
.alignCenter.art-text pre {
  padding: 0;
}
.alignCenter {
  margin: 1em 0;
}
.alignCenter > *:first-child {
  border: none;
  /* this isn't optimal, but it's an existence proof.  PrinceXML doesn't
     support flexbox yet.
  */
  display: table;
  margin: 0 auto;
}

/* lists */
ol, ul {
  padding: 0;
  margin: 0 0 1em 2em;
}
ol ol, ul ul, ol ul, ul ol {
  margin-left: 1em;
}
li {
  margin: 0 0 0.25em 0;
}
.ulCompact li {
  margin: 0;
}
ul.empty, .ulEmpty {
  list-style-type: none;
}
ul.empty li, .ulEmpty li {
  margin-top: 0.5em;
}
ul.compact, .ulCompact,
ol.compact, .olCompact {
  line-height: 100%;
  margin: 0 0 0 2em;
}

/* definition lists */
dl {
}
dl > dt {
  float: left;
  margin-right: 1em;
  font-weight: bold;
}
    dl.nohang > dt
    {
        float: none;
        font-weight: bold;
    }
dl > dd {
  margin-bottom: .8em;
  min-height: 1.3em;
}
dl.compact > dd, dlCompact > dd {
  margin-bottom: 0em;
}
dl > dd > dl {
  margin-top: 0.5em;
  margin-bottom: 0em;
}

/* links */
a {
  text-decoration: none;
}
a[href] {
  color: #3E8EDE;
}
a[href]:hover {
  background-color: #f2f2f2;
}
figcaption a[href],
a[href].selfRef {
  color: blueviolet;
}
/* XXX probably not this:
a.selfRef:hover {
  background-color: transparent;
  cursor: default;
} */

/* Figures */
tt, code, pre, code {
  background-color: #f9f9f9;
  font-family: 'Roboto Mono', monospace;
}
pre {
  border: 1px solid #eee;
  margin: 0;
  padding: 1em;
}
img {
  max-width: 100%;
}
figure {
  margin: 0;
}
figure blockquote {
  margin: 0.8em 0.4em 0.4em;
}
figcaption {
  font-style: italic;
  margin: 0 0 1em 0;
}
@media screen {
  pre {
    overflow-x: auto;
    max-width: 100%;
    max-width: calc(100% - 22px);
  }
}

/* aside, blockquote */
aside, blockquote {
  margin-left: 0;
  padding: 1.2em 2em;
}
blockquote {
  background-color: #f9f9f9;
  border: 1px solid #ddd;
  border-radius: 3px;
  margin: 1em 0;
}
cite {
  display: block;
  text-align: right;
  font-style: italic;
}

/* tables */
table {
  width: 100%;
  margin: 0 0 1em;
  border-collapse: collapse;
  border: 1px solid #eee;
}
th, td {
  text-align: left;
  vertical-align: top;
  padding: 0.5em 0.75em;
}
th {
  text-align: left;
  background-color: #e9e9e9;
}
tr:nth-child(2n+1) > td {
  background-color: #f5f5f5;
}
table caption {
  font-style: italic;
  margin: 0;
  padding: 0;
  text-align: left;
}
table p {
  /* XXX to avoid bottom margin on table row signifiers. If paragraphs should
     be allowed within tables more generally, it would be far better to select on a class. */
  margin: 0;
}

/* pilcrow */
a.pilcrow {
  color: #777;
  text-decoration: none;
  visibility: hidden;
  user-select: none;
  -ms-user-select: none;
  -o-user-select:none;
  -moz-user-select: none;
  -khtml-user-select: none;
  -webkit-user-select: none;
  -webkit-touch-callout: none;
}
@media screen {
  aside:hover > a.pilcrow,
  p:hover > a.pilcrow,
  blockquote:hover > a.pilcrow,
  div:hover > a.pilcrow,
  li:hover > a.pilcrow,
  pre:hover > a.pilcrow {
    visibility: visible;
  }
  a.pilcrow:hover {
    background-color: transparent;
  }
}

/* misc */
hr {
  border: 0;
  border-top: 1px solid #eee;
}
.bcp14 {
  font-variant: small-caps;
}

.role {
  font-variant: all-small-caps;
}

/* info block */
#identifiers {
  margin: 0;
  font-size: 0.9em;
}
#identifiers dt {
  width: 3em;
  clear: left;
}
#identifiers dd {
  float: left;
  margin-bottom: 0;
}
#identifiers .authors .author {
  display: inline-block;
  margin-right: 1.5em;
}
#identifiers .authors .org {
  font-style: italic;
}

/* The prepared/rendered info at the very bottom of the page */
.docInfo {
  color: #999;
  font-size: 0.9em;
  font-style: italic;
  margin-top: 2em;
}
.docInfo .prepared {
  float: left;
}
.docInfo .prepared {
  float: right;
}

/* table of contents */
#toc  {
  padding: 0.75em 0 2em 0;
  margin-bottom: 1em;
}
nav.toc ul {
  margin: 0 0.5em 0 0;
  padding: 0;
  list-style: none;
}
nav.toc li {
  line-height: 1.3em;
  margin: 0.75em 0;
  padding-left: 1.2em;
  text-indent: -1.2em;
}
/* references */
.reference dt {
  text-align: right;
  font-weight: bold;
  min-width: 7em;
}
.reference dd {
  margin-left: 8em;
  overflow: auto;
}

.refInstance {
  margin-bottom: 1.25em;
}

.reference .ascii {
  margin-bottom: 0.25em;
}

/* index */
.index ul {
  margin: 0 0 0 1em;
  padding: 0;
  list-style: none;
}
.index ul ul {
  margin: 0;
}
.index li {
  margin: 0;
  text-indent: -2em;
  padding-left: 2em;
  padding-bottom: 5px;
}
.indexIndex {
  margin: 0.5em 0 1em;
}
.index a {
  font-weight: 700;
}
/* make the index two-column on all but the smallest screens */
@media (min-width: 600px) {
  .index ul {
    -moz-column-count: 2;
    -moz-column-gap: 20px;
  }
  .index ul ul {
    -moz-column-count: 1;
    -moz-column-gap: 0;
  }
}

/* authors */
address.vcard {
  font-style: normal;
  margin: 1em 0;
}

address.vcard .nameRole {
  font-weight: 700;
  margin-left: 0;
}
address.vcard .label {
  font-family: "Noto Sans",Arial,Helvetica,sans-serif;
  margin: 0.5em 0;
}
address.vcard .type {
  display: none;
}
.alternative-contact {
  margin: 1.5em 0 1em;
}
hr.addr {
  border-top: 1px dashed;
  margin: 0;
  color: #ddd;
  max-width: calc(100% - 16px);
}

/* temporary notes */
.rfcEditorRemove::before {
  position: absolute;
  top: 0.2em;
  right: 0.2em;
  padding: 0.2em;
  content: "The RFC Editor will remove this note";
  color: #b76427;
  background-color: rgba(249, 232, 105, 0.3);
}
.rfcEditorRemove {
  position: relative;
  padding-top: 1.8em;
  background-color: rgba(249, 232, 105, 0.3);
  border-radius: 3px;
}
.cref {
  background-color: rgba(249, 232, 105, 0.3);
  padding: 2px 4px;
}
.crefSource {
  font-style: italic;
}
/* alternative layout for smaller screens */
@media screen and (max-width: 1023px) {
  body {
    padding-top: 2em;
  }
  #title {
    padding: 1em 0;
  }
  h1 {
    font-size: 24px;
  }
  h2 {
    font-size: 20px;
    margin-top: -18px;  /* provide offset for in-page anchors */
    padding-top: 38px;
  }
  #identifiers dd {
    max-width: 60%;
  }
  /* Just get rid of the idiot stuff: */
  /*
  #toc {
    position: fixed;
    z-index: 2;
    top: 0;
    right: 0;
    padding: 0;
    margin: 0;
    background-color: inherit;
    border-bottom: 1px solid #ccc;
  }
  #toc h2 {
    margin: -1px 0 0 0;
    padding: 4px 0 4px 6px;
    padding-right: 1em;
    min-width: 190px;
    font-size: 1.1em;
    text-align: right;
    background-color: #444;
    color: white;
    cursor: pointer;
  }
  #toc h2::before { 
    float: right;
    position: relative;
    width: 1em;
    height: 1px;
    left: -164px;
    margin: 6px 0 0 0;
    background: white none repeat scroll 0 0;
    box-shadow: 0 4px 0 0 white, 0 8px 0 0 white;
    content: "";
  }
  #toc nav {
    display: none;
    padding: 0.5em 1em 1em;
    overflow: auto;
    height: calc(100vh - 48px);
    border-left: 1px solid #ddd;
  }*/
}

/* alternative layout for wide screens */
@media screen and (min-width: 1024px) {
  body {
    max-width: 724px;
    margin: 42px auto;
    padding-left: 1.5em;
    padding-right: 29em;
  }
  #toc {
    position: fixed;
    top: 42px;
    right: 42px;
    width: 25%;
    margin: 0;
    padding: 0 1em;
    z-index: 1;
  }
  #toc h2 {
    border-top: none;
    border-bottom: 1px solid #ddd;
    font-size: 1em;
    font-weight: normal;
    margin: 0;
    padding: 0.25em 1em 1em 0;
  }
  #toc nav {
    display: block;
    height: calc(90vh - 84px);
    bottom: 0;
    padding: 0.5em 0 0;
    overflow: auto;
  }
  img { /* future proofing */
    max-width: 100%;
    height: auto;
  }
}

/* pagination */
@media print {
	/*
  body {
    font-family: 'Noto Serif', "Times New Roman", Times, serif;
    width: 100%;
  }*/
  p {
    orphans: 3;
    widows: 3;
  }
  #n-copyright-notice {
    border-bottom: none;
  }
  #toc, #n-introduction {
    page-break-before: always;
  }
  #toc {
    border-top: none;
    padding-top: 0;
  }
  figure, pre {
    page-break-inside: avoid;
  }
  figure {

  }
  h1, h2, h3, h4, h5, h6 {
    page-break-after: avoid;
	break-after: avoid;
  }
  h2+*, h3+*, h4+*, h5+*, h6+* {
    page-break-before: avoid;
  }
  pre {
    white-space: pre-wrap;
    word-wrap: break-word;
    font-size: 10pt;
  }
  table {
    border: 1px solid #ddd;
  }
  td {
    border-top: 1px solid #ddd;
  }
}

.ears thead .left {
  string-set: ears-top-left content();
}

.ears thead .center {
  string-set: ears-top-center content();
}

.ears thead .right {
  string-set: ears-top-right content();
}

.ears tfoot .left {
  string-set: ears-bottom-left content();
}

.ears tfoot .center {
  string-set: ears-bottom-center content();
}

.ears tfoot .right {
  string-set: ears-bottom-right content();
}

@page :first {
  padding-top: 0;
  @top-left {
    content: normal;
    border: none;
  }
  @top-center {
    content: normal;
    border: none;
  }
  @top-right {
    content: normal;
    border: none;
  }
}


@page {
  size: A4;
  margin-bottom: 45mm;
  padding-top: 20px;
  @top-left {
    content: 'Internet-Draft';
    vertical-align: bottom;
    border-bottom: solid 1px #ccc;
  }
  @top-left {
    content: string(ears-top-left);
    vertical-align: bottom;
    border-bottom: solid 1px #ccc;
  }
  @top-center {
    content: string(ears-top-center);
    vertical-align: bottom;
    border-bottom: solid 1px #ccc;
  }
  @top-right {
    content: string(ears-top-right);
    vertical-align: bottom;
    border-bottom: solid 1px #ccc;
  }
  @bottom-left {
    content: string(ears-bottom-left);
    vertical-align: top;
    border-top: solid 1px #ccc;
  }
  @bottom-center {
    content: string(ears-bottom-center);
    vertical-align: top;
    border-top: solid 1px #ccc;
  }
  @bottom-right {
      content: '[Page ' counter(page) ']';
      vertical-align: top;
      border-top: solid 1px #ccc;
  }
}
    </style>
    <link href="rfc-local.css" rel="stylesheet" type="text/css">
    <link href="urn:issn:2070-1721" rel="alternate">
<link rel="icon" href="data:image/svg+xml;base64,iVBORw0KGgoAAAANSUhEUgAAALQAAAC0CAYAAAA9zQYyAAAABHNCSVQICAgIfAhkiAAAAAlwSFlzAAAJuwAACbsBBxD8PQAAABl0RVh0U29mdHdhcmUAd3d3Lmlua3NjYXBlLm9yZ5vuPBoAAA6LSURBVHic7d1rcFTlGQfw/9lLkk0IuUBQNjEQyIUEAkUIkg7UcFMJ4I3BQpR2xo626nSmln5o7XQInY52OtTp1H5wEMapMxVEKGgCKpchCKKIgEruN5bcISG3zW2zl9MPKWjMbrK72XPe97zn+X3MnssD85/d57znnPeV8H+FKHwIwG8BLAcQA0L41wPgcwnS6zux8yQAGAFgF3btBLAPQCqACHb1ERKQCIxk9pk85MklKDkr7cKuDTLkYtaVETJZEqR8gwx5B+tCCAkFGfIOA4Ac1oUQEiLLDACmsK6CkBCJNrCugJBQokAToVCgiVAo0EQoFGgiFAo0EQoFmgiFAk2EQoEmQqFAE6FQoIlQKNBEKBRoIhQKNBEKBZoIhQJNhEKBJkKhQBOhUKCJUCjQRCgUaCIUCjQRCgWaCIUCTYRCgSZCoUAToVCgiVAo0EQoFGgiFBPrAu4wmAyIT4tHREwEwqaEsS5nFOeAE40XGlU9pzHMiFk/maXqOf3h6HXA3mJH/61+uIfdrMsZg3mgY5JjsPovq5G5ORPmSDPrcrzyuDx4Pel19N/sV+2c4THh2H5yu2rnC5TsltH4eSPOvXoOtR/Vsi7nLqYtR9zcODz/1fNYuH0ht2EGRn49FmxdwLoMrkhGCckrklFwrACLfraIdTl3MQ10XmEeIhMiWZbgt4XPLGRdApckScKaV9cAEutKRjAN9H2597E8fUCsS62YnjmddRlcik6MhiXewroMADTKERD6lvbO4/LA0etgXQYAxoFuON/A8vQByy7I5uanlScN5xrgcXpYlwGAcaDP/vksBjsHWZYQkNjZsZi1kr+hNJaGuodw4ncnWJdxF9NAd9V34e2Vb6PlUgvLMgJCbccIj8uD0gOl2Lt8L1qvtLIu5y7m49Dt5e1464G3kLgsEfMen4f0jemYsWAG67J8ytqSheO/Pg63g7+bCkqTZRmNnzWidH8pyt4vw0D7AOuSxmAeaACADDRfbEbzxWac/sNpRCdGI/PJTKx8ZSWm3MvXMooRsRFI35iOisMVrEtRleyWceDxA6gurmZdyri4HOWwN9vx5RtfYs+SPeiq62Jdzhh6bDu+eecb7sMMcBroO+wtdux/dD93P+9p+WncjLuqpez9MtYl+IXrQAMjPfaF3RdYlzGKMcyI+T+dz7oMVfXc6GFdgl+4DzQAXPj7BW4G7u9Y+LS+2g57q511CX7RRKCHuoZwdd9V1mWMkvTjJMTNiWNdhmp4a/t80USgAeDynsuQZZl1GXdJkqTLi0PeaSbQHZUd3N2AoUDzRzOBBoDS/aWsSxglPi0eicsSWZdBvkdbgX6vFLKbn7YDoG9p3mgq0H2tfbjx6Q3WZYyyYOsCGMzB/zcaw4whrIZoKtAAUHqAr7YjMiESqQ+nBrWvyWKCNcca4or0TXOBLnu/jLu3jYNtO1JWpSAsiq833LVOc4Ee6hpC/cl61mWMkvFYBsJjwgPeL21DmgLV6JvmAg0A1/ZfY13CKKYIEzKfzAx4v7R8CnSoaTLQlUcr4ex3si5jlEDbjhnZMxA7O1ahavRLk4F29jtRc7yGdRmjzM6bjan3TfV7+/SN6QpWo1+aDDTAX9shGaSRl2j9lL6BAq0EzQa65ngNhrqHWJcxir8zCFniLUh8gO4wKkGzgXY73Kg8Wsm6jFESshJw74/unXC7tPw0GEya/a/nmqb/V3m7yQIA2U9P3HbQcJ1yNB3o66evqzojqD+yC7IhGX3PRiMZJcxdN1fFivRF04H2uDwoP1zOuoxRoq3RSFmd4vPz5BXJsEzT1/uIatJ0oAH+HikFxh+TptENZWk+0A2fNXD3AmfW5iyfqxBQ/6wszQcaMn+v2JujzMh4NGPM32NTYpGQlcCgIv3QVKB9vZTKZduxfWzbQe2G8jQVaF9DYq1XWtFR0aFyNeObs3bOmGnM6Ha38jQV6PlPzYfJ4n06vrKDfLUdP1yXxRxlxqwHaSpepWkq0OFTw33+bPN4k+X7ox1z182FKYKPuTFFpqlAA76HxDoqO9D2dZvK1Yxv5pKZSJg/chFIoxvq0Fyg0/LTEDnd+8pZPF4c3lnGIm09BVoNmgu0wWxA1pYsr59d23+Nq9mVgJFfFOsSK6ITo1mXoguaCzQALNru/THN3sZeNF1oUrma8cUkx2DNa2tYl6Ebmgx0Um4SpqVP8/oZjxeHc9bOYV2Cbmgy0ACwYJv3pYpL3yuFx8XHEmNEfZoN9MKnF3pdM3CgfQC2MzbV6wlWTwNfz6FonWYDPd5EiTy2Hd501naio5KvO5xap9lAA77HpMsPlcM15FK5msBVHuHrFTIRaDrQ2duyvU526Oh1oO6TOgYVBabqwyrWJQhH04G2TLNg7sPeX2fibZqDHxq8PYjGzxtZlyEcTQca8L14T3VRNYb7hlWuxn9VRVXczXUtAs0HOuOxDETERoz5u3PAieoifheKpHZDGZoP9HgTJfLadrgdbtSf4msGVVFoPtCA79GO2o9rMXh7UOVqJlZ/qh7Ddn7bIS0TItCzHpzldaJEj9ODiiP8LTJP7YZyhAj0eBMl8naTRZZlVB/jt7fXOiECDfieKNF2xgZ7Cz/L+rZ82QJ7Mz/1iEaYQPuaKFH2yCg/xM/sStRuKEuYQAO+l3jgqe2oKqJAK0moQPta86/piyZ0X+9WuZqxuuq7cOvaLdZlCE2oQPskjzwnzVrVB/TtrDR9BBp8vEBL/bPydBPom9/eRHtZO7PzD3YOouF8A7Pz64VuAg2wbTtqjtfQq2Eq0FWgr73LbpoDajfUoatAd9V1ofVyq+rndTvcmnjhQAS6CjTA5uLw+pnrcPQ6VD+vHukv0AdKIXvUbTuo3VCP7gJtb7GrOtogyzLXLxqIRneBBtRtO9qutKG3qVe18+mdLgNdfqgcHqc6Q2jUbqhLl4Ee6BhQ7RWoyg9o7g016TLQgDpP4PU09ODmtzcVPw/5jm4DXXGkAq5BZWdXqvqgCqCZClSl20AP24dRc7xG0XNQ/6w+3QYaULbtcPQ4cOPTG4odn3in60BXF1fD0aPMHbya4zVwD7sVOTbxTdeBdg25FGsLqN1gQ9eBBpSZXcnj9KD249qQH5dMTPeBrj9Zj/5b/SE9pu2sDUPdQyE9JvGP7gPtcXlCPvE4tRvsaCrQksHLoiohEOq2gx5GYkdTgQ6bEjbu5wZTcP+chnMNIXuAqO3rNnTb2E+ZoFdiBdoc3D9H9sgoO1gW1L4/RO0GW5oJtCXeMuE3sCncFPTxQ3WThdoNtjQT6OmZ0yfcxtei9v5oudSCzprOoPcHAHuzHS2XWyZ1DDI5mgl0QmbChNtMdoH4yU5zUFVEDyOxpplAp6xJmXCbpOVJMEeagz7Htf9MbrSj8ig9+8yaJgJtMBmQ+nDqhNuZIkzIeCwj6PN0VHYE/fzysH0YthJb0OcmoaGJQKdvTEdE3NiVrrzJfTl3UucK9uKw9pNauB30MBJrmgh07g7/Q2rNsU7qW7r0QGlQsyuFerjOaPY+NTAzytzTCjnuA526PhXJK5ID2ueh3Q/BHBVcL919vRvNF5sD2sfj8qDmWGhfFrDEW0J6vMmKnBb8CJKauA50WHQYNr65MeD94lPjsWnPpqDPG2jb0fhZIwY7Q7t83IzsGSE93mRNmTmFdQl+4TbQklHCE/9+AjHJMUHtn12Qjfx/5Qf1U1l2sCygZYuVeLN7/lPzQ37MybAutbIuwS98BloC8t/Ix7wn5k3qMDkv5aCguCDgb5e+1j7Yztr83j7U/XPGoxmTug5QQu7LuQiLHv/RAx5wF2hzlBlbDm7B0heWhuR4aflpeLH0RSx+dnFA39b+zq7UXtaOrrquIKv7TtiUMKSuT8Uj/3gEWw5ugSTxdRUWNzcOBcUFsOZYub5AlApRyM29raTlSdi0Z5Ni/aOtxIbiXxbjdvXtCbe1xFuwo3WHz4WI7jj/2nmcfuV0UPXEpsQiuyAb6RvSYc2xBv20oNp6GnpQ8d8KXNl7hemqCN5wEeiI2Ais/eta3P/c/Yo983yHa9CFU78/hYv/vDjhttuKtiF9Y/q42+zL3YemL5oCrmP5b5Zj3d/WBf2EIA9kWcbVvVdx7MVj3KxOYMxDXiHLAhKXJeLZc89idt5sVX5mDWYDUtenwmA0wHbGNu62kiQhc3Omz8/72vpwYseJgJ/fSFmdgs3vboZk5Pi32w+SJGHmkpmADG7ukjL9ejCGGbH16FYmQ0Ir/7gS9yy6Z9xtqj6sgnPA6fPz6qLqoOaaXvyLxQHvw7Ocl3JYl3AX00DHpsQyG9+UDNKEz4cM9w2P+3xzsKMbcSlxQe3Hq8jpkYiI9e/RBKUxDTTriVjczonP7+smi7PfifrTwc1g2nezL6j9eOVxeeAaUnaeQH8xDXT39W5ms3O6h91+vV1S81GN1ykJ6k7WBT3Z41dvfsVsNS4lVH1YRYG+49DWQ34No4XSsH0YR39+FJ21E7+h4na4vU5zMJlljus+qUPRc0VCzN3RcL4Bxb8qZl3GXVwM2xlMIyMPScuTEG2NRtSMqAnHfwMiA/23+tF/qx+3ym6h8khlQM9eJK9IxoM7Hxz1t8MFhzHQPjCpssxRZsxZOwcz75+JqIQoRN0ThfCp4ZM6ptJcQy70tfWht6kXthLbyISUzBP0HS4CTUioMG85CAklCjQRCgWaCIUCTYRCgSZCoUAToVCgiVAo0EQoFGgiFAo0EQoFmgiFAk2EQoEmQqFAE6FQoIlQKNBEKBRoIhQKNBEKBZoIhQJNhEKBJkKhQBOhUKCJUCjQRCgUaCIUCjQRCgWaCIUCTYRCgSZCoUAToVCgiVAo0EQoFGgiFAMAO+siCAmRHgOAS6yrICRELhkkSLtZV0FIKEiQdhtLUFK7Cqs8APIAaHvxaaJXsgTpTzux820jAJSg5NNVWHUeQAKA6QAsTMsjxD9dAM4AeKEQhe8AwP8A7VA52MoWrGIAAAAASUVORK5CYII=">  </head>
  <body>
    <table class="ears">
      <thead>
        <tr>
          <td class="left"/>
          <td class="center">Mesh Architecture 3.0</td>
          <td class="right">March 2020</td>
        </tr>
      </thead>
      <tfoot>
        <tr>
          <td class="left">Hallam-Baker</td>
          <td class="center">Expires September 10, 2020</td>
          <td class="right">[Page]</td>
        </tr>
      </tfoot>
    </table>

    <div id="external-metadata" class="document-information">
    </div>
    <div id="internal-metadata" class="document-information">
      <dl id="identifiers">
        <dt class="label-workgroup">Workgroup:</dt>
        <dd class="workgroup">Network Working Group</dd>
        <dt class="label-stream">Stream:</dt>
        <dd class="stream">Internet-Draft</dd>
        <dt class="label-category">Intended status:</dt>
        <dd class="category">Informational</dd>
        <dt>Published:</dt>
        <dd>
          <time class="published" datetime="2020-03-09">9 March 2020</time>
        </dd>
        <dt class="label-issn">ISSN:</dt>
        <dd class="issn">2070-1721</dd>
        <dt>Expires</dt>
        <dd>
          <time class="expires" datetime="2020-09-10">10 September 2020</time>
        </dd>
        <dt>Authors:</dt>
        <dd class="authors">
          <div class="author">
<div class="author-name">Phillip Hallam-Baker</div><div class="org">ThresholdSecrets.com</div>          </div>
        </dd>
      </dl>
    </div>
    <h1 id="title">
      Mathematical Mesh 3.0 Part I: Architecture Guide
      <h1 id="idnum">draft-hallambaker-mesh-architecture-13</h1>
    </h1>
    <section id="abstract">
      <h3>
        <a class="selfRef" href="#abstract">Abstract</a>
      </h3>
      <p id="s-abstract-1">The Mathematical Mesh ‘The Mesh’ is an end-to-end secure infrastructure that makes computers easier to use by making them more secure. The Mesh provides a set of protocol and cryptographic building blocks that enable encrypted data stored in the cloud to be accessed, managed and exchanged between users with the same or better ease of use than traditional approaches which leave the data vulnerable to attack.<a class="pilcrow" href="#s-abstract-1">&para;</a></p>
      <p id="s-abstract-2">This document provides an overview of the Mesh data structures, protocols and examples of its use.<a class="pilcrow" href="#s-abstract-2">&para;</a></p>
      <p id="s-abstract-3">[Note to Readers]<a class="pilcrow" href="#s-abstract-3">&para;</a></p>
      <p id="s-abstract-4">Discussion of this draft takes place on the MATHMESH mailing list (mathmesh@ietf.org), which is archived at https://mailarchive.ietf.org/arch/search/?email_list=mathmesh.<a class="pilcrow" href="#s-abstract-4">&para;</a></p>
      <p id="s-abstract-5">This document is also available online at <a class="eref" href="http://mathmesh.com/Documents/draft-hallambaker-mesh-architecture.html">http://mathmesh.com/Documents/draft-hallambaker-mesh-architecture.html</a>.<a class="pilcrow" href="#s-abstract-5">&para;</a></p>
    </section>
    
    <section id="n-status-of-this-memo">
      <h3 id="bp-1">
        <a class="selfRef" href="#bp-1"></a>
        <a class="selfRef" href="#n-status-of-this-memo">Status of This Memo</a>
      </h3>
      <p id="bp-1-1">This Internet-Draft is submitted in full conformance with the provisions of BCP 78 and BCP 79.<a class="pilcrow" href="#bp-1-1">&para;</a></p>
      <p id="bp-1-2">Internet-Drafts are working documents of the Internet Engineering Task Force (IETF).  Note that other groups may also distribute working documents as Internet-Drafts. The list of current Internet-Drafts is at <a class="eref" href="http://datatracker.ietf.org/drafts/current/">http://datatracker.ietf.org/drafts/current/</a>.<a class="pilcrow" href="#bp-1-2">&para;</a></p>
      <p id="bp-1-3">Internet-Drafts are draft documents valid for a maximum of six months and may be updated, replaced, or obsoleted by other documents at any time.It is inappropriate to use Internet-Drafts as reference material or to cite them other than as "work in progress."<a class="pilcrow" href="#bp-1-3">&para;</a></p>
      <p id="bp-1-4">This Internet-Draft will expire on September 10, 2020<a class="pilcrow" href="#bp-1-4">&para;</a></p>
    </section>
    
    <section id="n-copyright-notice">
      <h3 id="bp-2">
        <a class="selfRef" href="#bp-2"></a>
        <a class="selfRef" href="#n-copyright-notice">Copyright Notice</a>
      </h3>
      <p id="bp-2-1">Copyright (c) IETF Trust and the persons identified as the document authors. All rights reserved.<a class="pilcrow" href="#bp-2-1">&para;</a></p>
      <p id="bp-2-2">This document is subject to BCP 78 and the IETF Trust’s Legal Provisions Relating to IETF Documents (http://trustee.ietf.org/license-info) in effect on the date of publication of this document. Please review these documents carefully, as they describe your rights and restrictions with respect to this document.<a class="pilcrow" href="#bp-2-2">&para;</a></p>
    </section>
    
    <section id="toc">
      <h3>
        <a class="selfRef" href="#toc">Table of Contents</a>
      </h3>
      <nav class="toc">
        <ul class="toc">
          <li class="toc">
            <a href="#s-1">1.</a><a href="#n-introduction">Introduction</a>
          </li>
          <li class="toc">
            <a href="#s-2">2.</a><a href="#n-definitions">Definitions</a>
            <ul class="toc">
              <li class="toc">
                <a href="#s-2_1">2.1.</a><a href="#n-related-specifications">Related Specifications</a>
              </li>
              <li class="toc">
                <a href="#s-2_2">2.2.</a><a href="#n-defined-terms">Defined Terms</a>
              </li>
              <li class="toc">
                <a href="#s-2_3">2.3.</a><a href="#n-requirements-language">Requirements Language</a>
              </li>
              <li class="toc">
                <a href="#s-2_4">2.4.</a><a href="#n-implementation-status">Implementation Status</a>
              </li>
            </ul>
          </li>
          <li class="toc">
            <a href="#s-3">3.</a><a href="#n-architecture">Architecture</a>
            <ul class="toc">
              <li class="toc">
                <a href="#s-3_1">3.1.</a><a href="#n-a-personal-pki">A Personal PKI</a>
                <ul class="toc">
                  <li class="toc">
                    <a href="#s-3_1_1">3.1.1.</a><a href="#n-device-management">Device Management</a>
                  </li>
                  <li class="toc">
                    <a href="#s-3_1_2">3.1.2.</a><a href="#n-exchange-of-trusted-credentials">Exchange of trusted credentials.</a>
                  </li>
                  <li class="toc">
                    <a href="#s-3_1_3">3.1.3.</a><a href="#n-application-configuration-management">Application configuration management</a>
                  </li>
                  <li class="toc">
                    <a href="#s-3_1_4">3.1.4.</a><a href="#n-the-mesh-as-platform">The Mesh as platform</a>
                  </li>
                </ul>
              </li>
              <li class="toc">
                <a href="#s-3_2">3.2.</a><a href="#n-mesh-architecture">Mesh Architecture</a>
                <ul class="toc">
                  <li class="toc">
                    <a href="#s-3_2_1">3.2.1.</a><a href="#n-mesh-device-management">Mesh Device Management</a>
                  </li>
                  <li class="toc">
                    <a href="#s-3_2_2">3.2.2.</a><a href="#n-mesh-account">Mesh Account</a>
                    <ul class="toc">
                      <li class="toc">
                        <a href="#s-3_2_2_1">3.2.2.1.</a><a href="#n-account-catalogs">Account Catalogs</a>
                      </li>
                    </ul>
                  </li>
                  <li class="toc">
                    <a href="#s-3_2_3">3.2.3.</a><a href="#n-mesh-service">Mesh Service</a>
                  </li>
                  <li class="toc">
                    <a href="#s-3_2_4">3.2.4.</a><a href="#n-mesh-messaging">Mesh Messaging</a>
                  </li>
                </ul>
              </li>
              <li class="toc">
                <a href="#s-3_3">3.3.</a><a href="#n-using-the-mesh-with-applications">Using the Mesh with Applications</a>
                <ul class="toc">
                  <li class="toc">
                    <a href="#s-3_3_1">3.3.1.</a><a href="#n-contact-exchange">Contact Exchange</a>
                  </li>
                  <li class="toc">
                    <a href="#s-3_3_2">3.3.2.</a><a href="#n-confirmation-protocol">Confirmation Protocol</a>
                  </li>
                  <li class="toc">
                    <a href="#s-3_3_3">3.3.3.</a><a href="#n-future-applications">Future Applications</a>
                  </li>
                </ul>
              </li>
            </ul>
          </li>
          <li class="toc">
            <a href="#s-4">4.</a><a href="#n-mesh-cryptography">Mesh Cryptography</a>
            <ul class="toc">
              <li class="toc">
                <a href="#s-4_1">4.1.</a><a href="#n-best-practice-by-default">Best Practice by Default</a>
              </li>
              <li class="toc">
                <a href="#s-4_2">4.2.</a><a href="#n-multilevel-security">Multi-Level Security</a>
              </li>
              <li class="toc">
                <a href="#s-4_3">4.3.</a><a href="#n-multikey-decryption">Multi-Key Decryption</a>
              </li>
              <li class="toc">
                <a href="#s-4_4">4.4.</a><a href="#n-multiparty-key-generation">Multi-Party Key Generation</a>
              </li>
              <li class="toc">
                <a href="#s-4_5">4.5.</a><a href="#n-data-at-rest-encryption">Data At Rest Encryption</a>
                <ul class="toc">
                  <li class="toc">
                    <a href="#s-4_5_1">4.5.1.</a><a href="#n-dare-envelope">DARE Envelope</a>
                  </li>
                  <li class="toc">
                    <a href="#s-4_5_2">4.5.2.</a><a href="#n-dare-container">Dare Container</a>
                  </li>
                </ul>
              </li>
              <li class="toc">
                <a href="#s-4_6">4.6.</a><a href="#n-uniform-data-fingerprints">Uniform Data Fingerprints.</a>
                <ul class="toc">
                  <li class="toc">
                    <a href="#s-4_6_1">4.6.1.</a><a href="#n-friendly-names">Friendly Names</a>
                  </li>
                  <li class="toc">
                    <a href="#s-4_6_2">4.6.2.</a><a href="#n-encrypted-authenticated-resource-locators">Encrypted Authenticated Resource Locators</a>
                  </li>
                  <li class="toc">
                    <a href="#s-4_6_3">4.6.3.</a><a href="#n-secure-internet-names">Secure Internet Names</a>
                  </li>
                </ul>
              </li>
              <li class="toc">
                <a href="#s-4_7">4.7.</a><a href="#n-personal-key-escrow">Personal Key Escrow</a>
              </li>
            </ul>
          </li>
          <li class="toc">
            <a href="#s-5">5.</a><a href="#n-user-experience">User Experience</a>
            <ul class="toc">
              <li class="toc">
                <a href="#s-5_1">5.1.</a><a href="#n-creating-a-mesh-profile-and-administration-device">Creating a Mesh Profile and Administration Device.</a>
              </li>
              <li class="toc">
                <a href="#s-5_2">5.2.</a><a href="#n-mesh-accounts">Mesh Accounts</a>
              </li>
              <li class="toc">
                <a href="#s-5_3">5.3.</a><a href="#n-using-a-mesh-service">Using a Mesh Service</a>
              </li>
              <li class="toc">
                <a href="#s-5_4">5.4.</a><a href="#n-connecting-and-authorizing-additional-devices">Connecting and Authorizing Additional Devices</a>
                <ul class="toc">
                  <li class="toc">
                    <a href="#s-5_4_1">5.4.1.</a><a href="#n-direct-connection">Direct Connection</a>
                  </li>
                  <li class="toc">
                    <a href="#s-5_4_2">5.4.2.</a><a href="#n-pin-connection">Pin Connection</a>
                  </li>
                  <li class="toc">
                    <a href="#s-5_4_3">5.4.3.</a><a href="#n-earlqr-code-connection">EARL/QR Code Connection</a>
                  </li>
                </ul>
              </li>
              <li class="toc">
                <a href="#s-5_5">5.5.</a><a href="#n-contact-requests">Contact Requests</a>
                <ul class="toc">
                  <li class="toc">
                    <a href="#s-5_5_1">5.5.1.</a><a href="#n-remote">Remote</a>
                  </li>
                  <li class="toc">
                    <a href="#s-5_5_2">5.5.2.</a><a href="#n-static-qr-code">Static QR Code</a>
                  </li>
                  <li class="toc">
                    <a href="#s-5_5_3">5.5.3.</a><a href="#n-dynamic-qr-code">Dynamic QR Code</a>
                  </li>
                </ul>
              </li>
              <li class="toc">
                <a href="#s-5_6">5.6.</a><a href="#n-sharing-confidential-data-in-the-cloud">Sharing Confidential Data in the Cloud</a>
              </li>
              <li class="toc">
                <a href="#s-5_7">5.7.</a><a href="#n-escrow-and-recovery-of-keys">Escrow and Recovery of Keys</a>
              </li>
            </ul>
          </li>
          <li class="toc">
            <a href="#s-6">6.</a><a href="#n-security-considerations">Security Considerations</a>
          </li>
          <li class="toc">
            <a href="#s-7">7.</a><a href="#n-iana-considerations">IANA Considerations</a>
          </li>
          <li class="toc">
            <a href="#s-8">8.</a><a href="#n-acknowledgements">Acknowledgements</a>
          </li>
          <li class="toc">
<a href="#n-references">References</a>
            <ul class="toc">
              <li class="toc">
<a href="#n-normative">Normative References</a>
              </li>
            </ul>
          </li>
        </ul>
        <ul class="toc">
          <li class="toc">
            <a href="#"></a><a href="#n-authors">Author's Address</a>
          </li>
        </ul>
        <h3 id="tof">
          <a class="selfRef" href="#tof">Table of Figures</a>
        </h3>
        <ul class="toc">
          <li class="toc">
            <a href="#n-mapping-of-device-profile-and-device-private-to-device-connection-keys">Figure 1</a>: <a href="#n-mapping-of-device-profile-and-device-private-to-device-connection-keys">Mapping of Device Profile and Device Private to Device Connection Keys.</a>
          </li>
          <li class="toc">
            <a href="#n-account-profile-connected-to-devices-and-services">Figure 2</a>: <a href="#n-account-profile-connected-to-devices-and-services">Account Profile Connected to Devices and Services.</a>
          </li>
          <li class="toc">
            <a href="#n-account-key-set">Figure 3</a>: <a href="#n-account-key-set">Account Key Set.</a>
          </li>
          <li class="toc">
            <a href="#n-service-profile-and-delegated-host-assertion">Figure 4</a>: <a href="#n-service-profile-and-delegated-host-assertion">Service Profile and Delegated Host Assertion.</a>
          </li>
          <li class="toc">
            <a href="#n-performing-access-control-on-outbound-messages">Figure 5</a>: <a href="#n-performing-access-control-on-outbound-messages">Performing Access Control on Outbound Messages</a>
          </li>
          <li class="toc">
            <a href="#n-performing-access-control-on-inbound-messages">Figure 6</a>: <a href="#n-performing-access-control-on-inbound-messages">Performing Access Control on Inbound Messages</a>
          </li>
          <li class="toc">
            <a href="#n-master-profile-and-subordinate-devices-and-accounts">Figure 7</a>: <a href="#n-master-profile-and-subordinate-devices-and-accounts">Master Profile and Subordinate Devices and Accounts.</a>
          </li>
          <li class="toc">
            <a href="#n-master-profile-and-associated-device-and-account-connection-assertions">Figure 8</a>: <a href="#n-master-profile-and-associated-device-and-account-connection-assertions">Master Profile and Associated Device and Account Connection Assertions.</a>
          </li>
          <li class="toc">
            <a href="#n-each-of-alices-devices-have-access-to-the-shared-context-of-her-personal-account">Figure 9</a>: <a href="#n-each-of-alices-devices-have-access-to-the-shared-context-of-her-personal-account">Each of Alice's devices have access to the shared context of her personal account.</a>
          </li>
          <li class="toc">
            <a href="#n-two-key-decryption">Figure 10</a>: <a href="#n-two-key-decryption">Two key decryption.</a>
          </li>
          <li class="toc">
            <a href="#n-two-party-key-pair-generation">Figure 11</a>: <a href="#n-two-party-key-pair-generation">Two party key pair generation.</a>
          </li>
          <li class="toc">
            <a href="#n-dare-container-containing-a-transaction-log">Figure 12</a>: <a href="#n-dare-container-containing-a-transaction-log">DARE Container containing a transaction log.</a>
          </li>
          <li class="toc">
            <a href="#n-qr-code-representation-of-the-earl">Figure 13</a>: <a href="#n-qr-code-representation-of-the-earl">QR Code representation of the EARL</a>
          </li>
          <li class="toc">
            <a href="#n-use-of-shamir-secret-sharing-to-create-a-recovery-record">Figure 14</a>: <a href="#n-use-of-shamir-secret-sharing-to-create-a-recovery-record">Use of Shamir Secret Sharing to create a recovery record.</a>
          </li>
          <li class="toc">
            <a href="#n-use-of-shamir-secret-recovery-to-recover-a-master-key-set">Figure 15</a>: <a href="#n-use-of-shamir-secret-recovery-to-recover-a-master-key-set">Use of Shamir Secret Recovery to recover a master key set.</a>
          </li>
          <li class="toc">
            <a href="#n-constrained-devices-connected-through-a-mesh-hub">Figure 16</a>: <a href="#n-constrained-devices-connected-through-a-mesh-hub">Constrained Devices connected through a Mesh Hub.</a>
          </li>
          <li class="toc">
            <a href="#n--bob-can-only-decrypt-messages-encrypted-to-group-w-if-the-cloud-service-allows-">Figure 17</a>: <a href="#n--bob-can-only-decrypt-messages-encrypted-to-group-w-if-the-cloud-service-allows-"> Bob can only decrypt messages encrypted to Group W if the cloud service allows. </a>
          </li>
          <li class="toc">
            <a href="#n-alices-personal-mesh">Figure 18</a>: <a href="#n-alices-personal-mesh">Alice's personal Mesh.</a>
          </li>
        </ul>
      </nav>
    </section>
    
    <section id="n-introduction">
      <h3 id="s-1">
        <a class="selfRef" href="#s-1">1.</a>
        <a class="selfRef" href="#n-introduction">Introduction</a>
      </h3>
      <p id="s-1-1">The Mathematical Mesh (Mesh) is a user centered Public Key Infrastructure that uses cryptography to make computers easier to use. The Mesh provides an infrastructure that addresses the three concerns that have proved obstacles to the use of end-to-end security in computer applications:<a class="pilcrow" href="#s-1-1">&para;</a></p>
      <ul id="s-1-2-">
        <li id="s-1-2">Device management.<a class="pilcrow" href="#s-1-2">&para;</a></li>
        <li id="s-1-3">Exchange of trusted credentials.<a class="pilcrow" href="#s-1-3">&para;</a></li>
        <li id="s-1-4">Application configuration management.<a class="pilcrow" href="#s-1-4">&para;</a></li>
      </ul>
      <p id="s-1-5">The infrastructure developed to address these original motivating concerns can be used to facilitate deployment and use of existing security protocols (OpenPGP, S/MIME, SSH) and as a platform for building end-to-end secure network applications. Current Mesh applications include:<a class="pilcrow" href="#s-1-5">&para;</a></p>
      <ul id="s-1-6-">
        <li id="s-1-6">Multi-factor authentication and confirmation<a class="pilcrow" href="#s-1-6">&para;</a></li>
        <li id="s-1-7">Credential management <a class="pilcrow" href="#s-1-7">&para;</a></li>
        <li id="s-1-8">Bookmark/Citation management<a class="pilcrow" href="#s-1-8">&para;</a></li>
        <li id="s-1-9">Task and workflow management<a class="pilcrow" href="#s-1-9">&para;</a></li>
      </ul>
      <p id="s-1-10">A core principle of the design of the Mesh is that each person is their own source of authority. They may choose to delegate that authority to another to act on their behalf (i.e. a Trusted Third Party) and they may choose to surrender parts of that authority to others (e.g. an employer) for limited times and limited purposes.<a class="pilcrow" href="#s-1-10">&para;</a></p>
      <p id="s-1-11">Thus, from the user's point of view, the Mesh is divided into two parts. The first and most important of these from their point of view being their own personal Mesh. The second being the ensemble of every Mesh to which their Mesh is connected. As with the Internet, which is a network of networks, a Mesh of Meshes has certain properties that are similar to those of its constituent parts and some that are very different.<a class="pilcrow" href="#s-1-11">&para;</a></p>
      <p id="s-1-12">This document is not normative. It provides an overview of the Mesh comprising a description of the architecture, and a discussion of typical use cases and requirements. The remainder of the document series provides a summary of the principal components of the Mesh architecture and their relationship to each other.<a class="pilcrow" href="#s-1-12">&para;</a></p>
      <p id="s-1-13">Normative descriptions of the individual Mesh encodings, data structures and protocols are provided in separate documents addressing each component in turn.<a class="pilcrow" href="#s-1-13">&para;</a></p>
      <p id="s-1-14">The currently available Mesh document series comprises:<a class="pilcrow" href="#s-1-14">&para;</a></p>
      <dl id="s-1-15-" class="nohang">
        <dt id="s-1-15">I. Architecture (This document.)<a class="pilcrow" href="#s-1-15">&para;</a></dt>
        <dd id="null">Provides an overview of the Mesh as a system and the relationship between its constituent parts.<a class="pilcrow" href="#">&para;</a></dd>
        <dt id="s-1-16">II. Uniform Data Fingerprint <a class="xref" href="#draft-hallambaker-mesh-udf">[draft-hallambaker-mesh-udf]</a>.<a class="pilcrow" href="#s-1-16">&para;</a></dt>
        <dd id="null">Describes the UDF format used to represent cryptographic nonces, keys and content digests in the Mesh and the use of Encrypted Authenticated Resource Locators (EARLs) and Strong Internet Names (SINs) that build on the UDF platform.<a class="pilcrow" href="#">&para;</a></dd>
        <dt id="s-1-17">III. Data at Rest Encryption <a class="xref" href="#draft-hallambaker-mesh-dare">[draft-hallambaker-mesh-dare]</a>.<a class="pilcrow" href="#s-1-17">&para;</a></dt>
        <dd id="null">Describes the cryptographic message and append-only sequence formats used in Mesh applications and the Mesh Service protocol.<a class="pilcrow" href="#">&para;</a></dd>
        <dt id="s-1-18">IV. Schema Reference <a class="xref" href="#draft-hallambaker-mesh-schema">[draft-hallambaker-mesh-schema]</a>.<a class="pilcrow" href="#s-1-18">&para;</a></dt>
        <dd id="null">Describes the syntax and semantics of Mesh Profiles, Container Entries and Mesh Messages and their use in Mesh Applications.<a class="pilcrow" href="#">&para;</a></dd>
        <dt id="s-1-19">V. Protocol Reference <a class="xref" href="#draft-hallambaker-mesh-protocol">[draft-hallambaker-mesh-protocol]</a>.<a class="pilcrow" href="#s-1-19">&para;</a></dt>
        <dd id="null">Describes the Mesh Service Protocol.<a class="pilcrow" href="#">&para;</a></dd>
        <dt id="s-1-20">VI. The Trust Mesh <a class="xref" href="#draft-hallambaker-mesh-trust">[draft-hallambaker-mesh-trust]</a>.<a class="pilcrow" href="#s-1-20">&para;</a></dt>
        <dd id="null">Describes the social work factor metric used to evaluate the effectiveness of different approaches to exchange of credentials between users and organizations in various contexts and argues for a hybrid approach taking advantage of direct trust, Web of Trust and Trusted Third Party models to provide introductions.<a class="pilcrow" href="#">&para;</a></dd>
        <dt id="s-1-21">VII. Security Considerations <a class="xref" href="#draft-hallambaker-mesh-security"></a><a class="pilcrow" href="#s-1-21">&para;</a></dt>
        <dd id="null">Describes the security considerations for the Mesh protocol suite.<a class="pilcrow" href="#">&para;</a></dd>
        <dt id="s-1-22">VIII Cryptographic Algorithms <a class="xref" href="#draft-hallambaker-mesh-cryptography">[draft-hallambaker-mesh-cryptography]</a>.<a class="pilcrow" href="#s-1-22">&para;</a></dt>
        <dd id="null">Describes the recommended and required algorithm suites for Mesh applications and the implementation of the multi-party cryptography techniques used in the Mesh.<a class="pilcrow" href="#">&para;</a></dd>
      </dl>
      <p id="s-1-23">The following documents describe technologies that are used in the Mesh but do not form part of the Mesh specification suite:<a class="pilcrow" href="#s-1-23">&para;</a></p>
      <dl id="s-1-24-" class="nohang">
        <dt id="s-1-24">JSON-BCD Encoding <a class="xref" href="#draft-hallambaker-jsonbcd">[draft-hallambaker-jsonbcd]</a>.<a class="pilcrow" href="#s-1-24">&para;</a></dt>
        <dd id="null">Describes extensions to the JSON serialization format to allow direct encoding of binary data (JSON-B), compressed encoding (JSON-C) and extended binary data encoding (JSON-D). Each of these encodings is a superset of the previous one so that JSON-B is a superset of JSON, JSON-C is a superset of JSON-B and JSON-D is a superset of JSON-C.<a class="pilcrow" href="#">&para;</a></dd>
        <dt id="s-1-25">DNS Web Service Discovery <a class="xref" href="#draft-hallambaker-web-service-discovery">[draft-hallambaker-web-service-discovery]</a>.<a class="pilcrow" href="#s-1-25">&para;</a></dt>
        <dd id="null">Describes the means by which prefixed DNS SRV and TXT records are used to perform discovery of Web Services.<a class="pilcrow" href="#">&para;</a></dd>
      </dl>
      <p id="s-1-26">The following documents describe aspects of the Mesh Reference implementation:<a class="pilcrow" href="#s-1-26">&para;</a></p>
      <dl id="s-1-27-" class="nohang">
        <dt id="s-1-27">Mesh Developer <a class="xref" href="#draft-hallambaker-mesh-developer">[draft-hallambaker-mesh-developer]</a>.<a class="pilcrow" href="#s-1-27">&para;</a></dt>
        <dd id="null">Describes the reference code distribution license terms, implementation status and currently supported functions.<a class="pilcrow" href="#">&para;</a></dd>
        <dt id="s-1-28">Mesh Platform <a class="xref" href="#draft-hallambaker-mesh-platform">[draft-hallambaker-mesh-platform]</a>.<a class="pilcrow" href="#s-1-28">&para;</a></dt>
        <dd id="null">Describes how platform specific functionality such as secure key storage and trustworthy computing features are employed in the Mesh.<a class="pilcrow" href="#">&para;</a></dd>
      </dl>
      
      <section id="n-definitions">
        <h3 id="s-2">
          <a class="selfRef" href="#s-2">2.</a>
          <a class="selfRef" href="#n-definitions">Definitions</a>
        </h3>
      </section>
      <p id="s-2-1">This section presents the related specifications and standards on which the Mesh is built, the terms that are used as terms of art within the Mesh protocols and applications and the terms used as requirements language.<a class="pilcrow" href="#s-2-1">&para;</a></p>
    </section>
    
    <section id="n-related-specifications">
      <h4 id="s-2_1">
        <a class="selfRef" href="#s-2_1">2.1.</a>
        <a class="selfRef" href="#n-related-specifications">Related Specifications</a>
      </h4>
      <p id="s-2_1-1">Besides the documents that form the Mesh core, the Mesh makes use of many existing Internet standards, including:<a class="pilcrow" href="#s-2_1-1">&para;</a></p>
      <dl id="s-2_1-2-" class="nohang">
        <dt id="s-2_1-2">Cryptographic Algorithms<a class="pilcrow" href="#s-2_1-2">&para;</a></dt>
        <dd id="null">The <span class="bcp14">RECOMMENDED</span> and <span class="bcp14">REQUIRED</span> cryptographic algorithms for Mesh implementations are specified in <a class="xref" href="#draft-hallambaker-mesh-cryptography">[draft-hallambaker-mesh-cryptography]</a>.<a class="pilcrow" href="#">&para;</a></dd>
        <dd id="null">In addition Mesh Devices used to administer non-Mesh applications must support the cryptographic algorithm suites specified by the application. <a class="pilcrow" href="#">&para;</a></dd>
        <dt id="s-2_1-3">Transport<a class="pilcrow" href="#s-2_1-3">&para;</a></dt>
        <dd id="null">All Mesh Services make use of multiple layers of security. Protection against traffic analysis and metadata attacks are provided by use of Transport Layer Security <a class="xref" href="#RFC5246">[RFC5246]</a>. At present, the HTTP/1.1 <a class="xref" href="#RFC7231">[RFC7231]</a> protocol is used to provide framing of transaction messages.<a class="pilcrow" href="#">&para;</a></dd>
        <dt id="s-2_1-4">Encoding<a class="pilcrow" href="#s-2_1-4">&para;</a></dt>
        <dd id="null">All Mesh protocols and data structures are expressed in the JSON data model and all Mesh applications accept data in standard JSON encoding <a class="xref" href="#RFC7159">[RFC7159]</a>. The JOSE Signature <a class="xref" href="#RFC7515">[RFC7515]</a> and Encryption <a class="xref" href="#RFC7516">[RFC7516]</a> standards are used as the basis for object signing and encryption.<a class="pilcrow" href="#">&para;</a></dd>
      </dl>
      
      <section id="n-defined-terms">
        <h4 id="s-2_2">
          <a class="selfRef" href="#s-2_2">2.2.</a>
          <a class="selfRef" href="#n-defined-terms">Defined Terms</a>
        </h4>
      </section>
      <p id="s-2_2-1">TBS<a class="pilcrow" href="#s-2_2-1">&para;</a></p>
    </section>
    
    <section id="n-requirements-language">
      <h4 id="s-2_3">
        <a class="selfRef" href="#s-2_3">2.3.</a>
        <a class="selfRef" href="#n-requirements-language">Requirements Language</a>
      </h4>
      <p id="s-2_3-1">The key words "<span class="bcp14">MUST</span>", "<span class="bcp14">MUST NOT</span>", "<span class="bcp14">REQUIRED</span>", "<span class="bcp14">SHALL</span>", "<span class="bcp14">SHALL NOT</span>", "<span class="bcp14">SHOULD</span>", "<span class="bcp14">SHOULD NOT</span>", "<span class="bcp14">RECOMMENDED</span>", "<span class="bcp14">MAY</span>", and "<span class="bcp14">OPTIONAL</span>" in this document are to be interpreted as described in RFC 2119 <a class="xref" href="#RFC2119">[RFC2119]</a>.<a class="pilcrow" href="#s-2_3-1">&para;</a></p>
    </section>
    
    <section id="n-implementation-status">
      <h4 id="s-2_4">
        <a class="selfRef" href="#s-2_4">2.4.</a>
        <a class="selfRef" href="#n-implementation-status">Implementation Status</a>
      </h4>
      <p id="s-2_4-1">The implementation status of the reference code base is described in the companion document <a class="xref" href="#draft-hallambaker-mesh-developer">[draft-hallambaker-mesh-developer]</a>.<a class="pilcrow" href="#s-2_4-1">&para;</a></p>
      <p id="s-2_4-2">The examples in this document were created on 1/22/2020 1:19:03 AM.  Out of 170 examples, 67 were not functional. <a class="pilcrow" href="#s-2_4-2">&para;</a></p>
      <p id="s-2_4-3">[Note: Example data is now being produced using the mesh command line tool which is currently substantially less complete than the Mesh reference code it is intended to provide an interface to. As a result, the documentation currently lags the code by more than is usual.] <a class="pilcrow" href="#s-2_4-3">&para;</a></p>
    </section>
    
    <section id="n-architecture">
      <h3 id="s-3">
        <a class="selfRef" href="#s-3">3.</a>
        <a class="selfRef" href="#n-architecture">Architecture</a>
      </h3>
      <p id="s-3-1">The Mathematical Mesh (Mesh) is a user centered Public Key Infrastructure that uses cryptography to make computers easier to use. This document describes version 3.0 of the Mesh architecture and protocols.<a class="pilcrow" href="#s-3-1">&para;</a></p>
      <p id="s-3-2">For several decades, it has been widely noted that most users are either unwilling or unable to make even the slightest efforts to protect their security, still less those of other parties. Yet despite this observation being widespread, the efforts of the IT security community have largely focused on changing this user behavior rather that designing applications that respect it. Real users have real work to do and have neither the time nor the inclination to use tools that will negatively impact their performance.<a class="pilcrow" href="#s-3-2">&para;</a></p>
      <p id="s-3-3">The Mesh is based on the principle that if the Internet is to be secure, if must become effortless to use applications securely. Rather than beginning the design process by imagining all the possible modes of attack and working out how to address these with the least possible inconvenience, we must reverse the question and ask how much security can be provided without requiring any effort on the user's part to address it.<a class="pilcrow" href="#s-3-3">&para;</a></p>
      <p id="s-3-4">Today's technology requires users to put their trust in an endless variety of devices, software and services they cannot fully understand let alone control. Even the humble television of the 20<sup>th</sup> century has been replaced by a 'smart' TV with 15 million lines of code. Whose undeclared capabilities may well include placing the room in which it is placed under continuous audio and video surveillance.<a class="pilcrow" href="#s-3-4">&para;</a></p>
      <p id="s-3-5">Every technology deployment by necessity requires some degree of trust on the owner/user's part. But this trust should be limited and subject to accountability. If manufacturers continue to fail in this regard, they risk a backlash in which users seek to restore their rights through litigation, legislation or worst of all, simply not buying more technology that they have learned to distrust through their own experience.<a class="pilcrow" href="#s-3-5">&para;</a></p>
      <p id="s-3-6">The Mesh is based on the principle of radical distrust, that is, if a party is capable of defecting, we assume that they will. As the Russian proverb goes: Доверяй, но проверяй: trust, but verify.<a class="pilcrow" href="#s-3-6">&para;</a></p>
      <p id="s-3-7">In the 1990s, the suggestion that 'hackers' might seek to make financial gains from their activities was denounced as 'fear-mongering'. The suggestion that email or anonymous currencies might be abused received a similar response. Today malware, ransomware and spam have become so ubiquitous that they are no longer news unless the circumstances are particularly egregious.<a class="pilcrow" href="#s-3-7">&para;</a></p>
      <p id="s-3-8">We must dispense with the notion that it is improper or impolite to question the good faith of technology suppliers of any kind whether they be manufacturers, service providers, software authors or reviewers. Modern supply chains are complex, typically involving hundreds if not thousands of potential points of deliberate or accidental compromise. The technology provider who relies on the presumption of good faith on their part risks serious damage to their reputation when others assert that a capability added to their product may have malign uses.<a class="pilcrow" href="#s-3-8">&para;</a></p>
      <p id="s-3-9">Radical distrust means that we apply the principles of least principle and accountability at every level in the design:<a class="pilcrow" href="#s-3-9">&para;</a></p>
      <ul id="s-3-10-">
        <li id="s-3-10">Cryptographic keys installed in a product during manufacture are only used for the limited purpose of putting that device under control of the user. <a class="pilcrow" href="#s-3-10">&para;</a></li>
        <li id="s-3-11">Cryptographic keys and assertions related to management of devices are only visible to the user they belong to and are never exposed to external parties.<a class="pilcrow" href="#s-3-11">&para;</a></li>
        <li id="s-3-12">Mesh Accounts belong to and are under control of the user they belong to and not the Mesh Service provider which the user can change at will with minimal inconvenience.<a class="pilcrow" href="#s-3-12">&para;</a></li>
        <li id="s-3-13">Mesh Services do not have access to the plaintext of any Mesh Messages or Mesh Catalog data except for the Contacts catalog.<a class="pilcrow" href="#s-3-13">&para;</a></li>
        <li id="s-3-14">All Mesh Messages are subject to access control by both the inbound and outbound Mesh Service to mitigate messaging abuse.<a class="pilcrow" href="#s-3-14">&para;</a></li>
      </ul>
      <p id="s-3-15">Security is risk management and not the elimination of all possibility of any risk. Radical distrust means that we raise the bar for attackers to the point where for most attackers the risk is greater than the reward.<a class="pilcrow" href="#s-3-15">&para;</a></p>
      <p id="s-3-16">In addition to distrusting technology providers the Mesh Architecture allows the user to limit the degree of trust they place in themselves. In the real world, devices are lost or stolen, passwords and activation codes are forgotten, natural or man-made catastrophes cause property and data to be lost. The Mesh permits but does not require use of escrow techniques that allow recovery from such situations.<a class="pilcrow" href="#s-3-16">&para;</a></p>
    </section>
    
    <section id="n-a-personal-pki">
      <h4 id="s-3_1">
        <a class="selfRef" href="#s-3_1">3.1.</a>
        <a class="selfRef" href="#n-a-personal-pki">A Personal PKI</a>
      </h4>
      <p id="s-3_1-1">The Mesh is a Public Key Infrastructure (PKI) that is designed to address the three major obstacles to deployment of end-to-end secure applications:<a class="pilcrow" href="#s-3_1-1">&para;</a></p>
      <ul id="s-3_1-2-">
        <li id="s-3_1-2">Device management.<a class="pilcrow" href="#s-3_1-2">&para;</a></li>
        <li id="s-3_1-3">Exchange of trusted credentials.<a class="pilcrow" href="#s-3_1-3">&para;</a></li>
        <li id="s-3_1-4">Application configuration management.<a class="pilcrow" href="#s-3_1-4">&para;</a></li>
      </ul>
      <p id="s-3_1-5">Each Mesh user is the ultimate source of authority in their Personal Mesh which specifies the set of devices, contacts and applications that they trust and for what purposes.<a class="pilcrow" href="#s-3_1-5">&para;</a></p>
      <p id="s-3_1-6">The Mesh 1.0 architecture described a PKI designed to meet these limited requirements to enable use of existing end-to-end secure Internet protocols such as OpenPGP, S/MIME and SSH. Since these protocols only secure data in transit and the vast majority of data breaches involve data at rest, the Data At Rest Encryption (DARE) was added as a layered application resulting in the Mesh 2.0 architecture. This document describes the Mesh 3.0 architecture which has been entirely re-worked so that DARE provides the platform on which all other Mesh functions are built.<a class="pilcrow" href="#s-3_1-6">&para;</a></p>
    </section>
    
    <section id="n-device-management">
      <h5 id="s-3_1_1">
        <a class="selfRef" href="#s-3_1_1">3.1.1.</a>
        <a class="selfRef" href="#n-device-management">Device Management</a>
      </h5>
      <p id="s-3_1_1-1">Existing PKIs were developed in an era when the 'personal computer' was still coming into being. Only a small number of people owned a computer and an even smaller number owned more than one. Today, computers are ubiquitous and a typical home in the developed world contains several hundred of which a dozen or more may have some form of network access. <a class="pilcrow" href="#s-3_1_1-1">&para;</a></p>
      <p id="s-3_1_1-2">The modern consumer faces a problem of device management that is considerably more complex than the IT administrator of a small business might have faced in the 1990s but without any of the network management tools such an administrator would expect to have available.<a class="pilcrow" href="#s-3_1_1-2">&para;</a></p>
      <p id="s-3_1_1-3">One important consequence of the proliferation of devices is that end-to-end security is no longer sufficient. To be acceptable to users, a system must be ends-to-ends secure. That is, a user must be able to read their encrypted email message on their laptop, tablet, phone, or watch with exactly the same ease of use as if the mail was unencrypted.<a class="pilcrow" href="#s-3_1_1-3">&para;</a></p>
      <p id="s-3_1_1-4">Each personal Mesh contains a device catalog in which the cryptographic credentials and device specific application configurations for each connected device are stored.<a class="pilcrow" href="#s-3_1_1-4">&para;</a></p>
      <p id="s-3_1_1-5">Management of the device catalog is restricted to a subset of devices that the owner of the Mesh has specifically authorized for that purpose as administration devices. Only a device with access to a duly authorized administration key can add or remove devices from a personal Mesh.<a class="pilcrow" href="#s-3_1_1-5">&para;</a></p>
    </section>
    
    <section id="n-exchange-of-trusted-credentials">
      <h5 id="s-3_1_2">
        <a class="selfRef" href="#s-3_1_2">3.1.2.</a>
        <a class="selfRef" href="#n-exchange-of-trusted-credentials">Exchange of trusted credentials.</a>
      </h5>
      <p id="s-3_1_2-1">One of the most challenging, certainly the most contentious issues in PKI is the means by which cryptographic credentials are published and validated. <a class="pilcrow" href="#s-3_1_2-1">&para;</a></p>
      <p id="s-3_1_2-2">The Mesh does not attempt to impose criteria for accepting credentials as valid as no such set of criteria can be comprehensive. Rather the Mesh allows users to make use of the credential validation criteria that are appropriate to the purpose for which they intend to use them and Mesh Services provides protocol support for exchange of credentials between users and to synchronize credential information between all the devices belonging to a user.<a class="pilcrow" href="#s-3_1_2-2">&para;</a></p>
      <p id="s-3_1_2-3">In some circumstances, only a direct trust model is acceptable, in others, only a trusted third-party model is possible and in the vast majority of cases opportunistic approaches are more than sufficient. Both approaches may be reinforced by use of chained notary certificate (e.g. BlockChain) technology affords a means of establishing that a particular assertion was made before a certain date. The management of Trust in the Mesh is described in detail in <a class="xref" href="#draft-hallambaker-mesh-trust">[draft-hallambaker-mesh-trust]</a>.<a class="pilcrow" href="#s-3_1_2-3">&para;</a></p>
    </section>
    
    <section id="n-application-configuration-management">
      <h5 id="s-3_1_3">
        <a class="selfRef" href="#s-3_1_3">3.1.3.</a>
        <a class="selfRef" href="#n-application-configuration-management">Application configuration management</a>
      </h5>
      <p id="s-3_1_3-1">Configuration of cryptographic applications is typically worse than an afterthought. Configuration of one popular mail user agent to use S/MIME security requires 17 steps to be performed using four separate application programs. And since S/MIME certificates expire, the user is required to repeat these steps every few years. Contrary to the public claims made by one major software vendor it is not necessary to perform 'usability testing' to recognize abject stupidity.<a class="pilcrow" href="#s-3_1_3-1">&para;</a></p>
      <p id="s-3_1_3-2">Rather than writing down configuration steps and giving them to the user, we should turn them into code and give them to a machine. Users should never be required to do the work of the machine. Nor should any programmer be allowed to insult the user by casting their effort aside and requiring it to be re-entered.<a class="pilcrow" href="#s-3_1_3-2">&para;</a></p>
      <p id="s-3_1_3-3">While most computer professionals who are required to do such tasks on a regular basis will create a tool for the purpose, most users do not have that option. And of those who do write their own tools, only a few have the time and the knowledge to do the job without introducing security vulnerabilities. <a class="pilcrow" href="#s-3_1_3-3">&para;</a></p>
    </section>
    
    <section id="n-the-mesh-as-platform">
      <h5 id="s-3_1_4">
        <a class="selfRef" href="#s-3_1_4">3.1.4.</a>
        <a class="selfRef" href="#n-the-mesh-as-platform">The Mesh as platform</a>
      </h5>
      <p id="s-3_1_4-1">Meeting the core objectives of the Mesh required new naming, communication and cryptographic capabilities provided to be developed. These capabilities may in turn be used to develop new end-to-end secure applications.<a class="pilcrow" href="#s-3_1_4-1">&para;</a></p>
      <p id="s-3_1_4-2">For example, a DARE Catalog is a cryptographic container in which the entries represent a set of objects which may be added, updated and deleted over time. The Mesh Service protocol allows DARE Catalogs to be synchronized between devices connected to a Mesh Account. DARE Catalogs are used as the basis for the device and contacts catalogs referred to above.<a class="pilcrow" href="#s-3_1_4-2">&para;</a></p>
      <p id="s-3_1_4-3">The Mesh Credentials Catalog uses the same DARE Catalog format and Mesh Service protocol to share passwords between devices with end-to-end encryption so that no password data is ever left unencrypted in the cloud.<a class="pilcrow" href="#s-3_1_4-3">&para;</a></p>
    </section>
    
    <section id="n-mesh-architecture">
      <h4 id="s-3_2">
        <a class="selfRef" href="#s-3_2">3.2.</a>
        <a class="selfRef" href="#n-mesh-architecture">Mesh Architecture</a>
      </h4>
      <p id="s-3_2-1">The Mesh has four principal components:<a class="pilcrow" href="#s-3_2-1">&para;</a></p>
      <dl id="s-3_2-2-" class="nohang">
        <dt id="s-3_2-2">Mesh Device Management<a class="pilcrow" href="#s-3_2-2">&para;</a></dt>
        <dd id="null">Each user has a personal Mesh profile that is used for management of their personal devices. A user may connect devices to or remove devices from their personal Mesh by use of a connected device that has been granted the 'administration' role.<a class="pilcrow" href="#">&para;</a></dd>
        <dt id="s-3_2-3">Mesh Account<a class="pilcrow" href="#s-3_2-3">&para;</a></dt>
        <dd id="null">A Mesh account is similar in concept to a traditional email or messaging account but with the important difference that it belongs to the user and not a service provider. Users may maintain multiple Mesh accounts for different purposes.<a class="pilcrow" href="#">&para;</a></dd>
        <dt id="s-3_2-4">Mesh Service<a class="pilcrow" href="#s-3_2-4">&para;</a></dt>
        <dd id="null">A Mesh Service provides a service identifier (e.g. <code>alice@example.com</code>) through which devices and other Mesh users may interact with a Mesh Account. It is not necessary for a Mesh Account to be connected to a Mesh Service and users may change their Mesh service provider at any time. It is even possible for a Mesh Account to be connected to multiple services at the same time but only one such account is regarded as the primary account at a given time.<a class="pilcrow" href="#">&para;</a></dd>
        <dt id="s-3_2-5">Mesh Messaging<a class="pilcrow" href="#s-3_2-5">&para;</a></dt>
        <dd id="null">Mesh Messaging allows short messages (less than 32KB) to be exchanged between Mesh devices connected to an account and between Mesh Accounts. One of the key differences between Mesh Messaging and legacy services such as SMTP is that every message received is subjected to access control. <a class="pilcrow" href="#">&para;</a></dd>
      </dl>
      <p id="s-3_2-6">A user's Personal Mesh is the set of their Personal Mesh Profiles, Mesh Accounts and the Mesh Services to which they are bound.<a class="pilcrow" href="#s-3_2-6">&para;</a></p>
      <p id="s-3_2-7">For example, Figure X shows Alice's personal Mesh which have separate accounts for her personal and business affairs. She has many devices, two of which are shown here. Both are linked to her personal account but only one is linked to her business account. Besides allowing Alice to separate work and pleasure, this separation means that she does not need to worry about her business affairs being compromised if the device <code>Alice2</code> is stolen.<a class="pilcrow" href="#s-3_2-7">&para;</a></p>
      <figure id="f-7">
        <div class="artwork art-svg" id="n-master-profile-and-subordinate-devices-and-accounts">
          <a class="pilcrow" href="#n-master-profile-and-subordinate-devices-and-accounts">&para;</a>
        </div>
        <figcaption>
          <a href="n-master-profile-and-subordinate-devices-and-accounts">Figure 7</a>
:          <a href="null" id="null" class="selfRef">Master Profile and Subordinate Devices and Accounts.</a>
        </figcaption>
      </figure>
      <p id="s-3_2-9">Alice's ProfileMaster contains a Master Signature Key used to sign the profile itself and one or more Administrator Signature Keys used to sign assertions binding devices and/or assertions to her Mesh.<a class="pilcrow" href="#s-3_2-9">&para;</a></p>
      <figure id="f-8">
        <div class="artwork art-svg" id="n-master-profile-and-associated-device-and-account-connection-assertions">
          <a class="pilcrow" href="#n-master-profile-and-associated-device-and-account-connection-assertions">&para;</a>
        </div>
        <figcaption>
          <a href="n-master-profile-and-associated-device-and-account-connection-assertions">Figure 8</a>
:          <a href="null" id="null" class="selfRef">Master Profile and Associated Device and Account Connection Assertions.</a>
        </figcaption>
      </figure>
      <p id="s-3_2-11">If desired, Alice can escrow the master key associated with her Profile Master and delete it from her device(s), thus ensuring that compromise of the device does not result in a permanent compromise of her personal Mesh. Recovery of the Master Signature Key and the associated Master Encryption Escrow keys (not shown) allows Alice to recover her entire digital life.<a class="pilcrow" href="#s-3_2-11">&para;</a></p>
      <p id="s-3_2-12">To eliminate the risk of hardware failure, the escrow scheme offered by the Mesh itself uses key shares printed on paper and an encrypted escrow record stored in the cloud. Mesh users are of course free to use alternative escrow means of their choice.<a class="pilcrow" href="#s-3_2-12">&para;</a></p>
    </section>
    
    <section id="n-mesh-device-management">
      <h5 id="s-3_2_1">
        <a class="selfRef" href="#s-3_2_1">3.2.1.</a>
        <a class="selfRef" href="#n-mesh-device-management">Mesh Device Management</a>
      </h5>
      <p id="s-3_2_1-1">Mesh devices are added to or removed from a user's personal Mesh by adding or removing Device catalog entries from the CatalogDevice associated with the Master Profile.<a class="pilcrow" href="#s-3_2_1-1">&para;</a></p>
      <p id="s-3_2_1-2">Device catalog entries are created by devices that have been provisioned with an administration key specified in the corresponding ProfileMaster<a class="pilcrow" href="#s-3_2_1-2">&para;</a></p>
      <p id="s-3_2_1-3">The keying material used by a device in the context of a user's personal Mesh comes from two separate sources:<a class="pilcrow" href="#s-3_2_1-3">&para;</a></p>
      <ul id="s-3_2_1-4-">
        <li id="s-3_2_1-4">Keying material specified in the ProfileDevice which is either generated on the device itself or installed during manufacture.<a class="pilcrow" href="#s-3_2_1-4">&para;</a></li>
        <li id="s-3_2_1-5">Keying material provided by the Administration Device during the connection process.<a class="pilcrow" href="#s-3_2_1-5">&para;</a></li>
      </ul>
      <p id="s-3_2_1-6">This approach mitigates the risk of keying material used by the device being compromised during or after manufacture and the risks associated with use of weak keys. The key combination mechanism is shown in section XX below and described in detail in <a class="xref" href="#draft-hallambaker-mesh-cryptography">[draft-hallambaker-mesh-cryptography]</a>.<a class="pilcrow" href="#s-3_2_1-6">&para;</a></p>
      <figure id="f-1">
        <div class="artwork art-svg" id="n-mapping-of-device-profile-and-device-private-to-device-connection-keys">
          <a class="pilcrow" href="#n-mapping-of-device-profile-and-device-private-to-device-connection-keys">&para;</a>
        </div>
        <figcaption>
          <a href="n-mapping-of-device-profile-and-device-private-to-device-connection-keys">Figure 1</a>
:          <a href="null" id="null" class="selfRef">Mapping of Device Profile and Device Private to Device Connection Keys.</a>
        </figcaption>
      </figure>
      <p id="s-3_2_1-8">In accordance with the principle of maintaining cryptographic hygiene, separate keys are generated for signature, authentication and encryption purposes.<a class="pilcrow" href="#s-3_2_1-8">&para;</a></p>
    </section>
    
    <section id="n-mesh-account">
      <h5 id="s-3_2_2">
        <a class="selfRef" href="#s-3_2_2">3.2.2.</a>
        <a class="selfRef" href="#n-mesh-account">Mesh Account</a>
      </h5>
      <p id="s-3_2_2-1">Mesh Accounts comprise a collection of persistent data stores associated with a particular persona associated with a personal Mesh. The connection between a Mesh Account and the personal Mesh to which it belongs may or may not be public. For example, Alice might allow her contacts to know that her business and personal accounts belong to the same personal Mesh and thus the same person but Bob might not.<a class="pilcrow" href="#s-3_2_2-1">&para;</a></p>
      <p id="s-3_2_2-2">Mesh Accounts afford similar functionality to the accounts provided by traditional Internet protocols and applications but with the important distinction that they belong to the user and not the service provider. A Mesh Account may be connected to one, many or no Mesh Services and the user may add or delete service providers at any time.<a class="pilcrow" href="#s-3_2_2-2">&para;</a></p>
      <p id="s-3_2_2-3">A Mesh Account that is not connected to a Service is called an offline account. Offline accounts cannot send or receive Mesh Messages and cannot be synchronized using the Mesh Service protocol (but may be synchronized through other means).<a class="pilcrow" href="#s-3_2_2-3">&para;</a></p>
      <p id="s-3_2_2-4">When a Mesh Account is connected to multiple services, only the first service is normally regarded as being primary with the others being secondary accounts for use in case of need.<a class="pilcrow" href="#s-3_2_2-4">&para;</a></p>
      <p id="s-3_2_2-5">Alice's personal account is connected to two devices and two services (<code>alice@example.com</code> and <code>alice@example.net</code>).<a class="pilcrow" href="#s-3_2_2-5">&para;</a></p>
      <figure id="f-2">
        <div class="artwork art-svg" id="n-account-profile-connected-to-devices-and-services">
          <a class="pilcrow" href="#n-account-profile-connected-to-devices-and-services">&para;</a>
        </div>
        <figcaption>
          <a href="n-account-profile-connected-to-devices-and-services">Figure 2</a>
:          <a href="null" id="null" class="selfRef">Account Profile Connected to Devices and Services.</a>
        </figcaption>
      </figure>
      <p id="s-3_2_2-7">As with the connection of the device to Alice's personal Mesh, the connection of each device to each account requires the creation of a separate set of keying using the same key combination mechanism described above. This information is contained in the ActivationAccount record corresponding to the account in the CatalogEntryDevice.<a class="pilcrow" href="#s-3_2_2-7">&para;</a></p>
      <figure id="f-3">
        <div class="artwork art-svg" id="n-account-key-set">
          <a class="pilcrow" href="#n-account-key-set">&para;</a>
        </div>
        <figcaption>
          <a href="n-account-key-set">Figure 3</a>
:          <a href="null" id="null" class="selfRef">Account Key Set.</a>
        </figcaption>
      </figure>
      <p id="s-3_2_2-9">Note that even though Alice's personal account is connected to two separate Mesh Services, the same cryptographic keys are used for both. However separate keys are used for her personal and business accounts so as to prevent these accounts being linked through use of the same device keys.<a class="pilcrow" href="#s-3_2_2-9">&para;</a></p>
    </section>
    
    <section id="n-account-catalogs">
      <h6 id="s-3_2_2_1">
        <a class="selfRef" href="#s-3_2_2_1">3.2.2.1.</a>
        <a class="selfRef" href="#n-account-catalogs">Account Catalogs</a>
      </h6>
      <p id="s-3_2_2_1-1">Mesh Catalogs are a DARE Containers whose entries represent a set of objects with no inherent ordering. Examples of Mesh catalogs include:<a class="pilcrow" href="#s-3_2_2_1-1">&para;</a></p>
      <dl id="s-3_2_2_1-2-" class="nohang">
        <dt id="s-3_2_2_1-2">Devices<a class="pilcrow" href="#s-3_2_2_1-2">&para;</a></dt>
        <dd id="null">The devices connected to the corresponding Mesh profile.<a class="pilcrow" href="#">&para;</a></dd>
        <dt id="s-3_2_2_1-3">Contacts<a class="pilcrow" href="#s-3_2_2_1-3">&para;</a></dt>
        <dd id="null">Logical and physical contact information for people and organizations.<a class="pilcrow" href="#">&para;</a></dd>
        <dt id="s-3_2_2_1-4">Application<a class="pilcrow" href="#s-3_2_2_1-4">&para;</a></dt>
        <dt id="s-3_2_2_1-5">Bookmarks<a class="pilcrow" href="#s-3_2_2_1-5">&para;</a></dt>
        <dd id="null">Web bookmarks and citations.<a class="pilcrow" href="#">&para;</a></dd>
        <dt id="s-3_2_2_1-6">Credentials<a class="pilcrow" href="#s-3_2_2_1-6">&para;</a></dt>
        <dd id="null">Username and password information for network resources.<a class="pilcrow" href="#">&para;</a></dd>
        <dt id="s-3_2_2_1-7">Calendar<a class="pilcrow" href="#s-3_2_2_1-7">&para;</a></dt>
        <dd id="null">Appointments and tasks.<a class="pilcrow" href="#">&para;</a></dd>
        <dt id="s-3_2_2_1-8">Network<a class="pilcrow" href="#s-3_2_2_1-8">&para;</a></dt>
        <dd id="null">Network access configuration information allowing access to WiFi networks and VPNs.<a class="pilcrow" href="#">&para;</a></dd>
        <dd id="null">Configuration information for applications including mail (SMTP, IMAP, OpenPGP, S/MIME, etc) and SSH.<a class="pilcrow" href="#">&para;</a></dd>
      </dl>
      <p id="s-3_2_2_1-9">The Devices and Contacts catalogues have special functions in the Mesh as they describe the set of devices and other users that a Mesh user interacts with.<a class="pilcrow" href="#s-3_2_2_1-9">&para;</a></p>
      <p id="s-3_2_2_1-10">These catalogs are also used as the basis for providing a consistent set of friendly names to the users devices and contacts that is accessible to all her devices. This (in principle) allows Alice to give a voice command to her car or her watch or her phone to call a person or open a door and expect consistent results.<a class="pilcrow" href="#s-3_2_2_1-10">&para;</a></p>
    </section>
    
    <section id="n-mesh-service">
      <h5 id="s-3_2_3">
        <a class="selfRef" href="#s-3_2_3">3.2.3.</a>
        <a class="selfRef" href="#n-mesh-service">Mesh Service</a>
      </h5>
      <p id="s-3_2_3-1">Each Mesh Service is described by a ProfileService signed by a long-lived signature key. As with the ProfileMaster, a separate set of Administrator keys is used to sign the Assertion Host objects used to credential Service Hosts.<a class="pilcrow" href="#s-3_2_3-1">&para;</a></p>
      <figure id="f-4">
        <div class="artwork art-svg" id="n-service-profile-and-delegated-host-assertion">
          <a class="pilcrow" href="#n-service-profile-and-delegated-host-assertion">&para;</a>
        </div>
        <figcaption>
          <a href="n-service-profile-and-delegated-host-assertion">Figure 4</a>
:          <a href="null" id="null" class="selfRef">Service Profile and Delegated Host Assertion.</a>
        </figcaption>
      </figure>
      <p id="s-3_2_3-3">Note that the Mesh Service Authentication mechanism only provides trust after first use. It does not provide a mechanism for secure introduction. A Mesh Service <span class="bcp14">SHOULD</span> be credentialed by means of a validation process that establishes the accountability. For example, the CA-Browser Forum Extended Validation Requirements.<a class="pilcrow" href="#s-3_2_3-3">&para;</a></p>
    </section>
    
    <section id="n-mesh-messaging">
      <h5 id="s-3_2_4">
        <a class="selfRef" href="#s-3_2_4">3.2.4.</a>
        <a class="selfRef" href="#n-mesh-messaging">Mesh Messaging</a>
      </h5>
      <p id="s-3_2_4-1">The Mesh Messaging layer supports the exchange of short (less than 32KB) messages. Mesh devices connected to the same Mesh profile may exchange Mesh Messages directly. Messages exchanged between Mesh Users <span class="bcp14">MUST</span> be mediated by a Mesh Service for both sending and receipt. This 'four corner' pattern permits ingress and egress controls to be enforced on the messages and that every message is properly recorded in the appropriate spools.<a class="pilcrow" href="#s-3_2_4-1">&para;</a></p>
      <p id="s-3_2_4-2">For example, To send a message to Alice, Bob posts it to one of the Mesh Services connected to the Mesh Account from which the message is to be sent. The Mesh Service checks to see that both the message and Bob's pattern of behavior comply with their acceptable use policy and if satisfactory, forwards the message to the receiving service example.com.<a class="pilcrow" href="#s-3_2_4-2">&para;</a></p>
      <figure id="f-5">
        <div class="artwork art-svg" id="n-performing-access-control-on-outbound-messages">
          <a class="pilcrow" href="#n-performing-access-control-on-outbound-messages">&para;</a>
        </div>
        <figcaption>
          <a href="n-performing-access-control-on-outbound-messages">Figure 5</a>
:          <a href="null" id="null" class="selfRef">Performing Access Control on Outbound Messages</a>
        </figcaption>
      </figure>
      <p id="s-3_2_4-4">The receiving service uses the recipient's contact catalog and other information to determine if the message should be accepted. If accepted, the message is added to the recipient's inbound message spool to be collected by her device(s) when needed.<a class="pilcrow" href="#s-3_2_4-4">&para;</a></p>
      <figure id="f-6">
        <div class="artwork art-svg" id="n-performing-access-control-on-inbound-messages">
          <a class="pilcrow" href="#n-performing-access-control-on-inbound-messages">&para;</a>
        </div>
        <figcaption>
          <a href="n-performing-access-control-on-inbound-messages">Figure 6</a>
:          <a href="null" id="null" class="selfRef">Performing Access Control on Inbound Messages</a>
        </figcaption>
      </figure>
      <p id="s-3_2_4-6">For efficiency and to limit the scope for abuse, all inbound Mesh Messages are subject to access control and limited in size to 32KB or less. This limit has proved adequate to support transfer of complex control messages and short content messages. Transfer of data objects of arbitrary size may be achieved by sending a control message containing a URI for the main content which may then be fetched using a protocol such as HTTP. <a class="pilcrow" href="#s-3_2_4-6">&para;</a></p>
      <p id="s-3_2_4-7">This approach makes transfers of very large data sets (i.e. multiple Terabytes) practical as the 'push' phase of the protocol is limited to the transfer of the initial control message. The bulk transfer is implemented as a 'pull' protocol allowing support for features such as continuous integrity checking and resumption of an interrupted transfer.<a class="pilcrow" href="#s-3_2_4-7">&para;</a></p>
    </section>
    
    <section id="n-using-the-mesh-with-applications">
      <h4 id="s-3_3">
        <a class="selfRef" href="#s-3_3">3.3.</a>
        <a class="selfRef" href="#n-using-the-mesh-with-applications">Using the Mesh with Applications</a>
      </h4>
      <p id="s-3_3-1">The Mesh provides an infrastructure for supporting existing Internet security applications and a set security features that may be used to build new ones.<a class="pilcrow" href="#s-3_3-1">&para;</a></p>
      <p id="s-3_3-2">For example, Alice uses the Mesh to provision and maintain the keys she uses for OpenPGP, S/MIME, SSH and IPSEC. She also uses the credential catalog for end-to-end secure management of the usernames and passwords for her Web browsing and other purposes:<a class="pilcrow" href="#s-3_3-2">&para;</a></p>
      <figure id="f-9">
        <div class="artwork art-svg" id="n-each-of-alices-devices-have-access-to-the-shared-context-of-her-personal-account">
          <a class="pilcrow" href="#n-each-of-alices-devices-have-access-to-the-shared-context-of-her-personal-account">&para;</a>
        </div>
        <figcaption>
          <a href="n-each-of-alices-devices-have-access-to-the-shared-context-of-her-personal-account">Figure 9</a>
:          <a href="null" id="null" class="selfRef">Each of Alice's devices have access to the shared context of her personal account.</a>
        </figcaption>
      </figure>
      <p id="s-3_3-4">The Mesh design is highly modular allowing components that were originally designed to support a specific requirement within the Mesh to be applied generally.<a class="pilcrow" href="#s-3_3-4">&para;</a></p>
    </section>
    
    <section id="n-contact-exchange">
      <h5 id="s-3_3_1">
        <a class="selfRef" href="#s-3_3_1">3.3.1.</a>
        <a class="selfRef" href="#n-contact-exchange">Contact Exchange</a>
      </h5>
      <p id="s-3_3_1-1">One of the chief concerns in any PKI is the means by which the public keys of other users are obtained and validated. This is of particular importance in the Mesh since every Mesh Message is subject to access control and it is thus necessary for Alice to accept Bob's credentials before Bob send most types of message to Alice.<a class="pilcrow" href="#s-3_3_1-1">&para;</a></p>
      <p id="s-3_3_1-2">The Mesh supports multiple mechanisms for credential exchange. If Alice and Bob meet in person and are carrying their smart phones, a secure mutual exchange of credentials can be achieved by means of a QR code mechanism. If they are at separate locations, Alice can choose between accepting Bob's contact information with or without additional verification according to the intended use.<a class="pilcrow" href="#s-3_3_1-2">&para;</a></p>
    </section>
    
    <section id="n-confirmation-protocol">
      <h5 id="s-3_3_2">
        <a class="selfRef" href="#s-3_3_2">3.3.2.</a>
        <a class="selfRef" href="#n-confirmation-protocol">Confirmation Protocol</a>
      </h5>
      <p id="s-3_3_2-1">The basic device connection protocol requires the ability for one device to send a connection request to the Mesh service hosting the user's profile. To accept the device connection, the user connects to the service using an administration device, reviews the pending requests and creates the necessary device connection assertion if it is accepted.<a class="pilcrow" href="#s-3_3_2-1">&para;</a></p>
      <p id="s-3_3_2-2">The confirmation protocol generalizes this communication pattern allowing any authorized party to post a short accept/reject question to the user who may (or may not) return a signed response. This feature can be used as improvement on traditional second factor authentication providing resistance to man-in-the-middle attacks and providing a permanent non-repudiable indication of the user's specific intent.<a class="pilcrow" href="#s-3_3_2-2">&para;</a></p>
    </section>
    
    <section id="n-future-applications">
      <h5 id="s-3_3_3">
        <a class="selfRef" href="#s-3_3_3">3.3.3.</a>
        <a class="selfRef" href="#n-future-applications">Future Applications</a>
      </h5>
      <p id="s-3_3_3-1">Since a wide range of network applications may be reduced to synchronization of sets and lists, the basic primitives of Catalogs and Spools may be applied to achieve end-to-end security in an even wider variety of applications.<a class="pilcrow" href="#s-3_3_3-1">&para;</a></p>
      <p id="s-3_3_3-2">For example, a Spool may be used to maintain a mailing list, track comments on a Web forum or record annotations on a document. Encrypting the container entries under a multi-party encryption group allows such communications to be shared with a group of users while maintaining full end-to-end security and without requiring every party writing to the spool to know the public encryption key of every recipient.<a class="pilcrow" href="#s-3_3_3-2">&para;</a></p>
      <p id="s-3_3_3-3">Another interesting possibility is the use of DARE Containers as a file archive mechanism. A single signature on the final Merkle Tree digest value would be sufficient to authenticate every file in the archive. Updates to the archive might be performed using the same container synchronization primitives provided by a Mesh Service. This approach could afford a robust, secure and efficient mechanism for software distribution and update.<a class="pilcrow" href="#s-3_3_3-3">&para;</a></p>
    </section>
    
    <section id="n-mesh-cryptography">
      <h3 id="s-4">
        <a class="selfRef" href="#s-4">4.</a>
        <a class="selfRef" href="#n-mesh-cryptography">Mesh Cryptography</a>
      </h3>
      <p id="s-4-1">All the cryptographic algorithms used in the Mesh are either industry standards or present a work factor that is provably equivalent to an industry standard approach.<a class="pilcrow" href="#s-4-1">&para;</a></p>
      <p id="s-4-2">Existing Internet security protocols are based on approaches developed in the 1990s when performance tradeoffs were a prime consideration in the design of cryptographic protocols. Security was focused on the transport layer as it provided the best security possible given the available resources.<a class="pilcrow" href="#s-4-2">&para;</a></p>
      <p id="s-4-3">With rare exceptions, most computing devices manufactured in the past ten years offer either considerably more computing power than was typical of 1990s era Internet connected machines or considerably less. The Mesh architecture is designed to provide security infrastructure both classes of machine but with the important constraint that the less capable ‘constrained’ devices are considered to be ‘network capable’ rather than ‘Internet capable’ and that the majority of Mesh related processing will be offloaded to another device.<a class="pilcrow" href="#s-4-3">&para;</a></p>
      <p id="s-4-4">For example, Alice uses her Desktop and Laptop to exchange end-to-end secure Mesh Messages and documents but her Internet-of-Things food blender and light bulb are limited in the range of functions they support and the telemetry information they provide. The IoT devices connect to a Mesh Hub which acts as an always-on point of presence for the device state and allows complex cryptographic operations to be offloaded if necessary. <a class="pilcrow" href="#s-4-4">&para;</a></p>
      <figure id="f-16">
        <div class="artwork art-svg" id="n-constrained-devices-connected-through-a-mesh-hub">
          <a class="pilcrow" href="#n-constrained-devices-connected-through-a-mesh-hub">&para;</a>
        </div>
        <figcaption>
          <a href="n-constrained-devices-connected-through-a-mesh-hub">Figure 16</a>
:          <a href="null" id="null" class="selfRef">Constrained Devices connected through a Mesh Hub.</a>
        </figcaption>
      </figure>
    </section>
    
    <section id="n-best-practice-by-default">
      <h4 id="s-4_1">
        <a class="selfRef" href="#s-4_1">4.1.</a>
        <a class="selfRef" href="#n-best-practice-by-default">Best Practice by Default</a>
      </h4>
      <p id="s-4_1-1">Except where support for external applications demand otherwise, the Mesh requires that the following 'best practices' be followed:<a class="pilcrow" href="#s-4_1-1">&para;</a></p>
      <dl id="s-4_1-2-" class="nohang">
        <dt id="s-4_1-2">Industry Standard Algorithms<a class="pilcrow" href="#s-4_1-2">&para;</a></dt>
        <dd id="null">All cryptographic protocols make use of the most recently adopted industry standard algorithms. <a class="pilcrow" href="#">&para;</a></dd>
        <dt id="s-4_1-3">Strongest Work Factor<a class="pilcrow" href="#s-4_1-3">&para;</a></dt>
        <dd id="null">Only the strongest modes of each cipher algorithm are used. All symmetric encryption is performed with 256-bit session keys and all digest algorithms are used in 512-bit output length mode. <a class="pilcrow" href="#">&para;</a></dd>
        <dt id="s-4_1-4">Key Hygiene<a class="pilcrow" href="#s-4_1-4">&para;</a></dt>
        <dd id="null">Separate public key pairs are used for all cryptographic functions: Encryption, Signature and Authentication. This enables separate control regimes for the separate functions and partitioning of cryptographic functions within the application itself.  <a class="pilcrow" href="#">&para;</a></dd>
        <dt id="s-4_1-5">Bound Device Keys<a class="pilcrow" href="#s-4_1-5">&para;</a></dt>
        <dd id="null">Each device has a separate set of Encryption, Signature and Authentication key pairs. These <span class="bcp14">MAY</span> be bound to the device to which they are assigned using hardware or other techniques to prevent or discourage export.<a class="pilcrow" href="#">&para;</a></dd>
        <dt id="s-4_1-6">No Optional Extras<a class="pilcrow" href="#s-4_1-6">&para;</a></dt>
        <dd id="null">Traditional approaches to security have treated many functions as being 'advanced' and thus suited for use by only the most sophisticated users. The Mesh rejects this approach noting that all users operate in precisely the same environment facing precisely the same threats.<a class="pilcrow" href="#">&para;</a></dd>
      </dl>
      
      <section id="n-multilevel-security">
        <h4 id="s-4_2">
          <a class="selfRef" href="#s-4_2">4.2.</a>
          <a class="selfRef" href="#n-multilevel-security">Multi-Level Security</a>
        </h4>
      </section>
      <p id="s-4_2-1">All Mesh protocol transactions are protected at the Transport, Message and Data level. This provides security in depth that cannot be achieved by applying security at the separate levels independently. Data level encryption provides end-to-end confidentiality and non-repudiation, Message level authentication provides the basis for access control and Transport level encryption provides a degree of protection against traffic analysis.<a class="pilcrow" href="#s-4_2-1">&para;</a></p>
    </section>
    
    <section id="n-multikey-decryption">
      <h4 id="s-4_3">
        <a class="selfRef" href="#s-4_3">4.3.</a>
        <a class="selfRef" href="#n-multikey-decryption">Multi-Key Decryption</a>
      </h4>
      <p id="s-4_3-1">Traditional public key encryption algorithms have two keys, one for encryption and another for decryption. The Mesh makes use of threshold cryptography techniques to allow the decryption key to be split into two or more parts.<a class="pilcrow" href="#s-4_3-1">&para;</a></p>
      <p id="s-4_3-2">For example, if we have a private key <i>z</i>, we can use this to perform a key agreement with a public key <i>S</i> to obtain the key agreement value A. But if <i>z</i> = (<i>x+y</i>) mod <i>g</i> (where g is the order of the group). we can obtain the exact same result by applying the private keys <i>x</i> and <i>y</i> to <i>S</i> separately and combining the results:<a class="pilcrow" href="#s-4_3-2">&para;</a></p>
      <figure id="f-10">
        <div class="artwork art-svg" id="n-two-key-decryption">
          <a class="pilcrow" href="#n-two-key-decryption">&para;</a>
        </div>
        <figcaption>
          <a href="n-two-key-decryption">Figure 10</a>
:          <a href="null" id="null" class="selfRef">Two key decryption.</a>
        </figcaption>
      </figure>
      <p id="s-4_3-4">The approach to Multi-Key Decryption used in the Mesh was originally inspired by the work of Matt Blaze et. al. on proxy re-encryption. But the approach used may also be considered a form of Torben Pedersen's Distributed Key generation.<a class="pilcrow" href="#s-4_3-4">&para;</a></p>
      <p id="s-4_3-5">This technique is used in the Mesh to allow use of decryption key held by a user to be controlled by a cloud service without giving the cloud service the ability to decrypt by itself. <a class="pilcrow" href="#s-4_3-5">&para;</a></p>
    </section>
    
    <section id="n-multiparty-key-generation">
      <h4 id="s-4_4">
        <a class="selfRef" href="#s-4_4">4.4.</a>
        <a class="selfRef" href="#n-multiparty-key-generation">Multi-Party Key Generation</a>
      </h4>
      <p id="s-4_4-1">The mathematics that support multi-key decryption are also the basis for the multi-party key generation mechanism that is applied at multiple levels in the Mesh. The basis for the multi-party key generation used in the Mesh is that for any Diffie-Hellman type cryptographic scheme, given two keypairs { <i>x</i>, <i>X</i> }, { <i>y</i>, <i>Y</i> }, we calculate the public key corresponding to the private key <i>x </i>+ <i>y</i> using just the public key values <i>X </i>and <i>Y</i>.<a class="pilcrow" href="#s-4_4-1">&para;</a></p>
      <figure id="f-11">
        <div class="artwork art-svg" id="n-two-party-key-pair-generation">
          <a class="pilcrow" href="#n-two-party-key-pair-generation">&para;</a>
        </div>
        <figcaption>
          <a href="n-two-party-key-pair-generation">Figure 11</a>
:          <a href="null" id="null" class="selfRef">Two party key pair generation.</a>
        </figcaption>
      </figure>
      <p id="s-4_4-3">Multi-party key generation ensures that keys used to bind devices to a personal Mesh or within a Mesh account are 'safe' if any of the contributions to the generation process are safe.<a class="pilcrow" href="#s-4_4-3">&para;</a></p>
    </section>
    
    <section id="n-data-at-rest-encryption">
      <h4 id="s-4_5">
        <a class="selfRef" href="#s-4_5">4.5.</a>
        <a class="selfRef" href="#n-data-at-rest-encryption">Data At Rest Encryption</a>
      </h4>
      <p id="s-4_5-1">The Data At Rest Encryption (DARE) format is used for all confidentiality and integrity enhancements. The DARE format is based on the JOSE Signature and Encryption formats and the use of an extended version of the JSON encoding allowing direct encoding of binary objects.<a class="pilcrow" href="#s-4_5-1">&para;</a></p>
    </section>
    
    <section id="n-dare-envelope">
      <h5 id="s-4_5_1">
        <a class="selfRef" href="#s-4_5_1">4.5.1.</a>
        <a class="selfRef" href="#n-dare-envelope">DARE Envelope</a>
      </h5>
      <p id="s-4_5_1-1">The DARE Envelope format offers similar capabilities to existing formats such as OpenPGP and CMS without the need for onerous encoding schemes. DARE Assertions are presented as DARE Envelopes.<a class="pilcrow" href="#s-4_5_1-1">&para;</a></p>
      <p id="s-4_5_1-2">A feature of the DARE Envelope format not supported in existing schemes is the ability to encrypt and authenticate sets of data attributes separately from the payload. This allows features such as the ability to encrypt a subject line or content type for a message separately from the payload.<a class="pilcrow" href="#s-4_5_1-2">&para;</a></p>
    </section>
    
    <section id="n-dare-container">
      <h5 id="s-4_5_2">
        <a class="selfRef" href="#s-4_5_2">4.5.2.</a>
        <a class="selfRef" href="#n-dare-container">Dare Container</a>
      </h5>
      <p id="s-4_5_2-1">A DARE Container is an append-only sequence of DARE Envelopes. A key feature of the DARE Container format is that entries <span class="bcp14">MAY</span> be encrypted and/or authenticated incrementally. Individual entries <span class="bcp14">MAY</span> be extracted from a DARE Container to create a stand-alone DARE Envelope.<a class="pilcrow" href="#s-4_5_2-1">&para;</a></p>
      <p id="s-4_5_2-2">Containers may be authenticated by means of a Merkle tree of digest values on the individual frames. This allows similar demonstrations of integrity to those afforded by Blockchain to be provided but with much greater efficiency.<a class="pilcrow" href="#s-4_5_2-2">&para;</a></p>
      <p id="s-4_5_2-3">Unlike traditional encryption formats which require a new public key exchange for each encrypted payload, the DARE Container format allows multiple entries to be encrypted under a single key exchange operation. This is particularly useful in applications such as encrypting server transaction logs. The server need only perform a single key exchange operation is performed each time it starts to establish a master key. The master key is then used to create fresh symmetric keying material for each entry in the log using a unique nonce per entry. <a class="pilcrow" href="#s-4_5_2-3">&para;</a></p>
      <figure id="f-12">
        <div class="artwork art-svg" id="n-dare-container-containing-a-transaction-log">
          <a class="pilcrow" href="#n-dare-container-containing-a-transaction-log">&para;</a>
        </div>
        <figcaption>
          <a href="n-dare-container-containing-a-transaction-log">Figure 12</a>
:          <a href="null" id="null" class="selfRef">DARE Container containing a transaction log.</a>
        </figcaption>
      </figure>
      <p id="s-4_5_2-5">Integrity is provided by a Merkle tree calculated over the sequence of log entries. The tree apex is signed at regular intervals to provide non-repudiation.<a class="pilcrow" href="#s-4_5_2-5">&para;</a></p>
      <p id="s-4_5_2-6">Three types of DARE Containers are used in the mesh<a class="pilcrow" href="#s-4_5_2-6">&para;</a></p>
      <dl id="s-4_5_2-7-" class="nohang">
        <dt id="s-4_5_2-7">Catalogs<a class="pilcrow" href="#s-4_5_2-7">&para;</a></dt>
        <dd id="null">A DARE Container whose entries track the status of a set of related objects which may be added, updated or deleted.<a class="pilcrow" href="#">&para;</a></dd>
        <dt id="s-4_5_2-8">Spools<a class="pilcrow" href="#s-4_5_2-8">&para;</a></dt>
        <dd id="null">A DARE Container whose entries track the status of a series of Mesh Messages.<a class="pilcrow" href="#">&para;</a></dd>
        <dt id="s-4_5_2-9">Archives<a class="pilcrow" href="#s-4_5_2-9">&para;</a></dt>
        <dd id="null">A DARE Container used to provide a file archive with optional confidentiality and/or integrity enhancements. <a class="pilcrow" href="#">&para;</a></dd>
      </dl>
      
      <section id="n-uniform-data-fingerprints">
        <h4 id="s-4_6">
          <a class="selfRef" href="#s-4_6">4.6.</a>
          <a class="selfRef" href="#n-uniform-data-fingerprints">Uniform Data Fingerprints.</a>
        </h4>
      </section>
      <p id="s-4_6-1">The Uniform Data Fingerprint (UDF) format provides a compact means of presenting cryptographic nonces, keys and digest values using Base32 encoding that resists semantic substitution attacks. UDF provides a convenient format for data entry. Since the encoding used is case-insensitive, UDFs may if necessary be read out over a voice link without excessive inconvenience.<a class="pilcrow" href="#s-4_6-1">&para;</a></p>
      <p id="s-4_6-2">The following are examples of UDF values:<a class="pilcrow" href="#s-4_6-2">&para;</a></p>
      <pre id="s-4_6-3">NB2U-NLDC-ZBEJ-VPWS-AHWM-CA72-4AMA
EALD-BHS4-SQXO-V7HJ-VPGX-36DA-JS2Q
SAQK-72HP-JWES-6CWN-JKTU-PW7X-FAOL-W
MB5S-R4AJ-3FBT-7NHO-T26Z-2E6Y-WFH4
KCM5-7VB6-IJXJ-WKHX-NZQF-OKGZ-EWVN
ACJJ-XRYN-VS32-PYSM-MX7W-64VQ-RNJX<a class="pilcrow" href="#s-4_6-3">&para;</a></pre>
      <p id="s-4_6-4">UDF content digests are used to support a direct trust model similar to that of OpenPGP. Every Mesh Profile is authenticated by the UDF fingerprint of its signature key. Mesh Friendly Names and UDF Fingerprints thus serve analogous functions to DNS names and IP Addresses. Like DNS names, Friendly Names provide the basis for application-layer interactions while the UDF Fingerprints are used as to provide the foundation for security.<a class="pilcrow" href="#s-4_6-4">&para;</a></p>
    </section>
    
    <section id="n-friendly-names">
      <h5 id="s-4_6_1">
        <a class="selfRef" href="#s-4_6_1">4.6.1.</a>
        <a class="selfRef" href="#n-friendly-names">Friendly Names</a>
      </h5>
      <p id="s-4_6_1-1">Internet addressing schemes are designed to provide a globally unique (or at minimum unambiguous) name for a host, service or account. In the early days of the Internet, this resulted in addresses such as 10.2.3.4 and alice@example.com which from a usability point of view might be considered serviceable if not ideal. Today the Internet is a global infrastructure servicing billions of users and tens of billions of devices and accounts are more likely to be alice.lastname.1934@example.com than something memorable.<a class="pilcrow" href="#s-4_6_1-1">&para;</a></p>
      <p id="s-4_6_1-2">Friendly names provide a user or community specific means of identifying resources that may take advantage of geographic location or other cues to resolve possible ambiguity. If Alice says to her voice activated device "close the garage door" it is implicit that it is her garage door that she wishes to close. And should Alice be fortunate enough to own two houses with a garage, it is implicit that it is the garage door of the house she is presently using that she wishes to close.<a class="pilcrow" href="#s-4_6_1-2">&para;</a></p>
      <p id="s-4_6_1-3">The Mesh Device Catalog provides a directory mapping friendly names to devices that is available to all Alice's connected devices so that she may give and instruction to any of her devices using the same friendly name and expect consistent results.<a class="pilcrow" href="#s-4_6_1-3">&para;</a></p>
    </section>
    
    <section id="n-encrypted-authenticated-resource-locators">
      <h5 id="s-4_6_2">
        <a class="selfRef" href="#s-4_6_2">4.6.2.</a>
        <a class="selfRef" href="#n-encrypted-authenticated-resource-locators">Encrypted Authenticated Resource Locators</a>
      </h5>
      <p id="s-4_6_2-1">Various schemes have been used to employ QR Codes as a means of device and/or user authentication. In many of these schemes a QR code contains a challenge nonce that is used to authenticate the connection request.<a class="pilcrow" href="#s-4_6_2-1">&para;</a></p>
      <p id="s-4_6_2-2">The Mesh supports a QR code connection mode employing the Encrypted Authenticated Resource Locator (EARL) format. An EARL is an identifier which allows an encrypted data object to be retrieved and decrypted. In this case, the encrypted data object contains the information needed to complete the interaction. <a class="pilcrow" href="#s-4_6_2-2">&para;</a></p>
      <p id="s-4_6_2-3">An EARL contains the domain name of the service providing the resolution service and an encryption master key:<a class="pilcrow" href="#s-4_6_2-3">&para;</a></p>
      <pre id="s-4_6_2-4">udf://example.com/ECQ4-KEU2-LRMG-UUUP-FGJ2-SZTP-WF4V-XE<a class="pilcrow" href="#s-4_6_2-4">&para;</a></pre>
      <p id="s-4_6_2-5">The EARL may be expressed as a QR code:<a class="pilcrow" href="#s-4_6_2-5">&para;</a></p>
      <figure id="f-13">
        <div class="artwork art-svg" id="n-qr-code-representation-of-the-earl">
          <a class="pilcrow" href="#n-qr-code-representation-of-the-earl">&para;</a>
        </div>
        <figcaption>
          <a href="n-qr-code-representation-of-the-earl">Figure 13</a>
:          <a href="null" id="null" class="selfRef">QR Code representation of the EARL</a>
        </figcaption>
      </figure>
      <p id="s-4_6_2-7">An EARL is resolved by presenting the content digest fingerprint of the encryption key to a Web service hosted at the specified domain. The service returns a DARE Envelope whose payload is encrypted and authenticated under the specified master key. Since the content is stored on the service under the fingerprint of the key and not the key itself, the service cannot decrypt the plaintext. Only a party that has access to the encryption key in the QR code can decrypt the message.<a class="pilcrow" href="#s-4_6_2-7">&para;</a></p>
    </section>
    
    <section id="n-secure-internet-names">
      <h5 id="s-4_6_3">
        <a class="selfRef" href="#s-4_6_3">4.6.3.</a>
        <a class="selfRef" href="#n-secure-internet-names">Secure Internet Names</a>
      </h5>
      <p id="s-4_6_3-1">Secure Internet Names bind an Internet address such as a URL or an email address to a Security Policy by means of a UDF content digest of a document describing the security policy. This binding enables a SIN-aware Internet client to ensure that the security policy is applied when connecting to the address. For example, ensuring that an email sent to an address must be end-to-end encrypted under a particular public key or that access to a Web Service requires a particular set of security enhancements.<a class="pilcrow" href="#s-4_6_3-1">&para;</a></p>
      <dl id="s-4_6_3-2-" class="nohang">
        <dt id="s-4_6_3-2">alice@example.com <a class="pilcrow" href="#s-4_6_3-2">&para;</a></dt>
        <dd id="null">Alice's regular email address (not a SIN).  <a class="pilcrow" href="#">&para;</a></dd>
        <dt id="s-4_6_3-3">alice@mm--uuuu-uuuu-uuuu.example.com <a class="pilcrow" href="#s-4_6_3-3">&para;</a></dt>
        <dd id="null">A strong email address for Alice that can be used by a regular email client. <a class="pilcrow" href="#">&para;</a></dd>
        <dt id="s-4_6_3-4">alice@example.com.mm--uuuu-uuuu-uuuu <a class="pilcrow" href="#s-4_6_3-4">&para;</a></dt>
        <dd id="null">A strong email address for Alice that can only used by an email client that can process SINs.  <a class="pilcrow" href="#">&para;</a></dd>
      </dl>
      <p id="s-4_6_3-5">Using an email address that has the Security Policy element as a prefix allows a DNS wildcard element to be defined that allows the address to be used with any email client. Presenting the Security Policy element as a suffix means it can only be resolved by a SIN-aware client.<a class="pilcrow" href="#s-4_6_3-5">&para;</a></p>
    </section>
    
    <section id="n-personal-key-escrow">
      <h4 id="s-4_7">
        <a class="selfRef" href="#s-4_7">4.7.</a>
        <a class="selfRef" href="#n-personal-key-escrow">Personal Key Escrow</a>
      </h4>
      <p id="s-4_7-1">One of the core objectives of the Mesh is to make data level encryption ubiquitous. While data level encryption provides robust protection of data confidentiality, loss of the ability to decrypt means data loss.<a class="pilcrow" href="#s-4_7-1">&para;</a></p>
      <p id="s-4_7-2">For many Internet users, data availability is a considerably greater concern than confidentiality. Ten years later, there is no way to replace pictures of the children at five years old. Recognizing the need to guarantee data recovery, the Mesh provides a robust personal key escrow and recovery mechanism. Lawful access is not supported as a requirement.<a class="pilcrow" href="#s-4_7-2">&para;</a></p>
      <p id="s-4_7-3">Besides supporting key recovery in the case of loss, the Mesh protocols potentially support key recovery in the case of the key holder's death. The chief difficulty faced in implementing such a scheme being developing an acceptable user interface which allows the user to specify which of their data should survive them and which should not. As the apothegm goes: Mallet wants his beneficiaries to know where he buried Aunt Agatha's jewels but not where he buried Aunt Agatha.<a class="pilcrow" href="#s-4_7-3">&para;</a></p>
      <p id="s-4_7-4">The Mesh supports use of Shamir Secret Sharing to split a secret key into a set of shares, a predetermined number of which may be used to recover the original secret. For convenience secret shares are represented using UDF allowing presentation in Base32 (i.e. text format) for easy transcription or QR code presentation if preferred.<a class="pilcrow" href="#s-4_7-4">&para;</a></p>
      <p id="s-4_7-5">A Mesh Profile is escrowed by creating a recovery record containing the private keys corresponding to the master signature and master escrow keys associated with the profile. A master secret is then generated which is used to generate a symmetric encryption key used to encrypt the recovery record and to generate the desired number of recovery shares. For example, Alice escrows her Mesh Profile creating three recovery shares, two of which are required to recover the master secret:<a class="pilcrow" href="#s-4_7-5">&para;</a></p>
      <figure id="f-14">
        <div class="artwork art-svg" id="n-use-of-shamir-secret-sharing-to-create-a-recovery-record">
          <a class="pilcrow" href="#n-use-of-shamir-secret-sharing-to-create-a-recovery-record">&para;</a>
        </div>
        <figcaption>
          <a href="n-use-of-shamir-secret-sharing-to-create-a-recovery-record">Figure 14</a>
:          <a href="null" id="null" class="selfRef">Use of Shamir Secret Sharing to create a recovery record.</a>
        </figcaption>
      </figure>
      <p id="s-4_7-7">To recover the master secret, Alice presents the necessary number of key shares. These are used to recover the master secret which is used to generate the decryption key.<a class="pilcrow" href="#s-4_7-7">&para;</a></p>
      <figure id="f-15">
        <div class="artwork art-svg" id="n-use-of-shamir-secret-recovery-to-recover-a-master-key-set">
          <a class="pilcrow" href="#n-use-of-shamir-secret-recovery-to-recover-a-master-key-set">&para;</a>
        </div>
        <figcaption>
          <a href="n-use-of-shamir-secret-recovery-to-recover-a-master-key-set">Figure 15</a>
:          <a href="null" id="null" class="selfRef">Use of Shamir Secret Recovery to recover a master key set.</a>
        </figcaption>
      </figure>
      <p id="s-4_7-9">A user may choose to store their encrypted recovery record themselves or make use of the EARL mechanism to store the information at one or more cloud services using the fingerprint of the master secret as the locator.<a class="pilcrow" href="#s-4_7-9">&para;</a></p>
    </section>
    
    <section id="n-user-experience">
      <h3 id="s-5">
        <a class="selfRef" href="#s-5">5.</a>
        <a class="selfRef" href="#n-user-experience">User Experience</a>
      </h3>
      <p id="s-5-1">This section describes the Mesh in use. These use cases described here are re-visited in the companion Mesh Schema Reference <a class="xref" href="#draft-hallambaker-mesh-schema">[draft-hallambaker-mesh-schema]</a> and Mesh Protocol Reference <a class="xref" href="#draft-hallambaker-mesh-protocol">[draft-hallambaker-mesh-protocol]</a> with additional examples and details.<a class="pilcrow" href="#s-5-1">&para;</a></p>
      <p id="s-5-2">For clarity and for compactness, these use cases are illustrated using the command line tool meshman. <a class="pilcrow" href="#s-5-2">&para;</a></p>
      <p id="s-5-3">The original design brief for the Mesh was to make it easier to use the Internet securely. Over time, it was realized that users are almost never prepared to sacrifice usability or convenience for security. It is therefore insufficient to minimize the cost of security, if secure applications are to be used securely they must be at least as easy to use as those they replace. If security features are to be used, they must not require the user to make any additional effort whatsoever.<a class="pilcrow" href="#s-5-3">&para;</a></p>
      <p id="s-5-4">The key to meeting this constraint is that any set of instructions that can be written down to be followed by a user can be turned into code and executed by machine. Provided that the necessary authentication, integrity and confidentiality controls are provided. Thus, the Mesh is not just a cryptographic infrastructure that makes use of computer systems more secure, it is a usability infrastructure that makes computers easier to use by providing security.<a class="pilcrow" href="#s-5-4">&para;</a></p>
      <p id="s-5-5">The user experience is thus at the heart of the design of the Mesh and a description of the Mesh Architecture properly begins with consideration of the view of the system that matters most: that of the user.<a class="pilcrow" href="#s-5-5">&para;</a></p>
      <p id="s-5-6">The principle security protocols in use today were designed at a time when most Internet users made use of either a single machine or one of a number of shared machines connected to a shared file store. The problem of transferring cryptographic keys and configuration data between machines was rarely considered and when it was considered was usually implemented badly. Today the typical user owns or makes use of multiple devices they recognize as a computer (laptop, tablet) and an even greater number of devices that they do not recognize as computers but are (almost any device with a display).<a class="pilcrow" href="#s-5-6">&para;</a></p>
      <figure id="f-18">
        <div class="artwork art-svg" id="n-alices-personal-mesh">
          <a class="pilcrow" href="#n-alices-personal-mesh">&para;</a>
        </div>
        <figcaption>
          <a href="n-alices-personal-mesh">Figure 18</a>
:          <a href="null" id="null" class="selfRef">Alice's personal Mesh.</a>
        </figcaption>
      </figure>
    </section>
    
    <section id="n-creating-a-mesh-profile-and-administration-device">
      <h4 id="s-5_1">
        <a class="selfRef" href="#s-5_1">5.1.</a>
        <a class="selfRef" href="#n-creating-a-mesh-profile-and-administration-device">Creating a Mesh Profile and Administration Device.</a>
      </h4>
      <p id="s-5_1-1">The first step in using the Mesh is to create a personal profile. From the user's point of view a profile is a collection of all the configuration data for all the Mesh enabled devices and services that they interact with.<a class="pilcrow" href="#s-5_1-1">&para;</a></p>
      <pre id="s-5_1-2">Alice&gt; mesh create
Device Profile UDF=MAKJ-PBFP-LU5T-5Z34-YITA-PHYT-F5QS
Personal Profile UDF=MDKD-XTUR-GFP4-QD52-STNB-Q7GS-MEWW
<a class="pilcrow" href="#s-5_1-2">&para;</a></pre>
      <p id="s-5_1-3">Note that the user does not specify the cryptographic algorithms to use. Choice of cryptographic algorithm is primarily the concern of the protocol designer, not the user. The only circumstance in which users would normally be involved in algorithm selection is when there is a transition in progress from one algorithm suite to another.<a class="pilcrow" href="#s-5_1-3">&para;</a></p>
    </section>
    
    <section id="n-mesh-accounts">
      <h4 id="s-5_2">
        <a class="selfRef" href="#s-5_2">5.2.</a>
        <a class="selfRef" href="#n-mesh-accounts">Mesh Accounts</a>
      </h4>
      <p id="s-5_2-1">Add an account to the personal Mesh:<a class="pilcrow" href="#s-5_2-1">&para;</a></p>
      <pre id="s-5_2-2">Alice&gt; account create personal
Account=MBAL-44YZ-X4GX-USBL-JAMU-AW32-SLBQ
<a class="pilcrow" href="#s-5_2-2">&para;</a></pre>
      <p id="s-5_2-3">A Mesh Catalog contains a set of entries, each of which has a unique object identifier. Catalog entries may be added, updated or deleted.<a class="pilcrow" href="#s-5_2-3">&para;</a></p>
      <p id="s-5_2-4">By default, all catalog entries are encrypted. Applying the Default Deny principle, in normal circumstances, the Mesh Service is not capable of decrypting any catalog excepting the Contacts catalog which is used as a source of authorization data in the Access Control applied to inbound messaging requests.<a class="pilcrow" href="#s-5_2-4">&para;</a></p>
      <p id="s-5_2-5">For example, the entries in the credentials catalog specify username and password credentials used to access Internet services. Adding credentials to her catalog allows Alice to write scripts that access password protected resources without including the passwords in the scripts themselves:<a class="pilcrow" href="#s-5_2-5">&para;</a></p>
      <pre id="s-5_2-6">Alice&gt; password add ftp.example.com alice1 password
alice1@ftp.example.com = [password]
Alice&gt; password add www.example.com alice@example.com newpassword
alice@example.com@www.example.com = [newpassword]
Alice&gt; password list
alice1@ftp.example.com = [password]
alice@example.com@www.example.com = [newpassword]
Alice&gt; password add ftp.example.com alice1 newpassword
alice1@ftp.example.com = [newpassword]
Alice&gt; password get ftp.example.com
alice1@ftp.example.com = [newpassword]
<a class="pilcrow" href="#s-5_2-6">&para;</a></pre>
    </section>
    
    <section id="n-using-a-mesh-service">
      <h4 id="s-5_3">
        <a class="selfRef" href="#s-5_3">5.3.</a>
        <a class="selfRef" href="#n-using-a-mesh-service">Using a Mesh Service</a>
      </h4>
      <p id="s-5_3-1">A Mesh Service provides an 'always available' point of presence that is used to exchange data between devices connected to the connected profile and send and receive Mesh Messages to and from other Mesh users.<a class="pilcrow" href="#s-5_3-1">&para;</a></p>
      <p id="s-5_3-2">To use a Mesh Service, a user creates a Mesh Service account. This is analogous to an SMTP email service but with the important distinction that the protocol is designed to allow users to change their Mesh Service provider at any time they choose with minimal impact. <a class="pilcrow" href="#s-5_3-2">&para;</a></p>
      <p id="s-5_3-3">The account is created by sending an account registration request to the chosen Mesh Service. If accepted, the Mesh Service creates a new account and creates containers to hold the associated catalogs and spools:<a class="pilcrow" href="#s-5_3-3">&para;</a></p>
      <pre id="s-5_3-4">Alice&gt; account register alice@example.com
Account=MBAL-44YZ-X4GX-USBL-JAMU-AW32-SLBQ
<a class="pilcrow" href="#s-5_3-4">&para;</a></pre>
      <p id="s-5_3-5">As with any other Internet service provision, Mesh Service providers may impose constraints on the use of their service such as the amount of data they send, store and receive and charge a fee for their service. <a class="pilcrow" href="#s-5_3-5">&para;</a></p>
    </section>
    
    <section id="n-connecting-and-authorizing-additional-devices">
      <h4 id="s-5_4">
        <a class="selfRef" href="#s-5_4">5.4.</a>
        <a class="selfRef" href="#n-connecting-and-authorizing-additional-devices">Connecting and Authorizing Additional Devices</a>
      </h4>
      <p id="s-5_4-1">Having established a Mesh profile, a user may connect any number of devices to it. Connecting a device to a Mesh profile allows it to share data with, control and be controlled by other devices connected to the profile. <a class="pilcrow" href="#s-5_4-1">&para;</a></p>
      <p id="s-5_4-2">Although any type of network capable device may be connected to a Mesh profile, some devices are better suited for use with certain applications than others. Connecting an oven to a Mesh profile could allow it to be controlled through entries to the user's recipe and calendar catalogs and alert the user when the meal is ready but attempting to use it to read emails or manage Mesh profiles.<a class="pilcrow" href="#s-5_4-2">&para;</a></p>
      <p id="s-5_4-3">Three connection mechanisms are currently specified, each of which provides strong mutual authentication: Direct, PIN and QR.<a class="pilcrow" href="#s-5_4-3">&para;</a></p>
      <p id="s-5_4-4">Since approval of a connection request requires the creation of a signed Connection Assertion, requests must be approved by a device that has access to an administration key authorized by the user's Master Profile. Such devices are referred to as Administration devices. Administration devices must have data entry (e.g. keyboard) and output (e.g. display) affordances to support any of the currently defined connection mechanisms. The QR code connection mechanism also requires a suitable camera.<a class="pilcrow" href="#s-5_4-4">&para;</a></p>
      <p id="s-5_4-5">It will be noted that the process of connecting a device that contains a preconfigured set of device keys might in principle expose the user to the risk that the manufacturer has retained knowledge of these keys and that this might be used to create a ‘backdoor’. <a class="pilcrow" href="#s-5_4-5">&para;</a></p>
      <p id="s-5_4-6">This risk is controlled using the key co-generation technique described earlier. The original device profile is combined with a device profile provided by the user to create a composite device profile. This ensures that every device uses a unique profile even if they are initialized from a shared firmware image containing a fixed set of device key pairs.  <a class="pilcrow" href="#s-5_4-6">&para;</a></p>
    </section>
    
    <section id="n-direct-connection">
      <h5 id="s-5_4_1">
        <a class="selfRef" href="#s-5_4_1">5.4.1.</a>
        <a class="selfRef" href="#n-direct-connection">Direct Connection</a>
      </h5>
      <p id="s-5_4_1-1">The direct connection mechanism requires that both the administration device and the device originating the connection request have data entry and output affordances and that it is possible for the user to compare the authentication codes presented by the two devices to check that they are identical. <a class="pilcrow" href="#s-5_4_1-1">&para;</a></p>
      <p id="s-5_4_1-2">The connection request is initiated on the device being connected: <a class="pilcrow" href="#s-5_4_1-2">&para;</a></p>
      <pre id="s-5_4_1-3">Alice2&gt; device request alice@example.com
   Witness value = M4J5-YPNB-2O3U-35FZ-PC6G-SP6R-4LBD
   Personal Mesh = MDKD-XTUR-GFP4-QD52-STNB-Q7GS-MEWW
<a class="pilcrow" href="#s-5_4_1-3">&para;</a></pre>
      <p id="s-5_4_1-4">Using her administration device, Alice gets a list of pending requests. Seeing that there is a pending request matching the witness value presented by the device, Alice accepts it: <a class="pilcrow" href="#s-5_4_1-4">&para;</a></p>
      <pre id="s-5_4_1-5">Alice&gt; device pending
Alice&gt; device accept NCGP-WWTX-4HDR-YR2I-N5DO-TYBJ-C4X7
<a class="pilcrow" href="#s-5_4_1-5">&para;</a></pre>
      <p id="s-5_4_1-6">The new device will now synchronize automatically in response to any Mesh commands. For example,  listing the password catalog: <a class="pilcrow" href="#s-5_4_1-6">&para;</a></p>
      <pre id="s-5_4_1-7">Alice2&gt; password list
ERROR - Object reference not set to an instance of an object.
<a class="pilcrow" href="#s-5_4_1-7">&para;</a></pre>
    </section>
    
    <section id="n-pin-connection">
      <h5 id="s-5_4_2">
        <a class="selfRef" href="#s-5_4_2">5.4.2.</a>
        <a class="selfRef" href="#n-pin-connection">Pin Connection</a>
      </h5>
      <p id="s-5_4_2-1">The PIN Connection mechanism is similar to the Direct connection mechanism except that the process is initiated on an administration device by requesting assignment of a new authentication PIN. The PIN is then input to the connecting device to authenticate the request.<a class="pilcrow" href="#s-5_4_2-1">&para;</a></p>
      <p id="s-5_4_2-2">The PIN connection mechanism begins with the issue of the PIN: <a class="pilcrow" href="#s-5_4_2-2">&para;</a></p>
      <pre id="s-5_4_2-3">Alice&gt; account pin
PIN=NCGD-ZOQL-JRVF-TALA-EY (Expires=2020-01-23T01:18:57Z)
<a class="pilcrow" href="#s-5_4_2-3">&para;</a></pre>
      <p id="s-5_4_2-4">The PIN code is transmitted out of band to the device being connected: <a class="pilcrow" href="#s-5_4_2-4">&para;</a></p>
      <pre id="s-5_4_2-5">Alice3&gt; device request alice@example.com /pin=NCGD-ZOQL-JRVF-TALA-EY
   Witness value = XNLM-MOF2-KNZS-3HCO-WOEO-BOTN-Y6G2
   Personal Mesh = MDKD-XTUR-GFP4-QD52-STNB-Q7GS-MEWW
<a class="pilcrow" href="#s-5_4_2-5">&para;</a></pre>
      <p id="s-5_4_2-6">Since the request was pre-authorized, it is not necessary for Alice to explicitly accept the connection request but the administration device is needed to create the connection assertion: <a class="pilcrow" href="#s-5_4_2-6">&para;</a></p>
      <pre id="s-5_4_2-7">Alice&gt; device pending
<a class="pilcrow" href="#s-5_4_2-7">&para;</a></pre>
      <p id="s-5_4_2-8">We can check the device connection by attempting to synchronize to the profile account: <a class="pilcrow" href="#s-5_4_2-8">&para;</a></p>
      <pre id="s-5_4_2-9">Alice3&gt; account sync
ERROR - Object reference not set to an instance of an object.
<a class="pilcrow" href="#s-5_4_2-9">&para;</a></pre>
      <p id="s-5_4_2-10">Note that this connection mechanism could be adapted to allow a device with a  camera affordance to connect by scanning a QR code on the administration device. <a class="pilcrow" href="#s-5_4_2-10">&para;</a></p>
      <p id="s-5_4_2-11">If the Device Profile fingerprint is known at the time the PIN is generated, this can be bound to the PIN authorization assertion to permit connection of a specific device.<a class="pilcrow" href="#s-5_4_2-11">&para;</a></p>
    </section>
    
    <section id="n-earlqr-code-connection">
      <h5 id="s-5_4_3">
        <a class="selfRef" href="#s-5_4_3">5.4.3.</a>
        <a class="selfRef" href="#n-earlqr-code-connection">EARL/QR Code Connection</a>
      </h5>
      <p id="s-5_4_3-1">The EARL/QR code connection mechanisms are used to connect a constrained device to a Mesh profile by means of an Encrypted Authenticated Resource Locator, typically presented as a QR code on the device itself or its packaging.<a class="pilcrow" href="#s-5_4_3-1">&para;</a></p>
      <p id="s-5_4_3-2">Since the meshman tool does not support QR input, it is decoded using a separate tool to recover the UDF EARL which is presented as a command line parameter:<a class="pilcrow" href="#s-5_4_3-2">&para;</a></p>
      <p id="s-5_4_3-3">To use the device QR code connection mechanism, we require a Web service that will host the connection document example.com and a MeshService account that the device will attempt to  complete the connection by requesting synchronization devices@example.com. <a class="pilcrow" href="#s-5_4_3-3">&para;</a></p>
      <p id="s-5_4_3-4">To begin the process we generate a new random key and combine it with the service to create an EARL: <a class="pilcrow" href="#s-5_4_3-4">&para;</a></p>
      <pre id="s-5_4_3-5">udf://example.com/ECQ4-KEU2-LRMG-UUUP-FGJ2-SZTP-WF4V-XE<a class="pilcrow" href="#s-5_4_3-5">&para;</a></pre>
      <p id="s-5_4_3-6">Next a device profile is created and preregistered on with the Mesh Service that will provide the hailing service. Since we are only preparing one device it is convenient to do this on the device itself. In a manufacturing scenario, these steps would typically  be performed offline in bulk. <a class="pilcrow" href="#s-5_4_3-6">&para;</a></p>
      <pre id="s-5_4_3-7">Alice4&gt; device pre devices@example.com /key=udf://example.com/ECQ4-KE
    U2-LRMG-UUUP-FGJ2-SZTP-WF4V-XE
ERROR - Object reference not set to an instance of an object.
<a class="pilcrow" href="#s-5_4_3-7">&para;</a></pre>
      <p id="s-5_4_3-8">Once initialized the device attempts to poll the service for a connection each time it is powered on, when a connection button affordance on the device is pressed or at other times as agreed with the Mesh Service Provider: <a class="pilcrow" href="#s-5_4_3-8">&para;</a></p>
      <pre id="s-5_4_3-9">Alice4&gt; account sync
ERROR - Object reference not set to an instance of an object.
<a class="pilcrow" href="#s-5_4_3-9">&para;</a></pre>
      <p id="s-5_4_3-10">To connect the device to her profile, Alice scans the device with her administration  device to obtain the UDF. The administration device retrieves the connection description,  decrypts it and then uses the information in the description to create the necessary Device Connection Assertion and connect to the device hailing Mesh Service Account to  complete the process: <a class="pilcrow" href="#s-5_4_3-10">&para;</a></p>
      <pre id="s-5_4_3-11">Alice&gt; device earl udf://example.com/ECQ4-KEU2-LRMG-UUUP-FGJ2-SZTP-WF
    4V-XE
ERROR - Object reference not set to an instance of an object.
<a class="pilcrow" href="#s-5_4_3-11">&para;</a></pre>
      <p id="s-5_4_3-12">When the device next attempts to connect to the hailing service, it receives the Device  Connection Assertion: <a class="pilcrow" href="#s-5_4_3-12">&para;</a></p>
      <pre id="s-5_4_3-13">Alice4&gt; account sync
ERROR - Object reference not set to an instance of an object.
<a class="pilcrow" href="#s-5_4_3-13">&para;</a></pre>
    </section>
    
    <section id="n-contact-requests">
      <h4 id="s-5_5">
        <a class="selfRef" href="#s-5_5">5.5.</a>
        <a class="selfRef" href="#n-contact-requests">Contact Requests</a>
      </h4>
      <p id="s-5_5-1">As previously stated, every inbound Mesh message is subject to access control. The user’s contact catalog is used as part of the access control authentication and authorization mechanism.<a class="pilcrow" href="#s-5_5-1">&para;</a></p>
      <p id="s-5_5-2">By default, the only form of inbound message that is accepted without authorization in the contact catalog is a contact request. Though for certain Mesh users (e.g. politicians, celebrities) even contact requests might require some form of prior approval (e.g. endorsement by a mutual friend).<a class="pilcrow" href="#s-5_5-2">&para;</a></p>
      <p id="s-5_5-3">A Mesh Contact Assertion may be limited to stating the user's profile fingerprint and Mesh Service Account(s). For most purposes however, it is more convenient to present a Contact Assertion that contains at least as much information as is typically provided on a business or calling card:<a class="pilcrow" href="#s-5_5-3">&para;</a></p>
      <p id="s-5_5-4">Alice creates a contact entry for herself: <a class="pilcrow" href="#s-5_5-4">&para;</a></p>
      <pre id="s-5_5-5">Alice&gt; contact self email alice@example.com
{
  "Self": true,
  "Key": "NAB7-U4XN-VGYE-5JUS-SVXK-AGPN-VSEZ",
  "EnvelopedContact": [{},
    "ewogICJDb250YWN0IjogewogICAgIkFkZHJlc3Nlcy
  I6IFt7CiAgICAgICAgIlVSSSI6ICJtYWlsdG86e2VtYWlsfSJ9XX19"]}<a class="pilcrow" href="#s-5_5-5">&para;</a></pre>
      <p id="s-5_5-6">User's may create multiple Contact Assertions for use in different circumstances. A user might not want to give their home address to a business contact or their business address to a personal friend. <a class="pilcrow" href="#s-5_5-6">&para;</a></p>
    </section>
    
    <section id="n-remote">
      <h5 id="s-5_5_1">
        <a class="selfRef" href="#s-5_5_1">5.5.1.</a>
        <a class="selfRef" href="#n-remote">Remote</a>
      </h5>
      <p id="s-5_5_1-1">In the most general case, the participants are remote from each other and one user must make a contact request of the other:<a class="pilcrow" href="#s-5_5_1-1">&para;</a></p>
      <p id="s-5_5_1-2">Bob requests Alice add him to her contacts catalog: <a class="pilcrow" href="#s-5_5_1-2">&para;</a></p>
      <pre id="s-5_5_1-3">Bob&gt; message contact alice@example.com
<a class="pilcrow" href="#s-5_5_1-3">&para;</a></pre>
      <p id="s-5_5_1-4">When Alice next checks her messages, she sees the pending contact request from Bob and accepts it. Bob's contact details are added to her catalog and Bob receives a response containing Alice's credentials: <a class="pilcrow" href="#s-5_5_1-4">&para;</a></p>
      <pre id="s-5_5_1-5">Alice&gt; message pending
Alice&gt; message accept tbs
<a class="pilcrow" href="#s-5_5_1-5">&para;</a></pre>
    </section>
    
    <section id="n-static-qr-code">
      <h5 id="s-5_5_2">
        <a class="selfRef" href="#s-5_5_2">5.5.2.</a>
        <a class="selfRef" href="#n-static-qr-code">Static QR Code</a>
      </h5>
      <p id="s-5_5_2-1">A DARE contact entry may be exchanged by means of an EARL UDF. This is typically presented by means of a QR code which may be created using the <code>meshman</code> tool and a QR code generator. The resulting QR code may be printed on a business card, laser engraved on a luggage tag, etc.<a class="pilcrow" href="#s-5_5_2-1">&para;</a></p>
      <p id="s-5_5_2-2">To accept the contact request, the recipient merely scans the code with a Mesh capable QR code reader. They are asked if they wish to accept the contact request and what privileges they wish to authorize for the new contact.<a class="pilcrow" href="#s-5_5_2-2">&para;</a></p>
    </section>
    
    <section id="n-dynamic-qr-code">
      <h5 id="s-5_5_3">
        <a class="selfRef" href="#s-5_5_3">5.5.3.</a>
        <a class="selfRef" href="#n-dynamic-qr-code">Dynamic QR Code</a>
      </h5>
      <p id="s-5_5_3-1">If it is possible for the device to generate a new QR code for the contact request, it is possible to support bi-directional exchange of credentials with strong mutual authentication. <a class="pilcrow" href="#s-5_5_3-1">&para;</a></p>
      <p id="s-5_5_3-2">For example, Alice selects the contact credential she wishes to pass to Bob on her mobile device which presents an EARL as a QR code. Bob scans the QR code with his mobile device which retrieves Alice's credential and asks if Bob wishes to accept it and if he wishes to share his credential with Alice. If Bob agrees, his device makes a Remote Contact request authenticated under a key passed to his device with Alice's Contact Assertion.<a class="pilcrow" href="#s-5_5_3-2">&para;</a></p>
      <p id="s-5_5_3-3">The Dynamic QR Code protocol may be applied to support exchange of credentials between larger groups. Enrolling the contact assertions collected in such circumstances in a notarized append only log (e.g. a DARE Container) provides a powerful basis for building a Web of Trust that is equivalent to but considerably more convenient than participation in PGP Key Signing parties.<a class="pilcrow" href="#s-5_5_3-3">&para;</a></p>
    </section>
    
    <section id="n-sharing-confidential-data-in-the-cloud">
      <h4 id="s-5_6">
        <a class="selfRef" href="#s-5_6">5.6.</a>
        <a class="selfRef" href="#n-sharing-confidential-data-in-the-cloud">Sharing Confidential Data in the Cloud</a>
      </h4>
      <p id="s-5_6-1">As previously discussed, the Mesh makes use of multi-party encryption techniques to mitigate the risk of a device compromise leading to disclosure of confidential data. The Mesh also allows these techniques to be applied to provide Confidential Document Control. This provides data encryption capabilities that are particularly suited to 'cloud computing' environments.<a class="pilcrow" href="#s-5_6-1">&para;</a></p>
      <p id="s-5_6-2">A Mesh Encryption Group is a special type of Mesh Service Account that is controlled by one of more group administrators. The Encryption Group Key is a normal ECDH public key used in the normal manner. The decryption key is held by the group administrator. To add a user to the group, the administrator splits the group private key into two parts, a service key and a user key. These parts are encrypted under the public encryption keys of their assigned parties. The encrypted key parts form a decryption entry for the user is added to the Members Catalog of the Encryption Group at the Mesh Service.<a class="pilcrow" href="#s-5_6-2">&para;</a></p>
      <figure id="f-17">
        <div class="artwork art-svg" id="n--bob-can-only-decrypt-messages-encrypted-to-group-w-if-the-cloud-service-allows-">
          <a class="pilcrow" href="#n--bob-can-only-decrypt-messages-encrypted-to-group-w-if-the-cloud-service-allows-">&para;</a>
        </div>
        <figcaption>
          <a href="n--bob-can-only-decrypt-messages-encrypted-to-group-w-if-the-cloud-service-allows-">Figure 17</a>
:          <a href="null" id="null" class="selfRef"> Bob can only decrypt messages encrypted to Group W if the cloud service allows. </a>
        </figcaption>
      </figure>
      <p id="s-5_6-4">When a user needs to decrypt a document encrypted under the group key, they make a request to the Mesh Service which checks to see that they are authorized to read that particular document, have not exceeded their decryption quota, etc. If the request is approved, the service returns the partial decryption result obtained from the service's key part together with the encrypted user key part. To complete the decryption process, the user decrypts their key part and uses it to create a second partial decryption result which is combined with the first to obtain the key agreement value needed to complete the decryption process. <a class="pilcrow" href="#s-5_6-4">&para;</a></p>
      <p id="s-5_6-5">Alice creates the recryption group groupw@example.com to share confidential information with her closest friends: <a class="pilcrow" href="#s-5_6-5">&para;</a></p>
      <pre id="s-5_6-6">Alice&gt; group create groupw@example.com
{
  "Profile": {
    "KeyOfflineSignature": {
      "UDF": "MCJ5-HMK2-SUBS-MOCG-J5IS-S2GT-IY7D",
      "PublicParameters": {
        "PublicKeyECDH": {
          "crv": "Ed448",
          "Public": "bNfUzYfsJJthhioeCukz03BQ9wJWD-2i_0GoDznzdhqEu8eE
              9iVo
  VAJDOF2gDnMxvkfnBsJk55GA"}}},
    "KeyEncryption": {
      "UDF": "MC25-LCSY-DUTQ-YBUL-XXCI-RLIZ-JHIL",
      "PublicParameters": {
        "PublicKeyECDH": {
          "crv": "Ed448",
          "Public": "sx8WWkgH6k4u8RchFZitCRTvncvWje1xog-cyx4kka9kwmFw
              lDTi
  t2JXFFalq-LJ-RQlu9eIuP-A"}}}}}<a class="pilcrow" href="#s-5_6-6">&para;</a></pre>
      <p id="s-5_6-7">Bob encrypts a test file but he can't decrypt it because he isn't in the group: <a class="pilcrow" href="#s-5_6-7">&para;</a></p>
      <pre id="s-5_6-8">Bob&gt; dare encodeTestFile1.txt /out=TestFile1-group.dare /encrypt=grou
    pw@example.com
ERROR - The command  is not known.
Bob&gt; dare decode  TestFile1-group.dare
ERROR - Could not find file 'C:\Users\hallam\Test\WorkingDirectory\Te
    stFile1-group.dare'.
<a class="pilcrow" href="#s-5_6-8">&para;</a></pre>
      <p id="s-5_6-9">Since she is the group administrator, Alice can decrypt the test file using the group decryption key: <a class="pilcrow" href="#s-5_6-9">&para;</a></p>
      <pre id="s-5_6-10">Alice&gt; dare decode  TestFile1-group.dare
ERROR - Could not find file 'C:\Users\hallam\Test\WorkingDirectory\Te
    stFile1-group.dare'.
<a class="pilcrow" href="#s-5_6-10">&para;</a></pre>
      <p id="s-5_6-11">Adding Bob to the group gives him immediate access to any file encrypted under the group key without making any change to the encrypted files: <a class="pilcrow" href="#s-5_6-11">&para;</a></p>
      <pre id="s-5_6-12">Alice&gt; dare decode  TestFile1-group.dare
ERROR - Could not find file 'C:\Users\hallam\Test\WorkingDirectory\Te
    stFile1-group.dare'.
<a class="pilcrow" href="#s-5_6-12">&para;</a></pre>
      <p id="s-5_6-13">Removing Bob from the group immediately withdraws his access. <a class="pilcrow" href="#s-5_6-13">&para;</a></p>
      <pre id="s-5_6-14">Alice&gt; group delete groupw@example.com bob@example.com
ERROR - The feature has not been implemented
<a class="pilcrow" href="#s-5_6-14">&para;</a></pre>
      <p id="s-5_6-15">Bob cannot decrypt any more files (but he may have kept copies of files he decrypted  earlier). <a class="pilcrow" href="#s-5_6-15">&para;</a></p>
      <pre id="s-5_6-16">Alice&gt; dare decode  TestFile1-group.dare
ERROR - Could not find file 'C:\Users\hallam\Test\WorkingDirectory\Te
    stFile1-group.dare'.
<a class="pilcrow" href="#s-5_6-16">&para;</a></pre>
      <p id="s-5_6-17">Should requirements demand, the same principle may be applied to achieve separation of duties in the administration roles. Instead of provisioning the group private key to a single administrator, it may be split into two or more parts. Adding a user to the group requires each of the administrators to create a decryption entry for the user and for the service and user to apply the appropriate operations to combine the key parts available to them before use.<a class="pilcrow" href="#s-5_6-17">&para;</a></p>
      <p id="s-5_6-18">These techniques could even be extended to support complex authorization requirements such as the need for 2 out of 3 administrators to approve membership of the group. A set of decryption entries is complete if the sum of the key parts is equal to the private key (modulo the order of the curve).<a class="pilcrow" href="#s-5_6-18">&para;</a></p>
      <p id="s-5_6-19">Thus, if the set of administrators is A, B and C and the private key is <i>k</i>, we can ensure that it requires exactly two administrators to create a complete set of decryption entries by issuing key set { <i>a</i> } to A, the key set {<i>k-a</i> , <i>b</i> } to B and the key set {<i>k-a</i> , <i>k-b</i> } to C (where <i>a</i> and <i>b</i> are randomly generated keys).<a class="pilcrow" href="#s-5_6-19">&para;</a></p>
    </section>
    
    <section id="n-escrow-and-recovery-of-keys">
      <h4 id="s-5_7">
        <a class="selfRef" href="#s-5_7">5.7.</a>
        <a class="selfRef" href="#n-escrow-and-recovery-of-keys">Escrow and Recovery of Keys</a>
      </h4>
      <p id="s-5_7-1">One of the chief objections made against deployment of Data Level encryption is that although it provides the strongest possible protection of the confidentiality of the data, loss of the decryption keys means loss of the encrypted data. Thus, a robust and effective key escrow mechanism is essential if use of encryption is to ever become commonplace for stored data.<a class="pilcrow" href="#s-5_7-1">&para;</a></p>
      <p id="s-5_7-2">The use of a 'life-long' Mesh profiles raises a similar concern. Loss of a Master Signature Key potentially means the loss of the ability to control devices connected to the profile and the accumulated trust endorsements of other users.<a class="pilcrow" href="#s-5_7-2">&para;</a></p>
      <p id="s-5_7-3">Because of these requirements, Mesh users are strongly advised but not required to create a backup copy of the private keys corresponding to their Master Profile Signature and Escrow keys.<a class="pilcrow" href="#s-5_7-3">&para;</a></p>
      <p id="s-5_7-4">Users may use the key escrow mechanism of their choice including the escrow mechanism supported by the Mesh itself which uses Shamir Secret Sharing to escrow the encryption key for a DARE Envelope containing the private key information.<a class="pilcrow" href="#s-5_7-4">&para;</a></p>
      <p id="s-5_7-5">To escrow a key set, the user specifies the number of key shares to be created and the number required for recovery. <a class="pilcrow" href="#s-5_7-5">&para;</a></p>
      <pre id="s-5_7-6">Alice&gt; mesh escrow
Share: SAQE-Y4MW-BH55-ZL57-4XFP-PQVZ-VLHT-U7C3-X2BA-ZOCW-75EE-KZZM-3K
    SQ-E47T-O26A-I
Share: SAQZ-QGZL-CPK4-DXZN-EOWK-2AAO-DS76-6JV2-ZXUB-YSVJ-TJKK-ONXT-CD
    VB-S633-ZANC-M
Share: SARO-HRGA-DWX2-ODU2-MGHG-EPLC-R2YK-HUIZ-3VHC-XXH4-GVQQ-SBVZ-I4
    XT-BAYE-DF4E-Q
<a class="pilcrow" href="#s-5_7-6">&para;</a></pre>
      <p id="s-5_7-7">Recovery of the key data requires the key recovery record and a quorum of the key shares:<a class="pilcrow" href="#s-5_7-7">&para;</a></p>
      <pre id="s-5_7-8">Alice&gt; mesh recover $SAQE-Y4MW-BH55-ZL57-4XFP-PQVZ-VLHT-U7C3-X2BA-ZOC
    W-75EE-KZZM-3KSQ-E47T-O26A-I $SARO-HRGA-DWX2-ODU2-MGHG-EPLC-R2YK-
    HUIZ-3VHC-XXH4-GVQQ-SBVZ-I4XT-BAYE-DF4E-Q /verify
Device Profile UDF=MAZC-3DVD-LIWY-A6UV-XGWR-GSBA-62YB
Personal Profile UDF=MDKD-XTUR-GFP4-QD52-STNB-Q7GS-MEWW
<a class="pilcrow" href="#s-5_7-8">&para;</a></pre>
      <p id="s-5_7-9">Having recovered the Master Signature Key, the user can now create a new master profile authorizing a new administration device which can be used to authenticate access to the Mesh Service Account(s) connected to the master profile.<a class="pilcrow" href="#s-5_7-9">&para;</a></p>
    </section>
    
    <section id="n-security-considerations">
      <h3 id="s-6">
        <a class="selfRef" href="#s-6">6.</a>
        <a class="selfRef" href="#n-security-considerations">Security Considerations</a>
      </h3>
      <p id="s-6-1">The security considerations for use and implementation of Mesh services and applications are described in the Mesh Security Considerations guide <a class="xref" href="#draft-hallambaker-mesh-security">.</a><a class="pilcrow" href="#s-6-1">&para;</a></p>
    </section>
    
    <section id="n-iana-considerations">
      <h3 id="s-7">
        <a class="selfRef" href="#s-7">7.</a>
        <a class="selfRef" href="#n-iana-considerations">IANA Considerations</a>
      </h3>
      <p id="s-7-1">This document does not contain actions for IANA<a class="pilcrow" href="#s-7-1">&para;</a></p>
    </section>
    
    <section id="n-acknowledgements">
      <h3 id="s-8">
        <a class="selfRef" href="#s-8">8.</a>
        <a class="selfRef" href="#n-acknowledgements">Acknowledgements</a>
      </h3>
      <p id="s-8-1">Comodo Group: Egemen Tas, Melhi Abdulhayoğlu, Rob Stradling, Robin Alden.<a class="pilcrow" href="#s-8-1">&para;</a></p>
      <p id="s-8-2"><a class="pilcrow" href="#s-8-2">&para;</a></p>
    </section>
    
    <section id="n-references">
      <h2>
        <a class="selfRef" href="#n-references">References</a>
      </h2>
      <section id="n-normative">
        <h3>
          <a class="selfRef" href="#n-normative">Normative References</a>
        </h3>
        <dl class="reference">
          <dt id="RFC2119">[RFC2119]</dt>
          <dd>
            <span class="refAuthor">S. Bradner</span>
            "<span class="refTitle">Key words for use in RFCs to Indicate Requirement Levels</span>"
            <span Class="refSeries">
              <span class="refSeriesName">BCP</span>
              <span class="refSeriesValue">14</span>
            </span>
            <span Class="refSeries">
              <span class="refSeriesName">RFC</span>
              <span class="refSeriesValue">2119</span>
            </span>
            <span Class="refSeries">
              <span class="refSeriesName">DOI</span>
              <span class="refSeriesValue">10.17487/RFC2119</span>
            </span>
            <time class="refDate" datetime="1997-03">March 1997</time>
          </dd>
          <dt id="draft-hallambaker-web-service-discovery">[draft-hallambaker-web-service-discovery]</dt>
          <dd>
            <span class="refAuthor">Phillip Hallam-Baker</span>
            "<span class="refTitle">DNS Web Service Discovery</span>"
            <span Class="refSeries">
              <span class="refSeriesName">Internet-Draft</span>
              <span class="refSeriesValue">draft-hallambaker-web-service-discovery-03</span>
            </span>
            &lt;<a class="refTarget">http://www.ietf.org/internet-drafts/draft-hallambaker-web-service-discovery-03.txt</a>&gt;
            <time class="refDate" datetime="2019-10-23">23 October 2019</time>
          </dd>
          <dt id="draft-hallambaker-jsonbcd">[draft-hallambaker-jsonbcd]</dt>
          <dd>
            <span class="refAuthor">Phillip Hallam-Baker</span>
            "<span class="refTitle">Binary Encodings for JavaScript Object Notation: JSON-B, JSON-C, JSON-D</span>"
            <span Class="refSeries">
              <span class="refSeriesName">Internet-Draft</span>
              <span class="refSeriesValue">draft-hallambaker-jsonbcd-15</span>
            </span>
            &lt;<a class="refTarget">http://www.ietf.org/internet-drafts/draft-hallambaker-jsonbcd-15.txt</a>&gt;
            <time class="refDate" datetime="2019-10-23">23 October 2019</time>
          </dd>
          <dt id="draft-hallambaker-mesh-cryptography">[draft-hallambaker-mesh-cryptography]</dt>
          <dd>
            <span class="refAuthor">Phillip Hallam-Baker</span>
            "<span class="refTitle">Mathematical Mesh 3.0 Part VIII: Cryptographic Algorithms</span>"
            <span Class="refSeries">
              <span class="refSeriesName">Internet-Draft</span>
              <span class="refSeriesValue">draft-hallambaker-mesh-cryptography-05</span>
            </span>
            &lt;<a class="refTarget">http://www.ietf.org/internet-drafts/draft-hallambaker-mesh-cryptography-05.txt</a>&gt;
            <time class="refDate" datetime="2020-01-16">16 January 2020</time>
          </dd>
          <dt id="draft-hallambaker-mesh-security">[draft-hallambaker-mesh-security]</dt>
          <dd>
            <span class="refAuthor">Phillip Hallam-Baker</span>
            "<span class="refTitle">Mathematical Mesh 3.0 Part VII: Security Considerations</span>"
            <span Class="refSeries">
              <span class="refSeriesName">Internet-Draft</span>
              <span class="refSeriesValue">draft-hallambaker-mesh-security-03</span>
            </span>
            &lt;<a class="refTarget">http://www.ietf.org/internet-drafts/draft-hallambaker-mesh-security-03.txt</a>&gt;
            <time class="refDate" datetime="2020-01-16">16 January 2020</time>
          </dd>
          <dt id="draft-hallambaker-mesh-trust">[draft-hallambaker-mesh-trust]</dt>
          <dd>
            <span class="refAuthor">Phillip Hallam-Baker</span>
            "<span class="refTitle">Mathematical Mesh 3.0 Part VI: The Trust Mesh</span>"
            <span Class="refSeries">
              <span class="refSeriesName">Internet-Draft</span>
              <span class="refSeriesValue">draft-hallambaker-mesh-trust-04</span>
            </span>
            &lt;<a class="refTarget">http://www.ietf.org/internet-drafts/draft-hallambaker-mesh-trust-04.txt</a>&gt;
            <time class="refDate" datetime="2020-01-16">16 January 2020</time>
          </dd>
          <dt id="draft-hallambaker-mesh-protocol">[draft-hallambaker-mesh-protocol]</dt>
          <dd>
            <span class="refAuthor">Phillip Hallam-Baker</span>
            "<span class="refTitle">Mathematical Mesh 3.0 Part V: Protocol Reference</span>"
            <span Class="refSeries">
              <span class="refSeriesName">Internet-Draft</span>
              <span class="refSeriesValue">draft-hallambaker-mesh-protocol-04</span>
            </span>
            &lt;<a class="refTarget">http://www.ietf.org/internet-drafts/draft-hallambaker-mesh-protocol-04.txt</a>&gt;
            <time class="refDate" datetime="2020-01-16">16 January 2020</time>
          </dd>
          <dt id="draft-hallambaker-mesh-developer">[draft-hallambaker-mesh-developer]</dt>
          <dd>
            <span class="refAuthor">Phillip Hallam-Baker</span>
            "<span class="refTitle">Mathematical Mesh: Reference Implementation</span>"
            <span Class="refSeries">
              <span class="refSeriesName">Internet-Draft</span>
              <span class="refSeriesValue">draft-hallambaker-mesh-developer-09</span>
            </span>
            &lt;<a class="refTarget">http://www.ietf.org/internet-drafts/draft-hallambaker-mesh-developer-09.txt</a>&gt;
            <time class="refDate" datetime="2019-10-23">23 October 2019</time>
          </dd>
          <dt id="draft-hallambaker-mesh-schema">[draft-hallambaker-mesh-schema]</dt>
          <dd>
            <span class="refAuthor">Phillip Hallam-Baker</span>
            "<span class="refTitle">Mathematical Mesh 3.0 Part IV: Schema Reference</span>"
            <span Class="refSeries">
              <span class="refSeriesName">Internet-Draft</span>
              <span class="refSeriesValue">draft-hallambaker-mesh-schema-05</span>
            </span>
            &lt;<a class="refTarget">http://www.ietf.org/internet-drafts/draft-hallambaker-mesh-schema-05.txt</a>&gt;
            <time class="refDate" datetime="2020-01-16">16 January 2020</time>
          </dd>
          <dt id="draft-hallambaker-mesh-udf">[draft-hallambaker-mesh-udf]</dt>
          <dd>
            <span class="refAuthor">Phillip Hallam-Baker</span>
            "<span class="refTitle">Mathematical Mesh 3.0 Part II: Uniform Data Fingerprint.</span>"
            <span Class="refSeries">
              <span class="refSeriesName">Internet-Draft</span>
              <span class="refSeriesValue">draft-hallambaker-mesh-udf-08</span>
            </span>
            &lt;<a class="refTarget">http://www.ietf.org/internet-drafts/draft-hallambaker-mesh-udf-08.txt</a>&gt;
            <time class="refDate" datetime="2020-01-6">6 January 2020</time>
          </dd>
          <dt id="RFC7516">[RFC7516]</dt>
          <dd>
            <span class="refAuthor">M. Jones</span>
            <span>and</span>
            <span class="refAuthor">J. Hildebrand</span>
            "<span class="refTitle">JSON Web Encryption (JWE)</span>"
            <span Class="refSeries">
              <span class="refSeriesName">RFC</span>
              <span class="refSeriesValue">7516</span>
            </span>
            <span Class="refSeries">
              <span class="refSeriesName">DOI</span>
              <span class="refSeriesValue">10.17487/RFC7516</span>
            </span>
            <time class="refDate" datetime="2015-05">May 2015</time>
          </dd>
          <dt id="RFC7515">[RFC7515]</dt>
          <dd>
            <span class="refAuthor">M. Jones</span>
            <span>and</span>
            <span class="refAuthor">J. Bradley</span>
            <span>and</span>
            <span class="refAuthor">N. Sakimura</span>
            "<span class="refTitle">JSON Web Signature (JWS)</span>"
            <span Class="refSeries">
              <span class="refSeriesName">RFC</span>
              <span class="refSeriesValue">7515</span>
            </span>
            <span Class="refSeries">
              <span class="refSeriesName">DOI</span>
              <span class="refSeriesValue">10.17487/RFC7515</span>
            </span>
            <time class="refDate" datetime="2015-05">May 2015</time>
          </dd>
          <dt id="RFC7159">[RFC7159]</dt>
          <dd>
            <span class="refAuthor">T. Bray</span>
            "<span class="refTitle">The JavaScript Object Notation (JSON) Data Interchange Format</span>"
            <span Class="refSeries">
              <span class="refSeriesName">RFC</span>
              <span class="refSeriesValue">7159</span>
            </span>
            <span Class="refSeries">
              <span class="refSeriesName">DOI</span>
              <span class="refSeriesValue">10.17487/RFC7159</span>
            </span>
            <time class="refDate" datetime="2014-03">March 2014</time>
          </dd>
          <dt id="RFC7231">[RFC7231]</dt>
          <dd>
            <span class="refAuthor">R. Fielding</span>
            <span>and</span>
            <span class="refAuthor">J. Reschke</span>
            "<span class="refTitle">Hypertext Transfer Protocol (HTTP/1.1): Semantics and Content</span>"
            <span Class="refSeries">
              <span class="refSeriesName">RFC</span>
              <span class="refSeriesValue">7231</span>
            </span>
            <span Class="refSeries">
              <span class="refSeriesName">DOI</span>
              <span class="refSeriesValue">10.17487/RFC7231</span>
            </span>
            <time class="refDate" datetime="2014-06">June 2014</time>
          </dd>
          <dt id="RFC5246">[RFC5246]</dt>
          <dd>
            <span class="refAuthor">T. Dierks</span>
            <span>and</span>
            <span class="refAuthor">E. Rescorla</span>
            "<span class="refTitle">The Transport Layer Security (TLS) Protocol Version 1.2</span>"
            <span Class="refSeries">
              <span class="refSeriesName">RFC</span>
              <span class="refSeriesValue">5246</span>
            </span>
            <span Class="refSeries">
              <span class="refSeriesName">DOI</span>
              <span class="refSeriesValue">10.17487/RFC5246</span>
            </span>
            <time class="refDate" datetime="2008-08">August 2008</time>
          </dd>
          <dt id="draft-hallambaker-mesh-dare">[draft-hallambaker-mesh-dare]</dt>
          <dd>
            <span class="refAuthor">Phillip Hallam-Baker</span>
            "<span class="refTitle">Mathematical Mesh 3.0 Part III : Data At Rest Encryption (DARE)</span>"
            <span Class="refSeries">
              <span class="refSeriesName">Internet-Draft</span>
              <span class="refSeriesValue">draft-hallambaker-mesh-dare-06</span>
            </span>
            &lt;<a class="refTarget">http://www.ietf.org/internet-drafts/draft-hallambaker-mesh-dare-06.txt</a>&gt;
            <time class="refDate" datetime="2020-01-16">16 January 2020</time>
          </dd>
          <dt id="draft-hallambaker-mesh-platform">[draft-hallambaker-mesh-platform]</dt>
          <dd>
            <span class="refAuthor">Phillip Hallam-Baker</span>
            "<span class="refTitle">Mathematical Mesh: Platform Configuration</span>"
            <span Class="refSeries">
              <span class="refSeriesName">Internet-Draft</span>
              <span class="refSeriesValue">draft-hallambaker-mesh-platform-05</span>
            </span>
            &lt;<a class="refTarget">http://www.ietf.org/internet-drafts/draft-hallambaker-mesh-platform-05.txt</a>&gt;
            <time class="refDate" datetime="2019-10-23">23 October 2019</time>
          </dd>
        </dl>
      </section>
      
    </section>
    
    <section id="n-authors">
      <h2>
        <a class="selfRef" href="#n-authors">Author's Address</a>
      </h2>
      <hr class="addr"/>
      <address class="vcard">
        <div class="nameRole">
          <span class="fn">Phillip Hallam-Baker</span>
        </div>
        <div class="org">ThresholdSecrets.com</div>
        <div>
          <span>Email:</span>
          <a class="email" href="mailto:phill@hallambaker.com     ">phill@hallambaker.com     </a>
        </div>
      </address>
    </section>
    
    <div class="docInfo">
      <span class="prepared">
        Prepared: 
        <time datetime="2020-03-09">2020-03-09</time>
      </span>
      <span class="rendered">
        Rendered: 
        <time datetime="2020-03-09">2020-03-09</time>
      </span>
    </div>
    
    <script src="xml2rfc.js" type="text/javascript"></script>
  </body>
</html>
