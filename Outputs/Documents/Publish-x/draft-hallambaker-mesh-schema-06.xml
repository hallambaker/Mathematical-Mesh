<?xml version='1.0' encoding='utf-8'?>
<rfc xmlns:xi="http://www.w3.org/2001/XInclude" category="info" docName="draft-hallambaker-mesh-schema-06" indexInclude="false" ipr="trust200902" prepTime="2020-11-03T01:51:20Z" scripts="Common,Latin" sortRefs="true" submissionType="independent" symRefs="true" tocDepth="3" tocInclude="true" version="3" xml:lang="en"><front>
<title abbrev="Mesh Schema Reference">Mathematical Mesh 3.0 Part IV: Schema Reference</title>
<seriesInfo name="Internet-Draft" value="draft-hallambaker-mesh-schema" stream="independent"/>
<author fullname="Phillip Hallam-Baker" initials="P. M." surname="Hallam-Baker"><organization>ThresholdSecrets.com</organization>
<address>
<email>phill@hallambaker.com</email>
</address>
</author>
<date day="3" month="November" year="2020"/>
<area/>
<workgroup/>
<abstract>
<t>The Mathematical Mesh 'The Mesh' is an end-to-end secure infrastructure that facilitates the exchange of configuration and credential data between multiple user devices. The core protocols of the Mesh are described with examples of common use cases and reference data.</t>
<t>[Note to Readers]</t>
<t>Discussion of this draft takes place on the MATHMESH mailing list (mathmesh@ietf.org), which is archived at https://mailarchive.ietf.org/arch/search/?email_list=mathmesh.</t>
<t>This document is also available online at <eref target="http://mathmesh.com/Documents/draft-hallambaker-mesh-schema.html"></eref>.</t>
</abstract>
</front>
<middle>
<section title="Introduction" anchor="n-introduction"><t>This document describes the data structures of the Mathematical Mesh with illustrative examples. For an overview of the Mesh objectives and architecture, consult the accompanying <em>Architecture Guide</em> <xref target="draft-hallambaker-mesh-architecture"></xref>. For information on the implementation of the Mesh Service protocol, consult the accompanying <em>Protocol Reference</em> <xref target="draft-hallambaker-mesh-protocol"></xref></t>
<t>This document has two main sections. The first section presents examples of the Mesh assertions, catalog entry and messages in use. The second section contains the schema reference. All the material in both sections is generated from the Mesh reference implementation <xref target="draft-hallambaker-mesh-developer"></xref>.</t>
<t>Although some of the services described in this document could be used to replace existing Internet protocols including FTP and SMTP, the principal value of any communication protocol lies in the size of the audience it allows them to communicate with. Thus, while the Mesh Messaging service is designed to support efficient and reliable transfer of messages ranging in size from a few bytes to multiple terabytes, the near-term applications of these services will be to applications that are not adequately supported by existing protocols if at all.</t>
</section>
<section title="Definitions" anchor="n-definitions"><t>This section presents the related specifications and standard, the terms that are used as terms of art within the documents and the terms used as requirements language.</t>
<section title="Requirements Language" anchor="n-requirements-language"><t>The key words "<bcp14>MUST</bcp14>", "<bcp14>MUST NOT</bcp14>", "<bcp14>REQUIRED</bcp14>", "<bcp14>SHALL</bcp14>", "<bcp14>SHALL NOT</bcp14>", "<bcp14>SHOULD</bcp14>", "<bcp14>SHOULD NOT</bcp14>", "<bcp14>RECOMMENDED</bcp14>", "<bcp14>MAY</bcp14>", and "<bcp14>OPTIONAL</bcp14>" in this document are to be interpreted as described in <xref target="RFC2119"></xref>.</t>
</section>
<section title="Defined Terms" anchor="n-defined-terms"><t>The terms of art used in this document are described in the <em>Mesh Architecture Guide</em> <xref target="draft-hallambaker-mesh-architecture"></xref>.</t>
</section>
<section title="Related Specifications" anchor="n-related-specifications"><t>The architecture of the Mathematical Mesh is described in the <em>Mesh Architecture Guide</em> <xref target="draft-hallambaker-mesh-architecture"></xref>. The Mesh documentation set and related specifications are described in this document.</t>
</section>
<section title="Implementation Status" anchor="n-implementation-status"><t>The implementation status of the reference code base is described in the companion document <xref target="draft-hallambaker-mesh-developer"></xref>.</t>
</section>
</section>
<section title="Actors" anchor="n-actors"><t>The Mesh mediates interactions between three principal actors: <strong>Accounts</strong>, <strong>Devices</strong>, and <strong>Services</strong>.</t>
<t>Currently two account types are specified, <strong>user accounts</strong> which belong to an individual user and <strong>group accounts</strong> that are used to share access to confidential information between a group of users. It may prove useful to define new types of account over time or to eliminate the distinction entirely. When active a Mesh account is bound to a Mesh Service. The service to which an account is bound <bcp14>MAY</bcp14> be changed over time but an account can only be bound to a single service at a time. </t>
<t>A Mesh account is an abstract construct that (when active) is instantiated across one or more physical machines called a device. Each device that is connected to an account has a separate set of cryptographic keys that are used to interact with other devices connected to the account and <bcp14>MAY</bcp14> be provisioned with access to the account private keys which <bcp14>MAY</bcp14> or <bcp14>MAY</bcp14> NOT be mediated by the current Mesh Service.</t>
<t>A Mesh Service is an abstract construct that is provided by one or more physical machines called Hosts. A Mesh Host is a device that is attached to a service rather than an account.</t>
<section title="Accounts" anchor="n-accounts"><t>A Mesh Account is described by a Profile descended from Profile Account and contains a set of Mesh stores. Currently two account profiles are defined:</t>
<dl>
<dt>ProfileUser</dt>
<dd>
<t>Describes a user account.</t>
</dd>
<dt>ProfileGroup</dt>
<dd>
<t>Describes a group account used to share confidential information between a group of users.</t>
</dd>
</dl>
<t>Both types of profile specify the following fields:</t>
<dl>
<dt>ProfileSignature</dt>
<dd>
<t>The public signature key used to authenticate the profile itself</t>
</dd>
<dt>AccountAddress</dt>
<dd>
<t>The account name to which the account is currently bound. (e.g. <tt>alice@example.com</tt>, <tt>@alice</tt>).</t>
</dd>
<dt>ServiceUdf</dt>
<dd>
<t>If the account is active, specifies the fingerprint of the service profile to which the account is currently bound.</t>
</dd>
<dt>AdministratorSignature</dt>
<dd>
<t>The public signature key used to verify administrative actions on the account. In particular addition of devices to a user account or members to a group account.</t>
</dd>
<dt>AccountEncryption</dt>
<dd>
<t>The public encryption key for the account. All messages sent to the account <bcp14>MUST</bcp14> be encrypted under this key. By definition, all data encrypted under this account is encrypted under this key.</t>
</dd>
</dl>
<t>User accounts specify two additional public keys, <tt>AccountSignature</tt> and <tt>AccountAuthentication</tt> which allow signature and authentication operations under the account context.</t>
<t>Every account contains a set of catalogs and spools that are managed by the service as directed by the contents of the associated <tt>Access</tt> catalog.</t>
<t>For example, the personal account profile Alice created is: </t>
<sourcecode>{
  "ProfileUser":{
    "ProfileSignature":{
      "Udf":"MCDH-FIPQ-XWI3-2MLS-KZ6U-SAVO-EVSH",
      "PublicParameters":{
        "PublicKeyECDH":{
          "crv":"Ed448",
          "Public":"hQLIqgN0KQKuxG_-HtGWbPCIuFRoloTBz8ss2Z9mzxyU8
  PhHlXNsdn6wEI5DlSSd-xDTT5Dqe-8A"}}},
    "AccountAddress":"alice@example.com",
    "ServiceUdf":"MDQO-R66J-MVEO-BDL6-V6T7-FPII-U42Q",
    "AccountEncryption":{
      "Udf":"MCSM-JRCO-FDSE-HU2X-RZ6B-TZVO-EUWG",
      "PublicParameters":{
        "PublicKeyECDH":{
          "crv":"X448",
          "Public":"28mMM_tdArnhlajmrAuXKHBwXjgdW7NaeaNiVa1BCRCyB
  Ax1t49JEIQPQAplbezybYeZHLPxciQA"}}},
    "AdministratorSignature":{
      "Udf":"MCDH-FIPQ-XWI3-2MLS-KZ6U-SAVO-EVSH",
      "PublicParameters":{
        "PublicKeyECDH":{
          "crv":"Ed448",
          "Public":"hQLIqgN0KQKuxG_-HtGWbPCIuFRoloTBz8ss2Z9mzxyU8
  PhHlXNsdn6wEI5DlSSd-xDTT5Dqe-8A"}}},
    "AccountAuthentication":{
      "Udf":"MDHV-NL5I-FTNE-MEPP-T3LL-GV2P-3PQK",
      "PublicParameters":{
        "PublicKeyECDH":{
          "crv":"X448",
          "Public":"9Km5sPv4-2EXP5548xrayizrApYeTsKsRcHrJO3igCnL8
  90y_ilAojRlaJ-BPTG39A0QGtMun-8A"}}},
    "AccountSignature":{
      "Udf":"MBYB-3SKG-SIFR-KEFJ-DDUI-XURM-VG6N",
      "PublicParameters":{
        "PublicKeyECDH":{
          "crv":"Ed448",
          "Public":"eCujE9J56gn6h-GvBphDhz1qB5PKTSGmmjkiqHFjmDpA2
  7mCZlK4PkG_mhON_Cw71UZaAiomjhCA"}}}}}</sourcecode>
</section>
<section title="Device" anchor="n-device"><t>Every Mesh device has a set of private keys that are unique to that device. These keys <bcp14>MAY</bcp14> be installed during manufacture, installed from an external source after manufacture or generated on the device. If the platform capabilities allow, device private keys <bcp14>SHOULD</bcp14> be bound to the device so that they cannot be extracted or exported without substantial effort.</t>
<t>The public keys corresponding to the device private keys are specified in a ProfileDevice. This <bcp14>MUST</bcp14> contain at least the following fields:</t>
<dl>
<dt>ProfileSignature</dt>
<dd>
<t>The public signature key used to authenticate the profile itself.</t>
</dd>
<dt>BaseEncryption</dt>
<dd>
<t>Public encryption key used as a share contribution to generation of device encryption keys to be used in the context of an account and to decrypt data during the process of connecting to an account.</t>
</dd>
<dt>BaseAuthentication</dt>
<dd>
<t>Public authentication key used as a share contribution to generation of device authentication keys to be used in the context of an account and to authenticate the device to a service during the process of connecting to an account.</t>
</dd>
<dt>BaseSignature</dt>
<dd>
<t>Public signature key used as a share contribution to generation of device authentication keys to be used in the context of an account.</t>
</dd>
</dl>
<t>For example, the device profile corresponding to Alice's coffee pot device is:</t>
<sourcecode>{
  "ProfileDevice":{
    "ProfileSignature":{
      "Udf":"MC67-GVFM-B45X-D6AS-YAVS-TJ57-UKVY",
      "PublicParameters":{
        "PublicKeyECDH":{
          "crv":"Ed448",
          "Public":"OdTzNZrT1fGNp370C4LuQXGYJIPVb2bRrTPq28JC_SXe6
  3dyJa3nRpVyr4exF1pIFE0WaeMBPtAA"}}},
    "BaseEncryption":{
      "Udf":"MCZE-Z7HA-MCIL-72US-VFFL-QFIB-AE47",
      "PublicParameters":{
        "PublicKeyECDH":{
          "crv":"X448",
          "Public":"pSzfHxxdrF6C6xtwr7HgwDqu5CVfNh3o2LFS9t6r6oGXT
  NMJyiyk0n4zJ_IUw9L9l1i8GJnP_IyA"}}},
    "BaseAuthentication":{
      "Udf":"MAPU-OCDS-27ZH-T7GB-NT62-YEAY-NL37",
      "PublicParameters":{
        "PublicKeyECDH":{
          "crv":"X448",
          "Public":"AhkZqgNobM0PclYuBY63wUJ8U-TgofPHJuGflr4hlk-SX
  BTYEuHD81EwToIKoMSQmy31HsUuzaMA"}}},
    "BaseSignature":{
      "Udf":"MBNK-CFXF-S57W-GFVQ-HO5H-BBJO-T4JD",
      "PublicParameters":{
        "PublicKeyECDH":{
          "crv":"Ed448",
          "Public":"KFEArX0e8l0z_HkmxOneYWkz2CsnxcjhmPR5tR5OxdISm
  2B4075Pjt6bvhcXwgPP6DcdalL-MN0A"}}}}}</sourcecode>
<section title="Activation" anchor="n-activation"><t>The device private keys are only used to perform cryptographic operations during the process of connecting a device to an account. During that connection process, a threshold key generation scheme is used to generate a second set of device keys bound to the account by combining the base key held by the device with a second device private key provided by the administration device approving the connection of the device to the account. The resulting key is referred to as the device key. The process of combining the base keys with the contributions to form the device keys is called Activation. </t>
<t>The activation record for Alice's coffee pot device is:</t>
<sourcecode>{
  "ActivationDevice":{
    "ActivationKey":"ZAAQ-G2RC-DJVV-IFII-2BJ3-XLYC-GPX6-KPI3-LGJB-J
J52-A7O6-Y5GZ-GXTC-SRQP",
    "AccountUdf":"MC67-GVFM-B45X-D6AS-YAVS-TJ57-UKVY"}}</sourcecode>
<t>The Mesh protocols are designed so that there is never a need to export or escrow private keys of any type associated with a device, neither the base key, nor the device key nor the contribution from the administration device.</t>
<t>This approach to device configuration ensures that the keys that are used by the device when operating within the context of the account are entirely separate from those originally provided by the device manufacturer or generated on the device, provided only that the key contributions from the administration device are sufficiently random and unguessable.</t>
<t>The public keys corresponding to the composite keys generated during the connection process are described in a <tt>ConnectionUser</tt> assertion signed by the administration key of the corresponding account.</t>
<t>The connection record for Alice's coffee pot device is:</t>
<sourcecode>{
  "ConnectionDevice":{
    "DeviceSignature":{
      "Udf":"MCUN-AHGM-A7JN-DFWA-BB6C-UPG4-KOTJ",
      "PublicParameters":{
        "PublicKeyECDH":{
          "crv":"Ed448",
          "Public":"PEtKSBO03Yncq7zeYUEG9DIhGoxjQX1W5UgfBbEIH-d6i
  bFxklJ5WD3inCeu30oLI0aoj6KkaGyA"}}},
    "DeviceEncryption":{
      "Udf":"MB6A-5AIN-EVO2-AXQN-NJRX-IQM3-MBEJ",
      "PublicParameters":{
        "PublicKeyECDH":{
          "crv":"X448",
          "Public":"t9xfIuQVc9LbMT8A0mpslDS8dd3I0Tdd4bgGPfABwYqAI
  Ws3lFgam87NBcBrihM42WZWOHTLp8AA"}}},
    "DeviceAuthentication":{
      "Udf":"MCXV-B6Z5-KWMQ-YYFS-F4FM-FODY-4KFC",
      "PublicParameters":{
        "PublicKeyECDH":{
          "crv":"X448",
          "Public":"291x6jkOqQzeYngKNzZO1Enii-oNqyYM_JtF2W3PP3EQN
  _hABBVvoTDmcy1w-DsOzRGBHBTbzzIA"}}}}}</sourcecode>
<t>The <tt>ConnectionUser</tt> assertion <bcp14>MAY</bcp14> be used in the same fashion as an X.509v3/PKIX certificate to mediate interactions between devices connected to the same account without the need for interaction with the Mesh service. Thus, a coffee pot device connected to the account can receive and authenticate instructions issued by a voice recognition device connected to that account.</t>
<t>While the <tt>ConnectionUser</tt> assertion <bcp14>MAY</bcp14> be used to mediate external interactions, this approach is typically undesirable as it provides the external parties with visibility to the internal configuration of the account, in particular which connected devices are being used on which occasions. Furthermore, the lack of the need to interact with the service means that the service is necessarily unable to mediate the exchange and enforce authorization policy on the interactions.</t>
<t>Device keys are intended to be used to secure communications between devices connected to the same account. All communication between Mesh accounts <bcp14>SHOULD</bcp14> be mediated by a Mesh service. This enables abuse mitigation by applying access control to every outbound and every inbound message. </t>
<t>Since Alice's coffee pot does not require the external communication right, the activation record for the coffee pot does not provide access to the account keys required to perform external communications. Alice's watch device does require access to the account keys so it can receive messages and task updates. But since it is a device that Alice has to carry on her person to use, it is a device that might easily be lost or stolen. Accordingly, the activation record for Alice's watch provides access to the account decryption and signature keys but in the form of threshold key shares mediated by the Mesh service. Thus, Alice's watch can sign and read message sent to the account but only under the control of the Mesh service.</t>
</section>
</section>
<section title="Service" anchor="n-service"><t>Mesh services are described by a <tt>ProfileService</tt>. This specifies the encryption, and signature authentication keys used to interact with the abstract service.</t>
<t>Since Mesh accounts and services are both abstract constructs, they cannot interact directly. A device connected to an account can only interact with a service by interacted with a device authorized to provide services on behalf of one or more accounts connected to the service. Such a device is called a Mesh Host. </t>
<t>Mesh hosts <bcp14>MAY</bcp14> be managed using the same ProfileDevice and device connection mechanism provided for management of user devices or by whatever other management protocols prove convenient. The only part of the Service/Host interaction that is visible to devices connected to a profile and to hosts connected to other services is the ConnectionHost structure that describes the set of device keys to use in interactions with that specific host.</t>
</section>
</section>
<section title="Catalogs" anchor="n-catalogs"><t>Catalogs track sets of persistent objects associated with a Mesh Service Account. The Mesh Service has no access to the entries in any Mesh catalog except for the Device and Contacts catalog which are used in device authentication and authorization of inbound messages.</t>
<t>Each Mesh Catalog managed by a Mesh Account has a name of the form:</t>
<t><tt>&lt;prefix&gt;_&lt;name&gt;</tt></t>
<t>Where <tt>&lt;prefix&gt;</tt> is the IANA assigned service name. The assigned service name for the Mathematical Mesh is mmm. Thus, all catalogs specified by the Mesh schema have names prefixed with the sequence <tt>mmm_</tt>.</t>
<t>The following catalogs are currently specified within the Mathematical Mesh. </t>
<dl>
<dt>Access: mmm_Access</dt>
<dd>
<t>Describes access control policy for performing operations on the account. The Access catalog is the only Mesh catalog whose contents are readable by the Mesh Service under normal circumstances.</t>
</dd>
<dt>Application: <tt>mmm_Application</tt></dt>
<dd>
<t>Describes configuration information for applications including mail (SMTP, IMAP, OpenPGP, S/MIME, etc) and SSH and for the MeshAccount application itself.</t>
</dd>
<dt>Bookmark: <tt>mmm_Bookmark</tt></dt>
<dd>
<t>Describes Web bookmarks and other citations allowing them to be shared between devices connected to the profile.</t>
</dd>
<dt>Contact: <tt>mmm_Contact</tt></dt>
<dd>
<t>Describes logical and physical contact information for people and organizations.</t>
</dd>
<dt>Credential: <tt>mmm_Credential</tt></dt>
<dd>
<t>Describes credentials used to access network resources.</t>
</dd>
<dt>Device: <tt>mmm_Device</tt></dt>
<dd>
<t>Describes the set of devices connected to the account and the permissions assigned to them</t>
</dd>
<dt>Network: <tt>mmm_Network</tt></dt>
<dd>
<t>Describes network settings such as WiFi access points, IPSEC and TLS VPN configurations, etc.</t>
</dd>
<dt>Member: mmm_Member</dt>
<dd>
<t>Describes the set of members connected to a group account.</t>
</dd>
<dt>Publication: mmm_Publication</dt>
<dd>
<t>Describes data published under the account context. The data <bcp14>MAY</bcp14> be stored in the publication catalog itself or on a separate service (e.g. a Web server).</t>
</dd>
<dt>Task: <tt>mmm_CatalogTask</tt></dt>
<dd>
<t>Describes tasks assigned to the user including calendar entries and to do lists.</t>
</dd>
</dl>
<t>The Access, Publication, Device and Member catalogs are involved in Mesh Service Protocol interactions. These interactions are further described in the Protocol Reference  <xref target="draft-hallambaker-mesh-protocol"></xref>.</t>
<t>In many cases, the Mesh Catalog offers capabilities that represent a superset of the capabilities of an existing application. For example, the task catalog supports the appointment tracking functions of a traditional calendar application and the task tracking function of the traditional 'to do list' application. Combining these functions allows tasks to be triggered by other events other than the passage of time such as completion of other tasks, geographical presence, etc.</t>
<t>In such cases, the Mesh Catalog entries are designed to provide a superset of the data representation capabilities of the legacy formats and (where available) recent extensions. Where a catalog entry is derived from input presented in a legacy format, the original data representation <bcp14>MAY</bcp14> be attached verbatim to facilitate interoperability.</t>
<section title="Access" anchor="n-access"><t>The access catalog <tt>mmm_Access</tt> contains a list of access control entries granting a party authenticated using a particular cryptographic credential a specific privilege such as:</t>
<ul>
<li>Accept Mesh Messages of particular types</li>
<li>Perform an operation on a private key known to the service.</li>
</ul>
<t>As with the publication catalog, the access catalog provides information that is necessary for the Mesh Service to act on behalf of the user. It is therefore necessary to grant a decryption capability for this catalog during the process of binding the account to a service.</t>
</section>
<section title="Application" anchor="n-application"><t>The application catalog <tt>mmm</tt>_<tt>Application</tt> contains <tt>CatalogEntryApplication</tt> entries which describe the use of specific applications under the Mesh Service Account. Multiple application accounts for a single application <bcp14>MAY</bcp14> be connected to a single Mesh Service Account. Each account being specified in a separate entry.</t>
<t>The <tt>CatalogEntryApplication</tt> entries only contain configuration information for the application as it applies to the account as a whole. If the application requires separate configuration for individual devices, this is specified in separate activation records specified in the corresponding <tt>ConnectionDevice</tt>.</t>
<section title="Mesh Account" anchor="n-mesh-account"><t>Mesh Accounts are described by <tt>CatalogEntryAccount</tt> entries. The corresponding activation records for the connected devices contain the contributions used to derive the private keys for use of the account.</t>
<t>The <tt>CatalogEntryAccount</tt> entry is described in the section describing Mesh accounts above.</t>
</section>
<section title="SSH" anchor="n-ssh"><t>SSH configuration profiles are described by <tt>CatalogEntryApplicationSSH</tt> entries. The corresponding activation records for the connected devices contain the contributions used to derive the private keys.</t>
<t>A user may have separate SSH configurations for separate purposes within a single Mesh Account. This allows a system administrator servicing multiple clients to maintain separate SSH profiles for each of her customers allowing credentials to be easily (and verifiably) revoked at contract termination.</t>
<t>The SSH profile contains the information that is stored in the <tt>known_hosts</tt> and <tt>authorized_keys</tt> files of SSH clients and servers. </t>
</section>
<section title="Mail" anchor="n-mail"><t>Mail configuration profiles are described by one or more <tt>CatalogEntryApplicationMail</tt> entries, one for each email account connected to the Mesh profile. The corresponding activation records for the connected devices contain information used to provide the device with the necessary decryption information.</t>
<t>Entries specify the email account address(es), the inbound and outbound server configuration and the cryptographic keys to be used for S/MIME and OpenPGP encryption.</t>
</section>
</section>
<section title="Bookmark" anchor="n-bookmark"><t>The bookmark catalog <tt>mmm_bookmark</tt> contains <tt>CatalogEntryBookmark</tt> entries which describe Web bookmarks and other citations allowing them to be shared between devices connected to the profile.</t>
<t>The fields currently supported by the Bookmarks catalog are currently limited to the fields required for tracking Web bookmarks. Specification of additional fields to track full academic citations is a work in progress.</t>
<sourcecode>{
  "CatalogedBookmark":{
    "Uri":"http://www.site1.com",
    "Title":"site1",
    "Path":"Sites.1"}}</sourcecode>
</section>
<section title="Contact" anchor="n-contact"><t>The contact catalog <tt>mmm_contact</tt> contains <tt>CatalogEntryContact</tt> entries which describe</t>
<sourcecode>{
  "CatalogedContact":{
    "Key":"MCDH-FIPQ-XWI3-2MLS-KZ6U-SAVO-EVSH",
    "Self":true,
    "Contact":{
      "ContactPerson":{
        "Id":"MCDH-FIPQ-XWI3-2MLS-KZ6U-SAVO-EVSH",
        "Anchors":[{
            "Udf":"MCDH-FIPQ-XWI3-2MLS-KZ6U-SAVO-EVSH",
            "Validation":"Self"}
          ],
        "NetworkAddresses":[{
            "Address":"alice@example.com",
            "EnvelopedProfileAccount":[{
                "EnvelopeID":"MCDH-FIPQ-XWI3-2MLS-KZ6U-SAVO-EVSH",
                "dig":"S512",
                "ContentMetaData":"ewogICJVbmlxdWVJRCI6ICJNQ0RILU
  ZJUFEtWFdJMy0yTUxTLUtaNlUtU0FWTy1FVlNIIiwKICAiTWVzc2FnZVR5cGUiOiA
  iUHJvZmlsZVVzZXIiLAogICJjdHkiOiAiYXBwbGljYXRpb24vbW1tL29iamVjdCIs
  CiAgIkNyZWF0ZWQiOiAiMjAyMC0xMS0wM1QwMTo1MDozOFoifQ"},
              "ewogICJQcm9maWxlVXNlciI6IHsKICAgICJQcm9maWxlU2lnbm
  F0dXJlIjogewogICAgICAiVWRmIjogIk1DREgtRklQUS1YV0kzLTJNTFMtS1o2VS1
  TQVZPLUVWU0giLAogICAgICAiUHVibGljUGFyYW1ldGVycyI6IHsKICAgICAgICAi
  UHVibGljS2V5RUNESCI6IHsKICAgICAgICAgICJjcnYiOiAiRWQ0NDgiLAogICAgI
  CAgICAgIlB1YmxpYyI6ICJoUUxJcWdOMEtRS3V4R18tSHRHV2JQQ0l1RlJvbG9UQn
  o4c3MyWjltenh5VThQaEhsWE5zCiAgZG42d0VJNURsU1NkLXhEVFQ1RHFlLThBIn1
  9fSwKICAgICJBY2NvdW50QWRkcmVzcyI6ICJhbGljZUBleGFtcGxlLmNvbSIsCiAg
  ICAiU2VydmljZVVkZiI6ICJNRFFPLVI2NkotTVZFTy1CREw2LVY2VDctRlBJSS1VN
  DJRIiwKICAgICJBY2NvdW50RW5jcnlwdGlvbiI6IHsKICAgICAgIlVkZiI6ICJNQ1
  NNLUpSQ08tRkRTRS1IVTJYLVJaNkItVFpWTy1FVVdHIiwKICAgICAgIlB1YmxpY1B
  hcmFtZXRlcnMiOiB7CiAgICAgICAgIlB1YmxpY0tleUVDREgiOiB7CiAgICAgICAg
  ICAiY3J2IjogIlg0NDgiLAogICAgICAgICAgIlB1YmxpYyI6ICIyOG1NTV90ZEFyb
  mhsYWptckF1WEtIQndYamdkVzdOYWVhTmlWYTFCQ1JDeUJBeDF0NDlKCiAgRUlRUF
  FBcGxiZXp5YlllWkhMUHhjaVFBIn19fSwKICAgICJBZG1pbmlzdHJhdG9yU2lnbmF
  0dXJlIjogewogICAgICAiVWRmIjogIk1DREgtRklQUS1YV0kzLTJNTFMtS1o2VS1T
  QVZPLUVWU0giLAogICAgICAiUHVibGljUGFyYW1ldGVycyI6IHsKICAgICAgICAiU
  HVibGljS2V5RUNESCI6IHsKICAgICAgICAgICJjcnYiOiAiRWQ0NDgiLAogICAgIC
  AgICAgIlB1YmxpYyI6ICJoUUxJcWdOMEtRS3V4R18tSHRHV2JQQ0l1RlJvbG9UQno
  4c3MyWjltenh5VThQaEhsWE5zCiAgZG42d0VJNURsU1NkLXhEVFQ1RHFlLThBIn19
  fSwKICAgICJBY2NvdW50QXV0aGVudGljYXRpb24iOiB7CiAgICAgICJVZGYiOiAiT
  URIVi1OTDVJLUZUTkUtTUVQUC1UM0xMLUdWMlAtM1BRSyIsCiAgICAgICJQdWJsaW
  NQYXJhbWV0ZXJzIjogewogICAgICAgICJQdWJsaWNLZXlFQ0RIIjogewogICAgICA
  gICAgImNydiI6ICJYNDQ4IiwKICAgICAgICAgICJQdWJsaWMiOiAiOUttNXNQdjQt
  MkVYUDU1NDh4cmF5aXpyQXBZZVRzS3NSY0hySk8zaWdDbkw4OTB5X2lsQQogIG9qU
  mxhSi1CUFRHMzlBMFFHdE11bi04QSJ9fX0sCiAgICAiQWNjb3VudFNpZ25hdHVyZS
  I6IHsKICAgICAgIlVkZiI6ICJNQllCLTNTS0ctU0lGUi1LRUZKLUREVUktWFVSTS1
  WRzZOIiwKICAgICAgIlB1YmxpY1BhcmFtZXRlcnMiOiB7CiAgICAgICAgIlB1Ymxp
  Y0tleUVDREgiOiB7CiAgICAgICAgICAiY3J2IjogIkVkNDQ4IiwKICAgICAgICAgI
  CJQdWJsaWMiOiAiZUN1akU5SjU2Z242aC1HdkJwaERoejFxQjVQS1RTR21tamtpcU
  hGam1EcEEyN21DWmxLNAogIFBrR19taE9OX0N3NzFVWmFBaW9tamhDQSJ9fX19fQ",
              {
                "signatures":[{
                    "alg":"S512",
                    "kid":"MCDH-FIPQ-XWI3-2MLS-KZ6U-SAVO-EVSH",
                    "signature":"hPWd3iRqTx5tn_VAcFOl5NFiUhiSvTQ2
  Yrt3lMUaZlgEAjJvjav7zwgB6SfVt59eaBG3cAI6z_iA2mi3eDP314lD8xxbOALJp
  3r02TTvMaxxGx1R_HdneReMZYlrO12YdllyI9w14mkQDBGtY1bn4QsA"}
                  ],
                "PayloadDigest":"j3iRsYIUPzWOAE1qN2MyfSZXb3DrEnqh
  tttoa8BgpGgZJb_A-1Nxi9Vk-wzz7kEh30HuWsfh2mYdprmNpeJDfw"}
              ],
            "Protocols":[{
                "Protocol":"mmm"}
              ]}
          ],
        "Sources":[{
            "Validation":"Self",
            "EnvelopedSource":[{
                "dig":"S512",
                "ContentMetaData":"ewogICJNZXNzYWdlVHlwZSI6ICJDb2
  50YWN0UGVyc29uIiwKICAiY3R5IjogImFwcGxpY2F0aW9uL21tbS9vYmplY3QiLAo
  gICJDcmVhdGVkIjogIjIwMjAtMTEtMDNUMDE6NTA6MzhaIn0"},
              "ewogICJDb250YWN0UGVyc29uIjogewogICAgIkFuY2hvcnMiOi
  BbewogICAgICAgICJVZGYiOiAiTUNESC1GSVBRLVhXSTMtMk1MUy1LWjZVLVNBVk8
  tRVZTSCIsCiAgICAgICAgIlZhbGlkYXRpb24iOiAiU2VsZiJ9XSwKICAgICJOZXR3
  b3JrQWRkcmVzc2VzIjogW3sKICAgICAgICAiQWRkcmVzcyI6ICJhbGljZUBleGFtc
  GxlLmNvbSIsCiAgICAgICAgIkVudmVsb3BlZFByb2ZpbGVBY2NvdW50IjogW3sKIC
  AgICAgICAgICAgIkVudmVsb3BlSUQiOiAiTUNESC1GSVBRLVhXSTMtMk1MUy1LWjZ
  VLVNBVk8tRVZTSCIsCiAgICAgICAgICAgICJkaWciOiAiUzUxMiIsCiAgICAgICAg
  ICAgICJDb250ZW50TWV0YURhdGEiOiAiZXdvZ0lDSlZibWx4ZFdWSlJDSTZJQ0pOU
  TBSSUxVWkpVRkV0V0ZkSk15MAogIHlUVXhUTFV0YU5sVXRVMEZXVHkxRlZsTklJaX
  dLSUNBaVRXVnpjMkZuWlZSNWNHVWlPaUFpVUhKdlptbHNaCiAgVlZ6WlhJaUxBb2d
  JQ0pqZEhraU9pQWlZWEJ3YkdsallYUnBiMjR2YlcxdEwyOWlhbVZqZENJc0NpQWdJ
  a04KICB5WldGMFpXUWlPaUFpTWpBeU1DMHhNUzB3TTFRd01UbzFNRG96T0ZvaWZRI
  n0sCiAgICAgICAgICAiZXdvZ0lDSlFjbTltYVd4bFZYTmxjaUk2SUhzS0lDQWdJQ0
  pRY205bWFXeAogIGxVMmxuYm1GMGRYSmxJam9nZXdvZ0lDQWdJQ0FpVldSbUlqb2d
  JazFEUkVndFJrbFFVUzFZVjBrekxUSk5UCiAgRk10UzFvMlZTMVRRVlpQTFVWV1Uw
  Z2lMQW9nSUNBZ0lDQWlVSFZpYkdsalVHRnlZVzFsZEdWeWN5STZJSHMKICBLSUNBZ
  0lDQWdJQ0FpVUhWaWJHbGpTMlY1UlVORVNDSTZJSHNLSUNBZ0lDQWdJQ0FnSUNKam
  NuWWlPaUFpUgogIFdRME5EZ2lMQW9nSUNBZ0lDQWdJQ0FnSWxCMVlteHBZeUk2SUN
  Kb1VVeEpjV2RPTUV0UlMzVjRSMTh0U0hSCiAgSFYySlFRMGwxUmxKdmJHOVVRbm80
  YzNNeVdqbHRlbmg1VlRoUWFFaHNXRTV6Q2lBZ1pHNDJkMFZKTlVSc1UKICAxTmtMW
  GhFVkZRMVJIRmxMVGhCSW4xOWZTd0tJQ0FnSUNKQlkyTnZkVzUwUVdSa2NtVnpjeU
  k2SUNKaGJHbAogIGpaVUJsZUdGdGNHeGxMbU52YlNJc0NpQWdJQ0FpVTJWeWRtbGp
  aVlZrWmlJNklDSk5SRkZQTFZJMk5rb3RUCiAgVlpGVHkxQ1JFdzJMVlkyVkRjdFJs
  QkpTUzFWTkRKUklpd0tJQ0FnSUNKQlkyTnZkVzUwUlc1amNubHdkR2wKICB2YmlJN
  klIc0tJQ0FnSUNBZ0lsVmtaaUk2SUNKTlExTk5MVXBTUTA4dFJrUlRSUzFJVlRKWU
  xWSmFOa0l0VgogIEZwV1R5MUZWVmRISWl3S0lDQWdJQ0FnSWxCMVlteHBZMUJoY21
  GdFpYUmxjbk1pT2lCN0NpQWdJQ0FnSUNBCiAgZ0lsQjFZbXhwWTB0bGVVVkRSRWdp
  T2lCN0NpQWdJQ0FnSUNBZ0lDQWlZM0oySWpvZ0lsZzBORGdpTEFvZ0kKICBDQWdJQ
  0FnSUNBZ0lsQjFZbXhwWXlJNklDSXlPRzFOVFY5MFpFRnlibWhzWVdwdGNrRjFXRX
  RJUW5kWWFtZAogIGtWemRPWVdWaFRtbFdZVEZDUTFKRGVVSkJlREYwTkRsS0NpQWd
  SVWxSVUZGQmNHeGlaWHA1WWxsbFdraE1VCiAgSGhqYVZGQkluMTlmU3dLSUNBZ0lD
  SkJaRzFwYm1semRISmhkRzl5VTJsbmJtRjBkWEpsSWpvZ2V3b2dJQ0EKICBnSUNBa
  VZXUm1Jam9nSWsxRFJFZ3RSa2xRVVMxWVYwa3pMVEpOVEZNdFMxbzJWUzFUUVZaUE
  xVVldVMGdpTAogIEFvZ0lDQWdJQ0FpVUhWaWJHbGpVR0Z5WVcxbGRHVnljeUk2SUh
  zS0lDQWdJQ0FnSUNBaVVIVmliR2xqUzJWCiAgNVJVTkVTQ0k2SUhzS0lDQWdJQ0Fn
  SUNBZ0lDSmpjbllpT2lBaVJXUTBORGdpTEFvZ0lDQWdJQ0FnSUNBZ0kKICBsQjFZb
  XhwWXlJNklDSm9VVXhKY1dkT01FdFJTM1Y0UjE4dFNIUkhWMkpRUTBsMVJsSnZiRz
  lVUW5vNGMzTQogIHlXamx0ZW5oNVZUaFFhRWhzV0U1ekNpQWdaRzQyZDBWSk5VUnN
  VMU5rTFhoRVZGUTFSSEZsTFRoQkluMTlmCiAgU3dLSUNBZ0lDSkJZMk52ZFc1MFFY
  VjBhR1Z1ZEdsallYUnBiMjRpT2lCN0NpQWdJQ0FnSUNKVlpHWWlPaUEKICBpVFVSS
  VZpMU9URFZKTFVaVVRrVXRUVVZRVUMxVU0weE1MVWRXTWxBdE0xQlJTeUlzQ2lBZ0
  lDQWdJQ0pRZAogIFdKc2FXTlFZWEpoYldWMFpYSnpJam9nZXdvZ0lDQWdJQ0FnSUN
  KUWRXSnNhV05MWlhsRlEwUklJam9nZXdvCiAgZ0lDQWdJQ0FnSUNBZ0ltTnlkaUk2
  SUNKWU5EUTRJaXdLSUNBZ0lDQWdJQ0FnSUNKUWRXSnNhV01pT2lBaU8KICBVdHROW
  E5RZGpRdE1rVllVRFUxTkRoNGNtRjVhWHB5UVhCWlpWUnpTM05TWTBoeVNrOHphV2
  REYmt3NE9UQgogIDVYMmxzUVFvZ0lHOXFVbXhoU2kxQ1VGUkhNemxCTUZGSGRFMTF
  iaTA0UVNKOWZYMHNDaUFnSUNBaVFXTmpiCiAgM1Z1ZEZOcFoyNWhkSFZ5WlNJNklI
  c0tJQ0FnSUNBZ0lsVmtaaUk2SUNKTlFsbENMVE5UUzBjdFUwbEdVaTEKICBMUlVaS
  0xVUkVWVWt0V0ZWU1RTMVdSelpPSWl3S0lDQWdJQ0FnSWxCMVlteHBZMUJoY21GdF
  pYUmxjbk1pTwogIGlCN0NpQWdJQ0FnSUNBZ0lsQjFZbXhwWTB0bGVVVkRSRWdpT2l
  CN0NpQWdJQ0FnSUNBZ0lDQWlZM0oySWpvCiAgZ0lrVmtORFE0SWl3S0lDQWdJQ0Fn
  SUNBZ0lDSlFkV0pzYVdNaU9pQWlaVU4xYWtVNVNqVTJaMjQyYUMxSGQKICBrSndhR
  VJvZWpGeFFqVlFTMVJUUjIxdGFtdHBjVWhHYW0xRWNFRXlOMjFEV214TE5Bb2dJRk
  JyUjE5dGFFOQogIE9YME4zTnpGVldtRkJhVzl0YW1oRFFTSjlmWDE5ZlEiLAogICA
  gICAgICAgewogICAgICAgICAgICAic2lnbmF0dXJlcyI6IFt7CiAgICAgICAgICAg
  ICAgICAiYWxnIjogIlM1MTIiLAogICAgICAgICAgICAgICAgImtpZCI6ICJNQ0RIL
  UZJUFEtWFdJMy0yTUxTLUtaNlUtU0FWTy1FVlNIIiwKICAgICAgICAgICAgICAgIC
  JzaWduYXR1cmUiOiAiaFBXZDNpUnFUeDV0bl9WQWNGT2w1TkZpVWhpU3ZUUTJZcnQ
  zbE1VYVpsZ0VBakp2agogIGF2N3p3Z0I2U2ZWdDU5ZWFCRzNjQUk2el9pQTJtaTNl
  RFAzMTRsRDh4eGJPQUxKcDNyMDJUVHZNYXh4R3gxCiAgUl9IZG5lUmVNWllsck8xM
  llkbGx5STl3MTRta1FEQkd0WTFibjRRc0EifV0sCiAgICAgICAgICAgICJQYXlsb2
  FkRGlnZXN0IjogImozaVJzWUlVUHpXT0FFMXFOMk15ZlNaWGIzRHJFbnFodHR0b2E
  4QmdwR2daSgogIGJfQS0xTnhpOVZrLXd6ejdrRWgzMEh1V3NmaDJtWWRwcm1OcGVK
  RGZ3In1dLAogICAgICAgICJQcm90b2NvbHMiOiBbewogICAgICAgICAgICAiUHJvd
  G9jb2wiOiAibW1tIn1dfV19fQ",
              {
                "signatures":[{
                    "alg":"S512",
                    "kid":"MBYB-3SKG-SIFR-KEFJ-DDUI-XURM-VG6N",
                    "signature":"Orf-ht-bmbAGT8TEVOWftjfx2q_h0Zfx
  _NFvD5Xu60sj7FU1W3c1MN10sSDTzHSvijTxKnzphz4AKpdaFO5FjoJ67m3nN8bz0
  lub-vfF93oTKrg3TkeXvwqY45dBROcXPsprqi9247P2W6GRvlqGRjIA"}
                  ],
                "PayloadDigest":"Xw7Zg3PWqPsjf1Tnu1jbEaeb3Q2AhXMc
  BDWtnAh9400za0Sx9UIMJzp3Hnk0XUoCT8ETzg3nP2g3IJ89mABu0g"}
              ]}
          ]}}}}</sourcecode>
<t>The fields of the contact catalog provide a superset of the capabilities of vCard <xref target="RFC2426"></xref>.</t>
<t>The Contact catalog is typically used by the MeshService as a source of authorization information to perform access control on inbound and outbound message requests. For this reason, Mesh Service <bcp14>SHOULD</bcp14> be granted read access to the contacts catalog by providing a decryption entry for the service.</t>
</section>
<section title="Credential" anchor="n-credential"><t>The credential catalog <tt>mmm_credential</tt> contains <tt>CatalogEntryCredential</tt> entries which describe credentials used to access network resources.</t>
<sourcecode>{
  "CatalogedCredential":{
    "Service":"ftp.example.com",
    "Username":"alice1",
    "Password":"password"}}</sourcecode>
<t>Only username/password credentials are stored in the credential catalog. If public key credentials are to be used, these <bcp14>SHOULD</bcp14> be managed as an application profile allowing separate credentials to be created for each device.</t>
</section>
<section title="Device" anchor="n-device-0"><t>The device catalog <tt>mmm_Device</tt> contains <tt>CatalogEntryDevice</tt> entries which describe the devices connected to the account and the permissions assigned to them.</t>
<t>Each device connected to a Mesh Account has an associated CatalogEntryDevice entry that includes the activation and connection records for the account. These records are described in further detail in section  REF _Ref54628559 \r \h 0.</t>
</section>
<section title="Network" anchor="n-network"><t>The network catalog contains <tt>CatalogEntryNetwork</tt> entries which describe network settings, IPSEC and TLS VPN configurations, etc.</t>
<sourcecode>{
  "CatalogedNetwork":{
    "Service":"myWiFi",
    "Password":"securePassword"}}</sourcecode>
</section>
<section title="Publication" anchor="n-publication"><t>The publication catalog <tt>mmm_Publication</tt> contains <tt>CatalogEntryPublication</tt> entries which describe content published through the account.</t>
</section>
<section title="Task" anchor="n-task"><t>The Task catalog <tt>mmm_Task</tt> contains <tt>CatalogEntryTask</tt> entries which describe tasks assigned to the user including calendar entries and to do lists.</t>
<t>The fields of the task catalog currently reflect those offered by the iCalendar specification <xref target="RFC5545"></xref>. Specification of additional fields to allow task triggering on geographic location and/or completion of other tasks is a work in progress.</t>
<sourcecode>{
  "CatalogedTask":{
    "Title":"SomeItem",
    "Key":"NAZH-Z36Z-HJRC-KS5C-RVWH-XVSB-Z5A7"}}</sourcecode>
</section>
</section>
<section title="Spools" anchor="n-spools"><t>Spools are DARE Containers containing an append only list of messages sent or received by an account. Three spools are currently defined:</t>
<dl>
<dt>Inbound</dt>
<dd>
<t>Messages sent to the account. These are encrypted under the account encryption keys of the sender and receiver that were current at the time the message was sent.</t>
</dd>
<dt>Outbound</dt>
<dd>
<t>Messages sent from the account. These are encrypted under the account encryption keys of the sender and receiver that were current at the time the message was sent. </t>
</dd>
<dt>Local</dt>
<dd>
<t>Messages sent from the account for internal use. These are encrypted under the encryption key of the intended recipient alone. This is either the account administration encryption key or a device encryption key.</t>
</dd>
</dl>
<t>Every Mesh Message has a unique message identifier. Messages created at the beginning of a new messaging protocol interaction are assigned a random message identifier. Responses to previous messages are assigned message identifiers formed from the message identifier to which they respond by means of a message digest function.</t>
<t>Every Mesh Message stored in a spool is encapsulated in an envelope which bears a unique identifier that is formed by applying a message digest function to the message identifier. Each stored message has an associated state which is initially set to the state <tt>Initial</tt> and <bcp14>MAY</bcp14> be subsequently altered by one or more <tt>MessageComplete</tt> messages subsequently appended to the spool. The allowable message states depending upon the spool in question.</t>
<section title="Outbound" anchor="n-outbound"><t>The outbound spool stores messages that are to be or have been sent and <tt>MessageComplete</tt> messages reporting changes to the status of the messages stored on the spool. </t>
<t>Messages posted to the outbound spool have the state Initial, Sent, Received or Refused:</t>
<dl>
<dt>Initial</dt>
<dd>
<t>The initial state of a message posted to the spool.</t>
</dd>
<dt>Sent</dt>
<dd>
<t>The Mesh Service of the sender has delivered the message to the Mesh Service of the recipient which accepted it.</t>
</dd>
<dt>Received</dt>
<dd>
<t>The Mesh Service of the sender has delivered the message to the Mesh Service of the recipient and the recipient has acknowledged receipt.</t>
</dd>
<dt>Refused</dt>
<dd>
<t>The Mesh Service of the sender has delivered the message to the Mesh Service of the recipient which refused to accept it.</t>
</dd>
</dl>
<t><tt>MessageComplete</tt> messages are only valid when posted to the spool by the service.</t>
</section>
<section title="Inbound" anchor="n-inbound"><t>The inbound spool stores messages that have been received by the Mesh service servicing the account and MessageComplete messages reporting changes to the status of the messages stored on the spool.</t>
<t>Messages posted to the outbound spool have the state Initial, Read:</t>
<dl>
<dt>Initial</dt>
<dd>
<t>The initial state of a message posted to the spool.</t>
</dd>
<dt>Read</dt>
<dd>
<t>The message has been read.</t>
</dd>
</dl>
<t>A message previously marked as read <bcp14>MAY</bcp14> be returned to the unread state by marking it as being in the Initial state.</t>
</section>
<section title="Local" anchor="n-local"><t>The local spool stores messages that are used for administrative functions. In normal circumstances, only administrator devices and the Mesh Service require access to the local spool.</t>
<t>The local spool is used to store MessagePin messages used to notify administration devices that a PIN code has been registered for some purpose and RespondConnection messages used to inform a device of the result of a connection request.</t>
<t>The local spool is used in a device connection operation to provide a device with the activation and connection records required to access the service as an authorized client. Servicing these requests requires that the service be able to access messages stored in the spool by envelope id.</t>
<t>Messages posted to the outbound spool have the states Initial, Closed:</t>
<dl>
<dt>Initial</dt>
<dd>
<t>The initial state of a message posted to the spool.</t>
</dd>
<dt>Closed</dt>
<dd>
<t>The action associated with the message has been completed.</t>
</dd>
</dl>
</section>
</section>
<section title="Cryptographic Operations" anchor="n-cryptographic-operations"><t>The Mesh makes use of various cryptographic operations including threshold operations. For convenience, these are gathered here and specified as functions that are referenced by other parts of the specification.</t>
<section title="Key Derivation from Seed" anchor="n-key-derivation-from-seed"><t>Mesh Keys that derived from a seed value use the mechanism described in <xref target="draft-hallambaker-mesh-udf"></xref>. Use of the <tt>keyname</tt> parameter allows multiple keys for different uses to be derived from a single key. Thus escrow of a single seed value permits recovery of all the private keys associated with the profile.</t>
<t>The keyname parameter is a string formed by concatenating identifiers specifying the key type, the actor that will use the key and the key operation:</t>
</section>
<section title="Message Response Identifier" anchor="n-message-response-identifier"><t>Every Mesh message has a unique <tt>MessageId</tt>. When encapsulated in a DARE Envelope, the EnvelopeId field of the envelope header is the UDF Content Digest of the enclosed MessageId as a string: </t>
<sourcecode>public static string GetEnvelopeId(string messageID) =&gt;
            UDF.ContentDigestOfUDF(messageID);</sourcecode>
<t>When processing a Mesh message results in the creation of a response to the sender, the MessageId of the response is UDF Content Digest of the Binary Data Sequence of the original MessageId:</t>
<sourcecode>static string MakeID(string udf, string content) {
    var (code, bds) = UDF.Parse(udf);
    return code switch
        {
            UdfTypeIdentifier.Digest_SHA_3_512 =&gt;
                UDF.ContentDigestOfDataString(
                bds, content, cryptoAlgorithmId:
                    CryptoAlgorithmId.SHA_3_512),
            _ =&gt; UDF.ContentDigestOfDataString(
            bds, content, cryptoAlgorithmId:
                    CryptoAlgorithmId.SHA_2_512),
            };</sourcecode>
<t>For example:</t>
<t>[To be specified] </t>
</section>
<section title="Proof of Knowledge of PIN" anchor="n-proof-of-knowledge-of-pin"><t>Mesh Message classes that are subclasses of <tt>MessagePinValidated</tt> <bcp14>MAY</bcp14> be authenticated by means of a PIN. Currently two such messages are defined: <tt>MessageContact</tt> used in contact exchange and <tt>RequestConnection</tt> message used in device connection. </t>
<t>The PIN codes used to authenticate <tt>MessagePinValidated</tt> messages are UDF Authenticator strings. The type code of the identifier specifies the algorithm to be used to authenticate the PIN code and the Binary Data Sequence value specifies the key.</t>
<t>The inputs to the PIN proof of knowledge functions are:</t>
<dl>
<dt>PIN: string</dt>
<dd>
<t>A UDF Authenticator. The type code of the identifier specifies the algorithm to be used to authenticate the PIN code and the Binary Data Sequence value specifies the key.</t>
</dd>
<dt>Action: string</dt>
<dd>
<t>A code determining the specific action that the PIN code <bcp14>MAY</bcp14> be used to authenticate. By convention this is the name of the Mesh message type used to perform the action.</t>
</dd>
<dt>Account: string</dt>
<dd>
<t>The account for which the PIN code is issued.</t>
</dd>
<dt>ClientNonce: binary</dt>
<dd>
<t>Nonce value generated by the client using the PIN code to authenticate its message.</t>
</dd>
<dt>PayloadDigest: binary</dt>
<dd>
<t>The PayloadDigest of a DARE Envelope that contains the message to be authenticated. Note that if the envelope is encrypted, this value is calculated over the ciphertext and does not provide proof of knowledge of the plaintext.</t>
</dd>
</dl>
<t>The following values of Action are currently defined:</t>
<table><thead>
<tr>
<th>
Code</th>
<th>
Mesh Message</th>
<th>
Purpose</th>
</tr>
</thead>
<tbody>
<tr>
<td>
"MessageContact"</td>
<td>
MessageContact</td>
<td>
Contact exchange </td>
</tr>
<tr>
<td>
"RequestConnection"</td>
<td>
RequestConnection</td>
<td>
Device connection</td>
</tr>
</tbody>
</table><t>These inputs are used to derive values as follows:</t>
<sourcecode>alg = UdfAlg (PIN)
pinData = UdfBDS (PIN)
saltedPINData = MAC (Action, pinData)
saltedPIN = UDFPresent (Authenticator_HMAC_SHA_2_512 + saltedPINData)
PinId = UDFPresent (MAC (Account, saltedPINData))
witnessData = Account.ToUTF8() + ClientNonce + PayloadDigest
witnessValue =  MAC (witnessData , saltedPINData)</sourcecode>
<t>Eg.</t>
<t>[To be specified] </t>
<t>Where <tt>MAC(data, key)</tt> is the message authentication code algorithm specified by the value of <tt>alg</tt>.</t>
<t>When an administrative device issues a PIN code, a Message PIN is appended to the local spool. This has the MessageId PinId and specifies the value <tt>saltedPIN</tt> in the field of that name.</t>
<t>When PIN code authentication is used, a message of type MessagePinValidated specifies the values ClientNonce, PinWitness and PinId in the fields of those names.</t>
<t>[To be specified] </t>
</section>
<section title="EARL" anchor="n-earl"><t>The UDF Encrypted Authenticated Resource Locator mechanism is used to publish data and provide means of authentication and access through a static identifier such as a QR code.</t>
<t>This mechanism is used to allow contact exchange by means of a QR code printed on a business card and to connect a device to an account using a static identifier printed on the device in the form of a QR code.</t>
<t>In both cases, the information is passed using the EARL format described in  <xref target="draft-hallambaker-mesh-udf"></xref>.</t>
</section>
<section title="Key Agreement" anchor="n-key-agreement"><t>All Mesh Protocol requests except for the HelloRequest and every response <bcp14>MUST</bcp14> be authenticated under the device key of the host or device making the request.</t>
<t>Initial authentication is achieved by performing a Key agreement under the <tt>DeviceAuthentication</tt> key of each of the hosts and combining the result with nonce values provided by the requestor and respondent using a KDF function as follows:</t>
<t>Two bindings are currently planned.</t>
<dl>
<dt>DARE Envelope over HTTPS</dt>
<dd>
<t>The request or response is encapsulated in a DARE Envelope that is exchanged by means of a HTTP POST method over a TLS transport. The shared secret is used as the key on Message Authentication Code that authenticates the request payload.</t>
</dd>
<dt>UDP Transport</dt>
<dd>
<t>Presents the same information as for the DARE Envelope over HTTPS case but in a compact encoding using the shared secret and an authenticated encryption scheme to pass the required information. </t>
</dd>
</dl>
<t>Once authentication has been performed, the same pair of devices <bcp14>MAY</bcp14> re-authenticate using the previously agreed key. To facilitate stateless implementation, a host specifies an opaque identifier to be used to identify the shared secret on subsequent uses which <bcp14>MAY</bcp14> be used to recover the shared secret from the opaque identifier.</t>
<t>[To be specified] </t>
</section>
<section title="Service Cryptographic Operations" anchor="n-service-cryptographic-operations"><t>A Mesh Service acts as the counterparty for threshold operations allowing mitigation of the risk of compromise of an individual device connected to a user account or an insider threat from an individual member of a group account.</t>
<t>When acting in this role, the Mesh service controls the use of the cryptographic function but does not have the ability to perform the action either by itself or by collaborating with other services to which the account has been bound in the past.</t>
<t>Note that this approach limits rather than eliminates trust in the service. As with services presenting themselves as 'zero trust', a Mesh service becomes a trusted service after a sufficient number of breaches in other parts of the system have occurred. And the user trusts the service to provide availability of the service.</t>
<t>Three service cryptographic operations are currently specified:</t>
<dl>
<dt>Threshold Key Share</dt>
<dd>
<t>A private key share <em>s</em>, held by the service is split into key shares <em>x</em>, <em>y</em> such that <em>a</em> = <em>x</em> + <em>y</em>. One key share is encrypted under a decryption key held by the service. The other is encrypted under a public key specified by the party making the request.</t>
</dd>
<dt>Threshold Key Agreement</dt>
<dd>
<t>A private key share s, held by the service is used to calculate the value (<em>sl </em>+ <em>c</em>).<em>P</em> where <em>l</em>, <em>c</em> are integers specified by the requestor and <em>P</em> is a point on the curve.</t>
</dd>
<dt>Threshold Signature</dt>
<dd>
<t>A private key share s, held by the service is used to calculate a contribution to a threshold signature scheme.</t>
</dd>
</dl>
<t>The implementation of the cryptographic operations described above is described in <xref target="draft-hallambaker-threshold"></xref> and <xref target="draft-hallambaker-threshold-sigs"></xref>.</t>
</section>
</section>
<section title="Mesh Assertions" anchor="n-mesh-assertions-"><t>Mesh Assertions are signed DARE Envelopes that contain one of more claims. Mesh Assertions provide the basis for trust in the Mathematical Mesh.</t>
<t>Mesh Assertions are divided into two classes. Mesh Profiles are self-signed assertions. Assertions that are not self-signed are called declarations. The only type of declaration currently defined is a Connection Declaration describing the connection of a device to an account. </t>
<figure>
<!-- Include SVG File ../Images/SchemaProfilesConnections.svg --><artwork type="svg">
<svg height="441" width="552" xmlns="http://www.w3.org/2000/svg" >
<g transform="translate(8,16)">
  <path d="M 16,0 L 224,0" fill="none" stroke="black" />
  <path d="M 296,0 L 504,0" fill="none" stroke="black" />
  <path d="M 16,32 L 176,32" fill="none" stroke="black" />
  <path d="M 296,32 L 472,32" fill="none" stroke="black" />
  <path d="M 176,48 L 192,48" fill="none" stroke="black" />
  <path d="M 472,48 L 488,48" fill="none" stroke="black" />
  <path d="M 176,96 L 208,96" fill="none" stroke="black" />
  <path d="M 16,112 L 176,112" fill="none" stroke="black" />
  <path d="M 296,112 L 472,112" fill="none" stroke="black" />
  <path d="M 16,144 L 176,144" fill="none" stroke="black" />
  <path d="M 296,144 L 472,144" fill="none" stroke="black" />
  <path d="M 184,160 L 192,160" fill="none" stroke="black" />
  <path d="M 480,160 L 488,160" fill="none" stroke="black" />
  <path d="M 16,176 L 176,176" fill="none" stroke="black" />
  <path d="M 296,176 L 472,176" fill="none" stroke="black" />
  <path d="M 16,192 L 224,192" fill="none" stroke="black" />
  <path d="M 296,192 L 504,192" fill="none" stroke="black" />
  <path d="M 296,224 L 504,224" fill="none" stroke="black" />
  <path d="M 312,256 L 488,256" fill="none" stroke="black" />
  <path d="M 312,336 L 488,336" fill="none" stroke="black" />
  <path d="M 312,368 L 488,368" fill="none" stroke="black" />
  <path d="M 240,384 L 280,384" fill="none" stroke="black" />
  <path d="M 280,384 L 304,384" fill="none" stroke="black" />
  <path d="M 312,400 L 488,400" fill="none" stroke="black" />
  <path d="M 296,416 L 504,416" fill="none" stroke="black" />
  <path d="M 0,16 L 0,176" fill="none" stroke="black" />
  <path d="M 16,32 L 16,112" fill="none" stroke="black" />
  <path d="M 16,144 L 16,176" fill="none" stroke="black" />
  <path d="M 176,32 L 176,48" fill="none" stroke="black" />
  <path d="M 176,48 L 176,96" fill="none" stroke="black" />
  <path d="M 176,96 L 176,112" fill="none" stroke="black" />
  <path d="M 176,144 L 176,160" fill="none" stroke="black" />
  <path d="M 176,160 L 176,176" fill="none" stroke="black" />
  <path d="M 208,64 L 208,96" fill="none" stroke="black" />
  <path d="M 208,96 L 208,144" fill="none" stroke="black" />
  <path d="M 224,112 L 224,192" fill="none" stroke="black" />
  <path d="M 224,192 L 224,368" fill="none" stroke="black" />
  <path d="M 240,16 L 240,176" fill="none" stroke="black" />
  <path d="M 280,16 L 280,176" fill="none" stroke="black" />
  <path d="M 280,240 L 280,384" fill="none" stroke="black" />
  <path d="M 280,384 L 280,400" fill="none" stroke="black" />
  <path d="M 296,32 L 296,112" fill="none" stroke="black" />
  <path d="M 296,144 L 296,176" fill="none" stroke="black" />
  <path d="M 312,256 L 312,336" fill="none" stroke="black" />
  <path d="M 312,368 L 312,400" fill="none" stroke="black" />
  <path d="M 472,32 L 472,48" fill="none" stroke="black" />
  <path d="M 472,48 L 472,112" fill="none" stroke="black" />
  <path d="M 472,144 L 472,160" fill="none" stroke="black" />
  <path d="M 472,160 L 472,176" fill="none" stroke="black" />
  <path d="M 488,256 L 488,336" fill="none" stroke="black" />
  <path d="M 488,368 L 488,400" fill="none" stroke="black" />
  <path d="M 504,64 L 504,144" fill="none" stroke="black" />
  <path d="M 520,16 L 520,176" fill="none" stroke="black" />
  <path d="M 520,240 L 520,400" fill="none" stroke="black" />
  <polygon points="192.000000,160.000000 180.000000,154.399994 180.000000,165.600006" fill="black" transform="rotate(180.000000, 184.000000, 160.000000)" />
  <polygon points="312.000000,384.000000 300.000000,378.399994 300.000000,389.600006" fill="black" transform="rotate(0.000000, 304.000000, 384.000000)" />
  <polygon points="488.000000,160.000000 476.000000,154.399994 476.000000,165.600006" fill="black" transform="rotate(180.000000, 480.000000, 160.000000)" />
  <path d="M 16,0 A 16,16 0 0,0 0,16" fill="none" stroke="black" />
  <path d="M 224,0 A 16,16 0 0,1 240,16" fill="none" stroke="black" />
  <path d="M 296,0 A 16,16 0 0,0 280,16" fill="none" stroke="black" />
  <path d="M 504,0 A 16,16 0 0,1 520,16" fill="none" stroke="black" />
  <path d="M 192,48 A 16,16 0 0,1 208,64" fill="none" stroke="black" />
  <path d="M 488,48 A 16,16 0 0,1 504,64" fill="none" stroke="black" />
  <path d="M 208,96 A 16,16 0 0,1 224,112" fill="none" stroke="black" />
  <path d="M 208,144 A 16,16 0 0,1 192,160" fill="none" stroke="black" />
  <path d="M 504,144 A 16,16 0 0,1 488,160" fill="none" stroke="black" />
  <path d="M 0,176 A 16,16 0 0,0 16,192" fill="none" stroke="black" />
  <path d="M 240,176 A 16,16 0 0,1 224,192" fill="none" stroke="black" />
  <path d="M 280,176 A 16,16 0 0,0 296,192" fill="none" stroke="black" />
  <path d="M 520,176 A 16,16 0 0,1 504,192" fill="none" stroke="black" />
  <path d="M 296,224 A 16,16 0 0,0 280,240" fill="none" stroke="black" />
  <path d="M 504,224 A 16,16 0 0,1 520,240" fill="none" stroke="black" />
  <path d="M 224,368 A 16,16 0 0,0 240,384" fill="none" stroke="black" />
  <path d="M 280,400 A 16,16 0 0,0 296,416" fill="none" stroke="black" />
  <path d="M 520,400 A 16,16 0 0,1 504,416" fill="none" stroke="black" />
  <text text-anchor="middle" font-family="sans-serif" x="432" y="20">f</text>
  <text text-anchor="middle" font-family="sans-serif" x="144" y="52">r</text>
  <text text-anchor="middle" font-family="sans-serif" x="360" y="84">c</text>
  <text text-anchor="middle" font-family="sans-serif" x="384" y="100">n</text>
  <text text-anchor="middle" font-family="sans-serif" x="96" y="100">r</text>
  <text text-anchor="middle" font-family="sans-serif" x="392" y="164">V</text>
  <text text-anchor="middle" font-family="sans-serif" x="344" y="276">c</text>
  <text text-anchor="middle" font-family="sans-serif" x="440" y="20">i</text>
  <text text-anchor="middle" font-family="sans-serif" x="416" y="244">n</text>
  <text text-anchor="middle" font-family="sans-serif" x="408" y="292">a</text>
  <text text-anchor="middle" font-family="sans-serif" x="480" y="324">n</text>
  <text text-anchor="middle" font-family="sans-serif" x="352" y="388">n</text>
  <text text-anchor="middle" font-family="sans-serif" x="416" y="20">r</text>
  <text text-anchor="middle" font-family="sans-serif" x="312" y="52">P</text>
  <text text-anchor="middle" font-family="sans-serif" x="400" y="68">r</text>
  <text text-anchor="middle" font-family="sans-serif" x="80" y="164">u</text>
  <text text-anchor="middle" font-family="sans-serif" x="328" y="308">D</text>
  <text text-anchor="middle" font-family="sans-serif" x="400" y="308">r</text>
  <text text-anchor="middle" font-family="sans-serif" x="32" y="84">S</text>
  <text text-anchor="middle" font-family="sans-serif" x="40" y="84">e</text>
  <text text-anchor="middle" font-family="sans-serif" x="80" y="84">e</text>
  <text text-anchor="middle" font-family="sans-serif" x="120" y="164">a</text>
  <text text-anchor="middle" font-family="sans-serif" x="56" y="84">v</text>
  <text text-anchor="middle" font-family="sans-serif" x="352" y="244">e</text>
  <text text-anchor="middle" font-family="sans-serif" x="424" y="308">t</text>
  <text text-anchor="middle" font-family="sans-serif" x="392" y="52">n</text>
  <text text-anchor="middle" font-family="sans-serif" x="64" y="84">i</text>
  <text text-anchor="middle" font-family="sans-serif" x="360" y="164">u</text>
  <text text-anchor="middle" font-family="sans-serif" x="456" y="244">i</text>
  <text text-anchor="middle" font-family="sans-serif" x="176" y="20">e</text>
  <text text-anchor="middle" font-family="sans-serif" x="64" y="68">u</text>
  <text text-anchor="middle" font-family="sans-serif" x="408" y="276">r</text>
  <text text-anchor="middle" font-family="sans-serif" x="144" y="100">i</text>
  <text text-anchor="middle" font-family="sans-serif" x="40" y="164">i</text>
  <text text-anchor="middle" font-family="sans-serif" x="416" y="292">t</text>
  <text text-anchor="middle" font-family="sans-serif" x="344" y="52">i</text>
  <text text-anchor="middle" font-family="sans-serif" x="424" y="52">r</text>
  <text text-anchor="middle" font-family="sans-serif" x="360" y="68">g</text>
  <text text-anchor="middle" font-family="sans-serif" x="48" y="84">r</text>
  <text text-anchor="middle" font-family="sans-serif" x="88" y="68">A</text>
  <text text-anchor="middle" font-family="sans-serif" x="112" y="68">r</text>
  <text text-anchor="middle" font-family="sans-serif" x="384" y="388">r</text>
  <text text-anchor="middle" font-family="sans-serif" x="416" y="324">n</text>
  <text text-anchor="middle" font-family="sans-serif" x="456" y="324">t</text>
  <text text-anchor="middle" font-family="sans-serif" x="80" y="20">c</text>
  <text text-anchor="middle" font-family="sans-serif" x="152" y="100">g</text>
  <text text-anchor="middle" font-family="sans-serif" x="64" y="164">a</text>
  <text text-anchor="middle" font-family="sans-serif" x="328" y="276">A</text>
  <text text-anchor="middle" font-family="sans-serif" x="384" y="68">t</text>
  <text text-anchor="middle" font-family="sans-serif" x="424" y="100">t</text>
  <text text-anchor="middle" font-family="sans-serif" x="352" y="164">t</text>
  <text text-anchor="middle" font-family="sans-serif" x="408" y="324">e</text>
  <text text-anchor="middle" font-family="sans-serif" x="72" y="20">c</text>
  <text text-anchor="middle" font-family="sans-serif" x="120" y="52">a</text>
  <text text-anchor="middle" font-family="sans-serif" x="136" y="52">u</text>
  <text text-anchor="middle" font-family="sans-serif" x="120" y="68">e</text>
  <text text-anchor="middle" font-family="sans-serif" x="440" y="388">e</text>
  <text text-anchor="middle" font-family="sans-serif" x="72" y="68">n</text>
  <text text-anchor="middle" font-family="sans-serif" x="72" y="84">c</text>
  <text text-anchor="middle" font-family="sans-serif" x="368" y="276">n</text>
  <text text-anchor="middle" font-family="sans-serif" x="400" y="292">n</text>
  <text text-anchor="middle" font-family="sans-serif" x="368" y="100">h</text>
  <text text-anchor="middle" font-family="sans-serif" x="384" y="308">n</text>
  <text text-anchor="middle" font-family="sans-serif" x="424" y="292">u</text>
  <text text-anchor="middle" font-family="sans-serif" x="448" y="308">n</text>
  <text text-anchor="middle" font-family="sans-serif" x="336" y="100">e</text>
  <text text-anchor="middle" font-family="sans-serif" x="352" y="100">u</text>
  <text text-anchor="middle" font-family="sans-serif" x="336" y="164">n</text>
  <text text-anchor="middle" font-family="sans-serif" x="416" y="276">e</text>
  <text text-anchor="middle" font-family="sans-serif" x="32" y="52">P</text>
  <text text-anchor="middle" font-family="sans-serif" x="344" y="244">D</text>
  <text text-anchor="middle" font-family="sans-serif" x="360" y="308">c</text>
  <text text-anchor="middle" font-family="sans-serif" x="432" y="324">i</text>
  <text text-anchor="middle" font-family="sans-serif" x="424" y="20">o</text>
  <text text-anchor="middle" font-family="sans-serif" x="64" y="100">n</text>
  <text text-anchor="middle" font-family="sans-serif" x="136" y="164">u</text>
  <text text-anchor="middle" font-family="sans-serif" x="152" y="52">e</text>
  <text text-anchor="middle" font-family="sans-serif" x="96" y="68">d</text>
  <text text-anchor="middle" font-family="sans-serif" x="32" y="100">A</text>
  <text text-anchor="middle" font-family="sans-serif" x="336" y="324">e</text>
  <text text-anchor="middle" font-family="sans-serif" x="392" y="308">c</text>
  <text text-anchor="middle" font-family="sans-serif" x="144" y="20">o</text>
  <text text-anchor="middle" font-family="sans-serif" x="56" y="68">o</text>
  <text text-anchor="middle" font-family="sans-serif" x="96" y="164">e</text>
  <text text-anchor="middle" font-family="sans-serif" x="400" y="164">a</text>
  <text text-anchor="middle" font-family="sans-serif" x="376" y="52">i</text>
  <text text-anchor="middle" font-family="sans-serif" x="448" y="324">a</text>
  <text text-anchor="middle" font-family="sans-serif" x="40" y="52">r</text>
  <text text-anchor="middle" font-family="sans-serif" x="104" y="100">a</text>
  <text text-anchor="middle" font-family="sans-serif" x="320" y="100">a</text>
  <text text-anchor="middle" font-family="sans-serif" x="376" y="164">e</text>
  <text text-anchor="middle" font-family="sans-serif" x="40" y="68">c</text>
  <text text-anchor="middle" font-family="sans-serif" x="360" y="292">c</text>
  <text text-anchor="middle" font-family="sans-serif" x="376" y="308">E</text>
  <text text-anchor="middle" font-family="sans-serif" x="64" y="20">A</text>
  <text text-anchor="middle" font-family="sans-serif" x="392" y="100">t</text>
  <text text-anchor="middle" font-family="sans-serif" x="408" y="100">c</text>
  <text text-anchor="middle" font-family="sans-serif" x="336" y="292">e</text>
  <text text-anchor="middle" font-family="sans-serif" x="160" y="20">i</text>
  <text text-anchor="middle" font-family="sans-serif" x="384" y="292">i</text>
  <text text-anchor="middle" font-family="sans-serif" x="368" y="324">e</text>
  <text text-anchor="middle" font-family="sans-serif" x="368" y="308">e</text>
  <text text-anchor="middle" font-family="sans-serif" x="128" y="20">P</text>
  <text text-anchor="middle" font-family="sans-serif" x="368" y="20">v</text>
  <text text-anchor="middle" font-family="sans-serif" x="56" y="52">f</text>
  <text text-anchor="middle" font-family="sans-serif" x="384" y="52">g</text>
  <text text-anchor="middle" font-family="sans-serif" x="352" y="20">D</text>
  <text text-anchor="middle" font-family="sans-serif" x="120" y="100">o</text>
  <text text-anchor="middle" font-family="sans-serif" x="336" y="308">e</text>
  <text text-anchor="middle" font-family="sans-serif" x="440" y="324">c</text>
  <text text-anchor="middle" font-family="sans-serif" x="312" y="84">B</text>
  <text text-anchor="middle" font-family="sans-serif" x="376" y="100">e</text>
  <text text-anchor="middle" font-family="sans-serif" x="88" y="164">r</text>
  <text text-anchor="middle" font-family="sans-serif" x="408" y="244">o</text>
  <text text-anchor="middle" font-family="sans-serif" x="432" y="292">r</text>
  <text text-anchor="middle" font-family="sans-serif" x="464" y="324">i</text>
  <text text-anchor="middle" font-family="sans-serif" x="104" y="84">f</text>
  <text text-anchor="middle" font-family="sans-serif" x="392" y="84">t</text>
  <text text-anchor="middle" font-family="sans-serif" x="408" y="164">l</text>
  <text text-anchor="middle" font-family="sans-serif" x="360" y="276">u</text>
  <text text-anchor="middle" font-family="sans-serif" x="376" y="68">a</text>
  <text text-anchor="middle" font-family="sans-serif" x="128" y="100">r</text>
  <text text-anchor="middle" font-family="sans-serif" x="112" y="164">V</text>
  <text text-anchor="middle" font-family="sans-serif" x="376" y="324">A</text>
  <text text-anchor="middle" font-family="sans-serif" x="400" y="276">d</text>
  <text text-anchor="middle" font-family="sans-serif" x="328" y="292">D</text>
  <text text-anchor="middle" font-family="sans-serif" x="344" y="388">g</text>
  <text text-anchor="middle" font-family="sans-serif" x="112" y="52">n</text>
  <text text-anchor="middle" font-family="sans-serif" x="408" y="52">t</text>
  <text text-anchor="middle" font-family="sans-serif" x="112" y="100">t</text>
  <text text-anchor="middle" font-family="sans-serif" x="416" y="100">a</text>
  <text text-anchor="middle" font-family="sans-serif" x="360" y="20">e</text>
  <text text-anchor="middle" font-family="sans-serif" x="88" y="100">t</text>
  <text text-anchor="middle" font-family="sans-serif" x="352" y="292">i</text>
  <text text-anchor="middle" font-family="sans-serif" x="136" y="20">r</text>
  <text text-anchor="middle" font-family="sans-serif" x="312" y="164">S</text>
  <text text-anchor="middle" font-family="sans-serif" x="424" y="244">n</text>
  <text text-anchor="middle" font-family="sans-serif" x="320" y="164">i</text>
  <text text-anchor="middle" font-family="sans-serif" x="376" y="20">i</text>
  <text text-anchor="middle" font-family="sans-serif" x="368" y="68">n</text>
  <text text-anchor="middle" font-family="sans-serif" x="384" y="84">p</text>
  <text text-anchor="middle" font-family="sans-serif" x="32" y="164">S</text>
  <text text-anchor="middle" font-family="sans-serif" x="312" y="68">B</text>
  <text text-anchor="middle" font-family="sans-serif" x="440" y="100">o</text>
  <text text-anchor="middle" font-family="sans-serif" x="432" y="308">i</text>
  <text text-anchor="middle" font-family="sans-serif" x="336" y="388">i</text>
  <text text-anchor="middle" font-family="sans-serif" x="384" y="20">c</text>
  <text text-anchor="middle" font-family="sans-serif" x="96" y="52">i</text>
  <text text-anchor="middle" font-family="sans-serif" x="400" y="52">a</text>
  <text text-anchor="middle" font-family="sans-serif" x="104" y="68">d</text>
  <text text-anchor="middle" font-family="sans-serif" x="104" y="20">n</text>
  <text text-anchor="middle" font-family="sans-serif" x="328" y="84">s</text>
  <text text-anchor="middle" font-family="sans-serif" x="352" y="68">i</text>
  <text text-anchor="middle" font-family="sans-serif" x="80" y="100">s</text>
  <text text-anchor="middle" font-family="sans-serif" x="328" y="164">g</text>
  <text text-anchor="middle" font-family="sans-serif" x="160" y="100">.</text>
  <text text-anchor="middle" font-family="sans-serif" x="368" y="164">r</text>
  <text text-anchor="middle" font-family="sans-serif" x="464" y="244">o</text>
  <text text-anchor="middle" font-family="sans-serif" x="392" y="388">e</text>
  <text text-anchor="middle" font-family="sans-serif" x="136" y="68">s</text>
  <text text-anchor="middle" font-family="sans-serif" x="336" y="68">e</text>
  <text text-anchor="middle" font-family="sans-serif" x="360" y="244">v</text>
  <text text-anchor="middle" font-family="sans-serif" x="408" y="308">y</text>
  <text text-anchor="middle" font-family="sans-serif" x="376" y="84">y</text>
  <text text-anchor="middle" font-family="sans-serif" x="352" y="308">i</text>
  <text text-anchor="middle" font-family="sans-serif" x="168" y="20">l</text>
  <text text-anchor="middle" font-family="sans-serif" x="64" y="52">i</text>
  <text text-anchor="middle" font-family="sans-serif" x="320" y="84">a</text>
  <text text-anchor="middle" font-family="sans-serif" x="368" y="84">r</text>
  <text text-anchor="middle" font-family="sans-serif" x="376" y="276">t</text>
  <text text-anchor="middle" font-family="sans-serif" x="392" y="276">d</text>
  <text text-anchor="middle" font-family="sans-serif" x="440" y="308">o</text>
  <text text-anchor="middle" font-family="sans-serif" x="40" y="100">d</text>
  <text text-anchor="middle" font-family="sans-serif" x="400" y="100">i</text>
  <text text-anchor="middle" font-family="sans-serif" x="400" y="244">C</text>
  <text text-anchor="middle" font-family="sans-serif" x="352" y="276">o</text>
  <text text-anchor="middle" font-family="sans-serif" x="80" y="52">e</text>
  <text text-anchor="middle" font-family="sans-serif" x="328" y="68">s</text>
  <text text-anchor="middle" font-family="sans-serif" x="376" y="244">c</text>
  <text text-anchor="middle" font-family="sans-serif" x="400" y="324">h</text>
  <text text-anchor="middle" font-family="sans-serif" x="408" y="388">V</text>
  <text text-anchor="middle" font-family="sans-serif" x="96" y="20">u</text>
  <text text-anchor="middle" font-family="sans-serif" x="320" y="52">r</text>
  <text text-anchor="middle" font-family="sans-serif" x="48" y="164">g</text>
  <text text-anchor="middle" font-family="sans-serif" x="424" y="324">t</text>
  <text text-anchor="middle" font-family="sans-serif" x="320" y="68">a</text>
  <text text-anchor="middle" font-family="sans-serif" x="408" y="84">o</text>
  <text text-anchor="middle" font-family="sans-serif" x="56" y="100">i</text>
  <text text-anchor="middle" font-family="sans-serif" x="368" y="388">t</text>
  <text text-anchor="middle" font-family="sans-serif" x="336" y="52">f</text>
  <text text-anchor="middle" font-family="sans-serif" x="456" y="20">e</text>
  <text text-anchor="middle" font-family="sans-serif" x="96" y="84">d</text>
  <text text-anchor="middle" font-family="sans-serif" x="440" y="244">c</text>
  <text text-anchor="middle" font-family="sans-serif" x="392" y="292">g</text>
  <text text-anchor="middle" font-family="sans-serif" x="344" y="324">v</text>
  <text text-anchor="middle" font-family="sans-serif" x="352" y="324">i</text>
  <text text-anchor="middle" font-family="sans-serif" x="360" y="324">c</text>
  <text text-anchor="middle" font-family="sans-serif" x="384" y="324">u</text>
  <text text-anchor="middle" font-family="sans-serif" x="368" y="52">S</text>
  <text text-anchor="middle" font-family="sans-serif" x="32" y="68">A</text>
  <text text-anchor="middle" font-family="sans-serif" x="416" y="84">n</text>
  <text text-anchor="middle" font-family="sans-serif" x="448" y="100">n</text>
  <text text-anchor="middle" font-family="sans-serif" x="48" y="52">o</text>
  <text text-anchor="middle" font-family="sans-serif" x="352" y="52">l</text>
  <text text-anchor="middle" font-family="sans-serif" x="56" y="164">n</text>
  <text text-anchor="middle" font-family="sans-serif" x="336" y="276">c</text>
  <text text-anchor="middle" font-family="sans-serif" x="88" y="84">U</text>
  <text text-anchor="middle" font-family="sans-serif" x="448" y="244">t</text>
  <text text-anchor="middle" font-family="sans-serif" x="432" y="276">s</text>
  <text text-anchor="middle" font-family="sans-serif" x="328" y="388">S</text>
  <text text-anchor="middle" font-family="sans-serif" x="408" y="20">P</text>
  <text text-anchor="middle" font-family="sans-serif" x="104" y="52">g</text>
  <text text-anchor="middle" font-family="sans-serif" x="328" y="52">o</text>
  <text text-anchor="middle" font-family="sans-serif" x="80" y="68">t</text>
  <text text-anchor="middle" font-family="sans-serif" x="312" y="100">B</text>
  <text text-anchor="middle" font-family="sans-serif" x="328" y="324">D</text>
  <text text-anchor="middle" font-family="sans-serif" x="432" y="244">e</text>
  <text text-anchor="middle" font-family="sans-serif" x="472" y="244">n</text>
  <text text-anchor="middle" font-family="sans-serif" x="72" y="52">l</text>
  <text text-anchor="middle" font-family="sans-serif" x="416" y="52">u</text>
  <text text-anchor="middle" font-family="sans-serif" x="328" y="100">s</text>
  <text text-anchor="middle" font-family="sans-serif" x="416" y="164">u</text>
  <text text-anchor="middle" font-family="sans-serif" x="376" y="292">S</text>
  <text text-anchor="middle" font-family="sans-serif" x="472" y="324">o</text>
  <text text-anchor="middle" font-family="sans-serif" x="72" y="100">i</text>
  <text text-anchor="middle" font-family="sans-serif" x="432" y="100">i</text>
  <text text-anchor="middle" font-family="sans-serif" x="144" y="164">e</text>
  <text text-anchor="middle" font-family="sans-serif" x="344" y="164">a</text>
  <text text-anchor="middle" font-family="sans-serif" x="128" y="52">t</text>
  <text text-anchor="middle" font-family="sans-serif" x="336" y="84">e</text>
  <text text-anchor="middle" font-family="sans-serif" x="344" y="100">A</text>
  <text text-anchor="middle" font-family="sans-serif" x="392" y="324">t</text>
  <text text-anchor="middle" font-family="sans-serif" x="88" y="20">o</text>
  <text text-anchor="middle" font-family="sans-serif" x="128" y="68">s</text>
  <text text-anchor="middle" font-family="sans-serif" x="352" y="84">n</text>
  <text text-anchor="middle" font-family="sans-serif" x="128" y="164">l</text>
  <text text-anchor="middle" font-family="sans-serif" x="384" y="276">A</text>
  <text text-anchor="middle" font-family="sans-serif" x="376" y="388">u</text>
  <text text-anchor="middle" font-family="sans-serif" x="360" y="100">t</text>
  <text text-anchor="middle" font-family="sans-serif" x="72" y="164">t</text>
  <text text-anchor="middle" font-family="sans-serif" x="344" y="292">v</text>
  <text text-anchor="middle" font-family="sans-serif" x="416" y="308">p</text>
  <text text-anchor="middle" font-family="sans-serif" x="368" y="244">i</text>
  <text text-anchor="middle" font-family="sans-serif" x="424" y="276">s</text>
  <text text-anchor="middle" font-family="sans-serif" x="368" y="292">e</text>
  <text text-anchor="middle" font-family="sans-serif" x="344" y="308">v</text>
  <text text-anchor="middle" font-family="sans-serif" x="112" y="20">t</text>
  <text text-anchor="middle" font-family="sans-serif" x="48" y="68">c</text>
  <text text-anchor="middle" font-family="sans-serif" x="400" y="84">i</text>
  <text text-anchor="middle" font-family="sans-serif" x="48" y="100">m</text>
  <text text-anchor="middle" font-family="sans-serif" x="424" y="388">l</text>
  <text text-anchor="middle" font-family="sans-serif" x="440" y="292">e</text>
  <text text-anchor="middle" font-family="sans-serif" x="360" y="388">a</text>
  <text text-anchor="middle" font-family="sans-serif" x="416" y="388">a</text>
  <text text-anchor="middle" font-family="sans-serif" x="152" y="20">f</text>
  <text text-anchor="middle" font-family="sans-serif" x="344" y="68">S</text>
  <text text-anchor="middle" font-family="sans-serif" x="424" y="164">e</text>
  <text text-anchor="middle" font-family="sans-serif" x="384" y="244">e</text>
  <text text-anchor="middle" font-family="sans-serif" x="136" y="100">S</text>
  <text text-anchor="middle" font-family="sans-serif" x="448" y="20">l</text>
  <text text-anchor="middle" font-family="sans-serif" x="360" y="52">e</text>
  <text text-anchor="middle" font-family="sans-serif" x="432" y="52">e</text>
  <text text-anchor="middle" font-family="sans-serif" x="392" y="68">u</text>
  <text text-anchor="middle" font-family="sans-serif" x="432" y="388">u</text>
  <text text-anchor="middle" font-family="sans-serif" x="392" y="20">e</text>
  <text text-anchor="middle" font-family="sans-serif" x="88" y="52">S</text>
  <text text-anchor="middle" font-family="sans-serif" x="408" y="68">e</text>
  <text text-anchor="middle" font-family="sans-serif" x="344" y="84">E</text>
</g></svg>
</artwork>
</figure>
<section title="Encoding" anchor="n-encoding"><t>The payload of a Mesh Assertion is a JSON encoded object that is a subclass of the Assertion class which defines the following fields:</t>
<dl>
<dt>Identifier</dt>
<dd>
<t>An identifier for the assertion.</t>
</dd>
<dt>Updated</dt>
<dd>
<t>The date and time at which the assertion was issued or last updated</t>
</dd>
<dt>NotaryToken</dt>
<dd>
<t>An assertion may optionally contain one or more notary tokens issued by a Mesh Notary service. These establish a proof that the assertion was signed after the date the notary token was created.</t>
</dd>
<dt>Conditions</dt>
<dd>
<t>A list of conditions that <bcp14>MAY</bcp14> be used to verify the status of the assertion if the relying party requires.</t>
</dd>
</dl>
<t>The implementation of the NotaryToken and Conditions mechanisms is to be specified in <xref target="draft-hallambaker-mesh-notary"></xref> at a future date.</t>
<t>Note that the implementation of Conditions differs significantly from that of SAML. Relying parties are required to process condition clauses in a SAML assertion to determine validity. Mesh Relying parties <bcp14>MAY</bcp14> verify the conditions clauses or rely on the trustworthiness of the provider.</t>
<t>The reason for weakening the processing of conditions clauses in the Mesh is that it is only ever possible to validate a conditions clause of any type relative to a ground truth. In SAML applications, the relying party almost invariably has access to an independent source of ground truth. A Mesh device connected to a Mesh Service does not. Thus the types of verification that can be achieved in practice are limited to verifying the consistency of current and previous statements from the Mesh Service.</t>
</section>
<section title="Mesh Profiles" anchor="n-mesh-profiles"><t>Mesh Profiles perform a similar role to X.509v3 certificates but with important differences:</t>
<ul>
<li>Profiles describe credentials, they do not make identity statements</li>
<li>Profiles do not expire, there is therefore no need to support renewal processing.</li>
<li>Profiles may be modified over time, the current and past status of a profile being recorded in an append only log.</li>
</ul>
<t>Profiles provide the axioms of trust for the Mesh PKI. Unlike in the PKIX model in which all trust flows from axioms of trust held by a small number of Certificate Authorities, every part in the Mesh contributes their own axiom of trust.</t>
<t>It should be noted however that the role of Certificate Authorities is redefined rather than eliminated. Rather than making assertions whose subject is represented by identities which are inherently mutable and subjective, Certificate Authorities can now make assertions about immutable cryptographic keys.</t>
<t>Every Profile <bcp14>MUST</bcp14> contain a <tt>SignatureKey</tt> field and <bcp14>MUST</bcp14> be signed by the key specified in that field.</t>
<t>A Profile is valid if and only if:</t>
<ul>
<li>There is a <tt>SignatureKey</tt> field.</li>
<li>The profile is signed under the key specified in the <tt>SignatureKey</tt> field.</li>
</ul>
<t>A profile has the status <tt>current</tt> if and only if:</t>
<ul>
<li>The Profile is valid</li>
<li>Every Conditions clause in the profile is understood by the relying party and evaluates to <tt>true</tt>.</li>
</ul>
</section>
<section title="Mesh Connections" anchor="n-mesh-connections"><t>A Mesh connection is an assertion describing the connection of a device or a member to an account.</t>
<t>Mesh connections provide similar functionality to 'end-entity' certificates in PKIX but with the important proviso that they are only used to provide trust between a device connected to an account and the service to which that account is bound and between the devices connected to an account.</t>
<t>A connection is valid with respect to an account with profile <em>P</em> if and only if:</t>
<ul>
<li>The profile <em>P</em> is valid</li>
<li>The <tt>AuthorityUdf</tt> field of the connection is consistent with the UDF of <em>P</em></li>
<li>The profile is signed under the key specified in the <tt>AdministrationKey</tt> field of <em>P</em>.</li>
<li>Any conditions specified in the profile are met</li>
</ul>
<t>A connection has the status current with respect to an account with profile if and only if:</t>
<ul>
<li>The connection is valid with respect to the account with profile <em>P</em>.</li>
<li>The profile <tt>P</tt> is current.</li>
</ul>
<t>A device is authenticated with respect to an account with profile P if and only if:</t>
<ul>
<li>The connection is valid with respect to the account with profile <em>P</em>.</li>
<li>The device has presented an appropriate proof of knowledge of the <tt>DeviceAuthentication</tt> key specified in the connection.</li>
</ul>
</section>
</section>
<section title="Architecture" anchor="n-architecture"><t>$$$$$$$$$$$ This has plenty or areas that need to be upgraded to the single master/account approach.</t>
<t>The Mesh architecture has four principal components:</t>
<dl>
<dt>Mesh Device Management</dt>
<dd>
<t>Binds a collection of devices that the owner of the Mesh uses together to function as a single personal Mesh.</t>
</dd>
<dt>Mesh Account</dt>
<dd>
<t>Contains all the information (contacts, calendar entries, inbound and outbound messages, etc.) related to a particular persona used by the owner.</t>
</dd>
<dt>Mesh Service</dt>
<dd>
<t>Provides a service identifier (e.g. <tt>alice@example.com</tt>) through which devices and other Mesh users may interact with a Mesh Account. </t>
</dd>
<dt>Mesh Messaging</dt>
<dd>
<t>Allows short messages (less than 32KB) to be exchanged between Mesh devices connected to an account and between Mesh Accounts.</t>
</dd>
</dl>
<t>Device management and Accounts components are defined by a data schema alone. The Service and Messaging components are defined by a data schema and a service protocol.</t>
<t>The separation of accounts and services as separate components is a key distinction between the Mesh and earlier Internet applications. A Mesh account belongs to the owner of the Mesh and not the Mesh Service Provider which the user may change at any time of their choosing.</t>
<t>A Mesh Account May be active or inactive. By definition, an active Mesh account is serviced by exactly one Mesh Service, an inactive Mesh account is not serviced by a Mesh Service. A Mesh Service Provider <bcp14>MAY</bcp14> offer a backup service for accounts hosted by other providers. In this case the backup provider is connected to the account as a Mesh device, thus allowing the backup provider to maintain a copy of the stores contained in the account and facilitating a rapid transfer of responsibility for servicing the account should that be desired. The use of backup providers is described further in <xref target="draft-hallambaker-mesh-discovery"></xref>.</t>
<section title="Device Management" anchor="n-device-management"><t>Device Management provides the foundation for all Mesh functions allowing a collection of devices belonging to a user to function as a single personal Mesh.</t>
<t>The device management layer of a personal Mesh consists of exactly one Master Profile and a catalog containing the entries describing the connected devices.</t>
<section title="Master Profile" anchor="n-master-profile"><t>A Mesh master profile provides the axiom of trust for a mesh user. It contains a Master Signature Key and one or more Administration Signature Keys. The unique identifier of the master profile is the UDF of the Master Signature Key.</t>
<t>A Master Profile <bcp14>MUST</bcp14> specify an <tt>EscrowEncryption</tt> key. This key <bcp14>MAY</bcp14> be used to escrow private keys used for encryption of stored data. They <bcp14>SHOULD NOT</bcp14> be used to escrow authentication keys and <bcp14>MUST NOT</bcp14> be used to escrow signature keys.</t>
<t>A user should not need to replace their account profile unless they intend to establish a separate identity. To minimize the risk of disclosure, the Profile Signature Key is only ever used to sign updates to the account profile itself. This allows the user to secure their Profile Signature Key by either keeping it on hardware token or device dedicated to that purpose or by using the escrow mechanism and paper recovery keys as described in this document.</t>
<section title="Creating a ProfileMaster" anchor="n-creating-a-profilemaster"><t>Creating a <tt>ProfileMaster</tt> comprises the steps of:</t>
<ol start="0">
<li>Creating a Master Signature key.</li>
<li>Creating an Online Signing Key</li>
<li>Signing the <tt>ProfileMaster</tt> using the Master Signature Key</li>
<li>Persisting the <tt>ProfileMaster</tt> on the administration device to the <tt>CatalogHost</tt>.</li>
<li>(Optional) Connecting at least one Administration Device and granting it the <tt>ActivationAdministration</tt> activation.</li>
</ol>
</section>
<section title="Updating a ProfileMaster" anchor="n-updating-a-profilemaster"><t>Updating a <tt>ProfileMaster</tt> comprises the steps of:</t>
<ol start="0">
<li>Making the necessary changes.</li>
<li>Signing the ProfileMaster using the Master Signature Key</li>
<li>Persisting the ProfileMaster on the administration device to the CatalogHost.</li>
</ol>
</section>
<section title="The Device Catalog" anchor="n-the-device-catalog"><t>Each personal Mesh has a Device Catalog <tt>CatalogDevice</tt> associated with it. The Device Catalog is used to manage the connection of devices to the Personal Mesh and has a <tt>CatalogEntryDevice</tt> for each device currently connected to the catalog.</t>
<t>Each Administration Device <bcp14>MUST</bcp14> have access to an up to date copy of the Device Catalog in order to manage the devices connected to the Mesh. The Mesh Service protocol <bcp14>MAY</bcp14> be used to synchronize the Device Catalog between administration devices in the case that there is more than one administration device.</t>
<t>The <tt>CatalogEntryDevice</tt> contains fields for the device profile, device private and device connection.</t>
</section>
</section>
<section title="Mesh Devices" anchor="n-mesh-devices"><t>The principle of radical distrust requires us to consider the possibility that a device might be compromised during manufacture. Once consequence of this possibility is that when an administration device connects a new device to a user's personal Mesh, we cannot put our full trust in either the device being connected or the administration device connecting it.</t>
<t>This concern is resolved by (at minimum) combining keying material generated from both sources to create the keys to be used in the context of the user's personal Mesh with the process being fully verified by both parties. </t>
<t>Additional keying material sources could be added if protection against the possibility of compromise at both devices was required but this is not supported by the current specifications.</t>
<t>A device profile provides the axiom of trust and the key contributions of the device. When bound to an account, the base keys specified in the Device Profile are combined with the key data provided in the Activation device to construct the keys the device will use in the context of the account.</t>
<figure>
<!-- Include SVG File ../Images/SchemaProfileDeviceKeys.svg --><artwork type="svg">
<svg height="249" width="576" xmlns="http://www.w3.org/2000/svg" >
<g transform="translate(8,16)">
  <path d="M 192,16 L 368,16" fill="none" stroke="black" />
  <path d="M 192,48 L 264,48" fill="none" stroke="black" />
  <path d="M 264,48 L 280,48" fill="none" stroke="black" />
  <path d="M 280,48 L 296,48" fill="none" stroke="black" />
  <path d="M 296,48 L 368,48" fill="none" stroke="black" />
  <path d="M 16,80 L 216,80" fill="none" stroke="black" />
  <path d="M 336,80 L 544,80" fill="none" stroke="black" />
  <path d="M 16,112 L 192,112" fill="none" stroke="black" />
  <path d="M 352,112 L 528,112" fill="none" stroke="black" />
  <path d="M 192,128 L 232,128" fill="none" stroke="black" />
  <path d="M 232,128 L 264,128" fill="none" stroke="black" />
  <path d="M 264,128 L 280,128" fill="none" stroke="black" />
  <path d="M 280,128 L 296,128" fill="none" stroke="black" />
  <path d="M 296,128 L 320,128" fill="none" stroke="black" />
  <path d="M 320,128 L 344,128" fill="none" stroke="black" />
  <path d="M 192,160 L 232,160" fill="none" stroke="black" />
  <path d="M 232,160 L 280,160" fill="none" stroke="black" />
  <path d="M 280,160 L 296,160" fill="none" stroke="black" />
  <path d="M 296,160 L 320,160" fill="none" stroke="black" />
  <path d="M 320,160 L 344,160" fill="none" stroke="black" />
  <path d="M 192,192 L 232,192" fill="none" stroke="black" />
  <path d="M 232,192 L 296,192" fill="none" stroke="black" />
  <path d="M 296,192 L 320,192" fill="none" stroke="black" />
  <path d="M 320,192 L 344,192" fill="none" stroke="black" />
  <path d="M 16,208 L 192,208" fill="none" stroke="black" />
  <path d="M 352,208 L 528,208" fill="none" stroke="black" />
  <path d="M 16,224 L 216,224" fill="none" stroke="black" />
  <path d="M 336,224 L 544,224" fill="none" stroke="black" />
  <path d="M 0,96 L 0,208" fill="none" stroke="black" />
  <path d="M 16,112 L 16,208" fill="none" stroke="black" />
  <path d="M 192,16 L 192,48" fill="none" stroke="black" />
  <path d="M 192,112 L 192,128" fill="none" stroke="black" />
  <path d="M 192,128 L 192,160" fill="none" stroke="black" />
  <path d="M 192,160 L 192,192" fill="none" stroke="black" />
  <path d="M 192,192 L 192,208" fill="none" stroke="black" />
  <path d="M 232,96 L 232,128" fill="none" stroke="black" />
  <path d="M 232,128 L 232,160" fill="none" stroke="black" />
  <path d="M 232,160 L 232,192" fill="none" stroke="black" />
  <path d="M 232,192 L 232,208" fill="none" stroke="black" />
  <path d="M 264,48 L 264,128" fill="none" stroke="black" />
  <path d="M 280,48 L 280,128" fill="none" stroke="black" />
  <path d="M 280,128 L 280,160" fill="none" stroke="black" />
  <path d="M 296,48 L 296,128" fill="none" stroke="black" />
  <path d="M 296,128 L 296,160" fill="none" stroke="black" />
  <path d="M 296,160 L 296,192" fill="none" stroke="black" />
  <path d="M 320,96 L 320,128" fill="none" stroke="black" />
  <path d="M 320,128 L 320,160" fill="none" stroke="black" />
  <path d="M 320,160 L 320,192" fill="none" stroke="black" />
  <path d="M 320,192 L 320,208" fill="none" stroke="black" />
  <path d="M 352,112 L 352,208" fill="none" stroke="black" />
  <path d="M 368,16 L 368,48" fill="none" stroke="black" />
  <path d="M 528,112 L 528,208" fill="none" stroke="black" />
  <path d="M 560,96 L 560,208" fill="none" stroke="black" />
  <polygon points="352.000000,128.000000 340.000000,122.400002 340.000000,133.600006" fill="black" transform="rotate(0.000000, 344.000000, 128.000000)" />
  <polygon points="352.000000,160.000000 340.000000,154.399994 340.000000,165.600006" fill="black" transform="rotate(0.000000, 344.000000, 160.000000)" />
  <polygon points="352.000000,192.000000 340.000000,186.399994 340.000000,197.600006" fill="black" transform="rotate(0.000000, 344.000000, 192.000000)" />
  <path d="M 16,80 A 16,16 0 0,0 0,96" fill="none" stroke="black" />
  <path d="M 216,80 A 16,16 0 0,1 232,96" fill="none" stroke="black" />
  <path d="M 336,80 A 16,16 0 0,0 320,96" fill="none" stroke="black" />
  <path d="M 544,80 A 16,16 0 0,1 560,96" fill="none" stroke="black" />
  <path d="M 0,208 A 16,16 0 0,0 16,224" fill="none" stroke="black" />
  <path d="M 232,208 A 16,16 0 0,1 216,224" fill="none" stroke="black" />
  <path d="M 320,208 A 16,16 0 0,0 336,224" fill="none" stroke="black" />
  <path d="M 560,208 A 16,16 0 0,1 544,224" fill="none" stroke="black" />
  <circle cx="264" cy="128" r="6" fill="none" stroke="black" />
  <circle cx="280" cy="160" r="6" fill="none" stroke="black" />
  <circle cx="296" cy="192" r="6" fill="none" stroke="black" />
  <text text-anchor="middle" font-family="sans-serif" x="280" y="36">o</text>
  <text text-anchor="middle" font-family="sans-serif" x="64" y="132">S</text>
  <text text-anchor="middle" font-family="sans-serif" x="120" y="164">i</text>
  <text text-anchor="middle" font-family="sans-serif" x="424" y="196">u</text>
  <text text-anchor="middle" font-family="sans-serif" x="384" y="164">v</text>
  <text text-anchor="middle" font-family="sans-serif" x="448" y="164">y</text>
  <text text-anchor="middle" font-family="sans-serif" x="40" y="196">a</text>
  <text text-anchor="middle" font-family="sans-serif" x="520" y="196">n</text>
  <text text-anchor="middle" font-family="sans-serif" x="152" y="100">f</text>
  <text text-anchor="middle" font-family="sans-serif" x="464" y="100">n</text>
  <text text-anchor="middle" font-family="sans-serif" x="112" y="164">t</text>
  <text text-anchor="middle" font-family="sans-serif" x="368" y="164">D</text>
  <text text-anchor="middle" font-family="sans-serif" x="232" y="36">t</text>
  <text text-anchor="middle" font-family="sans-serif" x="248" y="36">v</text>
  <text text-anchor="middle" font-family="sans-serif" x="416" y="132">S</text>
  <text text-anchor="middle" font-family="sans-serif" x="384" y="196">v</text>
  <text text-anchor="middle" font-family="sans-serif" x="456" y="164">p</text>
  <text text-anchor="middle" font-family="sans-serif" x="72" y="196">u</text>
  <text text-anchor="middle" font-family="sans-serif" x="224" y="36">c</text>
  <text text-anchor="middle" font-family="sans-serif" x="488" y="100">t</text>
  <text text-anchor="middle" font-family="sans-serif" x="88" y="164">r</text>
  <text text-anchor="middle" font-family="sans-serif" x="136" y="164">n</text>
  <text text-anchor="middle" font-family="sans-serif" x="80" y="196">t</text>
  <text text-anchor="middle" font-family="sans-serif" x="88" y="196">h</text>
  <text text-anchor="middle" font-family="sans-serif" x="256" y="36">a</text>
  <text text-anchor="middle" font-family="sans-serif" x="504" y="100">o</text>
  <text text-anchor="middle" font-family="sans-serif" x="56" y="164">e</text>
  <text text-anchor="middle" font-family="sans-serif" x="432" y="164">c</text>
  <text text-anchor="middle" font-family="sans-serif" x="264" y="36">t</text>
  <text text-anchor="middle" font-family="sans-serif" x="80" y="100">e</text>
  <text text-anchor="middle" font-family="sans-serif" x="472" y="100">e</text>
  <text text-anchor="middle" font-family="sans-serif" x="496" y="196">t</text>
  <text text-anchor="middle" font-family="sans-serif" x="216" y="36">A</text>
  <text text-anchor="middle" font-family="sans-serif" x="400" y="132">c</text>
  <text text-anchor="middle" font-family="sans-serif" x="464" y="164">t</text>
  <text text-anchor="middle" font-family="sans-serif" x="64" y="164">E</text>
  <text text-anchor="middle" font-family="sans-serif" x="80" y="164">c</text>
  <text text-anchor="middle" font-family="sans-serif" x="72" y="100">D</text>
  <text text-anchor="middle" font-family="sans-serif" x="440" y="100">C</text>
  <text text-anchor="middle" font-family="sans-serif" x="512" y="100">n</text>
  <text text-anchor="middle" font-family="sans-serif" x="456" y="132">t</text>
  <text text-anchor="middle" font-family="sans-serif" x="40" y="132">a</text>
  <text text-anchor="middle" font-family="sans-serif" x="56" y="132">e</text>
  <text text-anchor="middle" font-family="sans-serif" x="432" y="132">g</text>
  <text text-anchor="middle" font-family="sans-serif" x="376" y="196">e</text>
  <text text-anchor="middle" font-family="sans-serif" x="480" y="100">c</text>
  <text text-anchor="middle" font-family="sans-serif" x="120" y="132">r</text>
  <text text-anchor="middle" font-family="sans-serif" x="432" y="196">t</text>
  <text text-anchor="middle" font-family="sans-serif" x="472" y="164">i</text>
  <text text-anchor="middle" font-family="sans-serif" x="496" y="100">i</text>
  <text text-anchor="middle" font-family="sans-serif" x="480" y="164">o</text>
  <text text-anchor="middle" font-family="sans-serif" x="112" y="100">e</text>
  <text text-anchor="middle" font-family="sans-serif" x="80" y="132">g</text>
  <text text-anchor="middle" font-family="sans-serif" x="56" y="196">e</text>
  <text text-anchor="middle" font-family="sans-serif" x="136" y="196">a</text>
  <text text-anchor="middle" font-family="sans-serif" x="120" y="196">i</text>
  <text text-anchor="middle" font-family="sans-serif" x="152" y="196">i</text>
  <text text-anchor="middle" font-family="sans-serif" x="416" y="196">A</text>
  <text text-anchor="middle" font-family="sans-serif" x="472" y="196">i</text>
  <text text-anchor="middle" font-family="sans-serif" x="112" y="132">u</text>
  <text text-anchor="middle" font-family="sans-serif" x="400" y="164">c</text>
  <text text-anchor="middle" font-family="sans-serif" x="424" y="164">n</text>
  <text text-anchor="middle" font-family="sans-serif" x="32" y="196">B</text>
  <text text-anchor="middle" font-family="sans-serif" x="400" y="100">v</text>
  <text text-anchor="middle" font-family="sans-serif" x="456" y="100">n</text>
  <text text-anchor="middle" font-family="sans-serif" x="96" y="132">a</text>
  <text text-anchor="middle" font-family="sans-serif" x="480" y="196">c</text>
  <text text-anchor="middle" font-family="sans-serif" x="320" y="36">v</text>
  <text text-anchor="middle" font-family="sans-serif" x="88" y="100">v</text>
  <text text-anchor="middle" font-family="sans-serif" x="128" y="132">e</text>
  <text text-anchor="middle" font-family="sans-serif" x="392" y="196">i</text>
  <text text-anchor="middle" font-family="sans-serif" x="288" y="36">n</text>
  <text text-anchor="middle" font-family="sans-serif" x="144" y="100">o</text>
  <text text-anchor="middle" font-family="sans-serif" x="424" y="132">i</text>
  <text text-anchor="middle" font-family="sans-serif" x="440" y="164">r</text>
  <text text-anchor="middle" font-family="sans-serif" x="48" y="132">s</text>
  <text text-anchor="middle" font-family="sans-serif" x="448" y="132">a</text>
  <text text-anchor="middle" font-family="sans-serif" x="440" y="196">h</text>
  <text text-anchor="middle" font-family="sans-serif" x="408" y="132">e</text>
  <text text-anchor="middle" font-family="sans-serif" x="128" y="164">o</text>
  <text text-anchor="middle" font-family="sans-serif" x="376" y="164">e</text>
  <text text-anchor="middle" font-family="sans-serif" x="408" y="164">e</text>
  <text text-anchor="middle" font-family="sans-serif" x="304" y="36">D</text>
  <text text-anchor="middle" font-family="sans-serif" x="328" y="36">i</text>
  <text text-anchor="middle" font-family="sans-serif" x="168" y="100">l</text>
  <text text-anchor="middle" font-family="sans-serif" x="416" y="100">c</text>
  <text text-anchor="middle" font-family="sans-serif" x="464" y="196">t</text>
  <text text-anchor="middle" font-family="sans-serif" x="32" y="164">B</text>
  <text text-anchor="middle" font-family="sans-serif" x="40" y="164">a</text>
  <text text-anchor="middle" font-family="sans-serif" x="48" y="164">s</text>
  <text text-anchor="middle" font-family="sans-serif" x="272" y="36">i</text>
  <text text-anchor="middle" font-family="sans-serif" x="104" y="132">t</text>
  <text text-anchor="middle" font-family="sans-serif" x="464" y="132">u</text>
  <text text-anchor="middle" font-family="sans-serif" x="480" y="132">e</text>
  <text text-anchor="middle" font-family="sans-serif" x="504" y="196">i</text>
  <text text-anchor="middle" font-family="sans-serif" x="344" y="36">e</text>
  <text text-anchor="middle" font-family="sans-serif" x="160" y="100">i</text>
  <text text-anchor="middle" font-family="sans-serif" x="368" y="132">D</text>
  <text text-anchor="middle" font-family="sans-serif" x="384" y="132">v</text>
  <text text-anchor="middle" font-family="sans-serif" x="456" y="196">n</text>
  <text text-anchor="middle" font-family="sans-serif" x="96" y="100">i</text>
  <text text-anchor="middle" font-family="sans-serif" x="32" y="132">B</text>
  <text text-anchor="middle" font-family="sans-serif" x="96" y="196">e</text>
  <text text-anchor="middle" font-family="sans-serif" x="128" y="196">c</text>
  <text text-anchor="middle" font-family="sans-serif" x="144" y="196">t</text>
  <text text-anchor="middle" font-family="sans-serif" x="368" y="196">D</text>
  <text text-anchor="middle" font-family="sans-serif" x="104" y="100">c</text>
  <text text-anchor="middle" font-family="sans-serif" x="440" y="132">n</text>
  <text text-anchor="middle" font-family="sans-serif" x="392" y="164">i</text>
  <text text-anchor="middle" font-family="sans-serif" x="48" y="196">s</text>
  <text text-anchor="middle" font-family="sans-serif" x="336" y="36">c</text>
  <text text-anchor="middle" font-family="sans-serif" x="384" y="100">D</text>
  <text text-anchor="middle" font-family="sans-serif" x="392" y="132">i</text>
  <text text-anchor="middle" font-family="sans-serif" x="512" y="196">o</text>
  <text text-anchor="middle" font-family="sans-serif" x="96" y="164">y</text>
  <text text-anchor="middle" font-family="sans-serif" x="416" y="164">E</text>
  <text text-anchor="middle" font-family="sans-serif" x="104" y="196">n</text>
  <text text-anchor="middle" font-family="sans-serif" x="312" y="36">e</text>
  <text text-anchor="middle" font-family="sans-serif" x="128" y="100">P</text>
  <text text-anchor="middle" font-family="sans-serif" x="88" y="132">n</text>
  <text text-anchor="middle" font-family="sans-serif" x="472" y="132">r</text>
  <text text-anchor="middle" font-family="sans-serif" x="408" y="100">i</text>
  <text text-anchor="middle" font-family="sans-serif" x="72" y="164">n</text>
  <text text-anchor="middle" font-family="sans-serif" x="104" y="164">p</text>
  <text text-anchor="middle" font-family="sans-serif" x="112" y="196">t</text>
  <text text-anchor="middle" font-family="sans-serif" x="424" y="100">e</text>
  <text text-anchor="middle" font-family="sans-serif" x="64" y="196">A</text>
  <text text-anchor="middle" font-family="sans-serif" x="488" y="196">a</text>
  <text text-anchor="middle" font-family="sans-serif" x="240" y="36">i</text>
  <text text-anchor="middle" font-family="sans-serif" x="136" y="100">r</text>
  <text text-anchor="middle" font-family="sans-serif" x="176" y="100">e</text>
  <text text-anchor="middle" font-family="sans-serif" x="392" y="100">e</text>
  <text text-anchor="middle" font-family="sans-serif" x="168" y="196">n</text>
  <text text-anchor="middle" font-family="sans-serif" x="160" y="196">o</text>
  <text text-anchor="middle" font-family="sans-serif" x="400" y="196">c</text>
  <text text-anchor="middle" font-family="sans-serif" x="448" y="196">e</text>
  <text text-anchor="middle" font-family="sans-serif" x="448" y="100">o</text>
  <text text-anchor="middle" font-family="sans-serif" x="72" y="132">i</text>
  <text text-anchor="middle" font-family="sans-serif" x="376" y="132">e</text>
  <text text-anchor="middle" font-family="sans-serif" x="488" y="164">n</text>
  <text text-anchor="middle" font-family="sans-serif" x="408" y="196">e</text>
</g></svg>
</artwork>
</figure>
<t>Unless exceptional circumstances require, a device should not require more than one Device profile even if the device supports use by multiple users under different accounts. But a device <bcp14>MAY</bcp14> have multiple profiles if this approach is more convenient for implementation.</t>
<t>The derivation of the Connection encryption and signature keys from the Profile and Private contributions in this example is shown in <xref target="draft-hallambaker-mesh-cryptography"></xref>.</t>
<section title="Creating a ProfileDevice" anchor="n-creating-a-profiledevice"><t>Creating a <tt>ProfileDevice</tt> comprises the steps of:</t>
<ol start="0">
<li>Creating the necessary key </li>
<li>Signing the <tt>ProfileDevice</tt> using the Master Signature Key</li>
<li>Once created, a <tt>ProfileDevice</tt> is never changed. In the unlikely event that any modification is required, a completely new <tt>ProfileDevice</tt> <bcp14>MUST</bcp14> be created.</li>
</ol>
</section>
<section title="Connection to a Personal Mesh" anchor="n-connection-to-a-personal-mesh"><t>Devices are only connected to a personal Mesh by administration device. This comprises the steps of:</t>
<ol start="0">
<li>Generating the PrivateDevice keys.</li>
<li>Creating the ConnectionDevice data from the public components of the ProfileDevice and PrivateDevice keys and signing it using the administration key.</li>
<li>Creating the Activations for the device and signing them using the administration key.</li>
<li>Creating the <tt>CatalogEntryDevice</tt> for the device and adding it to the <tt>CatalogDevice</tt> of the Personal Mesh.</li>
<li>If the Personal Mesh has accounts that are connected to a Mesh Service, synchronizing the <tt>CatalogEntryDevice</tt> to those services.</li>
</ol>
</section>
</section>
</section>
<section title="Mesh Accounts" anchor="n-mesh-accounts"><t>Mesh Accounts contains all the stateful information (contacts, calendar entries, inbound and outbound messages, etc.) related to a particular persona used by the owner.</t>
<t>A Mesh Profile <bcp14>MAY</bcp14> be connected to multiple accounts at the same time allowing the user to maintain separate personas for separate purposes. </t>
<t>Unlike traditional Internet application accounts, Mesh accounts are created by and belong to the user, not the Mesh Service provider. A user <bcp14>MAY</bcp14> change their Mesh Service provider at any time and disconnect the profile from all Mesh Services (e.g. to archive the account).</t>
<t>Alice's personal account is connected to two Mesh services:</t>
<t>The account profile specifies the online and offline signature keys used to maintain the profile and the encryption key to be used by the account. </t>
<t>Each device connected to the account requires an activation record. This specifies the  key contribtions added to the manufacturer device profile keys: </t>
<t>The resulting key set is specified in the device connection: </t>
<t>All the above plus the ProfileDevice are combined to form the CatalogedDevice entry: </t>
<section title="Creating a ProfileAccount" anchor="n-creating-a-profileaccount"><t>Creating a <tt>ProfileAccount</tt> comprises the steps of:</t>
<ol start="0">
<li>[TBS]</li>
<li>.</li>
<li>Signing the ProfileMaster using the Master Signature Key</li>
</ol>
</section>
<section title="Connecting a Device to an Account" anchor="n-connecting-a-device-to-an-account"><t>Adding a device to an account comprises the steps of:</t>
<ol start="0">
<li>Creating a PrivateAccount instance for the device.</li>
<li>Creating a ConnectionAccountDevice for the device using the public keys from the PrivateAccount instance and the ProfileDevice.</li>
<li>Creating an ActivationAccount for the device containing the PrivateAccount and ConnectionAccountDevice instances.</li>
<li>Adding the ActivationAccount to the <tt>CatalogEntryDevice</tt> of the device.</li>
<li>If the Personal Mesh has accounts that are connected to a Mesh Service, synchronizing the <tt>CatalogEntryDevice</tt> to those services.</li>
</ol>
</section>
<section title="Binding and Account to a Service" anchor="n-binding-and-account-to-a-service"><t>Binding a <tt>ProfileAccount</tt> to a Mesh Service the steps of:</t>
<ol start="0">
<li>[TBS]</li>
<li>.</li>
<li>Signing the ProfileMaster using the Master Signature Key</li>
</ol>
</section>
</section>
<section title="Mesh Services" anchor="n-mesh-services"><t>A service profile provides the axiom of trust and cryptographic keys for a Mesh Service. A Mesh Service Host <bcp14>SHOULD</bcp14> return a copy of its ProfileHost and the parent ProfileService in response to a Hello transaction request.</t>
<figure>
<!-- Include SVG File ../Images/SchemaProfileService.svg --><artwork type="svg">
<svg height="441" width="552" xmlns="http://www.w3.org/2000/svg" >
<g transform="translate(8,16)">
  <path d="M 16,0 L 224,0" fill="none" stroke="black" />
  <path d="M 296,0 L 504,0" fill="none" stroke="black" />
  <path d="M 16,32 L 176,32" fill="none" stroke="black" />
  <path d="M 296,32 L 472,32" fill="none" stroke="black" />
  <path d="M 176,48 L 192,48" fill="none" stroke="black" />
  <path d="M 472,48 L 488,48" fill="none" stroke="black" />
  <path d="M 176,96 L 208,96" fill="none" stroke="black" />
  <path d="M 16,112 L 176,112" fill="none" stroke="black" />
  <path d="M 296,112 L 472,112" fill="none" stroke="black" />
  <path d="M 16,144 L 176,144" fill="none" stroke="black" />
  <path d="M 296,144 L 472,144" fill="none" stroke="black" />
  <path d="M 184,160 L 192,160" fill="none" stroke="black" />
  <path d="M 480,160 L 488,160" fill="none" stroke="black" />
  <path d="M 16,176 L 176,176" fill="none" stroke="black" />
  <path d="M 296,176 L 472,176" fill="none" stroke="black" />
  <path d="M 16,192 L 224,192" fill="none" stroke="black" />
  <path d="M 296,192 L 504,192" fill="none" stroke="black" />
  <path d="M 296,224 L 504,224" fill="none" stroke="black" />
  <path d="M 312,256 L 488,256" fill="none" stroke="black" />
  <path d="M 312,336 L 488,336" fill="none" stroke="black" />
  <path d="M 312,368 L 488,368" fill="none" stroke="black" />
  <path d="M 240,384 L 280,384" fill="none" stroke="black" />
  <path d="M 280,384 L 304,384" fill="none" stroke="black" />
  <path d="M 312,400 L 488,400" fill="none" stroke="black" />
  <path d="M 296,416 L 504,416" fill="none" stroke="black" />
  <path d="M 0,16 L 0,176" fill="none" stroke="black" />
  <path d="M 16,32 L 16,112" fill="none" stroke="black" />
  <path d="M 16,144 L 16,176" fill="none" stroke="black" />
  <path d="M 176,32 L 176,48" fill="none" stroke="black" />
  <path d="M 176,48 L 176,96" fill="none" stroke="black" />
  <path d="M 176,96 L 176,112" fill="none" stroke="black" />
  <path d="M 176,144 L 176,160" fill="none" stroke="black" />
  <path d="M 176,160 L 176,176" fill="none" stroke="black" />
  <path d="M 208,64 L 208,96" fill="none" stroke="black" />
  <path d="M 208,96 L 208,144" fill="none" stroke="black" />
  <path d="M 224,112 L 224,192" fill="none" stroke="black" />
  <path d="M 224,192 L 224,368" fill="none" stroke="black" />
  <path d="M 240,16 L 240,176" fill="none" stroke="black" />
  <path d="M 280,16 L 280,176" fill="none" stroke="black" />
  <path d="M 280,240 L 280,384" fill="none" stroke="black" />
  <path d="M 280,384 L 280,400" fill="none" stroke="black" />
  <path d="M 296,32 L 296,112" fill="none" stroke="black" />
  <path d="M 296,144 L 296,176" fill="none" stroke="black" />
  <path d="M 312,256 L 312,336" fill="none" stroke="black" />
  <path d="M 312,368 L 312,400" fill="none" stroke="black" />
  <path d="M 472,32 L 472,48" fill="none" stroke="black" />
  <path d="M 472,48 L 472,112" fill="none" stroke="black" />
  <path d="M 472,144 L 472,160" fill="none" stroke="black" />
  <path d="M 472,160 L 472,176" fill="none" stroke="black" />
  <path d="M 488,256 L 488,336" fill="none" stroke="black" />
  <path d="M 488,368 L 488,400" fill="none" stroke="black" />
  <path d="M 504,64 L 504,144" fill="none" stroke="black" />
  <path d="M 520,16 L 520,176" fill="none" stroke="black" />
  <path d="M 520,240 L 520,400" fill="none" stroke="black" />
  <polygon points="192.000000,160.000000 180.000000,154.399994 180.000000,165.600006" fill="black" transform="rotate(180.000000, 184.000000, 160.000000)" />
  <polygon points="312.000000,384.000000 300.000000,378.399994 300.000000,389.600006" fill="black" transform="rotate(0.000000, 304.000000, 384.000000)" />
  <polygon points="488.000000,160.000000 476.000000,154.399994 476.000000,165.600006" fill="black" transform="rotate(180.000000, 480.000000, 160.000000)" />
  <path d="M 16,0 A 16,16 0 0,0 0,16" fill="none" stroke="black" />
  <path d="M 224,0 A 16,16 0 0,1 240,16" fill="none" stroke="black" />
  <path d="M 296,0 A 16,16 0 0,0 280,16" fill="none" stroke="black" />
  <path d="M 504,0 A 16,16 0 0,1 520,16" fill="none" stroke="black" />
  <path d="M 192,48 A 16,16 0 0,1 208,64" fill="none" stroke="black" />
  <path d="M 488,48 A 16,16 0 0,1 504,64" fill="none" stroke="black" />
  <path d="M 208,96 A 16,16 0 0,1 224,112" fill="none" stroke="black" />
  <path d="M 208,144 A 16,16 0 0,1 192,160" fill="none" stroke="black" />
  <path d="M 504,144 A 16,16 0 0,1 488,160" fill="none" stroke="black" />
  <path d="M 0,176 A 16,16 0 0,0 16,192" fill="none" stroke="black" />
  <path d="M 240,176 A 16,16 0 0,1 224,192" fill="none" stroke="black" />
  <path d="M 280,176 A 16,16 0 0,0 296,192" fill="none" stroke="black" />
  <path d="M 520,176 A 16,16 0 0,1 504,192" fill="none" stroke="black" />
  <path d="M 296,224 A 16,16 0 0,0 280,240" fill="none" stroke="black" />
  <path d="M 504,224 A 16,16 0 0,1 520,240" fill="none" stroke="black" />
  <path d="M 224,368 A 16,16 0 0,0 240,384" fill="none" stroke="black" />
  <path d="M 280,400 A 16,16 0 0,0 296,416" fill="none" stroke="black" />
  <path d="M 520,400 A 16,16 0 0,1 504,416" fill="none" stroke="black" />
  <text text-anchor="middle" font-family="sans-serif" x="56" y="84">i</text>
  <text text-anchor="middle" font-family="sans-serif" x="152" y="84">g</text>
  <text text-anchor="middle" font-family="sans-serif" x="408" y="84">o</text>
  <text text-anchor="middle" font-family="sans-serif" x="464" y="244">n</text>
  <text text-anchor="middle" font-family="sans-serif" x="352" y="324">i</text>
  <text text-anchor="middle" font-family="sans-serif" x="32" y="52">P</text>
  <text text-anchor="middle" font-family="sans-serif" x="400" y="20">P</text>
  <text text-anchor="middle" font-family="sans-serif" x="376" y="244">t</text>
  <text text-anchor="middle" font-family="sans-serif" x="400" y="244">o</text>
  <text text-anchor="middle" font-family="sans-serif" x="432" y="276">s</text>
  <text text-anchor="middle" font-family="sans-serif" x="336" y="308">e</text>
  <text text-anchor="middle" font-family="sans-serif" x="440" y="324">c</text>
  <text text-anchor="middle" font-family="sans-serif" x="80" y="20">r</text>
  <text text-anchor="middle" font-family="sans-serif" x="144" y="100">i</text>
  <text text-anchor="middle" font-family="sans-serif" x="336" y="100">e</text>
  <text text-anchor="middle" font-family="sans-serif" x="360" y="164">u</text>
  <text text-anchor="middle" font-family="sans-serif" x="336" y="292">e</text>
  <text text-anchor="middle" font-family="sans-serif" x="344" y="292">v</text>
  <text text-anchor="middle" font-family="sans-serif" x="440" y="20">l</text>
  <text text-anchor="middle" font-family="sans-serif" x="104" y="68">d</text>
  <text text-anchor="middle" font-family="sans-serif" x="360" y="84">c</text>
  <text text-anchor="middle" font-family="sans-serif" x="400" y="84">i</text>
  <text text-anchor="middle" font-family="sans-serif" x="48" y="164">g</text>
  <text text-anchor="middle" font-family="sans-serif" x="56" y="164">n</text>
  <text text-anchor="middle" font-family="sans-serif" x="352" y="244">H</text>
  <text text-anchor="middle" font-family="sans-serif" x="408" y="308">y</text>
  <text text-anchor="middle" font-family="sans-serif" x="424" y="308">t</text>
  <text text-anchor="middle" font-family="sans-serif" x="360" y="388">a</text>
  <text text-anchor="middle" font-family="sans-serif" x="152" y="52">e</text>
  <text text-anchor="middle" font-family="sans-serif" x="96" y="84">r</text>
  <text text-anchor="middle" font-family="sans-serif" x="160" y="84">.</text>
  <text text-anchor="middle" font-family="sans-serif" x="144" y="164">e</text>
  <text text-anchor="middle" font-family="sans-serif" x="424" y="276">s</text>
  <text text-anchor="middle" font-family="sans-serif" x="368" y="324">e</text>
  <text text-anchor="middle" font-family="sans-serif" x="352" y="308">i</text>
  <text text-anchor="middle" font-family="sans-serif" x="360" y="324">c</text>
  <text text-anchor="middle" font-family="sans-serif" x="48" y="52">o</text>
  <text text-anchor="middle" font-family="sans-serif" x="112" y="84">t</text>
  <text text-anchor="middle" font-family="sans-serif" x="144" y="84">i</text>
  <text text-anchor="middle" font-family="sans-serif" x="120" y="164">a</text>
  <text text-anchor="middle" font-family="sans-serif" x="368" y="244">s</text>
  <text text-anchor="middle" font-family="sans-serif" x="376" y="292">S</text>
  <text text-anchor="middle" font-family="sans-serif" x="384" y="324">u</text>
  <text text-anchor="middle" font-family="sans-serif" x="112" y="68">r</text>
  <text text-anchor="middle" font-family="sans-serif" x="424" y="100">t</text>
  <text text-anchor="middle" font-family="sans-serif" x="368" y="292">e</text>
  <text text-anchor="middle" font-family="sans-serif" x="384" y="52">g</text>
  <text text-anchor="middle" font-family="sans-serif" x="408" y="52">t</text>
  <text text-anchor="middle" font-family="sans-serif" x="312" y="100">B</text>
  <text text-anchor="middle" font-family="sans-serif" x="432" y="244">c</text>
  <text text-anchor="middle" font-family="sans-serif" x="64" y="164">a</text>
  <text text-anchor="middle" font-family="sans-serif" x="392" y="164">V</text>
  <text text-anchor="middle" font-family="sans-serif" x="320" y="68">a</text>
  <text text-anchor="middle" font-family="sans-serif" x="352" y="164">t</text>
  <text text-anchor="middle" font-family="sans-serif" x="408" y="164">l</text>
  <text text-anchor="middle" font-family="sans-serif" x="440" y="244">t</text>
  <text text-anchor="middle" font-family="sans-serif" x="328" y="308">D</text>
  <text text-anchor="middle" font-family="sans-serif" x="48" y="68">r</text>
  <text text-anchor="middle" font-family="sans-serif" x="104" y="84">a</text>
  <text text-anchor="middle" font-family="sans-serif" x="424" y="292">u</text>
  <text text-anchor="middle" font-family="sans-serif" x="376" y="308">E</text>
  <text text-anchor="middle" font-family="sans-serif" x="376" y="388">u</text>
  <text text-anchor="middle" font-family="sans-serif" x="448" y="308">n</text>
  <text text-anchor="middle" font-family="sans-serif" x="392" y="324">t</text>
  <text text-anchor="middle" font-family="sans-serif" x="88" y="52">S</text>
  <text text-anchor="middle" font-family="sans-serif" x="392" y="68">u</text>
  <text text-anchor="middle" font-family="sans-serif" x="120" y="84">o</text>
  <text text-anchor="middle" font-family="sans-serif" x="392" y="84">t</text>
  <text text-anchor="middle" font-family="sans-serif" x="32" y="100">S</text>
  <text text-anchor="middle" font-family="sans-serif" x="96" y="164">e</text>
  <text text-anchor="middle" font-family="sans-serif" x="64" y="68">i</text>
  <text text-anchor="middle" font-family="sans-serif" x="360" y="100">t</text>
  <text text-anchor="middle" font-family="sans-serif" x="328" y="276">S</text>
  <text text-anchor="middle" font-family="sans-serif" x="352" y="276">v</text>
  <text text-anchor="middle" font-family="sans-serif" x="424" y="324">t</text>
  <text text-anchor="middle" font-family="sans-serif" x="128" y="52">t</text>
  <text text-anchor="middle" font-family="sans-serif" x="328" y="68">s</text>
  <text text-anchor="middle" font-family="sans-serif" x="336" y="276">e</text>
  <text text-anchor="middle" font-family="sans-serif" x="416" y="52">u</text>
  <text text-anchor="middle" font-family="sans-serif" x="384" y="100">n</text>
  <text text-anchor="middle" font-family="sans-serif" x="128" y="164">l</text>
  <text text-anchor="middle" font-family="sans-serif" x="416" y="308">p</text>
  <text text-anchor="middle" font-family="sans-serif" x="88" y="164">r</text>
  <text text-anchor="middle" font-family="sans-serif" x="384" y="308">n</text>
  <text text-anchor="middle" font-family="sans-serif" x="400" y="308">r</text>
  <text text-anchor="middle" font-family="sans-serif" x="432" y="324">i</text>
  <text text-anchor="middle" font-family="sans-serif" x="80" y="68">e</text>
  <text text-anchor="middle" font-family="sans-serif" x="408" y="388">V</text>
  <text text-anchor="middle" font-family="sans-serif" x="64" y="20">S</text>
  <text text-anchor="middle" font-family="sans-serif" x="136" y="52">u</text>
  <text text-anchor="middle" font-family="sans-serif" x="392" y="244">C</text>
  <text text-anchor="middle" font-family="sans-serif" x="416" y="388">a</text>
  <text text-anchor="middle" font-family="sans-serif" x="440" y="388">e</text>
  <text text-anchor="middle" font-family="sans-serif" x="144" y="52">r</text>
  <text text-anchor="middle" font-family="sans-serif" x="40" y="68">e</text>
  <text text-anchor="middle" font-family="sans-serif" x="32" y="84">A</text>
  <text text-anchor="middle" font-family="sans-serif" x="160" y="100">n</text>
  <text text-anchor="middle" font-family="sans-serif" x="408" y="20">r</text>
  <text text-anchor="middle" font-family="sans-serif" x="392" y="52">n</text>
  <text text-anchor="middle" font-family="sans-serif" x="344" y="276">r</text>
  <text text-anchor="middle" font-family="sans-serif" x="376" y="276">e</text>
  <text text-anchor="middle" font-family="sans-serif" x="408" y="292">a</text>
  <text text-anchor="middle" font-family="sans-serif" x="384" y="388">r</text>
  <text text-anchor="middle" font-family="sans-serif" x="48" y="84">m</text>
  <text text-anchor="middle" font-family="sans-serif" x="136" y="84">S</text>
  <text text-anchor="middle" font-family="sans-serif" x="432" y="292">r</text>
  <text text-anchor="middle" font-family="sans-serif" x="368" y="308">e</text>
  <text text-anchor="middle" font-family="sans-serif" x="424" y="388">l</text>
  <text text-anchor="middle" font-family="sans-serif" x="56" y="68">v</text>
  <text text-anchor="middle" font-family="sans-serif" x="88" y="68">A</text>
  <text text-anchor="middle" font-family="sans-serif" x="392" y="292">g</text>
  <text text-anchor="middle" font-family="sans-serif" x="344" y="324">v</text>
  <text text-anchor="middle" font-family="sans-serif" x="376" y="324">A</text>
  <text text-anchor="middle" font-family="sans-serif" x="480" y="324">n</text>
  <text text-anchor="middle" font-family="sans-serif" x="408" y="100">c</text>
  <text text-anchor="middle" font-family="sans-serif" x="72" y="20">e</text>
  <text text-anchor="middle" font-family="sans-serif" x="120" y="68">e</text>
  <text text-anchor="middle" font-family="sans-serif" x="320" y="84">a</text>
  <text text-anchor="middle" font-family="sans-serif" x="80" y="164">u</text>
  <text text-anchor="middle" font-family="sans-serif" x="400" y="324">h</text>
  <text text-anchor="middle" font-family="sans-serif" x="112" y="20">e</text>
  <text text-anchor="middle" font-family="sans-serif" x="80" y="52">e</text>
  <text text-anchor="middle" font-family="sans-serif" x="328" y="84">s</text>
  <text text-anchor="middle" font-family="sans-serif" x="56" y="100">v</text>
  <text text-anchor="middle" font-family="sans-serif" x="360" y="276">i</text>
  <text text-anchor="middle" font-family="sans-serif" x="344" y="308">v</text>
  <text text-anchor="middle" font-family="sans-serif" x="432" y="308">i</text>
  <text text-anchor="middle" font-family="sans-serif" x="376" y="20">s</text>
  <text text-anchor="middle" font-family="sans-serif" x="104" y="52">g</text>
  <text text-anchor="middle" font-family="sans-serif" x="368" y="52">S</text>
  <text text-anchor="middle" font-family="sans-serif" x="96" y="68">d</text>
  <text text-anchor="middle" font-family="sans-serif" x="368" y="84">r</text>
  <text text-anchor="middle" font-family="sans-serif" x="64" y="100">i</text>
  <text text-anchor="middle" font-family="sans-serif" x="72" y="52">l</text>
  <text text-anchor="middle" font-family="sans-serif" x="320" y="52">r</text>
  <text text-anchor="middle" font-family="sans-serif" x="344" y="164">a</text>
  <text text-anchor="middle" font-family="sans-serif" x="312" y="68">B</text>
  <text text-anchor="middle" font-family="sans-serif" x="72" y="84">i</text>
  <text text-anchor="middle" font-family="sans-serif" x="376" y="84">y</text>
  <text text-anchor="middle" font-family="sans-serif" x="440" y="100">o</text>
  <text text-anchor="middle" font-family="sans-serif" x="448" y="100">n</text>
  <text text-anchor="middle" font-family="sans-serif" x="416" y="244">n</text>
  <text text-anchor="middle" font-family="sans-serif" x="384" y="276">A</text>
  <text text-anchor="middle" font-family="sans-serif" x="360" y="308">c</text>
  <text text-anchor="middle" font-family="sans-serif" x="64" y="52">i</text>
  <text text-anchor="middle" font-family="sans-serif" x="360" y="52">e</text>
  <text text-anchor="middle" font-family="sans-serif" x="416" y="164">u</text>
  <text text-anchor="middle" font-family="sans-serif" x="408" y="276">r</text>
  <text text-anchor="middle" font-family="sans-serif" x="408" y="324">e</text>
  <text text-anchor="middle" font-family="sans-serif" x="416" y="20">o</text>
  <text text-anchor="middle" font-family="sans-serif" x="312" y="52">P</text>
  <text text-anchor="middle" font-family="sans-serif" x="344" y="68">S</text>
  <text text-anchor="middle" font-family="sans-serif" x="384" y="68">t</text>
  <text text-anchor="middle" font-family="sans-serif" x="376" y="164">e</text>
  <text text-anchor="middle" font-family="sans-serif" x="392" y="388">e</text>
  <text text-anchor="middle" font-family="sans-serif" x="376" y="52">i</text>
  <text text-anchor="middle" font-family="sans-serif" x="320" y="100">a</text>
  <text text-anchor="middle" font-family="sans-serif" x="328" y="100">s</text>
  <text text-anchor="middle" font-family="sans-serif" x="32" y="164">S</text>
  <text text-anchor="middle" font-family="sans-serif" x="424" y="244">e</text>
  <text text-anchor="middle" font-family="sans-serif" x="352" y="292">i</text>
  <text text-anchor="middle" font-family="sans-serif" x="144" y="20">o</text>
  <text text-anchor="middle" font-family="sans-serif" x="56" y="52">f</text>
  <text text-anchor="middle" font-family="sans-serif" x="352" y="68">i</text>
  <text text-anchor="middle" font-family="sans-serif" x="80" y="84">s</text>
  <text text-anchor="middle" font-family="sans-serif" x="416" y="276">e</text>
  <text text-anchor="middle" font-family="sans-serif" x="128" y="20">P</text>
  <text text-anchor="middle" font-family="sans-serif" x="424" y="20">f</text>
  <text text-anchor="middle" font-family="sans-serif" x="456" y="244">o</text>
  <text text-anchor="middle" font-family="sans-serif" x="152" y="20">f</text>
  <text text-anchor="middle" font-family="sans-serif" x="424" y="52">r</text>
  <text text-anchor="middle" font-family="sans-serif" x="48" y="100">r</text>
  <text text-anchor="middle" font-family="sans-serif" x="448" y="244">i</text>
  <text text-anchor="middle" font-family="sans-serif" x="464" y="324">i</text>
  <text text-anchor="middle" font-family="sans-serif" x="416" y="292">t</text>
  <text text-anchor="middle" font-family="sans-serif" x="136" y="68">s</text>
  <text text-anchor="middle" font-family="sans-serif" x="368" y="68">n</text>
  <text text-anchor="middle" font-family="sans-serif" x="64" y="84">n</text>
  <text text-anchor="middle" font-family="sans-serif" x="344" y="84">E</text>
  <text text-anchor="middle" font-family="sans-serif" x="80" y="100">e</text>
  <text text-anchor="middle" font-family="sans-serif" x="312" y="164">S</text>
  <text text-anchor="middle" font-family="sans-serif" x="432" y="388">u</text>
  <text text-anchor="middle" font-family="sans-serif" x="344" y="52">i</text>
  <text text-anchor="middle" font-family="sans-serif" x="400" y="164">a</text>
  <text text-anchor="middle" font-family="sans-serif" x="424" y="164">e</text>
  <text text-anchor="middle" font-family="sans-serif" x="176" y="20">e</text>
  <text text-anchor="middle" font-family="sans-serif" x="408" y="244">n</text>
  <text text-anchor="middle" font-family="sans-serif" x="368" y="276">c</text>
  <text text-anchor="middle" font-family="sans-serif" x="448" y="324">a</text>
  <text text-anchor="middle" font-family="sans-serif" x="472" y="324">o</text>
  <text text-anchor="middle" font-family="sans-serif" x="416" y="84">n</text>
  <text text-anchor="middle" font-family="sans-serif" x="40" y="100">e</text>
  <text text-anchor="middle" font-family="sans-serif" x="168" y="20">l</text>
  <text text-anchor="middle" font-family="sans-serif" x="112" y="52">n</text>
  <text text-anchor="middle" font-family="sans-serif" x="328" y="52">o</text>
  <text text-anchor="middle" font-family="sans-serif" x="432" y="52">e</text>
  <text text-anchor="middle" font-family="sans-serif" x="32" y="68">S</text>
  <text text-anchor="middle" font-family="sans-serif" x="72" y="68">c</text>
  <text text-anchor="middle" font-family="sans-serif" x="352" y="100">u</text>
  <text text-anchor="middle" font-family="sans-serif" x="344" y="100">A</text>
  <text text-anchor="middle" font-family="sans-serif" x="448" y="20">e</text>
  <text text-anchor="middle" font-family="sans-serif" x="72" y="100">c</text>
  <text text-anchor="middle" font-family="sans-serif" x="392" y="100">t</text>
  <text text-anchor="middle" font-family="sans-serif" x="368" y="388">t</text>
  <text text-anchor="middle" font-family="sans-serif" x="384" y="84">p</text>
  <text text-anchor="middle" font-family="sans-serif" x="416" y="100">a</text>
  <text text-anchor="middle" font-family="sans-serif" x="328" y="324">D</text>
  <text text-anchor="middle" font-family="sans-serif" x="96" y="52">i</text>
  <text text-anchor="middle" font-family="sans-serif" x="320" y="164">i</text>
  <text text-anchor="middle" font-family="sans-serif" x="344" y="388">g</text>
  <text text-anchor="middle" font-family="sans-serif" x="352" y="84">n</text>
  <text text-anchor="middle" font-family="sans-serif" x="136" y="164">u</text>
  <text text-anchor="middle" font-family="sans-serif" x="400" y="292">n</text>
  <text text-anchor="middle" font-family="sans-serif" x="352" y="388">n</text>
  <text text-anchor="middle" font-family="sans-serif" x="360" y="20">H</text>
  <text text-anchor="middle" font-family="sans-serif" x="400" y="68">r</text>
  <text text-anchor="middle" font-family="sans-serif" x="312" y="84">B</text>
  <text text-anchor="middle" font-family="sans-serif" x="88" y="100">E</text>
  <text text-anchor="middle" font-family="sans-serif" x="72" y="164">t</text>
  <text text-anchor="middle" font-family="sans-serif" x="336" y="324">e</text>
  <text text-anchor="middle" font-family="sans-serif" x="360" y="68">g</text>
  <text text-anchor="middle" font-family="sans-serif" x="360" y="244">o</text>
  <text text-anchor="middle" font-family="sans-serif" x="392" y="276">d</text>
  <text text-anchor="middle" font-family="sans-serif" x="352" y="52">l</text>
  <text text-anchor="middle" font-family="sans-serif" x="440" y="308">o</text>
  <text text-anchor="middle" font-family="sans-serif" x="128" y="68">s</text>
  <text text-anchor="middle" font-family="sans-serif" x="376" y="68">a</text>
  <text text-anchor="middle" font-family="sans-serif" x="400" y="100">i</text>
  <text text-anchor="middle" font-family="sans-serif" x="384" y="292">i</text>
  <text text-anchor="middle" font-family="sans-serif" x="336" y="68">e</text>
  <text text-anchor="middle" font-family="sans-serif" x="112" y="100">r</text>
  <text text-anchor="middle" font-family="sans-serif" x="120" y="100">y</text>
  <text text-anchor="middle" font-family="sans-serif" x="328" y="292">D</text>
  <text text-anchor="middle" font-family="sans-serif" x="360" y="292">c</text>
  <text text-anchor="middle" font-family="sans-serif" x="456" y="324">t</text>
  <text text-anchor="middle" font-family="sans-serif" x="384" y="20">t</text>
  <text text-anchor="middle" font-family="sans-serif" x="400" y="52">a</text>
  <text text-anchor="middle" font-family="sans-serif" x="432" y="100">i</text>
  <text text-anchor="middle" font-family="sans-serif" x="400" y="276">d</text>
  <text text-anchor="middle" font-family="sans-serif" x="392" y="308">c</text>
  <text text-anchor="middle" font-family="sans-serif" x="416" y="324">n</text>
  <text text-anchor="middle" font-family="sans-serif" x="336" y="84">e</text>
  <text text-anchor="middle" font-family="sans-serif" x="104" y="100">c</text>
  <text text-anchor="middle" font-family="sans-serif" x="368" y="20">o</text>
  <text text-anchor="middle" font-family="sans-serif" x="432" y="20">i</text>
  <text text-anchor="middle" font-family="sans-serif" x="40" y="52">r</text>
  <text text-anchor="middle" font-family="sans-serif" x="40" y="84">d</text>
  <text text-anchor="middle" font-family="sans-serif" x="128" y="84">r</text>
  <text text-anchor="middle" font-family="sans-serif" x="96" y="100">n</text>
  <text text-anchor="middle" font-family="sans-serif" x="96" y="20">i</text>
  <text text-anchor="middle" font-family="sans-serif" x="136" y="20">r</text>
  <text text-anchor="middle" font-family="sans-serif" x="336" y="52">f</text>
  <text text-anchor="middle" font-family="sans-serif" x="368" y="100">h</text>
  <text text-anchor="middle" font-family="sans-serif" x="408" y="68">e</text>
  <text text-anchor="middle" font-family="sans-serif" x="88" y="84">t</text>
  <text text-anchor="middle" font-family="sans-serif" x="328" y="164">g</text>
  <text text-anchor="middle" font-family="sans-serif" x="368" y="164">r</text>
  <text text-anchor="middle" font-family="sans-serif" x="104" y="20">c</text>
  <text text-anchor="middle" font-family="sans-serif" x="128" y="100">p</text>
  <text text-anchor="middle" font-family="sans-serif" x="152" y="100">o</text>
  <text text-anchor="middle" font-family="sans-serif" x="376" y="100">e</text>
  <text text-anchor="middle" font-family="sans-serif" x="40" y="164">i</text>
  <text text-anchor="middle" font-family="sans-serif" x="336" y="164">n</text>
  <text text-anchor="middle" font-family="sans-serif" x="328" y="388">S</text>
  <text text-anchor="middle" font-family="sans-serif" x="336" y="388">i</text>
  <text text-anchor="middle" font-family="sans-serif" x="88" y="20">v</text>
  <text text-anchor="middle" font-family="sans-serif" x="120" y="52">a</text>
  <text text-anchor="middle" font-family="sans-serif" x="112" y="164">V</text>
  <text text-anchor="middle" font-family="sans-serif" x="440" y="292">e</text>
  <text text-anchor="middle" font-family="sans-serif" x="160" y="20">i</text>
  <text text-anchor="middle" font-family="sans-serif" x="136" y="100">t</text>
</g></svg>
</artwork>
</figure>
<t>The credentials provided by the ProfileService and ProfileHost are distinct from those provided by the WebPKI that typically services TLS requests. WebPKI credentials provide service introduction and authentication while a Mesh ProfileHost only provides authentication.</t>
<t>Unless exceptional circumstances require, a service should not need to revise its Service Profile unless it is intended to change its identity. Service Profiles <bcp14>MAY</bcp14> be countersigned by Trusted Third Parties to establish accountability.</t>
<t>The service profile </t>
<t>The host also has a profile </t>
<t>And there should be a connection of the host to the service but this isn't implemented yet: </t>
<section title="Creating a ProfileService" anchor="n-creating-a-profileservice"><t>[TBS]</t>
<t>Creating a <tt>ProfileService</tt> comprises the steps of:</t>
<ol start="0">
<li>[TBS]</li>
<li>.</li>
<li>[TBS]</li>
<li></li>
<li>Signing the ProfileMaster using the Master Signature Key</li>
</ol>
<t></t>
</section>
<section title="Creating a ProfileHost" anchor="n-creating-a-profilehost"><t>Creating a <tt>ProfileHost</tt> comprises the steps of:</t>
<ol start="0">
<li>[TBS]</li>
<li>.</li>
<li>[TBS]</li>
<li></li>
<li>Signing the <tt>ConnectionHost</tt> using the Master Signature Key of the <tt>ProfileService</tt>.</li>
</ol>
</section>
<section title="Creating a ConnectionHost" anchor="n-creating-a-connectionhost"><t>Creating a <tt>ConnectionHost</tt> comprises the steps of:</t>
<ol start="0">
<li>[TBS]</li>
<li>.</li>
<li>Signing the <tt>ConnectionHost</tt> using the Master Signature Key of the <tt>ProfileService</tt>.</li>
</ol>
</section>
</section>
<section title="Mesh Messaging" anchor="n-mesh-messaging"><t>Mesh Messaging is an end-to-end secure messaging system used to exchange short (32KB) messages between Mesh devices and services. In cases where exchange of longer messages is required, Mesh Messaging <bcp14>MAY</bcp14> be used to provide a control plane to advise the intended message recipient(s) of the type of data being offered and the means of retrieval (e.g an EARL).</t>
<t>A four-corner messaging model is enforced. Mesh Services only accept outbound messages from devices connected to accounts that it services. Inbound messages are only accepted from other Mesh Services. This model enables access control at both the outbound and inbound services</t>
<figure>
<!-- Include SVG File ../Images/ArchFourCorner.svg --><artwork type="svg">
<svg height="217" width="448" xmlns="http://www.w3.org/2000/svg" >
<g transform="translate(8,16)">
  <path d="M 16,0 L 144,0" fill="none" stroke="black" />
  <path d="M 288,0 L 416,0" fill="none" stroke="black" />
  <path d="M 160,32 L 264,32" fill="none" stroke="black" />
  <path d="M 16,64 L 144,64" fill="none" stroke="black" />
  <path d="M 288,64 L 352,64" fill="none" stroke="black" />
  <path d="M 352,64 L 416,64" fill="none" stroke="black" />
  <path d="M 0,128 L 80,128" fill="none" stroke="black" />
  <path d="M 80,128 L 160,128" fill="none" stroke="black" />
  <path d="M 272,128 L 432,128" fill="none" stroke="black" />
  <path d="M 0,192 L 160,192" fill="none" stroke="black" />
  <path d="M 272,192 L 432,192" fill="none" stroke="black" />
  <path d="M 0,16 L 0,48" fill="none" stroke="black" />
  <path d="M 0,128 L 0,192" fill="none" stroke="black" />
  <path d="M 80,80 L 80,128" fill="none" stroke="black" />
  <path d="M 160,16 L 160,32" fill="none" stroke="black" />
  <path d="M 160,32 L 160,48" fill="none" stroke="black" />
  <path d="M 160,128 L 160,192" fill="none" stroke="black" />
  <path d="M 272,16 L 272,48" fill="none" stroke="black" />
  <path d="M 272,128 L 272,192" fill="none" stroke="black" />
  <path d="M 352,64 L 352,112" fill="none" stroke="black" />
  <path d="M 432,16 L 432,48" fill="none" stroke="black" />
  <path d="M 432,128 L 432,192" fill="none" stroke="black" />
  <path d="M 80,72 L 80,80" fill="none" stroke="black" />
  <polygon points="96.000000,80.000000 84.000000,74.400002 84.000000,85.599998" fill="black" transform="rotate(270.000000, 80.000000, 80.000000)" />
  <polygon points="272.000000,32.000000 260.000000,26.400000 260.000000,37.599998" fill="black" transform="rotate(0.000000, 264.000000, 32.000000)" />
  <path d="M 352,112 L 352,120" fill="none" stroke="black" />
  <polygon points="368.000000,112.000000 356.000000,106.400002 356.000000,117.599998" fill="black" transform="rotate(90.000000, 352.000000, 112.000000)" />
  <path d="M 16,0 A 16,16 0 0,0 0,16" fill="none" stroke="black" />
  <path d="M 144,0 A 16,16 0 0,1 160,16" fill="none" stroke="black" />
  <path d="M 288,0 A 16,16 0 0,0 272,16" fill="none" stroke="black" />
  <path d="M 416,0 A 16,16 0 0,1 432,16" fill="none" stroke="black" />
  <path d="M 0,48 A 16,16 0 0,0 16,64" fill="none" stroke="black" />
  <path d="M 160,48 A 16,16 0 0,1 144,64" fill="none" stroke="black" />
  <path d="M 272,48 A 16,16 0 0,0 288,64" fill="none" stroke="black" />
  <path d="M 432,48 A 16,16 0 0,1 416,64" fill="none" stroke="black" />
  <text text-anchor="middle" font-family="sans-serif" x="352" y="20">b</text>
  <text text-anchor="middle" font-family="sans-serif" x="368" y="20">s</text>
  <text text-anchor="middle" font-family="sans-serif" x="88" y="36">P</text>
  <text text-anchor="middle" font-family="sans-serif" x="352" y="36">S</text>
  <text text-anchor="middle" font-family="sans-serif" x="80" y="164">i</text>
  <text text-anchor="middle" font-family="sans-serif" x="352" y="164">o</text>
  <text text-anchor="middle" font-family="sans-serif" x="88" y="20">e</text>
  <text text-anchor="middle" font-family="sans-serif" x="336" y="20">B</text>
  <text text-anchor="middle" font-family="sans-serif" x="360" y="164">b</text>
  <text text-anchor="middle" font-family="sans-serif" x="344" y="20">o</text>
  <text text-anchor="middle" font-family="sans-serif" x="360" y="20">'</text>
  <text text-anchor="middle" font-family="sans-serif" x="72" y="36">M</text>
  <text text-anchor="middle" font-family="sans-serif" x="360" y="36">P</text>
  <text text-anchor="middle" font-family="sans-serif" x="64" y="20">l</text>
  <text text-anchor="middle" font-family="sans-serif" x="80" y="20">c</text>
  <text text-anchor="middle" font-family="sans-serif" x="80" y="36">S</text>
  <text text-anchor="middle" font-family="sans-serif" x="344" y="36">M</text>
  <text text-anchor="middle" font-family="sans-serif" x="72" y="164">l</text>
  <text text-anchor="middle" font-family="sans-serif" x="88" y="164">c</text>
  <text text-anchor="middle" font-family="sans-serif" x="96" y="164">e</text>
  <text text-anchor="middle" font-family="sans-serif" x="56" y="20">A</text>
  <text text-anchor="middle" font-family="sans-serif" x="96" y="20">'</text>
  <text text-anchor="middle" font-family="sans-serif" x="64" y="164">A</text>
  <text text-anchor="middle" font-family="sans-serif" x="344" y="164">B</text>
  <text text-anchor="middle" font-family="sans-serif" x="72" y="20">i</text>
  <text text-anchor="middle" font-family="sans-serif" x="104" y="20">s</text>
</g></svg>
</artwork>
</figure>
<t>The outbound Mesh Service checks to see that the request to send a message does not violate its acceptable use policy. Accounts that make a large number of message requests that result in complaints <bcp14>SHOULD</bcp14> be subject to consequences ranging from restriction of the number and type of messages sent to suspending or terminating messaging privileges. Services that fail to implement appropriate controls are likely to be subject to sanctions from either their users or from other services.</t>
<figure>
<!-- Include SVG File ../Images/ArchOutboundAccessControl.svg --><artwork type="svg">
<svg height="137" width="552" xmlns="http://www.w3.org/2000/svg" >
<g transform="translate(8,16)">
  <path d="M 0,0 L 160,0" fill="none" stroke="black" />
  <path d="M 288,0 L 416,0" fill="none" stroke="black" />
  <path d="M 160,32 L 264,32" fill="none" stroke="black" />
  <path d="M 0,64 L 160,64" fill="none" stroke="black" />
  <path d="M 288,64 L 408,64" fill="none" stroke="black" />
  <path d="M 432,64 L 536,64" fill="none" stroke="black" />
  <path d="M 288,96 L 408,96" fill="none" stroke="black" />
  <path d="M 288,112 L 416,112" fill="none" stroke="black" />
  <path d="M 0,0 L 0,64" fill="none" stroke="black" />
  <path d="M 160,0 L 160,32" fill="none" stroke="black" />
  <path d="M 160,32 L 160,64" fill="none" stroke="black" />
  <path d="M 272,16 L 272,96" fill="none" stroke="black" />
  <path d="M 288,64 L 288,96" fill="none" stroke="black" />
  <path d="M 408,64 L 408,96" fill="none" stroke="black" />
  <path d="M 432,16 L 432,64" fill="none" stroke="black" />
  <path d="M 432,64 L 432,96" fill="none" stroke="black" />
  <polygon points="272.000000,32.000000 260.000000,26.400000 260.000000,37.599998" fill="black" transform="rotate(0.000000, 264.000000, 32.000000)" />
  <polygon points="544.000000,64.000000 532.000000,58.400002 532.000000,69.599998" fill="black" transform="rotate(0.000000, 536.000000, 64.000000)" />
  <path d="M 288,0 A 16,16 0 0,0 272,16" fill="none" stroke="black" />
  <path d="M 416,0 A 16,16 0 0,1 432,16" fill="none" stroke="black" />
  <path d="M 272,96 A 16,16 0 0,0 288,112" fill="none" stroke="black" />
  <path d="M 432,96 A 16,16 0 0,1 416,112" fill="none" stroke="black" />
  <text text-anchor="middle" font-family="sans-serif" x="352" y="20">c</text>
  <text text-anchor="middle" font-family="sans-serif" x="472" y="52">e</text>
  <text text-anchor="middle" font-family="sans-serif" x="312" y="84">i</text>
  <text text-anchor="middle" font-family="sans-serif" x="328" y="84">e</text>
  <text text-anchor="middle" font-family="sans-serif" x="344" y="84">p</text>
  <text text-anchor="middle" font-family="sans-serif" x="360" y="84">l</text>
  <text text-anchor="middle" font-family="sans-serif" x="336" y="20">l</text>
  <text text-anchor="middle" font-family="sans-serif" x="360" y="20">e</text>
  <text text-anchor="middle" font-family="sans-serif" x="480" y="36">r</text>
  <text text-anchor="middle" font-family="sans-serif" x="464" y="52">M</text>
  <text text-anchor="middle" font-family="sans-serif" x="384" y="84">y</text>
  <text text-anchor="middle" font-family="sans-serif" x="72" y="36">l</text>
  <text text-anchor="middle" font-family="sans-serif" x="464" y="36">p</text>
  <text text-anchor="middle" font-family="sans-serif" x="480" y="52">s</text>
  <text text-anchor="middle" font-family="sans-serif" x="512" y="52">e</text>
  <text text-anchor="middle" font-family="sans-serif" x="368" y="84">i</text>
  <text text-anchor="middle" font-family="sans-serif" x="96" y="36">e</text>
  <text text-anchor="middle" font-family="sans-serif" x="504" y="52">g</text>
  <text text-anchor="middle" font-family="sans-serif" x="360" y="36">P</text>
  <text text-anchor="middle" font-family="sans-serif" x="320" y="84">t</text>
  <text text-anchor="middle" font-family="sans-serif" x="376" y="84">c</text>
  <text text-anchor="middle" font-family="sans-serif" x="328" y="20">A</text>
  <text text-anchor="middle" font-family="sans-serif" x="344" y="20">i</text>
  <text text-anchor="middle" font-family="sans-serif" x="80" y="36">i</text>
  <text text-anchor="middle" font-family="sans-serif" x="512" y="36">d</text>
  <text text-anchor="middle" font-family="sans-serif" x="304" y="84">S</text>
  <text text-anchor="middle" font-family="sans-serif" x="376" y="20">s</text>
  <text text-anchor="middle" font-family="sans-serif" x="504" y="36">e</text>
  <text text-anchor="middle" font-family="sans-serif" x="352" y="84">o</text>
  <text text-anchor="middle" font-family="sans-serif" x="488" y="36">o</text>
  <text text-anchor="middle" font-family="sans-serif" x="368" y="20">'</text>
  <text text-anchor="middle" font-family="sans-serif" x="64" y="36">A</text>
  <text text-anchor="middle" font-family="sans-serif" x="88" y="36">c</text>
  <text text-anchor="middle" font-family="sans-serif" x="344" y="36">M</text>
  <text text-anchor="middle" font-family="sans-serif" x="352" y="36">S</text>
  <text text-anchor="middle" font-family="sans-serif" x="456" y="36">A</text>
  <text text-anchor="middle" font-family="sans-serif" x="472" y="36">p</text>
  <text text-anchor="middle" font-family="sans-serif" x="496" y="36">v</text>
  <text text-anchor="middle" font-family="sans-serif" x="488" y="52">s</text>
  <text text-anchor="middle" font-family="sans-serif" x="496" y="52">a</text>
</g></svg>
</artwork>
</figure>
<t>The inbound Mesh Service also checks to see that messages received are consistent with the service Acceptable Use Policy and the user's personal access control settings.</t>
<t>Mesh Services that fail to police abuse by their account holders <bcp14>SHOULD</bcp14> be subject to consequences in the same fashion as account holders.</t>
<figure>
<!-- Include SVG File ../Images/ArchInboundAccessControl.svg --><artwork type="svg">
<svg height="201" width="552" xmlns="http://www.w3.org/2000/svg" >
<g transform="translate(8,16)">
  <path d="M 120,0 L 248,0" fill="none" stroke="black" />
  <path d="M 0,32 L 96,32" fill="none" stroke="black" />
  <path d="M 376,32 L 536,32" fill="none" stroke="black" />
  <path d="M 120,64 L 240,64" fill="none" stroke="black" />
  <path d="M 264,64 L 368,64" fill="none" stroke="black" />
  <path d="M 120,96 L 240,96" fill="none" stroke="black" />
  <path d="M 376,96 L 536,96" fill="none" stroke="black" />
  <path d="M 120,128 L 240,128" fill="none" stroke="black" />
  <path d="M 120,160 L 240,160" fill="none" stroke="black" />
  <path d="M 120,176 L 248,176" fill="none" stroke="black" />
  <path d="M 104,16 L 104,160" fill="none" stroke="black" />
  <path d="M 120,64 L 120,96" fill="none" stroke="black" />
  <path d="M 120,128 L 120,160" fill="none" stroke="black" />
  <path d="M 240,64 L 240,96" fill="none" stroke="black" />
  <path d="M 240,128 L 240,160" fill="none" stroke="black" />
  <path d="M 264,16 L 264,64" fill="none" stroke="black" />
  <path d="M 264,64 L 264,160" fill="none" stroke="black" />
  <path d="M 376,32 L 376,96" fill="none" stroke="black" />
  <path d="M 536,32 L 536,96" fill="none" stroke="black" />
  <polygon points="104.000000,32.000000 92.000000,26.400000 92.000000,37.599998" fill="black" transform="rotate(0.000000, 96.000000, 32.000000)" />
  <polygon points="376.000000,64.000000 364.000000,58.400002 364.000000,69.599998" fill="black" transform="rotate(0.000000, 368.000000, 64.000000)" />
  <path d="M 120,0 A 16,16 0 0,0 104,16" fill="none" stroke="black" />
  <path d="M 248,0 A 16,16 0 0,1 264,16" fill="none" stroke="black" />
  <path d="M 104,160 A 16,16 0 0,0 120,176" fill="none" stroke="black" />
  <path d="M 264,160 A 16,16 0 0,1 248,176" fill="none" stroke="black" />
  <text text-anchor="middle" font-family="sans-serif" x="304" y="36">c</text>
  <text text-anchor="middle" font-family="sans-serif" x="336" y="36">e</text>
  <text text-anchor="middle" font-family="sans-serif" x="304" y="52">e</text>
  <text text-anchor="middle" font-family="sans-serif" x="312" y="52">s</text>
  <text text-anchor="middle" font-family="sans-serif" x="328" y="52">a</text>
  <text text-anchor="middle" font-family="sans-serif" x="208" y="148">c</text>
  <text text-anchor="middle" font-family="sans-serif" x="192" y="20">'</text>
  <text text-anchor="middle" font-family="sans-serif" x="296" y="36">c</text>
  <text text-anchor="middle" font-family="sans-serif" x="64" y="20">e</text>
  <text text-anchor="middle" font-family="sans-serif" x="312" y="36">e</text>
  <text text-anchor="middle" font-family="sans-serif" x="152" y="84">t</text>
  <text text-anchor="middle" font-family="sans-serif" x="200" y="84">i</text>
  <text text-anchor="middle" font-family="sans-serif" x="176" y="148">P</text>
  <text text-anchor="middle" font-family="sans-serif" x="216" y="148">y</text>
  <text text-anchor="middle" font-family="sans-serif" x="32" y="20">s</text>
  <text text-anchor="middle" font-family="sans-serif" x="48" y="20">a</text>
  <text text-anchor="middle" font-family="sans-serif" x="184" y="20">b</text>
  <text text-anchor="middle" font-family="sans-serif" x="320" y="52">s</text>
  <text text-anchor="middle" font-family="sans-serif" x="144" y="84">i</text>
  <text text-anchor="middle" font-family="sans-serif" x="184" y="84">o</text>
  <text text-anchor="middle" font-family="sans-serif" x="216" y="84">y</text>
  <text text-anchor="middle" font-family="sans-serif" x="152" y="148">o</text>
  <text text-anchor="middle" font-family="sans-serif" x="24" y="20">e</text>
  <text text-anchor="middle" font-family="sans-serif" x="40" y="20">s</text>
  <text text-anchor="middle" font-family="sans-serif" x="192" y="148">l</text>
  <text text-anchor="middle" font-family="sans-serif" x="328" y="36">t</text>
  <text text-anchor="middle" font-family="sans-serif" x="448" y="68">B</text>
  <text text-anchor="middle" font-family="sans-serif" x="176" y="20">o</text>
  <text text-anchor="middle" font-family="sans-serif" x="184" y="36">S</text>
  <text text-anchor="middle" font-family="sans-serif" x="336" y="52">g</text>
  <text text-anchor="middle" font-family="sans-serif" x="344" y="52">e</text>
  <text text-anchor="middle" font-family="sans-serif" x="456" y="68">o</text>
  <text text-anchor="middle" font-family="sans-serif" x="160" y="84">e</text>
  <text text-anchor="middle" font-family="sans-serif" x="320" y="36">p</text>
  <text text-anchor="middle" font-family="sans-serif" x="344" y="36">d</text>
  <text text-anchor="middle" font-family="sans-serif" x="464" y="68">b</text>
  <text text-anchor="middle" font-family="sans-serif" x="136" y="84">S</text>
  <text text-anchor="middle" font-family="sans-serif" x="192" y="84">l</text>
  <text text-anchor="middle" font-family="sans-serif" x="208" y="84">c</text>
  <text text-anchor="middle" font-family="sans-serif" x="16" y="20">M</text>
  <text text-anchor="middle" font-family="sans-serif" x="200" y="20">s</text>
  <text text-anchor="middle" font-family="sans-serif" x="288" y="36">A</text>
  <text text-anchor="middle" font-family="sans-serif" x="160" y="148">b</text>
  <text text-anchor="middle" font-family="sans-serif" x="184" y="148">o</text>
  <text text-anchor="middle" font-family="sans-serif" x="168" y="20">B</text>
  <text text-anchor="middle" font-family="sans-serif" x="192" y="36">P</text>
  <text text-anchor="middle" font-family="sans-serif" x="296" y="52">M</text>
  <text text-anchor="middle" font-family="sans-serif" x="176" y="84">P</text>
  <text text-anchor="middle" font-family="sans-serif" x="144" y="148">B</text>
  <text text-anchor="middle" font-family="sans-serif" x="200" y="148">i</text>
  <text text-anchor="middle" font-family="sans-serif" x="56" y="20">g</text>
  <text text-anchor="middle" font-family="sans-serif" x="176" y="36">M</text>
</g></svg>
</artwork>
</figure>
<section title="Traffic Analysis" anchor="n-traffic-analysis"><t>The Mesh Messaging protocol as currently specified provides only limited protection against traffic analysis attacks. The use of TLS to encrypt communication between Mesh Services limits the effectiveness of na?ve traffic analysis mechanisms but does not prevent timing attacks unless dummy traffic is introduced to obfuscate traffic flows.</t>
<t>The limitation of the message size is in part intended to facilitate use of mechanisms capable of providing high levels of traffic analysis such as mixmaster and onion routing but the current Mesh Service Protocol does not provide support for such approaches and there are no immediate plans to do so.</t>
</section>
</section>
</section>
<section title="Mesh Messages" anchor="n-mesh-messages"><t>All communications between Mesh accounts takes the form of a Mesh Message carried in a Dare Envelope. Mesh Messages are stored in two spools associated with the account, the <tt>SpoolOutbound</tt> and the <tt>SpoolInbound</tt> containing the messages sent and received respectively.</t>
<t>This document only describes the representation of the messages within the message spool. The Mesh Service protocol by which the messages are exchanged between devices and services and between services is described in <xref target="draft-hallambaker-mesh-protocol"></xref>.</t>
<section title="PIN" anchor="n-pin"><t>One-time use 'PIN' codes are used to provide a means of out of band authentication in many Mesh Message applications. In particular the device connection and contact exchange message flows.</t>
<t>For example, when Alice reads the connection request from the device in the architecture  examples, a completion message is added to Alice's inbound spool so that the device is not  activated a second time by mistake: </t>
<sourcecode>{
  "MessagePin":{
    "MessageId":"ADPN-NW2M-7FVD-EN7C-FDA7-GB35-TMYZ",
    "Account":"alice@example.com",
    "Expires":"2020-11-04T01:50:44Z",
    "Automatic":true,
    "SaltedPin":"AAVT-FNF3-WCPJ-YLSC-ORUV-XNXJ-AEVJ",
    "Action":"Device"}}</sourcecode>
<t>The details of the presentation and verification of the PIN code are further described in the section below. </t>
</section>
<section title="Completion" anchor="n-completion"><t>Completion messages are dummy messages that are added to a Mesh Spool to change the status of messages previously posted. Any message that is in the inbound spool and has not been erased or redacted <bcp14>MAY</bcp14> be marked as <tt>read</tt>, <tt>unread</tt> or <tt>deleted</tt>. Any message in the outbound spool <bcp14>MAY</bcp14> be marked as <tt>sent</tt>, <tt>received</tt> or <tt>deleted</tt>.</t>
<t>Services <bcp14>MAY</bcp14> erase or redact messages in accordance with local site policy. Since messages are not removed from the spool on being marked deleted, they may be undeleted by marking them as read or unread. Marking a message deleted <bcp14>MAY</bcp14> make it more likely that the Service will purge the message however.</t>
<t>Having processed a message, a completion message is added to the spool so that other devices  can see that it has been read. </t>
<t>For example, when Alice's administration device uses the PIN registered above to  authenticate a device connection request, a completion message is added to Alice's  inbound spool so that the PIN cannot be reused to authenticate a second device: </t>
<sourcecode>Missing example 90</sourcecode>
</section>
<section title="Connection" anchor="n-connection"><t>Connection requests are sent by a device requesting connection to a Mesh Service Account.</t>
<t>The <tt>MessageConnectionRequest</tt> is originally sent by the device requesting connection to the Mesh Service associated with the account. </t>
<t>If the connection request is accepted by the Mesh Service, it creates a <tt>MessageConnectionResponse</tt> containing the ServerNonce and Witness values used in the authentication of the response together with a verbatim copy of the original request. The <tt>MessageConnectionResponse</tt> is then returned to the device that made the original request and placed on the SpoolInbound of the account to which the request was directed.</t>
<t>Further details of this mechanism are described in <xref target="draft-hallambaker-mesh-protocol"></xref>.</t>
<t>Alice connects a watch to her account. Since the watch has a camera (to allow for  video calls) she can use the dynamic QR code connection mechanism. </t>
<t>The watch reads the QR code generated on Alice's watch. This contains the device connection URI. </t>
<sourcecode>QR = {Connect.ConnectQRURI}</sourcecode>
<t>The URI tells the device the Mesh account to connect to and the PIN Code to be used to authenticate the request. The device requesting the connection adds its Profile device to create a RequestConnection message that will be presented to the service as a Connect transaction request. </t>
<sourcecode>{
  "RequestConnection":{
    "MessageId":"NBJG-EOWT-BS2Z-RVSI-7C3N-CTDB-ACVI",
    "AuthenticatedData":[{
        "EnvelopeID":"MDGU-U5T6-5SRZ-3S6H-KV5K-FQVE-SRBJ",
        "dig":"S512",
        "ContentMetaData":"ewogICJVbmlxdWVJRCI6ICJNREdVLVU1VDYtNV
  NSWi0zUzZILUtWNUstRlFWRS1TUkJKIiwKICAiTWVzc2FnZVR5cGUiOiAiUHJvZml
  sZURldmljZSIsCiAgImN0eSI6ICJhcHBsaWNhdGlvbi9tbW0vb2JqZWN0IiwKICAi
  Q3JlYXRlZCI6ICIyMDIwLTExLTAzVDAxOjUwOjQ1WiJ9"},
      "ewogICJQcm9maWxlRGV2aWNlIjogewogICAgIlByb2ZpbGVTaWduYXR1cm
  UiOiB7CiAgICAgICJVZGYiOiAiTURHVS1VNVQ2LTVTUlotM1M2SC1LVjVLLUZRVkU
  tU1JCSiIsCiAgICAgICJQdWJsaWNQYXJhbWV0ZXJzIjogewogICAgICAgICJQdWJs
  aWNLZXlFQ0RIIjogewogICAgICAgICAgImNydiI6ICJFZDQ0OCIsCiAgICAgICAgI
  CAiUHVibGljIjogImdLTGU3MkhLUWYxSlhRTmE3SVJ6SEZLQVZJT3RpZDhTM2RaNU
  FMTjF3eHdjWElaWmtQSGsKICBLZVZGZ0xfYVRONXd0U3c4MEdwVGRZNkEifX19LAo
  gICAgIkJhc2VFbmNyeXB0aW9uIjogewogICAgICAiVWRmIjogIk1EVVItSFkyNS1W
  S1VZLUdEWEEtSkVKMy1FTjZNLUZFREwiLAogICAgICAiUHVibGljUGFyYW1ldGVyc
  yI6IHsKICAgICAgICAiUHVibGljS2V5RUNESCI6IHsKICAgICAgICAgICJjcnYiOi
  AiWDQ0OCIsCiAgICAgICAgICAiUHVibGljIjogIkJyWTRGd2ZkTDluemk2cDMteTZ
  ubjlhT0dPOXczMWNYZzBNU0VUeG1fNF92ZWpEOFhxMGgKICBCVERPajhIWmVOdElT
  X3FZVDFYUy1ZZ0EifX19LAogICAgIkJhc2VBdXRoZW50aWNhdGlvbiI6IHsKICAgI
  CAgIlVkZiI6ICJNRFhCLU9MUFQtRFZFSy1PQldKLVlLWTMtVjcyVC1FQTVKIiwKIC
  AgICAgIlB1YmxpY1BhcmFtZXRlcnMiOiB7CiAgICAgICAgIlB1YmxpY0tleUVDREg
  iOiB7CiAgICAgICAgICAiY3J2IjogIlg0NDgiLAogICAgICAgICAgIlB1YmxpYyI6
  ICJHZlpGMVZ0NjVNMENuWHc1aTNKbzVmMmc5djJSRzVKaGFUSFVxeGxNTE1MZzF5Y
  nFLYzVzCiAgUUd1RnBfal9kRXpyWlZDVVdwaUdSMS1BIn19fSwKICAgICJCYXNlU2
  lnbmF0dXJlIjogewogICAgICAiVWRmIjogIk1BRkYtTjNHVy1FUkNVLUNINVctVlF
  PTS03QVNBLUZEQ0oiLAogICAgICAiUHVibGljUGFyYW1ldGVycyI6IHsKICAgICAg
  ICAiUHVibGljS2V5RUNESCI6IHsKICAgICAgICAgICJjcnYiOiAiRWQ0NDgiLAogI
  CAgICAgICAgIlB1YmxpYyI6ICJveTRDRjBERUJsaFZhakhLZXd6VVN0eWlTdzExeX
  BodXQ4bjBYdEFaUWpwVUhOdDUtNWJhCiAgRFpwejhPMWtBWHdCMHBvaEhYcDFENHl
  BIn19fX19",
      {
        "signatures":[{
            "alg":"S512",
            "kid":"MDGU-U5T6-5SRZ-3S6H-KV5K-FQVE-SRBJ",
            "signature":"wAwYBP7IuNh82p9uKRJipvdZGxWflNeIx2SYxwes
  fNvIQ7dVHzyFf9rvyyIALZsp6fVzaXSwqqiA6RQeWQIAMOhSy2Znh1K5c-qATSAJj
  rukejmhXmeKcOCHKUnt2yIrxAoEclTf0HzxfiNbSeoOzj4A"}
          ],
        "PayloadDigest":"2SWl6GfRY2649Q7jtEYkgRRZlUpR-lPA7rcl-qr6
  9EWu6stHguJeD0rMNjE76rCCp5fzSYDi5AZBwKTjYq_4rA"}
      ],
    "ClientNonce":"AU_wpUkuSo_bilgcAJ7Cqw",
    "PinId":"ADPN-NW2M-7FVD-EN7C-FDA7-GB35-TMYZ",
    "PinWitness":"4tqsy27PFNSIqsvti8RHq0INDXLz9adRxIiiYgb0uwtvqoY
  ac4UZhv2lNkO8f0A7XTLVaeRpY-74c2luSywFLQ",
    "AccountAddress":"alice@example.com"}}</sourcecode>
<t>The service generates an AcknowledgeConnection message which is returned to the device requesting the connection (via the Connect transaction response) and adds it to the inbound spool of the account for Alice's approval (or not). </t>
<sourcecode>{
  "AcknowledgeConnection":{
    "MessageId":"2OAQ-RZZ5-P3BL-DAGR-7XKG-P3YQ-MBZQ",
    "EnvelopedRequestConnection":[{
        "EnvelopeID":"MASN-S6XP-2RIN-IIJA-EBON-ZJVN-3TML",
        "ContentMetaData":"ewogICJVbmlxdWVJRCI6ICJOQkpHLUVPV1QtQl
  MyWi1SVlNJLTdDM04tQ1REQi1BQ1ZJIiwKICAiTWVzc2FnZVR5cGUiOiAiUmVxdWV
  zdENvbm5lY3Rpb24iLAogICJjdHkiOiAiYXBwbGljYXRpb24vbW1tL29iamVjdCIs
  CiAgIkNyZWF0ZWQiOiAiMjAyMC0xMS0wM1QwMTo1MDo0NVoifQ"},
      "ewogICJSZXF1ZXN0Q29ubmVjdGlvbiI6IHsKICAgICJNZXNzYWdlSWQiOi
  AiTkJKRy1FT1dULUJTMlotUlZTSS03QzNOLUNUREItQUNWSSIsCiAgICAiQXV0aGV
  udGljYXRlZERhdGEiOiBbewogICAgICAgICJFbnZlbG9wZUlEIjogIk1ER1UtVTVU
  Ni01U1JaLTNTNkgtS1Y1Sy1GUVZFLVNSQkoiLAogICAgICAgICJkaWciOiAiUzUxM
  iIsCiAgICAgICAgIkNvbnRlbnRNZXRhRGF0YSI6ICJld29nSUNKVmJtbHhkV1ZKUk
  NJNklDSk5SRWRWTFZVMVZEWXROVk5TV2kwCiAgelV6WklMVXRXTlVzdFJsRldSUzF
  UVWtKS0lpd0tJQ0FpVFdWemMyRm5aVlI1Y0dVaU9pQWlVSEp2Wm1sc1oKICBVUmxk
  bWxqWlNJc0NpQWdJbU4wZVNJNklDSmhjSEJzYVdOaGRHbHZiaTl0YlcwdmIySnFaV
  04wSWl3S0lDQQogIGlRM0psWVhSbFpDSTZJQ0l5TURJd0xURXhMVEF6VkRBeE9qVX
  dPalExV2lKOSJ9LAogICAgICAiZXdvZ0lDSlFjbTltYVd4bFJHVjJhV05sSWpvZ2V
  3b2dJQ0FnSWxCeWIyWgogIHBiR1ZUYVdkdVlYUjFjbVVpT2lCN0NpQWdJQ0FnSUNK
  VlpHWWlPaUFpVFVSSFZTMVZOVlEyTFRWVFVsb3RNCiAgMU0yU0MxTFZqVkxMVVpSV
  mtVdFUxSkNTaUlzQ2lBZ0lDQWdJQ0pRZFdKc2FXTlFZWEpoYldWMFpYSnpJam8KIC
  BnZXdvZ0lDQWdJQ0FnSUNKUWRXSnNhV05MWlhsRlEwUklJam9nZXdvZ0lDQWdJQ0F
  nSUNBZ0ltTnlkaUk2SQogIENKRlpEUTBPQ0lzQ2lBZ0lDQWdJQ0FnSUNBaVVIVmli
  R2xqSWpvZ0ltZExUR1UzTWtoTFVXWXhTbGhSVG1FCiAgM1NWSjZTRVpMUVZaSlQzU
  nBaRGhUTTJSYU5VRk1UakYzZUhkaldFbGFXbXRRU0dzS0lDQkxaVlpHWjB4ZlkKIC
  BWUk9OWGQwVTNjNE1FZHdWR1JaTmtFaWZYMTlMQW9nSUNBZ0lrSmhjMlZGYm1OeWV
  YQjBhVzl1SWpvZ2V3bwogIGdJQ0FnSUNBaVZXUm1Jam9nSWsxRVZWSXRTRmt5TlMx
  V1MxVlpMVWRFV0VFdFNrVktNeTFGVGpaTkxVWkZSCiAgRXdpTEFvZ0lDQWdJQ0FpV
  UhWaWJHbGpVR0Z5WVcxbGRHVnljeUk2SUhzS0lDQWdJQ0FnSUNBaVVIVmliR2wKIC
  BqUzJWNVJVTkVTQ0k2SUhzS0lDQWdJQ0FnSUNBZ0lDSmpjbllpT2lBaVdEUTBPQ0l
  zQ2lBZ0lDQWdJQ0FnSQogIENBaVVIVmliR2xqSWpvZ0lrSnlXVFJHZDJaa1REbHVl
  bWsyY0RNdGVUWnViamxoVDBkUE9YY3pNV05ZWnpCCiAgTlUwVlVlRzFmTkY5MlpXc
  EVPRmh4TUdnS0lDQkNWRVJQYWpoSVdtVk9kRWxUWDNGWlZERllVeTFaWjBFaWYKIC
  BYMTlMQW9nSUNBZ0lrSmhjMlZCZFhSb1pXNTBhV05oZEdsdmJpSTZJSHNLSUNBZ0l
  DQWdJbFZrWmlJNklDSgogIE5SRmhDTFU5TVVGUXRSRlpGU3kxUFFsZEtMVmxMV1RN
  dFZqY3lWQzFGUVRWS0lpd0tJQ0FnSUNBZ0lsQjFZCiAgbXhwWTFCaGNtRnRaWFJsY
  25NaU9pQjdDaUFnSUNBZ0lDQWdJbEIxWW14cFkwdGxlVVZEUkVnaU9pQjdDaUEKIC
  BnSUNBZ0lDQWdJQ0FpWTNKMklqb2dJbGcwTkRnaUxBb2dJQ0FnSUNBZ0lDQWdJbEI
  xWW14cFl5STZJQ0pIWgogIGxwR01WWjBOalZOTUVOdVdIYzFhVE5LYnpWbU1tYzVk
  akpTUnpWS2FHRlVTRlZ4ZUd4TlRFMU1aekY1WW5GCiAgTFl6VnpDaUFnVVVkMVJuQ
  mZhbDlrUlhweVdsWkRWVmR3YVVkU01TMUJJbjE5ZlN3S0lDQWdJQ0pDWVhObFUKIC
  AybG5ibUYwZFhKbElqb2dld29nSUNBZ0lDQWlWV1JtSWpvZ0lrMUJSa1l0VGpOSFZ
  5MUZVa05WTFVOSU5WYwogIHRWbEZQVFMwM1FWTkJMVVpFUTBvaUxBb2dJQ0FnSUNB
  aVVIVmliR2xqVUdGeVlXMWxkR1Z5Y3lJNklIc0tJCiAgQ0FnSUNBZ0lDQWlVSFZpY
  kdsalMyVjVSVU5FU0NJNklIc0tJQ0FnSUNBZ0lDQWdJQ0pqY25ZaU9pQWlSV1EKIC
  AwTkRnaUxBb2dJQ0FnSUNBZ0lDQWdJbEIxWW14cFl5STZJQ0p2ZVRSRFJqQkVSVUp
  zYUZaaGFraExaWGQ2VgogIFZOMGVXbFRkekV4ZVhCb2RYUTRiakJZZEVGYVVXcHdW
  VWhPZERVdE5XSmhDaUFnUkZwd2VqaFBNV3RCV0hkCiAgQ01IQnZhRWhZY0RGRU5Ib
  EJJbjE5ZlgxOSIsCiAgICAgIHsKICAgICAgICAic2lnbmF0dXJlcyI6IFt7CiAgIC
  AgICAgICAgICJhbGciOiAiUzUxMiIsCiAgICAgICAgICAgICJraWQiOiAiTURHVS1
  VNVQ2LTVTUlotM1M2SC1LVjVLLUZRVkUtU1JCSiIsCiAgICAgICAgICAgICJzaWdu
  YXR1cmUiOiAid0F3WUJQN0l1Tmg4MnA5dUtSSmlwdmRaR3hXZmxOZUl4MlNZeHdlc
  2ZOdklRN2RWSAogIHp5RmY5cnZ5eUlBTFpzcDZmVnphWFN3cXFpQTZSUWVXUUlBTU
  9oU3kyWm5oMUs1Yy1xQVRTQUpqcnVrZWptCiAgaFhtZUtjT0NIS1VudDJ5SXJ4QW9
  FY2xUZjBIenhmaU5iU2VvT3pqNEEifV0sCiAgICAgICAgIlBheWxvYWREaWdlc3Qi
  OiAiMlNXbDZHZlJZMjY0OVE3anRFWWtnUlJabFVwUi1sUEE3cmNsLXFyNjlFV3U2C
  iAgc3RIZ3VKZUQwck1OakU3NnJDQ3A1ZnpTWURpNUFaQndLVGpZcV80ckEifV0sCi
  AgICAiQ2xpZW50Tm9uY2UiOiAiQVVfd3BVa3VTb19iaWxnY0FKN0NxdyIsCiAgICA
  iUGluSWQiOiAiQURQTi1OVzJNLTdGVkQtRU43Qy1GREE3LUdCMzUtVE1ZWiIsCiAg
  ICAiUGluV2l0bmVzcyI6ICI0dHFzeTI3UEZOU0lxc3Z0aThSSHEwSU5EWEx6OWFkU
  nhJaWlZZ2IwdXd0dnFvWWEKICBjNFVaaHYybE5rTzhmMEE3WFRMVmFlUnBZLTc0Yz
  JsdVN5d0ZMUSIsCiAgICAiQWNjb3VudEFkZHJlc3MiOiAiYWxpY2VAZXhhbXBsZS5
  jb20ifX0"
      ],
    "ServerNonce":"8CS217pvOW72A3jMg71BKQ",
    "Witness":"2OAQ-RZZ5-P3BL-DAGR-7XKG-P3YQ-MBZQ"}}</sourcecode>
<t>Alice's administration device synchronizes to the service and receives the connection request acknowledgement from the service. Since the request is  authenticated by a PIN code that has been marked for automatic execution, the service can generate the assertions the device to participate in the account and appends the corresponding RespondConnection message to the local delivery  spool. </t>
<sourcecode>{
  "RespondConnection":{
    "MessageId":"MAHM-UAAV-Q3YT-DXZA-LTMO-IAXO-BBFH",
    "Result":"Accept",
    "CatalogedDevice":{
      "Udf":"MD2A-K4C3-SUNV-NQMW-4TPI-WPMV-B333",
      "DeviceUdf":"MDGU-U5T6-5SRZ-3S6H-KV5K-FQVE-SRBJ",
      "EnvelopedProfileUser":[{
          "EnvelopeID":"MCDH-FIPQ-XWI3-2MLS-KZ6U-SAVO-EVSH",
          "dig":"S512",
          "ContentMetaData":"ewogICJVbmlxdWVJRCI6ICJNQ0RILUZJUFEt
  WFdJMy0yTUxTLUtaNlUtU0FWTy1FVlNIIiwKICAiTWVzc2FnZVR5cGUiOiAiUHJvZ
  mlsZVVzZXIiLAogICJjdHkiOiAiYXBwbGljYXRpb24vbW1tL29iamVjdCIsCiAgIk
  NyZWF0ZWQiOiAiMjAyMC0xMS0wM1QwMTo1MDozOFoifQ"},
        "ewogICJQcm9maWxlVXNlciI6IHsKICAgICJQcm9maWxlU2lnbmF0dXJl
  IjogewogICAgICAiVWRmIjogIk1DREgtRklQUS1YV0kzLTJNTFMtS1o2VS1TQVZPL
  UVWU0giLAogICAgICAiUHVibGljUGFyYW1ldGVycyI6IHsKICAgICAgICAiUHVibG
  ljS2V5RUNESCI6IHsKICAgICAgICAgICJjcnYiOiAiRWQ0NDgiLAogICAgICAgICA
  gIlB1YmxpYyI6ICJoUUxJcWdOMEtRS3V4R18tSHRHV2JQQ0l1RlJvbG9UQno4c3My
  Wjltenh5VThQaEhsWE5zCiAgZG42d0VJNURsU1NkLXhEVFQ1RHFlLThBIn19fSwKI
  CAgICJBY2NvdW50QWRkcmVzcyI6ICJhbGljZUBleGFtcGxlLmNvbSIsCiAgICAiU2
  VydmljZVVkZiI6ICJNRFFPLVI2NkotTVZFTy1CREw2LVY2VDctRlBJSS1VNDJRIiw
  KICAgICJBY2NvdW50RW5jcnlwdGlvbiI6IHsKICAgICAgIlVkZiI6ICJNQ1NNLUpS
  Q08tRkRTRS1IVTJYLVJaNkItVFpWTy1FVVdHIiwKICAgICAgIlB1YmxpY1BhcmFtZ
  XRlcnMiOiB7CiAgICAgICAgIlB1YmxpY0tleUVDREgiOiB7CiAgICAgICAgICAiY3
  J2IjogIlg0NDgiLAogICAgICAgICAgIlB1YmxpYyI6ICIyOG1NTV90ZEFybmhsYWp
  tckF1WEtIQndYamdkVzdOYWVhTmlWYTFCQ1JDeUJBeDF0NDlKCiAgRUlRUFFBcGxi
  ZXp5YlllWkhMUHhjaVFBIn19fSwKICAgICJBZG1pbmlzdHJhdG9yU2lnbmF0dXJlI
  jogewogICAgICAiVWRmIjogIk1DREgtRklQUS1YV0kzLTJNTFMtS1o2VS1TQVZPLU
  VWU0giLAogICAgICAiUHVibGljUGFyYW1ldGVycyI6IHsKICAgICAgICAiUHVibGl
  jS2V5RUNESCI6IHsKICAgICAgICAgICJjcnYiOiAiRWQ0NDgiLAogICAgICAgICAg
  IlB1YmxpYyI6ICJoUUxJcWdOMEtRS3V4R18tSHRHV2JQQ0l1RlJvbG9UQno4c3MyW
  jltenh5VThQaEhsWE5zCiAgZG42d0VJNURsU1NkLXhEVFQ1RHFlLThBIn19fSwKIC
  AgICJBY2NvdW50QXV0aGVudGljYXRpb24iOiB7CiAgICAgICJVZGYiOiAiTURIVi1
  OTDVJLUZUTkUtTUVQUC1UM0xMLUdWMlAtM1BRSyIsCiAgICAgICJQdWJsaWNQYXJh
  bWV0ZXJzIjogewogICAgICAgICJQdWJsaWNLZXlFQ0RIIjogewogICAgICAgICAgI
  mNydiI6ICJYNDQ4IiwKICAgICAgICAgICJQdWJsaWMiOiAiOUttNXNQdjQtMkVYUD
  U1NDh4cmF5aXpyQXBZZVRzS3NSY0hySk8zaWdDbkw4OTB5X2lsQQogIG9qUmxhSi1
  CUFRHMzlBMFFHdE11bi04QSJ9fX0sCiAgICAiQWNjb3VudFNpZ25hdHVyZSI6IHsK
  ICAgICAgIlVkZiI6ICJNQllCLTNTS0ctU0lGUi1LRUZKLUREVUktWFVSTS1WRzZOI
  iwKICAgICAgIlB1YmxpY1BhcmFtZXRlcnMiOiB7CiAgICAgICAgIlB1YmxpY0tleU
  VDREgiOiB7CiAgICAgICAgICAiY3J2IjogIkVkNDQ4IiwKICAgICAgICAgICJQdWJ
  saWMiOiAiZUN1akU5SjU2Z242aC1HdkJwaERoejFxQjVQS1RTR21tamtpcUhGam1E
  cEEyN21DWmxLNAogIFBrR19taE9OX0N3NzFVWmFBaW9tamhDQSJ9fX19fQ",
        {
          "signatures":[{
              "alg":"S512",
              "kid":"MCDH-FIPQ-XWI3-2MLS-KZ6U-SAVO-EVSH",
              "signature":"hPWd3iRqTx5tn_VAcFOl5NFiUhiSvTQ2Yrt3lM
  UaZlgEAjJvjav7zwgB6SfVt59eaBG3cAI6z_iA2mi3eDP314lD8xxbOALJp3r02TT
  vMaxxGx1R_HdneReMZYlrO12YdllyI9w14mkQDBGtY1bn4QsA"}
            ],
          "PayloadDigest":"j3iRsYIUPzWOAE1qN2MyfSZXb3DrEnqhtttoa8
  BgpGgZJb_A-1Nxi9Vk-wzz7kEh30HuWsfh2mYdprmNpeJDfw"}
        ],
      "EnvelopedProfileDevice":[{
          "EnvelopeID":"MDGU-U5T6-5SRZ-3S6H-KV5K-FQVE-SRBJ",
          "dig":"S512",
          "ContentMetaData":"ewogICJVbmlxdWVJRCI6ICJNREdVLVU1VDYt
  NVNSWi0zUzZILUtWNUstRlFWRS1TUkJKIiwKICAiTWVzc2FnZVR5cGUiOiAiUHJvZ
  mlsZURldmljZSIsCiAgImN0eSI6ICJhcHBsaWNhdGlvbi9tbW0vb2JqZWN0IiwKIC
  AiQ3JlYXRlZCI6ICIyMDIwLTExLTAzVDAxOjUwOjQ1WiJ9"},
        "ewogICJQcm9maWxlRGV2aWNlIjogewogICAgIlByb2ZpbGVTaWduYXR1
  cmUiOiB7CiAgICAgICJVZGYiOiAiTURHVS1VNVQ2LTVTUlotM1M2SC1LVjVLLUZRV
  kUtU1JCSiIsCiAgICAgICJQdWJsaWNQYXJhbWV0ZXJzIjogewogICAgICAgICJQdW
  JsaWNLZXlFQ0RIIjogewogICAgICAgICAgImNydiI6ICJFZDQ0OCIsCiAgICAgICA
  gICAiUHVibGljIjogImdLTGU3MkhLUWYxSlhRTmE3SVJ6SEZLQVZJT3RpZDhTM2Ra
  NUFMTjF3eHdjWElaWmtQSGsKICBLZVZGZ0xfYVRONXd0U3c4MEdwVGRZNkEifX19L
  AogICAgIkJhc2VFbmNyeXB0aW9uIjogewogICAgICAiVWRmIjogIk1EVVItSFkyNS
  1WS1VZLUdEWEEtSkVKMy1FTjZNLUZFREwiLAogICAgICAiUHVibGljUGFyYW1ldGV
  ycyI6IHsKICAgICAgICAiUHVibGljS2V5RUNESCI6IHsKICAgICAgICAgICJjcnYi
  OiAiWDQ0OCIsCiAgICAgICAgICAiUHVibGljIjogIkJyWTRGd2ZkTDluemk2cDMte
  TZubjlhT0dPOXczMWNYZzBNU0VUeG1fNF92ZWpEOFhxMGgKICBCVERPajhIWmVOdE
  lTX3FZVDFYUy1ZZ0EifX19LAogICAgIkJhc2VBdXRoZW50aWNhdGlvbiI6IHsKICA
  gICAgIlVkZiI6ICJNRFhCLU9MUFQtRFZFSy1PQldKLVlLWTMtVjcyVC1FQTVKIiwK
  ICAgICAgIlB1YmxpY1BhcmFtZXRlcnMiOiB7CiAgICAgICAgIlB1YmxpY0tleUVDR
  EgiOiB7CiAgICAgICAgICAiY3J2IjogIlg0NDgiLAogICAgICAgICAgIlB1YmxpYy
  I6ICJHZlpGMVZ0NjVNMENuWHc1aTNKbzVmMmc5djJSRzVKaGFUSFVxeGxNTE1MZzF
  5YnFLYzVzCiAgUUd1RnBfal9kRXpyWlZDVVdwaUdSMS1BIn19fSwKICAgICJCYXNl
  U2lnbmF0dXJlIjogewogICAgICAiVWRmIjogIk1BRkYtTjNHVy1FUkNVLUNINVctV
  lFPTS03QVNBLUZEQ0oiLAogICAgICAiUHVibGljUGFyYW1ldGVycyI6IHsKICAgIC
  AgICAiUHVibGljS2V5RUNESCI6IHsKICAgICAgICAgICJjcnYiOiAiRWQ0NDgiLAo
  gICAgICAgICAgIlB1YmxpYyI6ICJveTRDRjBERUJsaFZhakhLZXd6VVN0eWlTdzEx
  eXBodXQ4bjBYdEFaUWpwVUhOdDUtNWJhCiAgRFpwejhPMWtBWHdCMHBvaEhYcDFEN
  HlBIn19fX19",
        {
          "signatures":[{
              "alg":"S512",
              "kid":"MDGU-U5T6-5SRZ-3S6H-KV5K-FQVE-SRBJ",
              "signature":"wAwYBP7IuNh82p9uKRJipvdZGxWflNeIx2SYxw
  esfNvIQ7dVHzyFf9rvyyIALZsp6fVzaXSwqqiA6RQeWQIAMOhSy2Znh1K5c-qATSA
  JjrukejmhXmeKcOCHKUnt2yIrxAoEclTf0HzxfiNbSeoOzj4A"}
            ],
          "PayloadDigest":"2SWl6GfRY2649Q7jtEYkgRRZlUpR-lPA7rcl-q
  r69EWu6stHguJeD0rMNjE76rCCp5fzSYDi5AZBwKTjYq_4rA"}
        ],
      "EnvelopedConnectionUser":[{
          "dig":"S512",
          "ContentMetaData":"ewogICJNZXNzYWdlVHlwZSI6ICJDb25uZWN0
  aW9uRGV2aWNlIiwKICAiY3R5IjogImFwcGxpY2F0aW9uL21tbS9vYmplY3QiLAogI
  CJDcmVhdGVkIjogIjIwMjAtMTEtMDNUMDE6NTA6NDVaIn0"},
        "ewogICJDb25uZWN0aW9uRGV2aWNlIjogewogICAgIkRldmljZVNpZ25h
  dHVyZSI6IHsKICAgICAgIlVkZiI6ICJNQkhGLUdXSzItNktVTC1BNE1CLTI3SlMtU
  1k3My1DTFNIIiwKICAgICAgIlB1YmxpY1BhcmFtZXRlcnMiOiB7CiAgICAgICAgIl
  B1YmxpY0tleUVDREgiOiB7CiAgICAgICAgICAiY3J2IjogIkVkNDQ4IiwKICAgICA
  gICAgICJQdWJsaWMiOiAibkM3ek5yUDgyUnkwdkxaSGdDeF92bGlqTHdDam8yTUZJ
  eVpUMGcxbmk4dEh0N0p4TDhNLQogIDlzNmNPX3FPUnRWMkVpOW04UzM3MEl3QSJ9f
  X0sCiAgICAiRGV2aWNlRW5jcnlwdGlvbiI6IHsKICAgICAgIlVkZiI6ICJNQU40LV
  JPVU0tUU1GNS1WS09OLU5IRzItT1NMVS1DS05HIiwKICAgICAgIlB1YmxpY1BhcmF
  tZXRlcnMiOiB7CiAgICAgICAgIlB1YmxpY0tleUVDREgiOiB7CiAgICAgICAgICAi
  Y3J2IjogIlg0NDgiLAogICAgICAgICAgIlB1YmxpYyI6ICItcWEwczdTYnlYOG5QQ
  XFKdjVCUk5RaDN0S21IU25UamFrRlVNZWE0a3dEaHAzZU92TEd4CiAgdUJOZzBhY0
  lQZzZCQjN3NjJ6SzdTVzZBIn19fSwKICAgICJEZXZpY2VBdXRoZW50aWNhdGlvbiI
  6IHsKICAgICAgIlVkZiI6ICJNQUZNLUtNUkQtNUNXVS1ZR1RILVY1S1YtWlpGUC1O
  U0pZIiwKICAgICAgIlB1YmxpY1BhcmFtZXRlcnMiOiB7CiAgICAgICAgIlB1YmxpY
  0tleUVDREgiOiB7CiAgICAgICAgICAiY3J2IjogIlg0NDgiLAogICAgICAgICAgIl
  B1YmxpYyI6ICJaQ0RncEZNNGdPNUxTMEI1b21ncXJ2ZUpVeWJ5TWdFTVVWZTZMUkQ
  wRmpCejljWERQdFUzCiAgak9MNnRNS2ZqYklQNEFKeS1qQ0pMdlFBIn19fX19",
        {
          "signatures":[{
              "alg":"S512",
              "kid":"MCCS-PUBP-DRFI-3WKI-7O2T-7XBK-5E5H",
              "signature":"173Om1h4ZlI5KiQ8cQgqNIn5iiiduBX3qngCay
  rFtQdeoRrt8QRY_E04ob-BD74pklveyLHaXHWAohgMXgtlDGDvtVOFrhn5yqUlAcS
  998exhjjO7Fysb8VtUbzADmGxGVOhRH5YOZegIU7rVhVOgigA"}
            ],
          "PayloadDigest":"YbllV_0OI_pJn3TZHWzcUz13M2WAeXkRlZT6HL
  2jzmOlPmb8hDGxxe6TFSpmEVY7XUfhAi6kPrbYgj-4lc7vsg"}
        ],
      "EnvelopedActivationDevice":[{
          "enc":"A256CBC",
          "dig":"S512",
          "kid":"EBQE-KGR6-NIZM-IKBK-ULWS-RTZK-GQZZ",
          "Salt":"4tj4IHw4GMFs8biZoNEsCA",
          "recipients":[{
              "kid":"MDUR-HY25-VKUY-GDXA-JEJ3-EN6M-FEDL",
              "epk":{
                "PublicKeyECDH":{
                  "crv":"X448",
                  "Public":"-iseCGLiyKvvnflm6dkQIDMPdUHhOFRrgTZxP
  0NGXH0oKR0omezbyOzNAaG8A7GzI-KSNvjLmcOA"}},
              "wmk":"5dw1s6It1OlqV2vfJbelyQ3hksgR9QiBBoPKbH7VCiIj
  lcwhuTHn0w"}
            ],
          "ContentMetaData":"ewogICJNZXNzYWdlVHlwZSI6ICJBY3RpdmF0
  aW9uRGV2aWNlIiwKICAiY3R5IjogImFwcGxpY2F0aW9uL21tbS9vYmplY3QiLAogI
  CJDcmVhdGVkIjogIjIwMjAtMTEtMDNUMDE6NTA6NDVaIn0"},
        "OWuAg6Xm0Eud6G62HzHz0yMVQgSpsQDbeC7Eo7oHfo6yKxtjLarBzBnJ
  sOimHOFKgm2Rn68ZVvY-t31rx0BggtxdVF3zcfUf6zVIJxWJ8C5nND1TUkHyqjJt6
  sy8fCJyMXhILrFAiOpJrwYlYnwDU_zLmi2koIHNQ2pPrm_4aqUfXoXSmWBnszl-N0
  OhgSKpmRSv9aHlvopS_s99TmCV6lItToXnYs3L5Cqi-T1Q3Nu0zM3H8ArIJ5eh5uV
  s6-sn",
        {
          "signatures":[{
              "alg":"S512",
              "kid":"MCCS-PUBP-DRFI-3WKI-7O2T-7XBK-5E5H",
              "signature":"mB5AHR1vh-aPs9KQBkvlKd1AMg2uplrCQ7mER_
  glOBRNyVd24O1XxKV-xDlwcNDcwfPmTJ-3DkyA_eCWLZu8t2Gq7C0LUsF_SUFpmw8
  lPAasMD_pNiAnoZF44-eAinM-SbhjpEFltdP7jh4pzn-cuywA",
              "witness":"DxKjIIu7fos_2S-x3mX1FRTPYPTFckxBR4G_iLex
  rnQ"}
            ],
          "PayloadDigest":"yABfny6laTKreLckSpcK63t-En2jyYnvyRHkDO
  53B1bdOxQ5iagb2ua7NcL0hGKxgDPTwjdiFwSPXCbRuPIy1g"}
        ],
      "EnvelopedActivationAccount":[{
          "dig":"S512",
          "ContentMetaData":"ewogICJNZXNzYWdlVHlwZSI6ICJBY3RpdmF0
  aW9uQWNjb3VudCIsCiAgImN0eSI6ICJhcHBsaWNhdGlvbi9tbW0vb2JqZWN0IiwKI
  CAiQ3JlYXRlZCI6ICIyMDIwLTExLTAzVDAxOjUwOjQ1WiJ9"},
        "ewogICJBY3RpdmF0aW9uQWNjb3VudCI6IHt9fQ",
        {
          "signatures":[{
              "alg":"S512",
              "kid":"MCCS-PUBP-DRFI-3WKI-7O2T-7XBK-5E5H",
              "signature":"2PD98zPN4k_QdO8AbaJNlh56CaCFg3qej5LQer
  8ab6NDlPE5FvTF10gedJk67M0suNZBwJ28PBiAsgMIrtHOqxi7sJBqsQrYCJCj_nE
  8QUcQEEiiRi2d31w3pQ2dk0GvCrk-f27aLfzBRX8GWZDPtjIA"}
            ],
          "PayloadDigest":"xgR5j7NiUbDvKWjP7IjI4HuMAPLD8-ru3cMITm
  gIiPuX9gh1llky1cgZPc1zU0wwYGKucV6mGegsV5wg7ZGYoA"}
        ]}}}</sourcecode>
</section>
<section title="Contact" anchor="n-contact-0"><t>A contact request presents a proposed contact entry and requests that it be added to the Contacts catalog of the specified Mesh Service Account. A contact request is usually sent by the party requesting that their contact be added but this is not necessarily the case.</t>
<t>The MessageContact contains a DARE Envelope containing the Contact information of the requester. If the request is accepted, this information will be added to the contact catalog of the relevant account. If the Reply field has the value 'true', this indicates that the sender is asking for the recipient to return their own credentials in reply.</t>
<t>Since the sender requires the user's contact information before the request can be made, the MessageContact message <bcp14>MAY</bcp14> be encrypted under either the user's account encryption key (if known) or the Mesh Service encryption key (which may be obtained from the service on request.</t>
<t>Bob asks Alice to send her contact details and sends his. </t>
<sourcecode>{
  "MessageContact":{
    "MessageId":"NAEZ-UOXO-KBH7-MT7I-KKA2-S37A-RGEZ",
    "Sender":"bob@example.com",
    "Recipient":"alice@example.com",
    "AuthenticatedData":[{
        "dig":"S512",
        "ContentMetaData":"ewogICJNZXNzYWdlVHlwZSI6ICJDb250YWN0UG
  Vyc29uIiwKICAiY3R5IjogImFwcGxpY2F0aW9uL21tbS9vYmplY3QiLAogICJDcmV
  hdGVkIjogIjIwMjAtMTEtMDNUMDE6NTA6NDJaIn0"},
      "ewogICJDb250YWN0UGVyc29uIjogewogICAgIkFuY2hvcnMiOiBbewogIC
  AgICAgICJVZGYiOiAiTUNZVS1JTzJGLUpGRkItM0xDTi1VVVJELUFJNVUtNllJSiI
  sCiAgICAgICAgIlZhbGlkYXRpb24iOiAiU2VsZiJ9XSwKICAgICJOZXR3b3JrQWRk
  cmVzc2VzIjogW3sKICAgICAgICAiQWRkcmVzcyI6ICJib2JAZXhhbXBsZS5jb20iL
  AogICAgICAgICJFbnZlbG9wZWRQcm9maWxlQWNjb3VudCI6IFt7CiAgICAgICAgIC
  AgICJFbnZlbG9wZUlEIjogIk1DWVUtSU8yRi1KRkZCLTNMQ04tVVVSRC1BSTVVLTZ
  ZSUoiLAogICAgICAgICAgICAiZGlnIjogIlM1MTIiLAogICAgICAgICAgICAiQ29u
  dGVudE1ldGFEYXRhIjogImV3b2dJQ0pWYm1seGRXVkpSQ0k2SUNKTlExbFZMVWxQT
  WtZdFNrWkdRaTAKICB6VEVOT0xWVlZVa1F0UVVrMVZTMDJXVWxLSWl3S0lDQWlUV1
  Z6YzJGblpWUjVjR1VpT2lBaVVISnZabWxzWgogIFZWelpYSWlMQW9nSUNKamRIa2l
  PaUFpWVhCd2JHbGpZWFJwYjI0dmJXMXRMMjlpYW1WamRDSXNDaUFnSWtOCiAgeVpX
  RjBaV1FpT2lBaU1qQXlNQzB4TVMwd00xUXdNVG8xTURvME1sb2lmUSJ9LAogICAgI
  CAgICAgImV3b2dJQ0pRY205bWFXeGxWWE5sY2lJNklIc0tJQ0FnSUNKUWNtOW1hV3
  gKICBsVTJsbmJtRjBkWEpsSWpvZ2V3b2dJQ0FnSUNBaVZXUm1Jam9nSWsxRFdWVXR
  TVTh5UmkxS1JrWkNMVE5NUQogIDA0dFZWVlNSQzFCU1RWVkxUWlpTVW9pTEFvZ0lD
  QWdJQ0FpVUhWaWJHbGpVR0Z5WVcxbGRHVnljeUk2SUhzCiAgS0lDQWdJQ0FnSUNBa
  VVIVmliR2xqUzJWNVJVTkVTQ0k2SUhzS0lDQWdJQ0FnSUNBZ0lDSmpjbllpT2lBaV
  IKICBXUTBORGdpTEFvZ0lDQWdJQ0FnSUNBZ0lsQjFZbXhwWXlJNklDSjJVbGRvYlh
  OTFJGcEVWV0poWlZKbFNVTgogIExjWEIzUzFReFNHWnhTSGszTWxWNFJFdDZaMVpz
  VG5sTk4zWkxkalphWVVkVUNpQWdhVkZzTW1OSFVtTTBUCiAgbkJKUkdSek1tVkphb
  XBOYUZGQkluMTlmU3dLSUNBZ0lDSkJZMk52ZFc1MFFXUmtjbVZ6Y3lJNklDSmliMk
  oKICBBWlhoaGJYQnNaUzVqYjIwaUxBb2dJQ0FnSWxObGNuWnBZMlZWWkdZaU9pQWl
  UVVJSVHkxU05qWktMVTFXUgogIFU4dFFrUk1OaTFXTmxRM0xVWlFTVWt0VlRReVVT
  SXNDaUFnSUNBaVFXTmpiM1Z1ZEVWdVkzSjVjSFJwYjI0CiAgaU9pQjdDaUFnSUNBZ
  0lDSlZaR1lpT2lBaVRVRkdVUzAyU0U5Q0xVeENSRlV0V1ZCUVVDMWFWRnBDTFRJMV
  UKICBWTXRWVWhKVHlJc0NpQWdJQ0FnSUNKUWRXSnNhV05RWVhKaGJXVjBaWEp6SWp
  vZ2V3b2dJQ0FnSUNBZ0lDSgogIFFkV0pzYVdOTFpYbEZRMFJJSWpvZ2V3b2dJQ0Fn
  SUNBZ0lDQWdJbU55ZGlJNklDSllORFE0SWl3S0lDQWdJCiAgQ0FnSUNBZ0lDSlFkV
  0pzYVdNaU9pQWlZbVJGVlZJd1NXaEZiMWRWYTBKeWRIQllXazFYWDI1dFdYZGxTbm
  gKICBsVlRoMFQwTkViVVpxTVdaclpHNXRNbTVvWm5CR1V3b2dJRmhOY0RVME9HOWx
  TV3RRYUhreFJDMXBjbmx6UwogIFdsSFFTSjlmWDBzQ2lBZ0lDQWlRV1J0YVc1cGMz
  UnlZWFJ2Y2xOcFoyNWhkSFZ5WlNJNklIc0tJQ0FnSUNBCiAgZ0lsVmtaaUk2SUNKT
  lExbFZMVWxQTWtZdFNrWkdRaTB6VEVOT0xWVlZVa1F0UVVrMVZTMDJXVWxLSWl3S0
  kKICBDQWdJQ0FnSWxCMVlteHBZMUJoY21GdFpYUmxjbk1pT2lCN0NpQWdJQ0FnSUN
  BZ0lsQjFZbXhwWTB0bGVVVgogIERSRWdpT2lCN0NpQWdJQ0FnSUNBZ0lDQWlZM0oy
  SWpvZ0lrVmtORFE0SWl3S0lDQWdJQ0FnSUNBZ0lDSlFkCiAgV0pzYVdNaU9pQWlkb
  EpYYUcxelMwUmFSRlZpWVdWU1pVbERTM0Z3ZDB0VU1VaG1jVWg1TnpKVmVFUkxlbW
  QKICBXYkU1NVRUZDJTM1kyV21GSFZBb2dJR2xSYkRKalIxSmpORTV3U1VSa2N6Smx
  TV3BxVFdoUlFTSjlmWDBzQwogIGlBZ0lDQWlRV05qYjNWdWRFRjFkR2hsYm5ScFky
  RjBhVzl1SWpvZ2V3b2dJQ0FnSUNBaVZXUm1Jam9nSWsxCiAgQlZsY3RNalZXVEMxT
  1dVcEpMVFZEUXpNdFZGQk5XaTFETlZaR0xWUkJOa1lpTEFvZ0lDQWdJQ0FpVUhWaW
  IKICBHbGpVR0Z5WVcxbGRHVnljeUk2SUhzS0lDQWdJQ0FnSUNBaVVIVmliR2xqUzJ
  WNVJVTkVTQ0k2SUhzS0lDQQogIGdJQ0FnSUNBZ0lDSmpjbllpT2lBaVdEUTBPQ0lz
  Q2lBZ0lDQWdJQ0FnSUNBaVVIVmliR2xqSWpvZ0ltVTNVCiAgamxpVGxwQ1VuZHNla
  mxSU0RSWmEwRjVibVJUVkVwWFRYVk9kSE41YVhWc2FFaDNVMGh1VERKUFFYSkhkMl
  IKICB2ZGxJS0lDQlBUVEJ6UlUxWFFVYzNRa0pRVUVKSFNEbFdZV1Y1YVVFaWZYMTl
  MQW9nSUNBZ0lrRmpZMjkxYgogIG5SVGFXZHVZWFIxY21VaU9pQjdDaUFnSUNBZ0lD
  SlZaR1lpT2lBaVRVRTBWeTFUTTFWV0xVSTNVMVV0VUVwCiAgR1FTMVhVRW8yTFRWR
  FVGTXRNekpETnlJc0NpQWdJQ0FnSUNKUWRXSnNhV05RWVhKaGJXVjBaWEp6SWpvZ2
  UKICB3b2dJQ0FnSUNBZ0lDSlFkV0pzYVdOTFpYbEZRMFJJSWpvZ2V3b2dJQ0FnSUN
  BZ0lDQWdJbU55ZGlJNklDSgogIEZaRFEwT0NJc0NpQWdJQ0FnSUNBZ0lDQWlVSFZp
  Ykdsaklqb2dJa2wwWTE4MU4wNTZSREZyYVZoWlozbFZYCiAgM2M1Y0dGQk1YaHpkR
  Th3VWpjdFlubDBaa3RGWjNBeFZHbEZURk5wUmxaNGVXa0tJQ0JuZEhFeVV6a3lVaz
  EKICBJVmpRMFZFdDZiR3R3WDNSM1FVRWlmWDE5ZlgwIiwKICAgICAgICAgIHsKICA
  gICAgICAgICAgInNpZ25hdHVyZXMiOiBbewogICAgICAgICAgICAgICAgImFsZyI6
  ICJTNTEyIiwKICAgICAgICAgICAgICAgICJraWQiOiAiTUNZVS1JTzJGLUpGRkItM
  0xDTi1VVVJELUFJNVUtNllJSiIsCiAgICAgICAgICAgICAgICAic2lnbmF0dXJlIj
  ogIm1uWlZieTQ3RHVQdWhRTGR0dTQ1eUxRdllkNGNGM2dVT29UeXI0M0JQS2ptajN
  DSkMKICAwWHNudkcyNDdwcEw3eTVoUGtsVWI0NDRabUFpRGNpUHF6REtkUFZFY2VP
  N2R1cjFTb0Y1bV9Fa3NtSWxmNgogIEtPZlN3aHdpdHJDNXh6V01KTUdJWndNd2pfb
  mpSMmdsTGFwMmN5QnNBIn1dLAogICAgICAgICAgICAiUGF5bG9hZERpZ2VzdCI6IC
  J0UUltenFEdENIZkpRN2sxcTFvZzhQazMzcVNjb3NVNW1hdWppT3A0WHNDY2UKICB
  lNzJHM2M3Qm1BQmVidTRTMnZBaUVwUy15YmtDTUVFeUJkNXJxOVpQZyJ9XSwKICAg
  ICAgICAiUHJvdG9jb2xzIjogW3sKICAgICAgICAgICAgIlByb3RvY29sIjogIm1tb
  SJ9XX1dfX0",
      {
        "signatures":[{
            "alg":"S512",
            "kid":"MA4W-S3UV-B7SU-PJFA-WPJ6-5CPS-32C7",
            "signature":"Q94QMOeb4cGA96lu_PhlVgV3hB5dzXocBETMEZxP
  9N_X2qHVxlxZJqZBkXhdCFtN8pa9EKtYcF2ADNSs9GlkrsuOjXXAp_MLaFDdOYLOW
  MG22la68_nEV1lP9wX8jLOy2_Mhn5rBVISC0XRBFzUR1zMA"}
          ],
        "PayloadDigest":"kDQqkQFFp1vnlyendI8xdpS7k8Ut2zZPj1zZrx5e
  R7oQW3fURoEsautn3fG-DgaQ2Xb-A2ZrZaB87WNsSBW_zA"}
      ],
    "Reply":true,
    "Subject":"alice@example.com",
    "PIN":"AADZ-27RV-SGJA-5LIO-GHVA-2QPC-ORRA"}}</sourcecode>
<t>Alice responds with her own contact information. Since she already has Bob's contact information, there is no need to request a response or provide a PIN code.</t>
<t>The current protocol assumes that all contact management will be performed end-to-end through the Mesh Services themselves. If the number of Mesh users were to become exceptionally large, additional infrastructure to facilitate contact management will be required. These topics are discussed at a high level in <xref target="draft-hallambaker-mesh-trust"></xref>.</t>
<t>In situations where a user is well known and has a very large number of contacts, they are likely to make use of a tiered approach to contact management in which they keep separate accounts for their 'public' and 'restricted' personas and delegate management of their public account to a subordinate or to their Mesh Service provider.</t>
</section>
<section title="Confirmation" anchor="n-confirmation"><t>Confirmation messages are used to provide an improved form of second factor authentication capability. </t>
<t>Two confirmation messages are specified, a request and response.</t>
<t>A confirmation request is initiated by sending a <tt>MessageConfirmationRequest</tt> to the Mesh Service hosting the recipient Mesh Service Account. The request specifies the question that is to be put to the user.</t>
<t>To respond to a confirmation request, a user generates a <tt>MessageConfirmationResponse</tt>. This <bcp14>MUST</bcp14> be signed by a device authorized to respond to confirmation requests by a Device Connection Assertion with the <tt>Confirmation</tt> privilege.</t>
<t>The console generates a confirmation request message: </t>
<sourcecode>{
  "RequestConfirmation":{
    "MessageId":"NA3M-FCCF-P67J-CHXN-NUYJ-X267-RCH5",
    "Sender":"console@example.com",
    "Recipient":"alice@example.com",
    "Text":"start"}}</sourcecode>
<t>Alice accepts the request and returns a ResponseConfirmation confirmation containing both the request and the response: </t>
<sourcecode>Missing example 91</sourcecode>
</section>
</section>
<section title="Publications" anchor="n-publications"><t>Static QR codes <bcp14>MAY</bcp14> be used to allow contact exchange or device connection. In either case, the QR code contains an EARL providing the means of locating, decrypting and authenticating the published data. </t>
<section title="Contact Exchange" anchor="n-contact-exchange"><t>When used for contact exchange, the envelope payload is a CatalogedContact record.</t>
<t>Besides allowing for exchange of contact information on a business card, a user might have their contact information printed on personal property to facilitate return of lost property.</t>
</section>
<section title="Device Preconfiguration" anchor="n-device-preconfiguration"><t>The static QR code device connection interaction allows a device with no keyboard, display or other user affordances to be connected to a Mesh account.</t>
<t>The information necessary to establish communication with the device and to complete a device connection workflow is provided by means of a DevicePreconfiguration record accessed by means of an EARL.</t>
<t>For example, Alice's coffee pot was preconfigured for connection to a Mesh account at the factory and the following DevicePreconfiguration record created:</t>
<sourcecode>{
  "DevicePreconfiguration":{
    "EnvelopedProfileDevice":[{
        "EnvelopeID":"MC67-GVFM-B45X-D6AS-YAVS-TJ57-UKVY",
        "dig":"S512",
        "ContentMetaData":"ewogICJVbmlxdWVJRCI6ICJNQzY3LUdWRk0tQj
  Q1WC1ENkFTLVlBVlMtVEo1Ny1VS1ZZIiwKICAiTWVzc2FnZVR5cGUiOiAiUHJvZml
  sZURldmljZSIsCiAgImN0eSI6ICJhcHBsaWNhdGlvbi9tbW0vb2JqZWN0IiwKICAi
  Q3JlYXRlZCI6ICIyMDIwLTExLTAzVDAxOjUwOjQ3WiJ9"},
      "ewogICJQcm9maWxlRGV2aWNlIjogewogICAgIlByb2ZpbGVTaWduYXR1cm
  UiOiB7CiAgICAgICJVZGYiOiAiTUM2Ny1HVkZNLUI0NVgtRDZBUy1ZQVZTLVRKNTc
  tVUtWWSIsCiAgICAgICJQdWJsaWNQYXJhbWV0ZXJzIjogewogICAgICAgICJQdWJs
  aWNLZXlFQ0RIIjogewogICAgICAgICAgImNydiI6ICJFZDQ0OCIsCiAgICAgICAgI
  CAiUHVibGljIjogIk9kVHpOWnJUMWZHTnAzNzBDNEx1UVhHWUpJUFZiMmJSclRQcT
  I4SkNfU1hlNjNkeUphM24KICBScFZ5cjRleEYxcElGRTBXYWVNQlB0QUEifX19LAo
  gICAgIkJhc2VFbmNyeXB0aW9uIjogewogICAgICAiVWRmIjogIk1DWkUtWjdIQS1N
  Q0lMLTcyVVMtVkZGTC1RRklCLUFFNDciLAogICAgICAiUHVibGljUGFyYW1ldGVyc
  yI6IHsKICAgICAgICAiUHVibGljS2V5RUNESCI6IHsKICAgICAgICAgICJjcnYiOi
  AiWDQ0OCIsCiAgICAgICAgICAiUHVibGljIjogInBTemZIeHhkckY2QzZ4dHdyN0h
  nd0RxdTVDVmZOaDNvMkxGUzl0NnI2b0dYVE5NSnlpeWsKICAwbjR6Sl9JVXc5TDls
  MWk4R0puUF9JeUEifX19LAogICAgIkJhc2VBdXRoZW50aWNhdGlvbiI6IHsKICAgI
  CAgIlVkZiI6ICJNQVBVLU9DRFMtMjdaSC1UN0dCLU5UNjItWUVBWS1OTDM3IiwKIC
  AgICAgIlB1YmxpY1BhcmFtZXRlcnMiOiB7CiAgICAgICAgIlB1YmxpY0tleUVDREg
  iOiB7CiAgICAgICAgICAiY3J2IjogIlg0NDgiLAogICAgICAgICAgIlB1YmxpYyI6
  ICJBaGtacWdOb2JNMFBjbFl1Qlk2M3dVSjhVLVRnb2ZQSEp1R2ZscjRobGstU1hCV
  FlFdUhECiAgODFFd1RvSUtvTVNRbXkzMUhzVXV6YU1BIn19fSwKICAgICJCYXNlU2
  lnbmF0dXJlIjogewogICAgICAiVWRmIjogIk1CTkstQ0ZYRi1TNTdXLUdGVlEtSE8
  1SC1CQkpPLVQ0SkQiLAogICAgICAiUHVibGljUGFyYW1ldGVycyI6IHsKICAgICAg
  ICAiUHVibGljS2V5RUNESCI6IHsKICAgICAgICAgICJjcnYiOiAiRWQ0NDgiLAogI
  CAgICAgICAgIlB1YmxpYyI6ICJLRkVBclgwZThsMHpfSGtteE9uZVlXa3oyQ3NueG
  NqaG1QUjV0UjVPeGRJU20yQjQwNzVQCiAganQ2YnZoY1h3Z1BQNkRjZGFsTC1NTjB
  BIn19fX19",
      {
        "signatures":[{
            "alg":"S512",
            "kid":"MC67-GVFM-B45X-D6AS-YAVS-TJ57-UKVY",
            "signature":"S84XRCL44RpT_hGxrLEG9PzoyWHu7GZQpYmuMyAO
  I2UPrUWbj03fSxloEh-xld82eaRQSnybPbEAAvCEfFQIoDYchaKvNgD0mGEOWk8XD
  ZfRGd4ZLZbi1uBv4l6h4u6bSrfgzjoDW5tW4IhxKg6wFRIA"}
          ],
        "PayloadDigest":"_nb8duNIPDGJT3HWXSC1mj56zqIvvqIpA6TLyjBT
  DFf0hzmteInfDIfKJhtZL8SPKpLabKVf3VaEt_hU_vAS-Q"}
      ],
    "EnvelopedConnectionDevice":[{
        "dig":"S512",
        "ContentMetaData":"ewogICJNZXNzYWdlVHlwZSI6ICJDb25uZWN0aW
  9uRGV2aWNlIiwKICAiY3R5IjogImFwcGxpY2F0aW9uL21tbS9vYmplY3QiLAogICJ
  DcmVhdGVkIjogIjIwMjAtMTEtMDNUMDE6NTA6NDdaIn0"},
      "ewogICJDb25uZWN0aW9uRGV2aWNlIjogewogICAgIkRldmljZVNpZ25hdH
  VyZSI6IHsKICAgICAgIlVkZiI6ICJNQk5LLUNGWEYtUzU3Vy1HRlZRLUhPNUgtQkJ
  KTy1UNEpEIiwKICAgICAgIlB1YmxpY1BhcmFtZXRlcnMiOiB7CiAgICAgICAgIlB1
  YmxpY0tleUVDREgiOiB7CiAgICAgICAgICAiY3J2IjogIkVkNDQ4IiwKICAgICAgI
  CAgICJQdWJsaWMiOiAiS0ZFQXJYMGU4bDB6X0hrbXhPbmVZV2t6MkNzbnhjamhtUF
  I1dFI1T3hkSVNtMkI0MDc1UAogIGp0NmJ2aGNYd2dQUDZEY2RhbEwtTU4wQSJ9fX0
  sCiAgICAiRGV2aWNlRW5jcnlwdGlvbiI6IHsKICAgICAgIlVkZiI6ICJNQ1pFLVo3
  SEEtTUNJTC03MlVTLVZGRkwtUUZJQi1BRTQ3IiwKICAgICAgIlB1YmxpY1BhcmFtZ
  XRlcnMiOiB7CiAgICAgICAgIlB1YmxpY0tleUVDREgiOiB7CiAgICAgICAgICAiY3
  J2IjogIlg0NDgiLAogICAgICAgICAgIlB1YmxpYyI6ICJwU3pmSHh4ZHJGNkM2eHR
  3cjdIZ3dEcXU1Q1ZmTmgzbzJMRlM5dDZyNm9HWFROTUp5aXlrCiAgMG40ekpfSVV3
  OUw5bDFpOEdKblBfSXlBIn19fSwKICAgICJEZXZpY2VBdXRoZW50aWNhdGlvbiI6I
  HsKICAgICAgIlVkZiI6ICJNQ1pFLVo3SEEtTUNJTC03MlVTLVZGRkwtUUZJQi1BRT
  Q3IiwKICAgICAgIlB1YmxpY1BhcmFtZXRlcnMiOiB7CiAgICAgICAgIlB1YmxpY0t
  leUVDREgiOiB7CiAgICAgICAgICAiY3J2IjogIlg0NDgiLAogICAgICAgICAgIlB1
  YmxpYyI6ICJwU3pmSHh4ZHJGNkM2eHR3cjdIZ3dEcXU1Q1ZmTmgzbzJMRlM5dDZyN
  m9HWFROTUp5aXlrCiAgMG40ekpfSVV3OUw5bDFpOEdKblBfSXlBIn19fX19",
      {
        "signatures":[{
            "alg":"S512",
            "kid":"MC75-25RX-TCZ7-BVJW-ZIKQ-57Q3-EPKS",
            "signature":"-GWtfXbOMZrvJDC3Qaw2ag4nI4W02lpK06GiEGiH
  03SFvhUO6xPqL87RxPJ8YPfPsgSkN3L7n0AAJkYqEa75fxCNd3mNg4xU1-0GGIzx4
  eDoRcLButgdxxr4FmR6Pny-HgtecIVyKo1bCGhgtNviXAgA"}
          ],
        "PayloadDigest":"mp98W45jPnTo579iwhW6Xh4CgoOyEuTtymAhFgVb
  55dgLg2NLwf3kYShR-CTlXnnfIITyFmBav7ItfJCYe7OqQ"}
      ],
    "PrivateKey":{
      "PrivateKeyUDF":{
        "PrivateValue":"ZAAQ-AGWA-OA2N-4YTE-LVH6-TM26-WVHO-35CJ-TOY
F-NUJZ-7D4V-IGUP-SF3P-M6T3",
        "KeyType":"MeshProfileDevice"}},
    "ConnectUri":"mcu://maker@example.com/EAQ6-22WS-DZIL-56OT-X4Q4-
KMBW-MY6D-4K6O-6FWB-UQB7-5DZ4-PZHX-JQ5H-Q"}}</sourcecode>
<t>To connect to the coffee pot, Alice first scans the QR code with her administrative device which uses the PIN code and service to retrieve, decrypt and authenticate the DevicePreconfiguration record. Future versions of the specification will allow this record to specify means by which the administration device can establish direct peer-to-peer communication to complete the connection process by any communication modality supported by both devices (e.g. IR, Bluetooth, WiFi-Direct, etc.)</t>
</section>
</section>
<section title="Schema" anchor="n-schema"><section title="Shared Classes" anchor="n-shared-classes-"><t>The following classes are used as common elements in Mesh profile specifications. </t>
<section title="Classes describing keys" anchor="n-classes-describing-keys-"></section>
<section title="Structure: KeyData" anchor="n-structure-keydata-"><t>The KeyData class is used to describe public key pairs and  trust assertions associated with a public key. </t>
<dl>
<dt>Udf: String (Optional) </dt>
<dd>
<t>UDF fingerprint of the public key parameters </t>
</dd>
<dt>X509Certificate: Binary (Optional) </dt>
<dd>
<t>List of X.509 Certificates </t>
</dd>
<dt>X509Chain: Binary [0..Many] </dt>
<dd>
<t>X.509 Certificate chain. </t>
</dd>
<dt>X509CSR: Binary (Optional) </dt>
<dd>
<t>X.509 Certificate Signing Request. </t>
</dd>
<dt>NotBefore: DateTime (Optional) </dt>
<dd>
<t>If present specifies a time instant that use of the private key is not valid before. </t>
</dd>
<dt>NotOnOrAfter: DateTime (Optional) </dt>
<dd>
<t>If present specifies a time instant that use of the private key is not valid on or after.  </t>
</dd>
</dl>
</section>
<section title="Structure: CompositePrivate" anchor="n-structure-compositeprivate-"><dl>
<dt>Inherits: Key  </dt>
<dd>
</dd>
<dt>DeviceKeyUdf: String (Optional) </dt>
<dd>
<t>UDF fingerprint of the bound device key (if used).  </t>
</dd>
</dl>
</section>
</section>
<section title="Assertion classes" anchor="n-assertion-classes-"><t>Classes that are derived from an assertion. </t>
<section title="Structure: Assertion" anchor="n-structure-assertion-"><t>Parent class from which all assertion classes are derived </t>
<dl>
<dt>Names: String [0..Many] </dt>
<dd>
<t>Fingerprints of index terms for profile retrieval. The use of the fingerprint of the name rather than the name itself is a precaution against enumeration attacks and other forms of abuse. </t>
</dd>
<dt>Updated: DateTime (Optional) </dt>
<dd>
<t>The time instant the profile was last modified. </t>
</dd>
<dt>NotaryToken: String (Optional) </dt>
<dd>
<t>A Uniform Notary Token providing evidence that a signature was performed after the notary token was created.  </t>
</dd>
</dl>
</section>
<section title="Structure: Condition" anchor="n-structure-condition-"><t>Parent class from which all condition classes are derived. </t>
<t>[No fields] </t>
</section>
<section title="Base Classes" anchor="n-base-classes-"><t>Abstract classes from which the Profile, Activation and Connection classes are derrived. </t>
</section>
<section title="Structure: Connection" anchor="n-structure-connection-"><dl>
<dt>Inherits: Assertion  </dt>
<dd>
</dd>
<dt>SubjectUdf: String (Optional) </dt>
<dd>
<t>UDF of the connection target. </t>
</dd>
<dt>AuthorityUdf: String (Optional) </dt>
<dd>
<t>UDF of the connection source.  </t>
</dd>
</dl>
</section>
<section title="Structure: Activation" anchor="n-structure-activation-"><dl>
<dt>Inherits: Assertion  </dt>
<dd>
</dd>
</dl>
<t>Contains the private activation information for a Mesh application running on a specific device </t>
<dl>
<dt>ActivationKey: String (Optional) </dt>
<dd>
<t>Secret seed used to derive keys that are not explicitly specified. </t>
</dd>
<dt>Entries: ActivationEntry [0..Many] </dt>
<dd>
<t>Activation of named resources.  </t>
</dd>
</dl>
</section>
<section title="Structure: ActivationEntry" anchor="n-structure-activationentry-"><dl>
<dt>Resource: String (Optional) </dt>
<dd>
<t>Name of the activated resource </t>
</dd>
<dt>Key: KeyData (Optional) </dt>
<dd>
<t>The activation key or key share  </t>
</dd>
</dl>
</section>
<section title="Mesh Profile Classes" anchor="n-mesh-profile-classes-"><t>Classes describing Mesh Profiles. All Profiles are Assertions derrived from Assertion. </t>
</section>
<section title="Structure: Profile" anchor="n-structure-profile-"><dl>
<dt>Inherits: Assertion  </dt>
<dd>
</dd>
</dl>
<t>Parent class from which all profile classes are derived </t>
<dl>
<dt>ProfileSignature: KeyData (Optional) </dt>
<dd>
<t>The permanent signature key used to sign the profile itself. The UDF of the key is used as the permanent object identifier of the profile. Thus, by definition, the KeySignature value of a Profile does not change under any circumstance.  </t>
</dd>
</dl>
</section>
<section title="Structure: ProfileDevice" anchor="n-structure-profiledevice-"><dl>
<dt>Inherits: Profile  </dt>
<dd>
</dd>
</dl>
<t>Describes a mesh device. </t>
<dl>
<dt>Description: String (Optional) </dt>
<dd>
<t>Description of the device </t>
</dd>
<dt>BaseEncryption: KeyData (Optional) </dt>
<dd>
<t>Base key contribution for encryption keys.  Also used to decrypt activation data sent to the device during connection to an account. </t>
</dd>
<dt>BaseAuthentication: KeyData (Optional) </dt>
<dd>
<t>Base key contribution for authentication keys.  Also used to authenticate the device during connection to an account. </t>
</dd>
<dt>BaseSignature: KeyData (Optional) </dt>
<dd>
<t>Base key contribution for signature keys.   </t>
</dd>
</dl>
</section>
<section title="Structure: ProfileAccount" anchor="n-structure-profileaccount-"><t>Base class for the account profiles ProfileUser and ProfileGroup. These subclasses may be merged at some future date. </t>
<dl>
<dt>Inherits: Profile  </dt>
<dd>
</dd>
<dt>AccountAddress: String (Optional) </dt>
<dd>
<t>The account address. This is either a DNS service address  (e.g. alice@example.com) or a Mesh Name (@alice). </t>
</dd>
<dt>ServiceUdf: String (Optional) </dt>
<dd>
<t>The fingerprint of the service profile to which the account is currently bound. </t>
</dd>
<dt>EscrowEncryption: KeyData (Optional) </dt>
<dd>
<t>Escrow key associated with the account. </t>
</dd>
<dt>AccountEncryption: KeyData (Optional) </dt>
<dd>
<t>Key currently used to encrypt data under this profile </t>
</dd>
<dt>AdministratorSignature: KeyData (Optional) </dt>
<dd>
<t>Key used to sign connection assertions to the account.  </t>
</dd>
</dl>
</section>
<section title="Structure: ProfileUser" anchor="n-structure-profileuser-"><dl>
<dt>Inherits: ProfileAccount  </dt>
<dd>
</dd>
</dl>
<t>Account assertion. This is signed by the service hosting the account. </t>
<dl>
<dt>AccountAuthentication: KeyData (Optional) </dt>
<dd>
<t>Key used to authenticate requests made under this user account. </t>
</dd>
<dt>AccountSignature: KeyData (Optional) </dt>
<dd>
<t>Key used to sign data under the account.  </t>
</dd>
</dl>
</section>
<section title="Structure: ProfileGroup" anchor="n-structure-profilegroup-"><dl>
<dt>Inherits: ProfileAccount  </dt>
<dd>
</dd>
</dl>
<t>Describes a group. Note that while a group is created by one person who becomes its first administrator, control of the group may pass to other administrators over time. </t>
<t>[No fields] </t>
</section>
<section title="Structure: ProfileService" anchor="n-structure-profileservice-"><dl>
<dt>Inherits: Profile  </dt>
<dd>
</dd>
</dl>
<t>Profile of a Mesh Service </t>
<dl>
<dt>ServiceAuthentication: KeyData (Optional) </dt>
<dd>
<t>Key used to authenticate service connections. </t>
</dd>
<dt>ServiceEncryption: KeyData (Optional) </dt>
<dd>
<t>Key used to encrypt data under this profile </t>
</dd>
<dt>ServiceSignature: KeyData (Optional) </dt>
<dd>
<t>Key used to sign data under the account.  </t>
</dd>
</dl>
</section>
<section title="Structure: ProfileHost" anchor="n-structure-profilehost-"><dl>
<dt>Inherits: Profile  </dt>
<dd>
</dd>
<dt>KeyAuthentication: KeyData (Optional) </dt>
<dd>
<t>Key used to authenticate service connections. </t>
</dd>
<dt>KeyEncryption: KeyData (Optional) </dt>
<dd>
<t>Key used to pass encrypted data to the device such as a  </t>
</dd>
</dl>
</section>
<section title="Connection Assertions" anchor="n-connection-assertions-"><t>Connection assertions are used to authenticate and authorize interactions between devices and the service currently servicing the account. They SHOULD NOT be visible to external parties. </t>
</section>
<section title="Structure: ConnectionDevice" anchor="n-structure-connectiondevice-"><dl>
<dt>Inherits: Connection  </dt>
<dd>
</dd>
</dl>
<t>Connection assertion used to authenticate service requests made by a device. </t>
<dl>
<dt>AccountAddress: String (Optional) </dt>
<dd>
<t>The account address </t>
</dd>
<dt>DeviceSignature: KeyData (Optional) </dt>
<dd>
<t>The signature key for use of the device under the profile </t>
</dd>
<dt>DeviceEncryption: KeyData (Optional) </dt>
<dd>
<t>The encryption key for use of the device under the profile </t>
</dd>
<dt>DeviceAuthentication: KeyData (Optional) </dt>
<dd>
<t>The authentication key for use of the device under the profile  </t>
</dd>
</dl>
</section>
<section title="Structure: ConnectionApplication" anchor="n-structure-connectionapplication-"><dl>
<dt>Inherits: Connection  </dt>
<dd>
</dd>
</dl>
<t>Connection assertion stating that a particular device is  </t>
<t>[No fields] </t>
</section>
<section title="Structure: ConnectionGroup" anchor="n-structure-connectiongroup-"><t>Describes the connection of a member to a group. </t>
<dl>
<dt>Inherits: Connection  </dt>
<dd>
</dd>
</dl>
<t>[No fields] </t>
</section>
<section title="Structure: ConnectionService" anchor="n-structure-connectionservice-"><dl>
<dt>Inherits: Connection  </dt>
<dd>
</dd>
</dl>
<t>[No fields] </t>
</section>
<section title="Structure: ConnectionHost" anchor="n-structure-connectionhost-"><dl>
<dt>Inherits: Connection  </dt>
<dd>
</dd>
</dl>
<t>[No fields] </t>
</section>
<section title="Activation Assertions" anchor="n-activation-assertions-"></section>
<section title="Structure: ActivationDevice" anchor="n-structure-activationdevice-"><t>Contains activation data for device specific keys used in the context of a  Mesh account. </t>
<dl>
<dt>Inherits: Activation  </dt>
<dd>
</dd>
<dt>AccountUdf: String (Optional) </dt>
<dd>
<t>The UDF of the account  </t>
</dd>
</dl>
</section>
<section title="Structure: ActivationAccount" anchor="n-structure-activationaccount-"><dl>
<dt>Inherits: Activation  </dt>
<dd>
</dd>
<dt>ProfileSignature: KeyData (Optional) </dt>
<dd>
<t>Grant access to profile online signing key used to sign updates to the profile. </t>
</dd>
<dt>AdministratorSignature: KeyData (Optional) </dt>
<dd>
<t>Grant access to Profile administration key used to make changes to administrator catalogs. </t>
</dd>
<dt>AccountEncryption: KeyData (Optional) </dt>
<dd>
<t>Grant access to ProfileUser account encryption key </t>
</dd>
<dt>AccountAuthentication: KeyData (Optional) </dt>
<dd>
<t>Grant access to ProfileUser account authentication key </t>
</dd>
<dt>AccountSignature: KeyData (Optional) </dt>
<dd>
<t>Grant access to ProfileUser account signature key  </t>
</dd>
</dl>
</section>
<section title="Structure: ActivationApplication" anchor="n-structure-activationapplication-"><dl>
<dt>Inherits: Activation  </dt>
<dd>
</dd>
</dl>
<t>[No fields] </t>
</section>
</section>
<section title="Data Structures" anchor="n-data-structures-"><t>Classes describing data used in cataloged data.	 </t>
<section title="Structure: Contact" anchor="n-structure-contact-"><dl>
<dt>Inherits: Assertion  </dt>
<dd>
</dd>
</dl>
<t>Base class for contact entries. </t>
<dl>
<dt>Id: String (Optional) </dt>
<dd>
<t>The globally unique contact identifier. </t>
</dd>
<dt>Anchors: Anchor [0..Many] </dt>
<dd>
<t>Mesh fingerprints associated with the contact. </t>
</dd>
<dt>NetworkAddresses: NetworkAddress [0..Many] </dt>
<dd>
<t>Network address entries </t>
</dd>
<dt>Locations: Location [0..Many] </dt>
<dd>
<t>The physical locations the contact is associated with. </t>
</dd>
<dt>Roles: Role [0..Many] </dt>
<dd>
<t>The roles of the contact </t>
</dd>
<dt>Bookmark: Bookmark [0..Many] </dt>
<dd>
<t>The Web sites and other online presences of the contact </t>
</dd>
<dt>Sources: TaggedSource [0..Many] </dt>
<dd>
<t>Source(s) from which this contact was constructed.  </t>
</dd>
</dl>
</section>
<section title="Structure: Anchor" anchor="n-structure-anchor-"><t>Trust anchor </t>
<dl>
<dt>Udf: String (Optional) </dt>
<dd>
<t>The trust anchor. </t>
</dd>
<dt>Validation: String (Optional) </dt>
<dd>
<t>The means of validation.  </t>
</dd>
</dl>
</section>
<section title="Structure: TaggedSource" anchor="n-structure-taggedsource-"><t>Source from which contact information was obtained. </t>
<dl>
<dt>LocalName: String (Optional) </dt>
<dd>
<t>Short name for the contact information. </t>
</dd>
<dt>Validation: String (Optional) </dt>
<dd>
<t>The means of validation.	 </t>
</dd>
<dt>BinarySource: Binary (Optional) </dt>
<dd>
<t>The contact data in binary form. </t>
</dd>
<dt>EnvelopedSource: Enveloped (Optional) </dt>
<dd>
<t>The contact data in enveloped form. If present, the BinarySource property is ignored.  </t>
</dd>
</dl>
</section>
<section title="Structure: ContactGroup" anchor="n-structure-contactgroup-"><dl>
<dt>Inherits: Contact  </dt>
<dd>
</dd>
</dl>
<t>Contact for a group, including encryption groups. </t>
<t>[No fields] </t>
</section>
<section title="Structure: ContactPerson" anchor="n-structure-contactperson-"><dl>
<dt>Inherits: Contact  </dt>
<dd>
</dd>
<dt>CommonNames: PersonName [0..Many] </dt>
<dd>
<t>List of person names in order of preference  </t>
</dd>
</dl>
</section>
<section title="Structure: ContactOrganization" anchor="n-structure-contactorganization-"><dl>
<dt>Inherits: Contact  </dt>
<dd>
</dd>
<dt>CommonNames: OrganizationName [0..Many] </dt>
<dd>
<t>List of person names in order of preference  </t>
</dd>
</dl>
</section>
<section title="Structure: OrganizationName" anchor="n-structure-organizationname-"><t>The name of an organization </t>
<dl>
<dt>Inactive: Boolean (Optional) </dt>
<dd>
<t>If true, the name is not in current use. </t>
</dd>
<dt>RegisteredName: String (Optional) </dt>
<dd>
<t>The registered name. </t>
</dd>
<dt>DBA: String (Optional) </dt>
<dd>
<t>Names that the organization uses including trading names and doing business as names.  </t>
</dd>
</dl>
</section>
<section title="Structure: PersonName" anchor="n-structure-personname-"><t>The name of a natural person </t>
<dl>
<dt>Inactive: Boolean (Optional) </dt>
<dd>
<t>If true, the name is not in current use. </t>
</dd>
<dt>FullName: String (Optional) </dt>
<dd>
<t>The preferred presentation of the full name. </t>
</dd>
<dt>Prefix: String (Optional) </dt>
<dd>
<t>Honorific or title, E.g. Sir, Lord, Dr., Mr. </t>
</dd>
<dt>First: String (Optional) </dt>
<dd>
<t>First name. </t>
</dd>
<dt>Middle: String [0..Many] </dt>
<dd>
<t>Middle names or initials. </t>
</dd>
<dt>Last: String (Optional) </dt>
<dd>
<t>Last name. </t>
</dd>
<dt>Suffix: String (Optional) </dt>
<dd>
<t>Nominal suffix, e.g. Jr., III, etc. </t>
</dd>
<dt>PostNominal: String (Optional) </dt>
<dd>
<t>Post nominal letters (if used).  </t>
</dd>
</dl>
</section>
<section title="Structure: NetworkAddress" anchor="n-structure-networkaddress-"><t>Provides all means of contacting the individual according to a particular network address </t>
<dl>
<dt>Inactive: Boolean (Optional) </dt>
<dd>
<t>If true, the name is not in current use. </t>
</dd>
<dt>Address: String (Optional) </dt>
<dd>
<t>The network address, e.g. alice@example.com </t>
</dd>
<dt>NetworkCapability: String [0..Many] </dt>
<dd>
<t>The capabilities bound to this address. </t>
</dd>
<dt>EnvelopedProfileAccount: Enveloped (Optional) </dt>
<dd>
<t>The account profile </t>
</dd>
<dt>Protocols: NetworkProtocol [0..Many] </dt>
<dd>
<t>Public keys associated with the network address  </t>
</dd>
</dl>
</section>
<section title="Structure: NetworkProtocol" anchor="n-structure-networkprotocol-"><dl>
<dt>Protocol: String (Optional) </dt>
<dd>
<t>The IANA protocol|identifier of the network protocols by which  the contact may be reached using the specified Address.   </t>
</dd>
</dl>
</section>
<section title="Structure: Role" anchor="n-structure-role-"><dl>
<dt>OrganizationName: String (Optional) </dt>
<dd>
<t>The organization at which the role is held </t>
</dd>
<dt>Titles: String [0..Many] </dt>
<dd>
<t>The titles held with respect to that organization. </t>
</dd>
<dt>Locations: Location [0..Many] </dt>
<dd>
<t>Postal or physical addresses associated with the role.  </t>
</dd>
</dl>
</section>
<section title="Structure: Location" anchor="n-structure-location-"><dl>
<dt>Appartment: String (Optional) </dt>
<dd>
</dd>
<dt>Street: String (Optional) </dt>
<dd>
</dd>
<dt>District: String (Optional) </dt>
<dd>
</dd>
<dt>Locality: String (Optional) </dt>
<dd>
</dd>
<dt>County: String (Optional) </dt>
<dd>
</dd>
<dt>Postcode: String (Optional) </dt>
<dd>
</dd>
<dt>Country: String (Optional)  </dt>
<dd>
</dd>
</dl>
</section>
<section title="Structure: Bookmark" anchor="n-structure-bookmark-"><dl>
<dt>Uri: String (Optional) </dt>
<dd>
</dd>
<dt>Title: String (Optional) </dt>
<dd>
</dd>
<dt>Role: String [0..Many]  </dt>
<dd>
</dd>
</dl>
</section>
<section title="Structure: Reference" anchor="n-structure-reference-"><dl>
<dt>MessageId: String (Optional) </dt>
<dd>
<t>The received message to which this is a response </t>
</dd>
<dt>ResponseId: String (Optional) </dt>
<dd>
<t>Message that was generated in response to the original (optional). </t>
</dd>
<dt>Relationship: String (Optional) </dt>
<dd>
<t>The relationship type. This can be Read, Unread, Accept, Reject.  </t>
</dd>
</dl>
</section>
<section title="Structure: Task" anchor="n-structure-task-"><dl>
<dt>Key: String (Optional) </dt>
<dd>
<t>Unique key. </t>
</dd>
<dt>Start: DateTime (Optional) </dt>
<dd>
</dd>
<dt>Finish: DateTime (Optional) </dt>
<dd>
</dd>
<dt>StartTravel: String (Optional) </dt>
<dd>
</dd>
<dt>FinishTravel: String (Optional) </dt>
<dd>
</dd>
<dt>TimeZone: String (Optional) </dt>
<dd>
</dd>
<dt>Title: String (Optional) </dt>
<dd>
</dd>
<dt>Description: String (Optional) </dt>
<dd>
</dd>
<dt>Location: String (Optional) </dt>
<dd>
</dd>
<dt>Trigger: String [0..Many] </dt>
<dd>
</dd>
<dt>Conference: String [0..Many] </dt>
<dd>
</dd>
<dt>Repeat: String (Optional) </dt>
<dd>
</dd>
<dt>Busy: Boolean (Optional)  </dt>
<dd>
</dd>
</dl>
</section>
</section>
<section title="Catalog Entries" anchor="n-catalog-entries-"><section title="Structure: CatalogedEntry" anchor="n-structure-catalogedentry-"><t>Base class for cataloged Mesh data. </t>
<dl>
<dt>Labels: String [0..Many] </dt>
<dd>
<t>The set of labels describing the entry  </t>
</dd>
</dl>
</section>
<section title="Structure: CatalogedDevice" anchor="n-structure-catalogeddevice-"><dl>
<dt>Inherits: CatalogedEntry  </dt>
<dd>
</dd>
</dl>
<t>Public device entry, indexed under the device ID Hello </t>
<dl>
<dt>Udf: String (Optional) </dt>
<dd>
<t>UDF of the signature key of the device in the Mesh </t>
</dd>
<dt>DeviceUdf: String (Optional) </dt>
<dd>
<t>UDF of the offline signature key of the device </t>
</dd>
<dt>SignatureUdf: String (Optional) </dt>
<dd>
<t>UDF of the account online signature key </t>
</dd>
<dt>EnvelopedProfileUser: Enveloped (Optional) </dt>
<dd>
<t>The Mesh profile </t>
</dd>
<dt>EnvelopedProfileDevice: Enveloped (Optional) </dt>
<dd>
<t>The device profile </t>
</dd>
<dt>EnvelopedConnectionUser: Enveloped (Optional) </dt>
<dd>
<t>The public assertion demonstrating connection of the Device to the Mesh </t>
</dd>
<dt>EnvelopedActivationDevice: Enveloped (Optional) </dt>
<dd>
<t>The activation of the device within the Mesh account </t>
</dd>
<dt>EnvelopedActivationAccount: Enveloped (Optional) </dt>
<dd>
<t>The activation of the device within the Mesh account </t>
</dd>
<dt>EnvelopedActivationApplication: Enveloped [0..Many] </dt>
<dd>
<t>Application activations granted to the device.  </t>
</dd>
</dl>
</section>
<section title="Structure: CatalogedPublication" anchor="n-structure-catalogedpublication-"><dl>
<dt>Inherits: CatalogedEntry  </dt>
<dd>
</dd>
</dl>
<t>A publication. </t>
<dl>
<dt>Id: String (Optional) </dt>
<dd>
<t>Unique identifier code </t>
</dd>
<dt>Authenticator: String (Optional) </dt>
<dd>
<t>The witness key value to use to request access to the record.	 </t>
</dd>
<dt>EnvelopedData: DareEnvelope (Optional) </dt>
<dd>
<t>Dare Envelope containing the entry data. The data type is specified by the envelope metadata. </t>
</dd>
<dt>NotOnOrAfter: DateTime (Optional) </dt>
<dd>
<t>Epiration time (inclusive)  </t>
</dd>
</dl>
</section>
<section title="Structure: CatalogedCredential" anchor="n-structure-catalogedcredential-"><dl>
<dt>Inherits: CatalogedEntry  </dt>
<dd>
</dd>
<dt>Protocol: String (Optional) </dt>
<dd>
</dd>
<dt>Service: String (Optional) </dt>
<dd>
</dd>
<dt>Username: String (Optional) </dt>
<dd>
</dd>
<dt>Password: String (Optional)  </dt>
<dd>
</dd>
</dl>
</section>
<section title="Structure: CatalogedNetwork" anchor="n-structure-catalogednetwork-"><dl>
<dt>Inherits: CatalogedEntry  </dt>
<dd>
</dd>
<dt>Protocol: String (Optional) </dt>
<dd>
</dd>
<dt>Service: String (Optional) </dt>
<dd>
</dd>
<dt>Username: String (Optional) </dt>
<dd>
</dd>
<dt>Password: String (Optional)  </dt>
<dd>
</dd>
</dl>
</section>
<section title="Structure: CatalogedContact" anchor="n-structure-catalogedcontact-"><dl>
<dt>Inherits: CatalogedEntry  </dt>
<dd>
</dd>
<dt>Key: String (Optional) </dt>
<dd>
<t>Unique key.  </t>
</dd>
<dt>Self: Boolean (Optional) </dt>
<dd>
<t>If true, this catalog entry is for the user who created the catalog.  </t>
</dd>
</dl>
</section>
<section title="Structure: CatalogedAccess" anchor="n-structure-catalogedaccess-"><dl>
<dt>Inherits: CatalogedEntry  </dt>
<dd>
</dd>
</dl>
<t>[No fields] </t>
</section>
<section title="Structure: CryptographicCapability" anchor="n-structure-cryptographiccapability-"><dl>
<dt>Id: String (Optional) </dt>
<dd>
<t>The identifier of the capability. If this is a user capability, MUST match the KeyData identifier. If this is a serviced capability, MUST match the value of ServiceId on the corresponding service capability. </t>
</dd>
<dt>KeyData: KeyData (Optional) </dt>
<dd>
<t>The key that enables the capability </t>
</dd>
<dt>EnvelopedKeyShares: Enveloped [0..Many] </dt>
<dd>
<t>One or more enveloped key shares. </t>
</dd>
<dt>SubjectId: String (Optional) </dt>
<dd>
<t>The identifier of the resource that is controlled using the key. </t>
</dd>
<dt>SubjectAddress: String (Optional) </dt>
<dd>
<t>The address of the resource that is controlled using the key.  </t>
</dd>
</dl>
</section>
<section title="Structure: CapabilityDecrypt" anchor="n-structure-capabilitydecrypt-"><dl>
<dt>Inherits: CryptographicCapability  </dt>
<dd>
</dd>
</dl>
<t>The corresponding key is a decryption key </t>
<t>[No fields] </t>
</section>
<section title="Structure: CapabilityDecryptPartial" anchor="n-structure-capabilitydecryptpartial-"><dl>
<dt>Inherits: CapabilityDecrypt  </dt>
<dd>
</dd>
</dl>
<t>The corresponding key is an encryption key </t>
<dl>
<dt>ServiceId: String (Optional) </dt>
<dd>
<t>The identifier used to claim the capability from the service.[Only present for a partial capability.] </t>
</dd>
<dt>ServiceAddress: String (Optional) </dt>
<dd>
<t>The service account that supports a serviced capability. [Only present for a partial capability.]  </t>
</dd>
</dl>
</section>
<section title="Structure: CapabilityDecryptServiced" anchor="n-structure-capabilitydecryptserviced-"><dl>
<dt>Inherits: CapabilityDecrypt  </dt>
<dd>
</dd>
</dl>
<t>The corresponding key is an encryption key </t>
<dl>
<dt>AuthenticationId: String (Optional) </dt>
<dd>
<t>UDF of trust root under which request to use a serviced capability must be  authorized. [Only present for a serviced capability]  </t>
</dd>
</dl>
</section>
<section title="Structure: CapabilitySign" anchor="n-structure-capabilitysign-"><dl>
<dt>Inherits: CryptographicCapability  </dt>
<dd>
</dd>
</dl>
<t>The corresponding key is an administration key </t>
<t>[No fields] </t>
</section>
<section title="Structure: CapabilityKeyGenerate" anchor="n-structure-capabilitykeygenerate-"><dl>
<dt>Inherits: CryptographicCapability  </dt>
<dd>
</dd>
</dl>
<t>The corresponding key is a key that may be used to generate key shares. </t>
<t>[No fields] </t>
</section>
<section title="Structure: CapabilityFairExchange" anchor="n-structure-capabilityfairexchange-"><dl>
<dt>Inherits: CryptographicCapability  </dt>
<dd>
</dd>
</dl>
<t>The corresponding key is a decryption key to be used in accordance  with the Micali Fair Electronic Exchange with Invisible Trusted Parties protocol. </t>
<t>[No fields] </t>
</section>
<section title="Structure: CatalogedBookmark" anchor="n-structure-catalogedbookmark-"><dl>
<dt>Inherits: CatalogedEntry  </dt>
<dd>
</dd>
<dt>Uri: String (Optional) </dt>
<dd>
</dd>
<dt>Title: String (Optional) </dt>
<dd>
</dd>
<dt>Path: String (Optional)  </dt>
<dd>
</dd>
</dl>
</section>
<section title="Structure: CatalogedTask" anchor="n-structure-catalogedtask-"><dl>
<dt>Inherits: CatalogedEntry  </dt>
<dd>
</dd>
<dt>EnvelopedTask: Enveloped (Optional) </dt>
<dd>
</dd>
<dt>Title: String (Optional) </dt>
<dd>
</dd>
<dt>Key: String (Optional) </dt>
<dd>
<t>Unique key.  </t>
</dd>
</dl>
</section>
<section title="Structure: CatalogedApplication" anchor="n-structure-catalogedapplication-"><dl>
<dt>Inherits: CatalogedEntry  </dt>
<dd>
</dd>
<dt>Key: String (Optional) </dt>
<dd>
</dd>
<dt>EnvelopedCapabilities: DareEnvelope [0..Many] </dt>
<dd>
<t>Enveloped keys for use with Application  </t>
</dd>
</dl>
</section>
<section title="Structure: CatalogedMember" anchor="n-structure-catalogedmember-"><dl>
<dt>ContactAddress: String (Optional) </dt>
<dd>
</dd>
<dt>MemberCapabilityId: String (Optional) </dt>
<dd>
</dd>
<dt>ServiceCapabilityId: String (Optional) </dt>
<dd>
</dd>
<dt>Inherits: CatalogedEntry  </dt>
<dd>
</dd>
</dl>
</section>
<section title="Structure: CatalogedGroup" anchor="n-structure-catalogedgroup-"><dl>
<dt>Inherits: CatalogedApplication  </dt>
<dd>
</dd>
<dt>EnvelopedProfileGroup: Enveloped (Optional) </dt>
<dd>
<t>The Mesh profile </t>
</dd>
<dt>EnvelopedActivationAccount: Enveloped (Optional) </dt>
<dd>
<t>The activation of the device within the Mesh account  </t>
</dd>
</dl>
</section>
<section title="Structure: CatalogedApplicationSSH" anchor="n-structure-catalogedapplicationssh-"><dl>
<dt>Inherits: CatalogedApplication  </dt>
<dd>
</dd>
</dl>
<t>[No fields] </t>
</section>
<section title="Structure: CatalogedApplicationMail" anchor="n-structure-catalogedapplicationmail-"><dl>
<dt>Inherits: CatalogedApplication  </dt>
<dd>
</dd>
</dl>
<t>[No fields] </t>
</section>
<section title="Structure: CatalogedApplicationNetwork" anchor="n-structure-catalogedapplicationnetwork-"><dl>
<dt>Inherits: CatalogedApplication  </dt>
<dd>
</dd>
</dl>
<t>[No fields] </t>
</section>
</section>
<section title="Publications" anchor="n-publications-"><section title="Structure: DevicePreconfiguration" anchor="n-structure-devicepreconfiguration-"><t>A data structure that is passed  </t>
<dl>
<dt>EnvelopedProfileDevice: Enveloped (Optional) </dt>
<dd>
<t>The device profile </t>
</dd>
<dt>EnvelopedConnectionDevice: Enveloped (Optional) </dt>
<dd>
<t>The device connection </t>
</dd>
<dt>ConnectUri: String (Optional) </dt>
<dd>
<t>The connection URI. This would normally be printed on the device as a  QR code.  </t>
</dd>
</dl>
</section>
</section>
<section title="Messages" anchor="n-messages-"><section title="Structure: Message" anchor="n-structure-message-"><dl>
<dt>MessageId: String (Optional) </dt>
<dd>
<t>Unique per-message ID. When encapsulating a Mesh Message in a DARE envelope, the envelope EnvelopeID field MUST be a UDF fingerprint of the MessageId value.  </t>
</dd>
<dt>Sender: String (Optional) </dt>
<dd>
</dd>
<dt>Recipient: String (Optional)  </dt>
<dd>
</dd>
</dl>
</section>
<section title="Structure: MessageError" anchor="n-structure-messageerror-"><dl>
<dt>Inherits: Message  </dt>
<dd>
</dd>
<dt>ErrorCode: String (Optional)  </dt>
<dd>
</dd>
</dl>
</section>
<section title="Structure: MessageComplete" anchor="n-structure-messagecomplete-"><dl>
<dt>Inherits: Message  </dt>
<dd>
</dd>
<dt>References: Reference [0..Many]  </dt>
<dd>
</dd>
</dl>
</section>
<section title="Structure: MessagePinValidated" anchor="n-structure-messagepinvalidated-"><dl>
<dt>Inherits: Message  </dt>
<dd>
</dd>
<dt>AuthenticatedData: DareEnvelope (Optional) </dt>
<dd>
<t>Enveloped data that is authenticated by means of the PIN </t>
</dd>
<dt>ClientNonce: Binary (Optional) </dt>
<dd>
<t>Nonce provided by the client to validate the PIN </t>
</dd>
<dt>PinId: String (Optional) </dt>
<dd>
<t>Pin identifier value calculated from the PIN code, action and account address. </t>
</dd>
<dt>PinWitness: Binary (Optional) </dt>
<dd>
<t>Witness value calculated as KDF (Device.Udf + AccountAddress, ClientNonce)  </t>
</dd>
</dl>
</section>
<section title="Structure: MessagePin" anchor="n-structure-messagepin-"><dl>
<dt>Account: String (Optional) </dt>
<dd>
</dd>
<dt>Inherits: Message  </dt>
<dd>
</dd>
<dt>Expires: DateTime (Optional) </dt>
<dd>
</dd>
<dt>Automatic: Boolean (Optional) </dt>
<dd>
<t>If true, authentication against the PIN code is sufficient to complete the associated action without further authorization. </t>
</dd>
<dt>SaltedPin: String (Optional) </dt>
<dd>
<t>PIN code bound to the specified action. </t>
</dd>
<dt>Action: String (Optional) </dt>
<dd>
<t>The action to which this PIN code is bound.  </t>
</dd>
</dl>
</section>
<section title="Structure: RequestConnection" anchor="n-structure-requestconnection-"><t>Connection request message. This message contains the information </t>
<dl>
<dt>Inherits: MessagePinValidated  </dt>
<dd>
</dd>
<dt>AccountAddress: String (Optional) </dt>
<dd>
</dd>
</dl>
</section>
<section title="Structure: AcknowledgeConnection" anchor="n-structure-acknowledgeconnection-"><t>Connection request message generated by a service on receipt of a valid MessageConnectionRequestClient </t>
<dl>
<dt>Inherits: Message  </dt>
<dd>
</dd>
<dt>EnvelopedRequestConnection: Enveloped (Optional) </dt>
<dd>
<t>The client connection request. </t>
</dd>
<dt>ServerNonce: Binary (Optional) </dt>
<dd>
</dd>
<dt>Witness: String (Optional) </dt>
<dd>
</dd>
</dl>
</section>
<section title="Structure: RespondConnection" anchor="n-structure-respondconnection-"><t>Respond to RequestConnection message to grant or refuse the connection request. </t>
<dl>
<dt>Inherits: Message  </dt>
<dd>
</dd>
<dt>Result: String (Optional) </dt>
<dd>
<t>The response to the request. One of "Accept", "Reject" or "Pending". </t>
</dd>
<dt>CatalogedDevice: CatalogedDevice (Optional) </dt>
<dd>
<t>The device information. MUST be present if the value of Result is "Accept". MUST be absent or null otherwise.  </t>
</dd>
</dl>
</section>
<section title="Structure: MessageContact" anchor="n-structure-messagecontact-"><dl>
<dt>Inherits: MessagePinValidated  </dt>
<dd>
</dd>
<dt>Reply: Boolean (Optional) </dt>
<dd>
<t>If true, requests that the recipient return their own contact information in reply. </t>
</dd>
<dt>Subject: String (Optional) </dt>
<dd>
<t>Optional explanation of the reason for the request. </t>
</dd>
<dt>PIN: String (Optional) </dt>
<dd>
<t>One time authentication code supplied to a recipient to allow authentication of the response.  </t>
</dd>
</dl>
</section>
<section title="Structure: GroupInvitation" anchor="n-structure-groupinvitation-"><dl>
<dt>Inherits: Message  </dt>
<dd>
</dd>
<dt>Text: String (Optional)  </dt>
<dd>
</dd>
</dl>
</section>
<section title="Structure: RequestConfirmation" anchor="n-structure-requestconfirmation-"><dl>
<dt>Inherits: Message  </dt>
<dd>
</dd>
<dt>Text: String (Optional)  </dt>
<dd>
</dd>
</dl>
</section>
<section title="Structure: ResponseConfirmation" anchor="n-structure-responseconfirmation-"><dl>
<dt>Inherits: Message  </dt>
<dd>
</dd>
<dt>Request: Enveloped (Optional) </dt>
<dd>
</dd>
<dt>Accept: Boolean (Optional)  </dt>
<dd>
</dd>
</dl>
</section>
<section title="Structure: RequestTask" anchor="n-structure-requesttask-"><dl>
<dt>Inherits: Message  </dt>
<dd>
</dd>
</dl>
<t>[No fields] </t>
</section>
<section title="Structure: MessageClaim" anchor="n-structure-messageclaim-"><dl>
<dt>Inherits: Message  </dt>
<dd>
</dd>
<dt>PublicationId: String (Optional) </dt>
<dd>
</dd>
<dt>ServiceAuthenticate: String (Optional) </dt>
<dd>
</dd>
<dt>DeviceAuthenticate: String (Optional) </dt>
<dd>
</dd>
<dt>Expires: DateTime (Optional)  </dt>
<dd>
</dd>
</dl>
</section>
<section title="Structure: ProcessResult" anchor="n-structure-processresult-"><t>For future use, allows logging of operations and results	 </t>
<dl>
<dt>Inherits: Message  </dt>
<dd>
</dd>
<dt>Success: Boolean (Optional) </dt>
<dd>
</dd>
<dt>ErrorReport: String (Optional) </dt>
<dd>
<t>The error report code.  </t>
</dd>
</dl>
</section>
</section>
</section>
<section title="Security Considerations" anchor="n-security-considerations"><t>The security considerations for use and implementation of Mesh services and applications are described in the Mesh Security Considerations guide <xref target="draft-hallambaker-mesh-security"></xref>.</t>
</section>
<section title="IANA Considerations" anchor="n-iana-considerations"><t>All the IANA considerations for the Mesh documents are specified in this document</t>
</section>
<section title="Acknowledgements" anchor="n-acknowledgements"><t>A list of people who have contributed to the design of the Mesh is presented in <xref target="draft-hallambaker-mesh-architecture"></xref>.</t>
</section>
<section title="Appendix A: Example Container Organization (not normative)" anchor="n-appendix-a-example-container-organization-not-normative"><t>The means by which profiles are stored on devices is outside the scope of the specification. Only catalogs that are required to be shared between machines by means of accounts need to be standardized.</t>
<section title="Device" anchor="n-device-1"><dl>
<dt>Host Catalog: Host.dare</dt>
<dd>
<t>Catalog of all the Mesh Profiles that the user has registered with the device and the latest version of the device profile for this device.</t>
</dd>
<dt>MeshCatalog: [UDF-Mesh].dcat</dt>
<dd>
<t>Catalog containing the Account Entries for the Mesh [UDF-Mesh].</t>
</dd>
<dt>Account Catalogs: [UDF-Account]/mmm_Device.dcat</dt>
<dd>
<t>The device catalog associated with the specified account</t>
</dd>
<dt>Account Catalogs: [UDF-Account]/[Catalog name].dcat</dt>
<dd>
<t>The set of account catalogs that are shared verbatim between the devices connected to the account.</t>
</dd>
</dl>
<section title="Creating a new Mesh" anchor="n-creating-a-new-mesh"><t>Create new Mesh Profile, Device Profile, Add to Host Catalog</t>
<t>Create MeshCatalog</t>
</section>
<section title="Adding an Account" anchor="n-adding-an-account"><t>Create new Account Profile, Add to MeshCatalog</t>
<t>Create new Account Device Catalog</t>
<t>For each device to be added to the account: Create Account Connection Assertion, add to Account Device Catalog.</t>
</section>
<section title="Adding a Device" anchor="n-adding-a-device"><t>Create a Device Connection Assertion.</t>
<t>For each account the device is to be added to: Create Account Connection Assertion, add to Account Device Catalog.</t>
</section>
</section>
<section title="Service" anchor="n-service-0"><dl>
<dt>Master Catalog</dt>
<dd>
<t>Catalog of all services on machine</t>
</dd>
<dt>Service Catalog</dt>
<dd>
<t>Catalog of accounts in the service.</t>
</dd>
</dl>
<section title="Creating a Service" anchor="n-creating-a-service"><t>Create a Service Description, add to Master Catalog</t>
</section>
<section title="Adding an Account" anchor="n-adding-an-account-0"><t>Create the account entry, add to Service Catalog</t>
<t>Create the Account Directory</t>
<t></t>
<t></t>
</section>
</section>
</section>
<section title="Appendix B: Collected Authentication and Encryption Requirements" anchor="n-appendix-b-collected-authentication-and-encryption-requirements"><section title="Mesh Messaging" anchor="n-mesh-messaging-0"><t></t>
<table><thead>
<tr>
<th>
Message</th>
<th>
Signer</th>
<th>
Recipients</th>
</tr>
</thead>
<tbody>
<tr>
<td>
RequestConnection</td>
<td>
Device</td>
<td>
Service</td>
</tr>
<tr>
<td>
AcknowledgeConnection</td>
<td>
Service</td>
<td>
Device, Receiver</td>
</tr>
<tr>
<td>
OfferGroup</td>
<td>
Sender</td>
<td>
Receiver</td>
</tr>
<tr>
<td>
RequestContact</td>
<td>
Sender</td>
<td>
Receiver</td>
</tr>
<tr>
<td>
ReplyContact</td>
<td>
Sender</td>
<td>
Receiver</td>
</tr>
<tr>
<td>
RequestConfirmation</td>
<td>
Sender</td>
<td>
Receiver</td>
</tr>
<tr>
<td>
ResponseConfirmation</td>
<td>
Sender</td>
<td>
Receiver</td>
</tr>
<tr>
<td>
RequestTask</td>
<td>
Sender</td>
<td>
Receiver</td>
</tr>
<tr>
<td>
ResponseTask</td>
<td>
Sender</td>
<td>
Receiver</td>
</tr>
</tbody>
</table><t></t>
<t></t>
<t></t>
</section>
</section>
</middle>
<back>
<references title="Normative References"><reference anchor="RFC2119"><front>
<title>Key words for use in RFCs to Indicate Requirement Levels</title>
<author fullname="S. Bradner" initials="S." surname="Bradner"><organization/>
<address>
</address>
</author>
<date month="March" year="1997"/>
</front>
<seriesInfo name="BCP" value="14"/>
<seriesInfo name="RFC" value="2119"/>
<seriesInfo name="DOI" value="10.17487/RFC2119"/>
</reference>
<reference anchor="draft-hallambaker-mesh-architecture"><front>
<title>Mathematical Mesh 3.0 Part I: Architecture Guide</title>
<author fullname="Phillip Hallam-Baker" initials="P" surname="Hallam-Baker"><organization/>
<address>
</address>
</author>
<date day="27" month="July" year="2020"/>
</front>
<seriesInfo name="Internet-Draft" value="draft-hallambaker-mesh-architecture-14"/>
<format type="TXT" target="http://www.ietf.org/internet-drafts/draft-hallambaker-mesh-architecture-14.txt"/>
</reference>
<reference anchor="draft-hallambaker-mesh-protocol"><front>
<title>Mathematical Mesh 3.0 Part V: Protocol Reference</title>
<author fullname="Phillip Hallam-Baker" initials="P" surname="Hallam-Baker"><organization/>
<address>
</address>
</author>
<date day="27" month="July" year="2020"/>
</front>
<seriesInfo name="Internet-Draft" value="draft-hallambaker-mesh-protocol-06"/>
<format type="TXT" target="http://www.ietf.org/internet-drafts/draft-hallambaker-mesh-protocol-06.txt"/>
</reference>
<reference anchor="draft-hallambaker-mesh-udf"><front>
<title>Mathematical Mesh 3.0 Part II: Uniform Data Fingerprint.</title>
<author fullname="Phillip Hallam-Baker" initials="P" surname="Hallam-Baker"><organization/>
<address>
</address>
</author>
<date day="27" month="July" year="2020"/>
</front>
<seriesInfo name="Internet-Draft" value="draft-hallambaker-mesh-udf-10"/>
<format type="TXT" target="http://www.ietf.org/internet-drafts/draft-hallambaker-mesh-udf-10.txt"/>
</reference>
<reference anchor="draft-hallambaker-threshold"><front>
<title>Threshold Modes in Elliptic Curves</title>
<author fullname="Phillip Hallam-Baker" initials="P" surname="Hallam-Baker"><organization/>
<address>
</address>
</author>
<date day="3" month="September" year="2020"/>
</front>
<seriesInfo name="Internet-Draft" value="draft-hallambaker-threshold-03"/>
<format type="TXT" target="http://www.ietf.org/internet-drafts/draft-hallambaker-threshold-03.txt"/>
</reference>
<reference anchor="draft-hallambaker-threshold-sigs"><front>
<title>Threshold Signatures in Elliptic Curves</title>
<author fullname="Phillip Hallam-Baker" initials="P" surname="Hallam-Baker"><organization/>
<address>
</address>
</author>
<date day="3" month="September" year="2020"/>
</front>
<seriesInfo name="Internet-Draft" value="draft-hallambaker-threshold-sigs-04"/>
<format type="TXT" target="http://www.ietf.org/internet-drafts/draft-hallambaker-threshold-sigs-04.txt"/>
</reference>
<reference anchor="draft-hallambaker-mesh-cryptography"><front>
<title>Mathematical Mesh 3.0 Part VIII: Cryptographic Algorithms</title>
<author fullname="Phillip Hallam-Baker" initials="P" surname="Hallam-Baker"><organization/>
<address>
</address>
</author>
<date day="27" month="July" year="2020"/>
</front>
<seriesInfo name="Internet-Draft" value="draft-hallambaker-mesh-cryptography-06"/>
<format type="TXT" target="http://www.ietf.org/internet-drafts/draft-hallambaker-mesh-cryptography-06.txt"/>
</reference>
<reference anchor="draft-hallambaker-mesh-security"><front>
<title>Mathematical Mesh 3.0 Part VII: Security Considerations</title>
<author fullname="Phillip Hallam-Baker" initials="P" surname="Hallam-Baker"><organization/>
<address>
</address>
</author>
<date day="27" month="July" year="2020"/>
</front>
<seriesInfo name="Internet-Draft" value="draft-hallambaker-mesh-security-05"/>
<format type="TXT" target="http://www.ietf.org/internet-drafts/draft-hallambaker-mesh-security-05.txt"/>
</reference>
<reference anchor="draft-hallambaker-mesh-notary"><front>
<title>[Reference Not Found!]</title>
<author initials="" surname=""><organization/>
<address>
</address>
</author>
<date/>
</front>
</reference>
<reference anchor="draft-hallambaker-mesh-discovery"><front>
<title>[Reference Not Found!]</title>
<author initials="" surname=""><organization/>
<address>
</address>
</author>
<date/>
</front>
</reference>
</references>
<references title="Informative References"><reference anchor="RFC2426"><front>
<title>vCard MIME Directory Profile</title>
<author fullname="F. Dawson" initials="F." surname="Dawson"><organization/>
<address>
</address>
</author>
<author fullname="T. Howes" initials="T." surname="Howes"><organization/>
<address>
</address>
</author>
<date month="September" year="1998"/>
</front>
<seriesInfo name="RFC" value="2426"/>
<seriesInfo name="DOI" value="10.17487/RFC2426"/>
</reference>
<reference anchor="RFC5545"><front>
<title>Internet Calendaring and Scheduling Core Object Specification (iCalendar)</title>
<author fullname="B. Desruisseaux" initials="B." surname="Desruisseaux"><organization/>
<address>
</address>
</author>
<date month="September" year="2009"/>
</front>
<seriesInfo name="RFC" value="5545"/>
<seriesInfo name="DOI" value="10.17487/RFC5545"/>
</reference>
<reference anchor="draft-hallambaker-mesh-developer"><front>
<title>Mathematical Mesh: Reference Implementation</title>
<author fullname="Phillip Hallam-Baker" initials="P" surname="Hallam-Baker"><organization/>
<address>
</address>
</author>
<date day="27" month="July" year="2020"/>
</front>
<seriesInfo name="Internet-Draft" value="draft-hallambaker-mesh-developer-10"/>
<format type="TXT" target="http://www.ietf.org/internet-drafts/draft-hallambaker-mesh-developer-10.txt"/>
</reference>
<reference anchor="draft-hallambaker-mesh-trust"><front>
<title>Mathematical Mesh 3.0 Part VI: The Trust Mesh</title>
<author fullname="Phillip Hallam-Baker" initials="P" surname="Hallam-Baker"><organization/>
<address>
</address>
</author>
<date day="27" month="July" year="2020"/>
</front>
<seriesInfo name="Internet-Draft" value="draft-hallambaker-mesh-trust-06"/>
<format type="TXT" target="http://www.ietf.org/internet-drafts/draft-hallambaker-mesh-trust-06.txt"/>
</reference>
</references>
</back>
</rfc>
