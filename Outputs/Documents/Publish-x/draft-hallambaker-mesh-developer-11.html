<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8">
    <meta content="Common,Latin" name="scripts">
    <meta content="initial-scale=1.0" name="viewport">
    <title>Mathematical Mesh: Reference Implementation</title>
    <meta name="author" content="Phillip Hallam-Baker">
    <meta name="description" content="The Mathematical Mesh 'The Mesh' is an end-to-end secure infrastructure that facilitates the exchange of configuration and credential data between multiple user devices. This document describes the Mesh reference code and how to install, run and make use of it in applications. It does not form a part of the Mesh specifications and is not normative. This document is also available online at . ">
    <meta content="rfctool 2.0" name="generator">
    <link href="#copyright" rel="license">
    <style type="text/css">
/* fonts */
@import url('https://fonts.googleapis.com/css?family=Noto+Sans'); /* Sans-serif */
@import url('https://fonts.googleapis.com/css?family=Noto+Serif'); /* Serif (print) */
@import url('https://fonts.googleapis.com/css?family=Roboto+Mono'); /* Monospace */

@viewport {
  zoom: 1.0;
  width: extend-to-zoom;
}
@-ms-viewport {
  width: extend-to-zoom;
  zoom: 1.0;
}
/* general and mobile first */
html {
}
body {
  max-width: 90%;
  margin: 1.5em auto;
  color: #222;
  background-color: #fff;
  font-size: 14px;
  font-family: 'Noto Sans', Arial, Helvetica, sans-serif;
  line-height: 1.6;
  scroll-behavior: smooth;
}
.ears {
  display: none;
}

/* headings */
#title, h1, h2, h3, h4, h5, h6 {
  margin: 1em 0 0.5em;
  font-weight: bold;
  line-height: 1.3;
}
#title {
  clear: both;
  border-bottom: 1px solid #ddd;
  margin: 0 0 0.5em 0;
  padding: 1em 0 0.5em;
}
.filename
{
    font-size: 20px;
    color: darkgray;
}
.author {
  padding-bottom: 4px;
}
h1 {
  font-size: 26px;
  margin: 1em 0;
  color: blueviolet;
}
h2
{
    font-size: 22px;
    margin-top: -20px; /* provide offset for in-page anchors */
    padding-top: 33px;
    color: blueviolet;
}
h3
{
    font-size: 18px;
    margin-top: -36px; /* provide offset for in-page anchors */
    padding-top: 42px;
    color: blueviolet;
}
h4
{
    font-size: 16px;
    margin-top: -36px; /* provide offset for in-page anchors */
    padding-top: 42px;
    color: blueviolet;
}
h5, h6 {
  font-size: 14px;
}
#n-copyright-notice {
  border-bottom: 1px solid #ddd;
  padding-bottom: 1em;
  margin-bottom: 1em;
}
/* general structure */
p {
  padding: 0;
  margin: 0 0 1em 0;
  text-align: left;
}
div, span {
  position: relative;
}
div {
  margin: 0;
}
.alignRight.art-text {
  background-color: #f9f9f9;
  border: 1px solid #eee;
  border-radius: 3px;
  padding: 1em 1em 0;
  margin-bottom: 1.5em;
}
.alignRight.art-text pre {
  padding: 0;
}
.alignRight {
  margin: 1em 0;
}
.alignRight > *:first-child {
  border: none;
  margin: 0;
  float: right;
  clear: both;
}
.alignRight > *:nth-child(2) {
  clear: both;
  display: block;
  border: none;
}
svg {
  display: block;
}
.alignCenter.art-text {
  background-color: #f9f9f9;
  border: 1px solid #eee;
  border-radius: 3px;
  padding: 1em 1em 0;
  margin-bottom: 1.5em;
}
.alignCenter.art-text pre {
  padding: 0;
}
.alignCenter {
  margin: 1em 0;
}
.alignCenter > *:first-child {
  border: none;
  /* this isn't optimal, but it's an existence proof.  PrinceXML doesn't
     support flexbox yet.
  */
  display: table;
  margin: 0 auto;
}

/* lists */
ol, ul {
  padding: 0;
  margin: 0 0 1em 2em;
}
ol ol, ul ul, ol ul, ul ol {
  margin-left: 1em;
}
li {
  margin: 0 0 0.25em 0;
}
.ulCompact li {
  margin: 0;
}
ul.empty, .ulEmpty {
  list-style-type: none;
}
ul.empty li, .ulEmpty li {
  margin-top: 0.5em;
}
ul.compact, .ulCompact,
ol.compact, .olCompact {
  line-height: 100%;
  margin: 0 0 0 2em;
}

/* definition lists */
dl {
}
dl > dt {
  float: left;
  margin-right: 1em;
  font-weight: bold;
}
    dl.nohang > dt
    {
        float: none;
        font-weight: bold;
    }
dl > dd {
  margin-bottom: .8em;
  min-height: 1.3em;
}
dl.compact > dd, dlCompact > dd {
  margin-bottom: 0em;
}
dl > dd > dl {
  margin-top: 0.5em;
  margin-bottom: 0em;
}

/* links */
a {
  text-decoration: none;
}
a[href] {
  color: #3E8EDE;
}
a[href]:hover {
  background-color: #f2f2f2;
}
figcaption a[href],
a[href].selfRef {
  color: blueviolet;
}
/* XXX probably not this:
a.selfRef:hover {
  background-color: transparent;
  cursor: default;
} */

/* Figures */
tt, code, pre, code {
  background-color: #f9f9f9;
  font-family: 'Roboto Mono', monospace;
}
pre {
  border: 1px solid #eee;
  margin: 0;
  padding: 1em;
}
img {
  max-width: 100%;
}
figure {
  margin: 0;
}
figure blockquote {
  margin: 0.8em 0.4em 0.4em;
}
figcaption {
  font-style: italic;
  margin: 0 0 1em 0;
}
@media screen {
  pre {
    overflow-x: auto;
    max-width: 100%;
    max-width: calc(100% - 22px);
  }
}

/* aside, blockquote */
aside, blockquote {
  margin-left: 0;
  padding: 1.2em 2em;
}
blockquote {
  background-color: #f9f9f9;
  border: 1px solid #ddd;
  border-radius: 3px;
  margin: 1em 0;
}
cite {
  display: block;
  text-align: right;
  font-style: italic;
}

/* tables */
table {
  width: 100%;
  margin: 0 0 1em;
  border-collapse: collapse;
  border: 1px solid #eee;
}
th, td {
  text-align: left;
  vertical-align: top;
  padding: 0.5em 0.75em;
}
th {
  text-align: left;
  background-color: #e9e9e9;
}
tr:nth-child(2n+1) > td {
  background-color: #f5f5f5;
}
table caption {
  font-style: italic;
  margin: 0;
  padding: 0;
  text-align: left;
}
table p {
  /* XXX to avoid bottom margin on table row signifiers. If paragraphs should
     be allowed within tables more generally, it would be far better to select on a class. */
  margin: 0;
}

/* pilcrow */
a.pilcrow {
  color: #777;
  text-decoration: none;
  visibility: hidden;
  user-select: none;
  -ms-user-select: none;
  -o-user-select:none;
  -moz-user-select: none;
  -khtml-user-select: none;
  -webkit-user-select: none;
  -webkit-touch-callout: none;
}
@media screen {
  aside:hover > a.pilcrow,
  p:hover > a.pilcrow,
  blockquote:hover > a.pilcrow,
  div:hover > a.pilcrow,
  li:hover > a.pilcrow,
  pre:hover > a.pilcrow {
    visibility: visible;
  }
  a.pilcrow:hover {
    background-color: transparent;
  }
}

/* misc */
hr {
  border: 0;
  border-top: 1px solid #eee;
}
.bcp14 {
  font-variant: small-caps;
}

.role {
  font-variant: all-small-caps;
}

/* info block */
#identifiers {
  margin: 0;
  font-size: 0.9em;
}
#identifiers dt {
  width: 3em;
  clear: left;
}
#identifiers dd {
  float: left;
  margin-bottom: 0;
}
#identifiers .authors .author {
  display: inline-block;
  margin-right: 1.5em;
}
#identifiers .authors .org {
  font-style: italic;
}

/* The prepared/rendered info at the very bottom of the page */
.docInfo {
  color: #999;
  font-size: 0.9em;
  font-style: italic;
  margin-top: 2em;
}
.docInfo .prepared {
  float: left;
}
.docInfo .prepared {
  float: right;
}

/* table of contents */
#toc  {
  padding: 0.75em 0 2em 0;
  margin-bottom: 1em;
}
nav.toc ul {
  margin: 0 0.5em 0 0;
  padding: 0;
  list-style: none;
}
nav.toc li {
  line-height: 1.3em;
  margin: 0.75em 0;
  padding-left: 1.2em;
  text-indent: -1.2em;
}
/* references */
.reference dt {
  text-align: right;
  font-weight: bold;
  min-width: 7em;
}
.reference dd {
  margin-left: 8em;
  overflow: auto;
}

.refInstance {
  margin-bottom: 1.25em;
}

.reference .ascii {
  margin-bottom: 0.25em;
}

/* index */
.index ul {
  margin: 0 0 0 1em;
  padding: 0;
  list-style: none;
}
.index ul ul {
  margin: 0;
}
.index li {
  margin: 0;
  text-indent: -2em;
  padding-left: 2em;
  padding-bottom: 5px;
}
.indexIndex {
  margin: 0.5em 0 1em;
}
.index a {
  font-weight: 700;
}
/* make the index two-column on all but the smallest screens */
@media (min-width: 600px) {
  .index ul {
    -moz-column-count: 2;
    -moz-column-gap: 20px;
  }
  .index ul ul {
    -moz-column-count: 1;
    -moz-column-gap: 0;
  }
}

/* authors */
address.vcard {
  font-style: normal;
  margin: 1em 0;
}

address.vcard .nameRole {
  font-weight: 700;
  margin-left: 0;
}
address.vcard .label {
  font-family: "Noto Sans",Arial,Helvetica,sans-serif;
  margin: 0.5em 0;
}
address.vcard .type {
  display: none;
}
.alternative-contact {
  margin: 1.5em 0 1em;
}
hr.addr {
  border-top: 1px dashed;
  margin: 0;
  color: #ddd;
  max-width: calc(100% - 16px);
}

/* temporary notes */
.rfcEditorRemove::before {
  position: absolute;
  top: 0.2em;
  right: 0.2em;
  padding: 0.2em;
  content: "The RFC Editor will remove this note";
  color: #b76427;
  background-color: rgba(249, 232, 105, 0.3);
}
.rfcEditorRemove {
  position: relative;
  padding-top: 1.8em;
  background-color: rgba(249, 232, 105, 0.3);
  border-radius: 3px;
}
.cref {
  background-color: rgba(249, 232, 105, 0.3);
  padding: 2px 4px;
}
.crefSource {
  font-style: italic;
}
/* alternative layout for smaller screens */
@media screen and (max-width: 1023px) {
  body {
    padding-top: 2em;
  }
  #title {
    padding: 1em 0;
  }
  h1 {
    font-size: 24px;
  }
  h2 {
    font-size: 20px;
    margin-top: -18px;  /* provide offset for in-page anchors */
    padding-top: 38px;
  }
  #identifiers dd {
    max-width: 60%;
  }
  /* Just get rid of the idiot stuff: */
  /*
  #toc {
    position: fixed;
    z-index: 2;
    top: 0;
    right: 0;
    padding: 0;
    margin: 0;
    background-color: inherit;
    border-bottom: 1px solid #ccc;
  }
  #toc h2 {
    margin: -1px 0 0 0;
    padding: 4px 0 4px 6px;
    padding-right: 1em;
    min-width: 190px;
    font-size: 1.1em;
    text-align: right;
    background-color: #444;
    color: white;
    cursor: pointer;
  }
  #toc h2::before { 
    float: right;
    position: relative;
    width: 1em;
    height: 1px;
    left: -164px;
    margin: 6px 0 0 0;
    background: white none repeat scroll 0 0;
    box-shadow: 0 4px 0 0 white, 0 8px 0 0 white;
    content: "";
  }
  #toc nav {
    display: none;
    padding: 0.5em 1em 1em;
    overflow: auto;
    height: calc(100vh - 48px);
    border-left: 1px solid #ddd;
  }*/
}

/* alternative layout for wide screens */
@media screen and (min-width: 1024px) {
  body {
    max-width: 724px;
    margin: 42px auto;
    padding-left: 1.5em;
    padding-right: 29em;
  }
  #toc {
    position: fixed;
    top: 42px;
    right: 42px;
    width: 25%;
    margin: 0;
    padding: 0 1em;
    z-index: 1;
  }
  #toc h2 {
    border-top: none;
    border-bottom: 1px solid #ddd;
    font-size: 1em;
    font-weight: normal;
    margin: 0;
    padding: 0.25em 1em 1em 0;
  }
  #toc nav {
    display: block;
    height: calc(90vh - 84px);
    bottom: 0;
    padding: 0.5em 0 0;
    overflow: auto;
  }
  img { /* future proofing */
    max-width: 100%;
    height: auto;
  }
}

/* pagination */
@media print {
	/*
  body {
    font-family: 'Noto Serif', "Times New Roman", Times, serif;
    width: 100%;
  }*/
  p {
    orphans: 3;
    widows: 3;
  }
  #n-copyright-notice {
    border-bottom: none;
  }
  #toc, #n-introduction {
    page-break-before: always;
  }
  #toc {
    border-top: none;
    padding-top: 0;
  }
  figure, pre {
    page-break-inside: avoid;
  }
  figure {

  }
  h1, h2, h3, h4, h5, h6 {
    page-break-after: avoid;
	break-after: avoid;
  }
  h2+*, h3+*, h4+*, h5+*, h6+* {
    page-break-before: avoid;
  }
  pre {
    white-space: pre-wrap;
    word-wrap: break-word;
    font-size: 10pt;
  }
  table {
    border: 1px solid #ddd;
  }
  td {
    border-top: 1px solid #ddd;
  }
}

.ears thead .left {
  string-set: ears-top-left content();
}

.ears thead .center {
  string-set: ears-top-center content();
}

.ears thead .right {
  string-set: ears-top-right content();
}

.ears tfoot .left {
  string-set: ears-bottom-left content();
}

.ears tfoot .center {
  string-set: ears-bottom-center content();
}

.ears tfoot .right {
  string-set: ears-bottom-right content();
}

@page :first {
  padding-top: 0;
  @top-left {
    content: normal;
    border: none;
  }
  @top-center {
    content: normal;
    border: none;
  }
  @top-right {
    content: normal;
    border: none;
  }
}


@page {
  size: A4;
  margin-bottom: 45mm;
  padding-top: 20px;
  @top-left {
    content: 'Internet-Draft';
    vertical-align: bottom;
    border-bottom: solid 1px #ccc;
  }
  @top-left {
    content: string(ears-top-left);
    vertical-align: bottom;
    border-bottom: solid 1px #ccc;
  }
  @top-center {
    content: string(ears-top-center);
    vertical-align: bottom;
    border-bottom: solid 1px #ccc;
  }
  @top-right {
    content: string(ears-top-right);
    vertical-align: bottom;
    border-bottom: solid 1px #ccc;
  }
  @bottom-left {
    content: string(ears-bottom-left);
    vertical-align: top;
    border-top: solid 1px #ccc;
  }
  @bottom-center {
    content: string(ears-bottom-center);
    vertical-align: top;
    border-top: solid 1px #ccc;
  }
  @bottom-right {
      content: '[Page ' counter(page) ']';
      vertical-align: top;
      border-top: solid 1px #ccc;
  }
}
    </style>
    <link href="rfc-local.css" rel="stylesheet" type="text/css">
    <link href="urn:issn:2070-1721" rel="alternate">
<link rel="icon" href="data:image/svg+xml;base64,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">  </head>
  <body>
    <table class="ears">
      <thead>
        <tr>
          <td class="left"/>
          <td class="center">Mathematical Mesh Developer</td>
          <td class="right">August 2021</td>
        </tr>
      </thead>
      <tfoot>
        <tr>
          <td class="left">Hallam-Baker</td>
          <td class="center">Expires February 6, 2022</td>
          <td class="right">[Page]</td>
        </tr>
      </tfoot>
    </table>

    <div id="external-metadata" class="document-information">
    </div>
    <div id="internal-metadata" class="document-information">
      <dl id="identifiers">
        <dt class="label-workgroup">Workgroup:</dt>
        <dd class="workgroup">Network Working Group</dd>
        <dt class="label-stream">Stream:</dt>
        <dd class="stream">Internet-Draft</dd>
        <dt class="label-category">Intended status:</dt>
        <dd class="category">Informational</dd>
        <dt>Published:</dt>
        <dd>
          <time class="published" datetime="2021-08-05">5 August 2021</time>
        </dd>
        <dt class="label-issn">ISSN:</dt>
        <dd class="issn">2070-1721</dd>
        <dt>Expires</dt>
        <dd>
          <time class="expires" datetime="2022-02-06">6 February 2022</time>
        </dd>
        <dt>Authors:</dt>
        <dd class="authors">
          <div class="author">
<div class="author-name">Phillip Hallam-Baker</div>          </div>
        </dd>
      </dl>
    </div>
    <h1 id="title">
      Mathematical Mesh: Reference Implementation
      <h1 id="idnum">draft-hallambaker-mesh-developer-11</h1>
    </h1>
    <section id="abstract">
      <h3>
        <a class="selfRef" href="#abstract">Abstract</a>
      </h3>
      <p id="s-abstract-1">The Mathematical Mesh ‘The Mesh’ is an end-to-end secure infrastructure that facilitates the exchange of configuration and credential data between multiple user devices.<a class="pilcrow" href="#s-abstract-1">&para;</a></p>
      <p id="s-abstract-2">This document describes the Mesh reference code and how to install, run and make use of it in applications. It does not form a part of the Mesh specifications and is not normative.<a class="pilcrow" href="#s-abstract-2">&para;</a></p>
      <p id="s-abstract-3">This document is also available online at <a class="eref" href="http://mathmesh.com/Documents/draft-hallambaker-mesh-developer.html">http://mathmesh.com/Documents/draft-hallambaker-mesh-developer.html</a>.<a class="pilcrow" href="#s-abstract-3">&para;</a></p>
    </section>
    
    <section id="n-status-of-this-memo">
      <h3 id="bp-1">
        <a class="selfRef" href="#bp-1"></a>
        <a class="selfRef" href="#n-status-of-this-memo">Status of This Memo</a>
      </h3>
      <p id="bp-1-1">This Internet-Draft is submitted in full conformance with the provisions of BCP 78 and BCP 79.<a class="pilcrow" href="#bp-1-1">&para;</a></p>
      <p id="bp-1-2">Internet-Drafts are working documents of the Internet Engineering Task Force (IETF).  Note that other groups may also distribute working documents as Internet-Drafts. The list of current Internet-Drafts is at <a class="eref" href="http://datatracker.ietf.org/drafts/current/">http://datatracker.ietf.org/drafts/current/</a>.<a class="pilcrow" href="#bp-1-2">&para;</a></p>
      <p id="bp-1-3">Internet-Drafts are draft documents valid for a maximum of six months and may be updated, replaced, or obsoleted by other documents at any time.It is inappropriate to use Internet-Drafts as reference material or to cite them other than as "work in progress."<a class="pilcrow" href="#bp-1-3">&para;</a></p>
      <p id="bp-1-4">This Internet-Draft will expire on February 6, 2022<a class="pilcrow" href="#bp-1-4">&para;</a></p>
    </section>
    
    <section id="n-copyright-notice">
      <h3 id="bp-2">
        <a class="selfRef" href="#bp-2"></a>
        <a class="selfRef" href="#n-copyright-notice">Copyright Notice</a>
      </h3>
      <p id="bp-2-1">Copyright (c) IETF Trust and the persons identified as the document authors. All rights reserved.<a class="pilcrow" href="#bp-2-1">&para;</a></p>
      <p id="bp-2-2">This document is subject to BCP 78 and the IETF Trust’s Legal Provisions Relating to IETF Documents (http://trustee.ietf.org/license-info) in effect on the date of publication of this document. Please review these documents carefully, as they describe your rights and restrictions with respect to this document.<a class="pilcrow" href="#bp-2-2">&para;</a></p>
    </section>
    
    <section id="toc">
      <h3>
        <a class="selfRef" href="#toc">Table of Contents</a>
      </h3>
      <nav class="toc">
        <ul class="toc">
          <li class="toc">
            <a href="#s-1">1.</a><a href="#n-definitions">Definitions</a>
            <ul class="toc">
              <li class="toc">
                <a href="#s-1_1">1.1.</a><a href="#n-requirements-language">Requirements Language</a>
              </li>
              <li class="toc">
                <a href="#s-1_2">1.2.</a><a href="#n-defined-terms">Defined Terms</a>
              </li>
              <li class="toc">
                <a href="#s-1_3">1.3.</a><a href="#n-related-specifications">Related Specifications</a>
              </li>
              <li class="toc">
                <a href="#s-1_4">1.4.</a><a href="#n-implementation-status">Implementation Status</a>
              </li>
            </ul>
          </li>
          <li class="toc">
            <a href="#s-2">2.</a><a href="#n-getting-the-reference-code-and-build-tools">Getting the Reference Code and Build Tools</a>
            <ul class="toc">
              <li class="toc">
                <a href="#s-2_1">2.1.</a><a href="#n-obtaining-the-development-environment">Obtaining the Development Environment</a>
              </li>
              <li class="toc">
                <a href="#s-2_2">2.2.</a><a href="#n-obtaining-the-build-tools">Obtaining the Build Tools</a>
              </li>
              <li class="toc">
                <a href="#s-2_3">2.3.</a><a href="#n-obtaining-the-mesh-source-libraries">Obtaining the Mesh Source Libraries</a>
              </li>
            </ul>
          </li>
          <li class="toc">
            <a href="#s-3">3.</a><a href="#n-compiling-the-reference-code">Compiling the Reference Code</a>
            <ul class="toc">
              <li class="toc">
                <a href="#s-3_1">3.1.</a><a href="#n-creating-a-software-signing-key">Creating a software signing key</a>
              </li>
              <li class="toc">
                <a href="#s-3_2">3.2.</a><a href="#n-create-dummy-build-action-files">Create (dummy) build action files</a>
              </li>
            </ul>
          </li>
          <li class="toc">
            <a href="#s-4">4.</a><a href="#n-running-the-reference-code-examples">Running the Reference Code Examples</a>
            <ul class="toc">
              <li class="toc">
                <a href="#s-4_1">4.1.</a><a href="#n-starting-the-server">Starting the Server</a>
              </li>
              <li class="toc">
                <a href="#s-4_2">4.2.</a><a href="#n-the-profile-manager-wizard">The Profile Manager Wizard</a>
              </li>
              <li class="toc">
                <a href="#s-4_3">4.3.</a><a href="#n-the-profile-connection-wizard">The Profile Connection Wizard</a>
              </li>
            </ul>
          </li>
          <li class="toc">
            <a href="#s-5">5.</a><a href="#n-platform-specific-configuration-data">Platform specific configuration data</a>
            <ul class="toc">
              <li class="toc">
                <a href="#s-5_1">5.1.</a><a href="#n-windows">Windows</a>
                <ul class="toc">
                  <li class="toc">
                    <a href="#s-5_1_1">5.1.1.</a><a href="#n-private-key-data">Private Key Data</a>
                  </li>
                  <li class="toc">
                    <a href="#s-5_1_2">5.1.2.</a><a href="#n-registry-settings">Registry settings</a>
                  </li>
                  <li class="toc">
                    <a href="#s-5_1_3">5.1.3.</a><a href="#n-profile-data-files">Profile data files</a>
                  </li>
                </ul>
              </li>
              <li class="toc">
                <a href="#s-5_2">5.2.</a><a href="#n-osx-and-linux">OSX and Linux</a>
              </li>
            </ul>
          </li>
          <li class="toc">
            <a href="#s-6">6.</a><a href="#n-using-the-mesh-cnet-libraries-in-an-application">Using the Mesh C#/.Net Libraries in an Application</a>
            <ul class="toc">
              <li class="toc">
                <a href="#s-6_1">6.1.</a><a href="#n-portals-sessions-and-clients">Portals, Sessions and Clients</a>
                <ul class="toc">
                  <li class="toc">
                    <a href="#s-6_1_1">6.1.1.</a><a href="#n-meshsession-vs-personalsession">MeshSession vs PersonalSession</a>
                  </li>
                </ul>
              </li>
              <li class="toc">
                <a href="#s-6_2">6.2.</a><a href="#n-creating-a-mesh-session">Creating a Mesh Session</a>
              </li>
              <li class="toc">
                <a href="#s-6_3">6.3.</a><a href="#n-creating-a-mesh-session-for-testing">Creating a Mesh Session for Testing</a>
              </li>
              <li class="toc">
                <a href="#s-6_4">6.4.</a><a href="#n-checking-that-a-portal-account-name-is-acceptable">Checking that a Portal Account name is acceptable</a>
              </li>
              <li class="toc">
                <a href="#s-6_5">6.5.</a><a href="#n-creating-a-personal-profile">Creating a Personal Profile</a>
              </li>
              <li class="toc">
                <a href="#s-6_6">6.6.</a><a href="#n-creating-an-offline-escrow-entry">Creating an Offline Escrow Entry</a>
              </li>
              <li class="toc">
                <a href="#s-6_7">6.7.</a><a href="#n-deleting-profile-data">Deleting Profile Data</a>
              </li>
              <li class="toc">
                <a href="#s-6_8">6.8.</a><a href="#n-recovering-profile-data">Recovering Profile Data</a>
              </li>
              <li class="toc">
                <a href="#s-6_9">6.9.</a><a href="#n-connecting-a-new-device">Connecting a New Device</a>
              </li>
              <li class="toc">
                <a href="#s-6_10">6.10.</a><a href="#n-managing-applications">Managing Applications</a>
              </li>
            </ul>
          </li>
          <li class="toc">
            <a href="#s-7">7.</a><a href="#n-using-other-languages">Using other languages</a>
            <ul class="toc">
              <li class="toc">
                <a href="#s-7_1">7.1.</a><a href="#n-lightweight-api">Lightweight API</a>
              </li>
            </ul>
          </li>
          <li class="toc">
            <a href="#s-8">8.</a><a href="#n-implementation-status-0">Implementation Status</a>
            <ul class="toc">
              <li class="toc">
                <a href="#s-8_1">8.1.</a><a href="#n-reference-implementation">Reference Implementation</a>
                <ul class="toc">
                  <li class="toc">
                    <a href="#s-8_1_1">8.1.1.</a><a href="#n-coverage">Coverage:</a>
                  </li>
                  <li class="toc">
                    <a href="#s-8_1_2">8.1.2.</a><a href="#n-licensing">Licensing</a>
                  </li>
                  <li class="toc">
                    <a href="#s-8_1_3">8.1.3.</a><a href="#n-implementation-experience">Implementation Experience</a>
                  </li>
                  <li class="toc">
                    <a href="#s-8_1_4">8.1.4.</a><a href="#n-contact-info">Contact Info</a>
                  </li>
                </ul>
              </li>
            </ul>
          </li>
          <li class="toc">
            <a href="#s-9">9.</a><a href="#n-security-considerations">Security Considerations</a>
          </li>
          <li class="toc">
            <a href="#s-10">10.</a><a href="#n-iana-considerations">IANA Considerations</a>
          </li>
          <li class="toc">
            <a href="#s-11">11.</a><a href="#n-acknowledgements">Acknowledgements</a>
          </li>
          <li class="toc">
<a href="#n-references">References</a>
            <ul class="toc">
              <li class="toc">
<a href="#n-normative">Normative References</a>
              </li>
              <li class="toc">
<a href="#n-informative">Informative References</a>
              </li>
            </ul>
          </li>
        </ul>
        <ul class="toc">
          <li class="toc">
            <a href="#"></a><a href="#n-authors">Author's Address</a>
          </li>
        </ul>
      </nav>
    </section>
    
    <section id="n-definitions">
      <h3 id="s-1">
        <a class="selfRef" href="#s-1">1.</a>
        <a class="selfRef" href="#n-definitions">Definitions</a>
      </h3>
      <p id="s-1-1">This section presents the related specifications and standard, the terms that are used as terms of art within the documents and the terms used as requirements language.<a class="pilcrow" href="#s-1-1">&para;</a></p>
    </section>
    
    <section id="n-requirements-language">
      <h4 id="s-1_1">
        <a class="selfRef" href="#s-1_1">1.1.</a>
        <a class="selfRef" href="#n-requirements-language">Requirements Language</a>
      </h4>
      <p id="s-1_1-1">This document is not normative and does not contain requirements language<a class="pilcrow" href="#s-1_1-1">&para;</a></p>
    </section>
    
    <section id="n-defined-terms">
      <h4 id="s-1_2">
        <a class="selfRef" href="#s-1_2">1.2.</a>
        <a class="selfRef" href="#n-defined-terms">Defined Terms</a>
      </h4>
      <p id="s-1_2-1">The terms of art used in this document are described in the <i>Mesh Architecture Guide</i> <a class="xref" href="#draft-hallambaker-mesh-architecture">[draft-hallambaker-mesh-architecture]</a>.<a class="pilcrow" href="#s-1_2-1">&para;</a></p>
    </section>
    
    <section id="n-related-specifications">
      <h4 id="s-1_3">
        <a class="selfRef" href="#s-1_3">1.3.</a>
        <a class="selfRef" href="#n-related-specifications">Related Specifications</a>
      </h4>
      <p id="s-1_3-1">The architecture of the Mathematical Mesh is described in the <i>Mesh Architecture Guide</i> <a class="xref" href="#draft-hallambaker-mesh-architecture">[draft-hallambaker-mesh-architecture]</a>. The Mesh documentation set and related specifications are described in this document.<a class="pilcrow" href="#s-1_3-1">&para;</a></p>
    </section>
    
    <section id="n-implementation-status">
      <h4 id="s-1_4">
        <a class="selfRef" href="#s-1_4">1.4.</a>
        <a class="selfRef" href="#n-implementation-status">Implementation Status</a>
      </h4>
      <p id="s-1_4-1">The implementation status of the reference code base is described in the companion document <a class="xref" href="#draft-hallambaker-mesh-developer">[draft-hallambaker-mesh-developer]</a>.<a class="pilcrow" href="#s-1_4-1">&para;</a></p>
    </section>
    
    <section id="n-getting-the-reference-code-and-build-tools">
      <h3 id="s-2">
        <a class="selfRef" href="#s-2">2.</a>
        <a class="selfRef" href="#n-getting-the-reference-code-and-build-tools">Getting the Reference Code and Build Tools</a>
      </h3>
      <p id="s-2-1">The Mesh Reference library was developed using Visual Studio 2017 Community Edition <a class="xref" href="#VS2017">[VS2017]</a> using PHB’s Build Tools <a class="xref" href="#PHB2017">[PHB2017]</a> extensions. The reference code itself is currently limited to C# libraries.<a class="pilcrow" href="#s-2-1">&para;</a></p>
      <p id="s-2-2">The code should in theory run under other operating systems but this has not been tested recently. <a class="pilcrow" href="#s-2-2">&para;</a></p>
      <p id="s-2-3">Development under different development environments is also possible but would require re-engineering to make use of the line mode versions of the build tools.<a class="pilcrow" href="#s-2-3">&para;</a></p>
    </section>
    
    <section id="n-obtaining-the-development-environment">
      <h4 id="s-2_1">
        <a class="selfRef" href="#s-2_1">2.1.</a>
        <a class="selfRef" href="#n-obtaining-the-development-environment">Obtaining the Development Environment</a>
      </h4>
      <p id="s-2_1-1">Visual Studio 2017 Community Edition is currently available at no cost for a wide range of non-commercial development including personal use and development of Open Source software. For full details, please consult the license published by Microsoft.<a class="pilcrow" href="#s-2_1-1">&para;</a></p>
      <pre id="s-2_1-2">https://www.visualstudio.com/</pre>
<a class="pilcrow" href="#s-2_1-2">&para;</a>    </section>
    
    <section id="n-obtaining-the-build-tools">
      <h4 id="s-2_2">
        <a class="selfRef" href="#s-2_2">2.2.</a>
        <a class="selfRef" href="#n-obtaining-the-build-tools">Obtaining the Build Tools</a>
      </h4>
      <p id="s-2_2-1">Over half the code in the reference code library is generated using code generators. These are used to ensure that the specification, examples and reference code are always kept in synchronization. <a class="pilcrow" href="#s-2_2-1">&para;</a></p>
      <p id="s-2_2-2">The build tools are published under an MIT License and are available in two forms:<a class="pilcrow" href="#s-2_2-2">&para;</a></p>
      <p id="s-2_2-3">As stand-alone tools to be run from the command line.<a class="pilcrow" href="#s-2_2-3">&para;</a></p>
      <p id="s-2_2-4">As a VSIX package that integrates into the Visual Studio environment.<a class="pilcrow" href="#s-2_2-4">&para;</a></p>
      <p id="s-2_2-5">The source distribution is configured to use the tools integrated into the Visual Studio environment. If development on other platforms is desired, the simplest approach is likely to be to write a tool that reads the Visual Studio configuration files and generates the corresponding files for use with make.<a class="pilcrow" href="#s-2_2-5">&para;</a></p>
      <p id="s-2_2-6">The VSIX package is available from the Visual Studio extensions gallery:<a class="pilcrow" href="#s-2_2-6">&para;</a></p>
      <pre id="s-2_2-7">PHB Code Generation Tools</pre>
<a class="pilcrow" href="#s-2_2-7">&para;</a>      <p id="s-2_2-8">The source code for the build tools is available from:<a class="pilcrow" href="#s-2_2-8">&para;</a></p>
      <pre id="s-2_2-9">https://sourceforge.net/projects/phb-build-tools/</pre>
<a class="pilcrow" href="#s-2_2-9">&para;</a>    </section>
    
    <section id="n-obtaining-the-mesh-source-libraries">
      <h4 id="s-2_3">
        <a class="selfRef" href="#s-2_3">2.3.</a>
        <a class="selfRef" href="#n-obtaining-the-mesh-source-libraries">Obtaining the Mesh Source Libraries</a>
      </h4>
      <p id="s-2_3-1">The Mesh reference library source code is published under an MIT license and is available from:<a class="pilcrow" href="#s-2_3-1">&para;</a></p>
      <pre id="s-2_3-2">https://sourceforge.net/projects/mathematicalmesh/</pre>
<a class="pilcrow" href="#s-2_3-2">&para;</a>    </section>
    
    <section id="n-compiling-the-reference-code">
      <h3 id="s-3">
        <a class="selfRef" href="#s-3">3.</a>
        <a class="selfRef" href="#n-compiling-the-reference-code">Compiling the Reference Code</a>
      </h3>
      <p id="s-3-1">To compile the code it is necessary to<a class="pilcrow" href="#s-3-1">&para;</a></p>
      <p id="s-3-2">Create a signing key<a class="pilcrow" href="#s-3-2">&para;</a></p>
      <p id="s-3-3">Create batch files for pre and post build tasks<a class="pilcrow" href="#s-3-3">&para;</a></p>
    </section>
    
    <section id="n-creating-a-software-signing-key">
      <h4 id="s-3_1">
        <a class="selfRef" href="#s-3_1">3.1.</a>
        <a class="selfRef" href="#n-creating-a-software-signing-key">Creating a software signing key</a>
      </h4>
      <p id="s-3_1-1">The purpose of signing assemblies is so that they can be authenticated during the load process. For this to be secure, it is of course essential that each developer has their own key.<a class="pilcrow" href="#s-3_1-1">&para;</a></p>
      <p id="s-3_1-2">To create a software developer signing key, the Visual Studio 'sn' tool is used. To run the tool, start the Visual Studio Developer Console <i>in administrator mode</i>. This requires the following steps:<a class="pilcrow" href="#s-3_1-2">&para;</a></p>
      <p id="s-3_1-3">Move to a directory you want to write to.<a class="pilcrow" href="#s-3_1-3">&para;</a></p>
      <p id="s-3_1-4">Set the machine to create user based keys<a class="pilcrow" href="#s-3_1-4">&para;</a></p>
      <p id="s-3_1-5">Create a new key and write it to a file.<a class="pilcrow" href="#s-3_1-5">&para;</a></p>
      <p id="s-3_1-6">Copy the file from the key to a container.<a class="pilcrow" href="#s-3_1-6">&para;</a></p>
      <p id="s-3_1-7">Delete the container.<a class="pilcrow" href="#s-3_1-7">&para;</a></p>
      <p id="s-3_1-8">Locate the private key file<a class="pilcrow" href="#s-3_1-8">&para;</a></p>
      <p id="s-3_1-9">Give permission to use the key.<a class="pilcrow" href="#s-3_1-9">&para;</a></p>
      <p id="s-3_1-10">This is of course one of the tasks we would like to automate with the Mesh tools in due course but that presents a bootstrap problem.<a class="pilcrow" href="#s-3_1-10">&para;</a></p>
      <pre id="s-3_1-11">C:\Windows\System32&gt;cd hallam

c:\Users\hallam&gt;sn -m N

Microsoft (R) .NET Framework Strong Name Utility  Version 4.0.30319.0
Copyright (c) Microsoft Corporation.  All rights reserved.

Key containers are user based

c:\Users\hallam&gt;sn -k fred.snk

Microsoft (R) .NET Framework Strong Name Utility  Version 4.0.30319.0
Copyright (c) Microsoft Corporation.  All rights reserved.

Key pair written to fred.snk

c:\Users\hallam&gt;sn -i fred.snk SigningKeyDeveloper

Microsoft (R) .NET Framework Strong Name Utility  Version 4.0.30319.0
Copyright (c) Microsoft Corporation.  All rights reserved.

Key pair installed into 'SigningKeyDeveloper'

c:\Users\hallam&gt;del fred.snk

c:\Users\hallam&gt;</pre>
<a class="pilcrow" href="#s-3_1-11">&para;</a>    </section>
    
    <section id="n-create-dummy-build-action-files">
      <h4 id="s-3_2">
        <a class="selfRef" href="#s-3_2">3.2.</a>
        <a class="selfRef" href="#n-create-dummy-build-action-files">Create (dummy) build action files</a>
      </h4>
      <p id="s-3_2-1">Visual Studio allows projects to specify batch files to be run before and after a project build. Since the actions to be taken are likely to change from developer to developer, these are specified in separate batch files. All that is necessary to build the code without warnings is to specify a set of dummy batch files with the following names and place them somewhere in the command line $PATH environment variable.<a class="pilcrow" href="#s-3_2-1">&para;</a></p>
      <p id="s-3_2-2">The files required are:<a class="pilcrow" href="#s-3_2-2">&para;</a></p>
      <p id="s-3_2-3">VSPreBuild.bat<a class="pilcrow" href="#s-3_2-3">&para;</a></p>
      <p id="s-3_2-4">VSPostBuild.bat<a class="pilcrow" href="#s-3_2-4">&para;</a></p>
      <p id="s-3_2-5">VSPostBuildWindows.bat<a class="pilcrow" href="#s-3_2-5">&para;</a></p>
      <p id="s-3_2-6">VSPostBuildOSX.bat<a class="pilcrow" href="#s-3_2-6">&para;</a></p>
      <p id="s-3_2-7">VSPostBuildLinux.bat<a class="pilcrow" href="#s-3_2-7">&para;</a></p>
      <p id="s-3_2-8">The following code will prevent error messages being thrown:<a class="pilcrow" href="#s-3_2-8">&para;</a></p>
      <pre id="s-3_2-9">@echo off
SETLOCAL
exit /b 0</pre>
<a class="pilcrow" href="#s-3_2-9">&para;</a>    </section>
    
    <section id="n-running-the-reference-code-examples">
      <h3 id="s-4">
        <a class="selfRef" href="#s-4">4.</a>
        <a class="selfRef" href="#n-running-the-reference-code-examples">Running the Reference Code Examples</a>
      </h3>
      <p id="s-4-1">The reference code examples are designed to illustrate how the Mesh might be used in an application rather than be standalone tools in their own right. The Mesh is designed to make it each for developers to add security to their own applications rather than providing the applications themselves.<a class="pilcrow" href="#s-4-1">&para;</a></p>
    </section>
    
    <section id="n-starting-the-server">
      <h4 id="s-4_1">
        <a class="selfRef" href="#s-4_1">4.1.</a>
        <a class="selfRef" href="#n-starting-the-server">Starting the Server</a>
      </h4>
      <p id="s-4_1-1">On the Windows platform, the server runs in the context of the platform Web server and must be granted permission to bind to the range of server addresses used using the netsh command.<a class="pilcrow" href="#s-4_1-1">&para;</a></p>
      <p id="s-4_1-2">From a command prompt with administrator privileges, run the following command:<a class="pilcrow" href="#s-4_1-2">&para;</a></p>
      <pre id="s-4_1-3">netsh http add urlacl http://&lt;domain&gt;/.well-known/mmm/
    \user=&lt;machine&gt;\&lt;user&gt;</pre>
<a class="pilcrow" href="#s-4_1-3">&para;</a>      <p id="s-4_1-4">Where &lt;domain&gt; is the DNS domain name under which the service is run, &lt;machine&gt; is the Windows domain name of the machine and &lt;user&gt; the account name.<a class="pilcrow" href="#s-4_1-4">&para;</a></p>
      <p id="s-4_1-5">To start the service from the command line type:<a class="pilcrow" href="#s-4_1-5">&para;</a></p>
      <pre id="s-4_1-6">servermesh &lt;domain&gt;</pre>
<a class="pilcrow" href="#s-4_1-6">&para;</a>      <p id="s-4_1-7">The server does not require administration privileges.<a class="pilcrow" href="#s-4_1-7">&para;</a></p>
    </section>
    
    <section id="n-the-profile-manager-wizard">
      <h4 id="s-4_2">
        <a class="selfRef" href="#s-4_2">4.2.</a>
        <a class="selfRef" href="#n-the-profile-manager-wizard">The Profile Manager Wizard</a>
      </h4>
      <p id="s-4_2-1">The profile manager wizard demonstrates functions that are performed on an administration device. These include creating a completely new profile and initial configuration of applications, connecting a device to the profile and recovery of the profile from escrow data.<a class="pilcrow" href="#s-4_2-1">&para;</a></p>
      <p id="s-4_2-2">To run the client from the command line, place the executable image in a location that it will be found in the PATH variable and type:<a class="pilcrow" href="#s-4_2-2">&para;</a></p>
      <pre id="s-4_2-3">meshclient</pre>
<a class="pilcrow" href="#s-4_2-3">&para;</a>    </section>
    
    <section id="n-the-profile-connection-wizard">
      <h4 id="s-4_3">
        <a class="selfRef" href="#s-4_3">4.3.</a>
        <a class="selfRef" href="#n-the-profile-connection-wizard">The Profile Connection Wizard</a>
      </h4>
      <p id="s-4_3-1">The Profile connection wizard demonstrates the much more restricted functionality that would be required in a Mesh connected application and/or a profile manager for a non-administration device.<a class="pilcrow" href="#s-4_3-1">&para;</a></p>
      <p id="s-4_3-2">To run the client from the command line, place the executable image in a location that it will be found in the PATH variable and type:<a class="pilcrow" href="#s-4_3-2">&para;</a></p>
      <pre id="s-4_3-3">meshconnect</pre>
<a class="pilcrow" href="#s-4_3-3">&para;</a>    </section>
    
    <section id="n-platform-specific-configuration-data">
      <h3 id="s-5">
        <a class="selfRef" href="#s-5">5.</a>
        <a class="selfRef" href="#n-platform-specific-configuration-data">Platform specific configuration data</a>
      </h3>
    </section>
    
    <section id="n-windows">
      <h4 id="s-5_1">
        <a class="selfRef" href="#s-5_1">5.1.</a>
        <a class="selfRef" href="#n-windows">Windows</a>
      </h4>
    </section>
    
    <section id="n-private-key-data">
      <h5 id="s-5_1_1">
        <a class="selfRef" href="#s-5_1_1">5.1.1.</a>
        <a class="selfRef" href="#n-private-key-data">Private Key Data</a>
      </h5>
      <p id="s-5_1_1-1">All private key data is stored using the Windows public key store. At minimum, this ensures that private keys are obfuscated and encrypted under the account password to protect the data against casual extraction attacks. On a machine with cryptographic hardware support such as a TPM or HSM, extraction of the private key may be infeasible without physical access to the machine and possibly require sophisticated diagnostic equipment.<a class="pilcrow" href="#s-5_1_1-1">&para;</a></p>
    </section>
    
    <section id="n-registry-settings">
      <h5 id="s-5_1_2">
        <a class="selfRef" href="#s-5_1_2">5.1.2.</a>
        <a class="selfRef" href="#n-registry-settings">Registry settings</a>
      </h5>
      <p id="s-5_1_2-1">Separate settings are used for production and test code. Test Code should use the Registry Hive:<a class="pilcrow" href="#s-5_1_2-1">&para;</a></p>
      <p id="s-5_1_2-2">HKEY_CURRENT_USER\SOFTWARE\CryptoMesh<a class="pilcrow" href="#s-5_1_2-2">&para;</a></p>
      <p id="s-5_1_2-3">Production code should use the hive<a class="pilcrow" href="#s-5_1_2-3">&para;</a></p>
      <p id="s-5_1_2-4">HKEY_CURRENT_USER\SOFTWARE\MathematicalMesh<a class="pilcrow" href="#s-5_1_2-4">&para;</a></p>
      <p id="s-5_1_2-5">In either case the sub structure is:<a class="pilcrow" href="#s-5_1_2-5">&para;</a></p>
      <dl id="s-5_1_2-6-" class="nohang">
        <dt id="s-5_1_2-6">Accounts<a class="pilcrow" href="#s-5_1_2-6">&para;</a></dt>
        <dd id="null">Contains the set of Mesh Portal Accounts for the user. The default value is the account name of the default account. The Name of the each key is a portal account name and the value a REG_SZ entry containing the UDF of the profile master key.<a class="pilcrow" href="#">&para;</a></dd>
        <dt id="s-5_1_2-7">PersonalProfiles<a class="pilcrow" href="#s-5_1_2-7">&para;</a></dt>
        <dd id="null">Contains the set of Mesh Profiles for the user. The default value is the UDF of the default profile master key. The Name of each key is the UDF of the master key and the value a REG_SZ entry containing the file location of the cached copy of the personal profile.<a class="pilcrow" href="#">&para;</a></dd>
        <dt id="s-5_1_2-8">ThisDevice<a class="pilcrow" href="#s-5_1_2-8">&para;</a></dt>
        <dd id="null">Contains the set of Device profiles in the same format as the PersonalProfiles.<a class="pilcrow" href="#">&para;</a></dd>
      </dl>
      
      <section id="n-profile-data-files">
        <h5 id="s-5_1_3">
          <a class="selfRef" href="#s-5_1_3">5.1.3.</a>
          <a class="selfRef" href="#n-profile-data-files">Profile data files</a>
        </h5>
      </section>
      <p id="s-5_1_3-1">The profile data itself is stored in data files at the location specified in the registry. The files are standard XML files in UTF8 encoding.<a class="pilcrow" href="#s-5_1_3-1">&para;</a></p>
    </section>
    
    <section id="n-osx-and-linux">
      <h4 id="s-5_2">
        <a class="selfRef" href="#s-5_2">5.2.</a>
        <a class="selfRef" href="#n-osx-and-linux">OSX and Linux</a>
      </h4>
      <p id="s-5_2-1">[[Not yet implemented, subject to change.]<a class="pilcrow" href="#s-5_2-1">&para;</a></p>
      <p id="s-5_2-2">All configuration information is stored in the user directory ~/.mmm<a class="pilcrow" href="#s-5_2-2">&para;</a></p>
      <p id="s-5_2-3">Keys are stored in SSH key file format <a class="xref" href="#RFC4716">[RFC4716]</a> using the customary name and extension conventions for that application. <a class="pilcrow" href="#s-5_2-3">&para;</a></p>
    </section>
    
    <section id="n-using-the-mesh-cnet-libraries-in-an-application">
      <h3 id="s-6">
        <a class="selfRef" href="#s-6">6.</a>
        <a class="selfRef" href="#n-using-the-mesh-cnet-libraries-in-an-application">Using the Mesh C#/.Net Libraries in an Application</a>
      </h3>
      <p id="s-6-1">The application <code>ExampleGenerator</code> shows the use of the Mesh in an application using the convenience API. It is the application program used to generate the examples in the reference document.<a class="pilcrow" href="#s-6-1">&para;</a></p>
      <p id="s-6-2"><code>ExampleGenerator</code> implements a client that connects to a remote Web Service, creates new personal profile with an escrow entry with offline recovery codes, attaches applications and other devices, updates an application profile, deletes all the profile data from the local machine and then restores them using the recovery codes and escrow entry.<a class="pilcrow" href="#s-6-2">&para;</a></p>
    </section>
    
    <section id="n-portals-sessions-and-clients">
      <h4 id="s-6_1">
        <a class="selfRef" href="#s-6_1">6.1.</a>
        <a class="selfRef" href="#n-portals-sessions-and-clients">Portals, Sessions and Clients</a>
      </h4>
      <p id="s-6_1-1">The libraries are designed to support testing and development use. For this reason, the client side of the libraries is divided into the following main classes:<a class="pilcrow" href="#s-6_1-1">&para;</a></p>
      <dl id="s-6_1-2-" class="nohang">
        <dt id="s-6_1-2"><code>MeshClient</code><a class="pilcrow" href="#s-6_1-2">&para;</a></dt>
        <dd id="null">Provides a logical connection to a remote or simulated Mesh service.<a class="pilcrow" href="#">&para;</a></dd>
        <dt id="s-6_1-3"><code>MeshPortal</code><a class="pilcrow" href="#s-6_1-3">&para;</a></dt>
        <dd id="null">Provides the interface to a Mesh service which may be an actual remote service accessed via a network connection, or local code running in the same process as the client to simulate a Mesh service for testing purposes.<a class="pilcrow" href="#">&para;</a></dd>
        <dt id="s-6_1-4"><code>MeshMachine</code><a class="pilcrow" href="#s-6_1-4">&para;</a></dt>
        <dd id="null">Provides an interface to Mesh data stored on the local machine.<a class="pilcrow" href="#">&para;</a></dd>
        <dt id="s-6_1-5"><code>MeshSession</code> / <code>PersonalSession</code><a class="pilcrow" href="#s-6_1-5">&para;</a></dt>
        <dd id="null">Provide the high level application interface to the Mesh combining access through the MeshClient and MeshMachine. <a class="pilcrow" href="#">&para;</a></dd>
      </dl>
      <p id="s-6_1-6">The relationship between these parts is shown in . The application programmer will typically need only the MeshSession class.<a class="pilcrow" href="#s-6_1-6">&para;</a></p>
      <p id="s-6_1-7">The principal classes in the Mesh Client side API.<a class="pilcrow" href="#s-6_1-7">&para;</a></p>
      <p id="s-6_1-8">This division makes it possible to test Mesh clients and server implementations in a single process with a single debugger which is usually more convenient than spinning up a separate development session for the client and service.<a class="pilcrow" href="#s-6_1-8">&para;</a></p>
    </section>
    
    <section id="n-meshsession-vs-personalsession">
      <h5 id="s-6_1_1">
        <a class="selfRef" href="#s-6_1_1">6.1.1.</a>
        <a class="selfRef" href="#n-meshsession-vs-personalsession">MeshSession vs PersonalSession</a>
      </h5>
      <p id="s-6_1_1-1">Most Mesh operations are performed within the context of a specific PersonalProfile registered on the current machine. This context is provided by an instance of the PersonalSession class.<a class="pilcrow" href="#s-6_1_1-1">&para;</a></p>
      <p id="s-6_1_1-2">An instance of the MeshSession class is used for operations that are not bound to a specific PersonalProfile registered on the machine. These operations are:<a class="pilcrow" href="#s-6_1_1-2">&para;</a></p>
      <ul id="s-6_1_1-3-">
        <li id="s-6_1_1-3">Binding a new PersonalProfile to the machine.<a class="pilcrow" href="#s-6_1_1-3">&para;</a></li>
        <li id="s-6_1_1-4">Offline key recovery.<a class="pilcrow" href="#s-6_1_1-4">&para;</a></li>
        <li id="s-6_1_1-5">Requesting and completing a device connection request from the new device.<a class="pilcrow" href="#s-6_1_1-5">&para;</a></li>
        <li id="s-6_1_1-6">Acquiring a PersonalSession instance.<a class="pilcrow" href="#s-6_1_1-6">&para;</a></li>
      </ul>
      
      <section id="n-creating-a-mesh-session">
        <h4 id="s-6_2">
          <a class="selfRef" href="#s-6_2">6.2.</a>
          <a class="selfRef" href="#n-creating-a-mesh-session">Creating a Mesh Session</a>
        </h4>
      </section>
      <p id="s-6_2-1">The primary interface for the application programmer is the <code>MeshSession</code> class. To create a mesh session class, the following steps are required:<a class="pilcrow" href="#s-6_2-1">&para;</a></p>
      <ol id="s-6_2-2-">
        <li id="s-6_2-2">Initialize the Mesh code for the intended platform<a class="pilcrow" href="#s-6_2-2">&para;</a></li>
        <li id="s-6_2-3">Request a new <code>MeshSession</code> instance.<a class="pilcrow" href="#s-6_2-3">&para;</a></li>
      </ol>
      <p id="s-6_2-4">Although C# code is nominally 'write once, run anywhere', this approach does not ensure use of platform specific features such as the Windows registry or protected storage for cryptographic keys. Calling <code>MeshWindows.Initialize()</code> causes the platform specific code for the Windows to be initialized in production mode. Alternatively, calls to MeshLinux.Initialize() or MeshOSX.Initialize() causes the platform specific code for those platforms to be initialized.<a class="pilcrow" href="#s-6_2-4">&para;</a></p>
      <p id="s-6_2-5">The code to initialize a production instance of the code is shown in :<a class="pilcrow" href="#s-6_2-5">&para;</a></p>
      <pre id="s-6_2-6">        static MeshSession MeshSession = null;

        static void ApplicationInit () {
            MeshWindows.Initialize();
            MeshSession = new MeshSession();
            }</pre>
<a class="pilcrow" href="#s-6_2-6">&para;</a>      <p id="s-6_2-7">If the user has already created a <code>PersonalProfile</code> and connected it to the machine, it will automatically be read from local storage. The instance will automatically create <code>MeshClient</code> instances as required to establish a web service using the default transport (HTTP) to the service as necessary (see ).<a class="pilcrow" href="#s-6_2-7">&para;</a></p>
      <p id="s-6_2-8">Connecting to a remote service from a Windows platform.<a class="pilcrow" href="#s-6_2-8">&para;</a></p>
      <p id="s-6_2-9">The server implementation is managed in the same fashion. Internally, the <code>MeshService</code> and <code>MeshClient</code> classes are both descended from the same parent.<a class="pilcrow" href="#s-6_2-9">&para;</a></p>
    </section>
    
    <section id="n-creating-a-mesh-session-for-testing">
      <h4 id="s-6_3">
        <a class="selfRef" href="#s-6_3">6.3.</a>
        <a class="selfRef" href="#n-creating-a-mesh-session-for-testing">Creating a Mesh Session for Testing</a>
      </h4>
      <p id="s-6_3-1">Since the purpose of the <code>ExampleGenerator</code> is to create examples for the documentation, it is not necessary for the JSON Remote Procedure Calls to actually be ‘Remote’. Instead the ‘Local’ Procedure Call mode is used in which the client and server both run in the same process with the client API invoking the server dispatch methods through an interface that performs JSON serialization and deserialization but does not invoke the network transport. <a class="pilcrow" href="#s-6_3-1">&para;</a></p>
      <p id="s-6_3-2">Connecting to a direct service for testing.<a class="pilcrow" href="#s-6_3-2">&para;</a></p>
      <p id="s-6_3-3">A direct connection to the service provider may be established by either specifying the portal to use in the initialization of MeshSession or by setting the default portal property of the MeshPortal class as is done here .<a class="pilcrow" href="#s-6_3-3">&para;</a></p>
      <pre id="s-6_3-4">        static void DebugApplicationInit () {

            MeshPortal.Default = new MeshPortalDirect("example.com",
                "MeshLog.jlog", "PortalLog.jlog");

            MeshWindows.Initialize(true);
            MeshSession = new MeshSession();
            MeshSession.EraseTest();
            }</pre>
<a class="pilcrow" href="#s-6_3-4">&para;</a>      <p id="s-6_3-5">This time, we initialize a specific version of the platform dependent code and specify that it is to be initialized as test code rather than production. This will cause all persistent data stored on the machine (keys, profiles) to be stored in locations marked as test locations. The EraseTest() method causes all data stored in test locations to be erased from the machine, thus ensuring that the test begins from a known state with no results from previous runs.<a class="pilcrow" href="#s-6_3-5">&para;</a></p>
      <p id="s-6_3-6">When writing test code, it is frequently useful to create multiple independent <code>MeshSessions</code> to simulate multiple machines. To prevent data written to one machine interfering with another, a new simulated machine is created for each session using the <code>MeshMachineCached</code> class <a class="pilcrow" href="#s-6_3-6">&para;</a></p>
      <pre id="s-6_3-7">            MeshSession = new MeshSession(new MeshMachineCached());</pre>
<a class="pilcrow" href="#s-6_3-7">&para;</a>    </section>
    
    <section id="n-checking-that-a-portal-account-name-is-acceptable">
      <h4 id="s-6_4">
        <a class="selfRef" href="#s-6_4">6.4.</a>
        <a class="selfRef" href="#n-checking-that-a-portal-account-name-is-acceptable">Checking that a Portal Account name is acceptable</a>
      </h4>
      <p id="s-6_4-1">The user experience is improved if the application indicates whether their choice of portal account name is acceptable or not while they are entering it. The Validate method allows the user's choice of account name to be validated .<a class="pilcrow" href="#s-6_4-1">&para;</a></p>
      <pre id="s-6_4-2">        PersonalProfile PersonalProfile;
        PersonalSession PersonalSession;
        OfflineEscrowEntry OfflineEscrowEntry;

        void DebugCreateProfile () {
            var Response = MeshSession.Validate("alice@example.com");
            if (!Response.Valid) {
                throw new Exception();
                }
            ...</pre>
<a class="pilcrow" href="#s-6_4-2">&para;</a>      <p id="s-6_4-3">The portal address is given in the usual <code>username@domain</code> format, for example <code>alice@example.com</code>.<a class="pilcrow" href="#s-6_4-3">&para;</a></p>
    </section>
    
    <section id="n-creating-a-personal-profile">
      <h4 id="s-6_5">
        <a class="selfRef" href="#s-6_5">6.5.</a>
        <a class="selfRef" href="#n-creating-a-personal-profile">Creating a Personal Profile</a>
      </h4>
      <p id="s-6_5-1">Creating a PersonalProfile has two steps:<a class="pilcrow" href="#s-6_5-1">&para;</a></p>
      <ol id="s-6_5-2-">
        <li id="s-6_5-2">Create a <code>DeviceProfile</code> (if necessary)<a class="pilcrow" href="#s-6_5-2">&para;</a></li>
        <li id="s-6_5-3">Create the <code>PersonalProfile</code><a class="pilcrow" href="#s-6_5-3">&para;</a></li>
        <li id="s-6_5-4">Create an account bound to the profile at the portal.<a class="pilcrow" href="#s-6_5-4">&para;</a></li>
      </ol>
      <p id="s-6_5-5">These steps are shown in .<a class="pilcrow" href="#s-6_5-5">&para;</a></p>
      <pre id="s-6_5-6">            var Device = MeshSession.CreateDevice();
            PersonalProfile = new PersonalProfile(
                Device.DeviceProfile);
            PersonalSession = MeshSession.CreateAccount(
                "alice@example.com", PersonalProfile);</pre>
<a class="pilcrow" href="#s-6_5-6">&para;</a>      <p id="s-6_5-7">The application could have overridden the default values of <code>DeviceID</code> and <code>DeviceDescription</code> when creating the device.<a class="pilcrow" href="#s-6_5-7">&para;</a></p>
    </section>
    
    <section id="n-creating-an-offline-escrow-entry">
      <h4 id="s-6_6">
        <a class="selfRef" href="#s-6_6">6.6.</a>
        <a class="selfRef" href="#n-creating-an-offline-escrow-entry">Creating an Offline Escrow Entry</a>
      </h4>
      <p id="s-6_6-1">Having created a potentially valuable profile, we probably want to back it up. To do this, we create an instance of the <code>OfflineEscrowEntry</code> class with the desired quorum and number of shares (2 out of 4) .<a class="pilcrow" href="#s-6_6-1">&para;</a></p>
      <pre id="s-6_6-2">            OfflineEscrowEntry = new OfflineEscrowEntry(
                PersonalProfile, 2, 4);
            PersonalSession.Escrow(OfflineEscrowEntry);</pre>
<a class="pilcrow" href="#s-6_6-2">&para;</a>    </section>
    
    <section id="n-deleting-profile-data">
      <h4 id="s-6_7">
        <a class="selfRef" href="#s-6_7">6.7.</a>
        <a class="selfRef" href="#n-deleting-profile-data">Deleting Profile Data</a>
      </h4>
      <p id="s-6_7-1">We can test our escrow parameters by deleting the profile from the current machine using the <code>Delete</code> method .<a class="pilcrow" href="#s-6_7-1">&para;</a></p>
      <pre id="s-6_7-2">            PersonalSession.Delete();</pre>
<a class="pilcrow" href="#s-6_7-2">&para;</a>    </section>
    
    <section id="n-recovering-profile-data">
      <h4 id="s-6_8">
        <a class="selfRef" href="#s-6_8">6.8.</a>
        <a class="selfRef" href="#n-recovering-profile-data">Recovering Profile Data</a>
      </h4>
      <p id="s-6_8-1">Profile recovery has two steps:<a class="pilcrow" href="#s-6_8-1">&para;</a></p>
      <ol id="s-6_8-2-">
        <li id="s-6_8-2">Reconstruct the shared secret from the recovery shares.<a class="pilcrow" href="#s-6_8-2">&para;</a></li>
        <li id="s-6_8-3">Recover the profile.<a class="pilcrow" href="#s-6_8-3">&para;</a></li>
      </ol>
      <p id="s-6_8-4">In this case our recovery shares are the first and the third key shares we just generated. The Recover method recovers the profile and rebinds it to the existing portal .<a class="pilcrow" href="#s-6_8-4">&para;</a></p>
      <pre id="s-6_8-5">            var RecoveryShares = new KeyShare[] {
                OfflineEscrowEntry.KeyShares[0],
                OfflineEscrowEntry.KeyShares[2] };

            var Secret = new Secret(RecoveryShares);
            PersonalSession = MeshSession.Recover(
                Secret, "alice@example.com");
            }</pre>
<a class="pilcrow" href="#s-6_8-5">&para;</a>    </section>
    
    <section id="n-connecting-a-new-device">
      <h4 id="s-6_9">
        <a class="selfRef" href="#s-6_9">6.9.</a>
        <a class="selfRef" href="#n-connecting-a-new-device">Connecting a New Device</a>
      </h4>
      <p id="s-6_9-1">Device connection involves two devices, the device to be connected and the device used to approve the request. <a class="pilcrow" href="#s-6_9-1">&para;</a></p>
      <p id="s-6_9-2">The new device:<a class="pilcrow" href="#s-6_9-2">&para;</a></p>
      <ol id="s-6_9-3-">
        <li id="s-6_9-3">Create a device profile for the new device.<a class="pilcrow" href="#s-6_9-3">&para;</a></li>
        <li id="s-6_9-4">Request connection to the new device<a class="pilcrow" href="#s-6_9-4">&para;</a></li>
        <li id="s-6_9-5">Wait for the result.<a class="pilcrow" href="#s-6_9-5">&para;</a></li>
      </ol>
      <p id="s-6_9-6">These calls are shown .<a class="pilcrow" href="#s-6_9-6">&para;</a></p>
      <pre id="s-6_9-7">        void RequestConnect (string Address) {
            var DeviceRegistration = MeshSession.CreateDevice();
            var Connect = MeshSession.Connect(DeviceRegistration,
                    Address, out var Authenticator);
            PersonalSession = Connect.Await();
            }</pre>
<a class="pilcrow" href="#s-6_9-7">&para;</a>      <p id="s-6_9-8">In a real example, we would want to show the connection authentication code to the user so that they can verify that they are responding to the right request on the approval device.<a class="pilcrow" href="#s-6_9-8">&para;</a></p>
      <p id="s-6_9-9">On the approval device, the application<a class="pilcrow" href="#s-6_9-9">&para;</a></p>
      <ol id="s-6_9-10-">
        <li id="s-6_9-10">Requests a list of pending requests using <code>ConnectPending</code>.<a class="pilcrow" href="#s-6_9-10">&para;</a></li>
        <li id="s-6_9-11">Accepts or Rejects devices using <code>ConnectClose</code>.<a class="pilcrow" href="#s-6_9-11">&para;</a></li>
      </ol>
      <pre id="s-6_9-12">        void AcceptPending () {

            var Pending = PersonalSession.ConnectPending();
            foreach (var Request in Pending.Pending) {
                var Result = PersonalSession.ConnectClose(Request,
                    ConnectionStatus.Accepted);
                }
            }</pre>
<a class="pilcrow" href="#s-6_9-12">&para;</a>    </section>
    
    <section id="n-managing-applications">
      <h4 id="s-6_10">
        <a class="selfRef" href="#s-6_10">6.10.</a>
        <a class="selfRef" href="#n-managing-applications">Managing Applications</a>
      </h4>
      <p id="s-6_10-1">Application profiles are created in the same manner as personal profiles .<a class="pilcrow" href="#s-6_10-1">&para;</a></p>
      <pre id="s-6_10-2">            var PasswordProfile = new PasswordProfile(true);
            var RegistrationApplication =
                    RegistrationPersonal.Add(PasswordProfile, false);</pre>
<a class="pilcrow" href="#s-6_10-2">&para;</a>      <p id="s-6_10-3">Changes to the Application Profile are written to the <code>RegistrationApplication</code> instance and then committed using the <code>Update()</code> method.<a class="pilcrow" href="#s-6_10-3">&para;</a></p>
    </section>
    
    <section id="n-using-other-languages">
      <h3 id="s-7">
        <a class="selfRef" href="#s-7">7.</a>
        <a class="selfRef" href="#n-using-other-languages">Using other languages</a>
      </h3>
      <p id="s-7-1">If you are building Mesh applications in another language, the least effort approach may be to rewrite the PROTOGEN build tool to target your language.<a class="pilcrow" href="#s-7-1">&para;</a></p>
      <p id="s-7-2">Protogen does support generation of C header files that may be used to drive a parser. If however you are adding Mesh support for an application that already uses JSON based protocols, you might want to edit the generator scripting files to generate code for your existing libraries.<a class="pilcrow" href="#s-7-2">&para;</a></p>
    </section>
    
    <section id="n-lightweight-api">
      <h4 id="s-7_1">
        <a class="selfRef" href="#s-7_1">7.1.</a>
        <a class="selfRef" href="#n-lightweight-api">Lightweight API</a>
      </h4>
      <p id="s-7_1-1">A lightweight API providing the minimal features required to Mesh enable an application is required. Such an API should exclude most account management features:<a class="pilcrow" href="#s-7_1-1">&para;</a></p>
      <ul id="s-7_1-2-">
        <li id="s-7_1-2">Creating new Personal Profiles and portal accounts.<a class="pilcrow" href="#s-7_1-2">&para;</a></li>
        <li id="s-7_1-3">Key escrow, recovery<a class="pilcrow" href="#s-7_1-3">&para;</a></li>
        <li id="s-7_1-4">List, accept pending device connection requests<a class="pilcrow" href="#s-7_1-4">&para;</a></li>
      </ul>
      <p id="s-7_1-5">This leaves the following features:<a class="pilcrow" href="#s-7_1-5">&para;</a></p>
      <ul id="s-7_1-6-">
        <li id="s-7_1-6">Create Device Profile<a class="pilcrow" href="#s-7_1-6">&para;</a></li>
        <li id="s-7_1-7">Request device connection<a class="pilcrow" href="#s-7_1-7">&para;</a></li>
        <li id="s-7_1-8">Get Personal Profile<a class="pilcrow" href="#s-7_1-8">&para;</a></li>
        <li id="s-7_1-9">Get, Update, Application Profile<a class="pilcrow" href="#s-7_1-9">&para;</a></li>
      </ul>
      <p id="s-7_1-10">In addition to providing less functionality, an implementation of the lightweight binding is likely to be written in a 'flattened' style rather than the abstracted, object oriented approach of the reference code.<a class="pilcrow" href="#s-7_1-10">&para;</a></p>
    </section>
    
    <section id="n-implementation-status-0">
      <h3 id="s-8">
        <a class="selfRef" href="#s-8">8.</a>
        <a class="selfRef" href="#n-implementation-status-0">Implementation Status</a>
      </h3>
      <p id="s-8-1">This section records the status of known implementations of the protocol defined by this specification at the time of posting of this Internet-Draft, and is based on a proposal described in <a class="xref" href="#RFC6892">[RFC6892]</a>.  The description of implementations in this section is intended to assist the IETF in its decision processes in progressing drafts to RFCs.  Please note that the listing of any individual implementation here does not imply endorsement by the IETF.  Furthermore, no effort has been spent to verify the information presented here that was supplied by IETF contributors. This is not intended as, and must not be construed to be, a catalog of available implementations or their features.  Readers are advised to note that other implementations may exist. <a class="pilcrow" href="#s-8-1">&para;</a></p>
      <p id="s-8-2">According to <a class="xref" href="#RFC6892">[RFC6892]</a>, "this will allow reviewers and working groups to assign due consideration to documents that have the benefit of running code, which may serve as evidence of valuable experimentation and feedback that have made the implemented protocols more mature.  It is up to the individual working groups to use this information as they see fit". <a class="pilcrow" href="#s-8-2">&para;</a></p>
    </section>
    
    <section id="n-reference-implementation">
      <h4 id="s-8_1">
        <a class="selfRef" href="#s-8_1">8.1.</a>
        <a class="selfRef" href="#n-reference-implementation">Reference Implementation</a>
      </h4>
      <p id="s-8_1-1">Organization: Comodo Group Inc.<a class="pilcrow" href="#s-8_1-1">&para;</a></p>
      <p id="s-8_1-2">Implementer: Phillip Hallam-Baker<a class="pilcrow" href="#s-8_1-2">&para;</a></p>
      <p id="s-8_1-3">Maturity: Experimental Prototype<a class="pilcrow" href="#s-8_1-3">&para;</a></p>
      <p id="s-8_1-4">This implementation was used to produce the reference section and all the examples in this document. Since the conversion of specification to code is automatic, there is a high degree of assurance that the reference implementation is consistent with this document.<a class="pilcrow" href="#s-8_1-4">&para;</a></p>
    </section>
    
    <section id="n-coverage">
      <h5 id="s-8_1_1">
        <a class="selfRef" href="#s-8_1_1">8.1.1.</a>
        <a class="selfRef" href="#n-coverage">Coverage:</a>
      </h5>
      <p id="s-8_1_1-1">The draft-xx branch describes the code used to create version xx of this document.<a class="pilcrow" href="#s-8_1_1-1">&para;</a></p>
      <p id="s-8_1_1-2">The main current limitations are that the code only supports RSA key pairs and for ease of development the server does not persist keys across sessions. Nor does the implementation currently support the HTTP payload authentication and encryption layer or make use of TLS. These could be easily fixed.<a class="pilcrow" href="#s-8_1_1-2">&para;</a></p>
      <p id="s-8_1_1-3">The client and server are implemented as libraries that may be called from a multi-protocol server. A standalone server will be provided in a future release.<a class="pilcrow" href="#s-8_1_1-3">&para;</a></p>
      <p id="s-8_1_1-4">Only the JSON encoding is currently implemented. The JSON-B, JSON-C, ASN.1 and TLS Schema implementations are all supported by the code generation tool but not currently implemented as the build tool bindings for those encodings have not yet been finalized or documented.<a class="pilcrow" href="#s-8_1_1-4">&para;</a></p>
      <p id="s-8_1_1-5">The key restrictions for TLS key exchange have not yet been implemented.<a class="pilcrow" href="#s-8_1_1-5">&para;</a></p>
      <p id="s-8_1_1-6">The code has only been tested on Windows 10 but passed compatibility testing for both Mono and dotNetCore 2.0 run times which should in theory permit use on Linux and OSX platforms.<a class="pilcrow" href="#s-8_1_1-6">&para;</a></p>
    </section>
    
    <section id="n-licensing">
      <h5 id="s-8_1_2">
        <a class="selfRef" href="#s-8_1_2">8.1.2.</a>
        <a class="selfRef" href="#n-licensing">Licensing</a>
      </h5>
      <p id="s-8_1_2-1">The code is released under an MIT License<a class="pilcrow" href="#s-8_1_2-1">&para;</a></p>
      <p id="s-8_1_2-2">Source code is available from GitHub at https://github.com/hallambaker/Mathematical-Mesh<a class="pilcrow" href="#s-8_1_2-2">&para;</a></p>
    </section>
    
    <section id="n-implementation-experience">
      <h5 id="s-8_1_3">
        <a class="selfRef" href="#s-8_1_3">8.1.3.</a>
        <a class="selfRef" href="#n-implementation-experience">Implementation Experience</a>
      </h5>
      <p id="s-8_1_3-1">The implementation and specification documentation were developed in Visual Studio using the PHB Build Tools suite.<a class="pilcrow" href="#s-8_1_3-1">&para;</a></p>
    </section>
    
    <section id="n-contact-info">
      <h5 id="s-8_1_4">
        <a class="selfRef" href="#s-8_1_4">8.1.4.</a>
        <a class="selfRef" href="#n-contact-info">Contact Info</a>
      </h5>
      <p id="s-8_1_4-1">Contact Phillip Hallam-Baker phill@hallambaker.com<a class="pilcrow" href="#s-8_1_4-1">&para;</a></p>
    </section>
    
    <section id="n-security-considerations">
      <h3 id="s-9">
        <a class="selfRef" href="#s-9">9.</a>
        <a class="selfRef" href="#n-security-considerations">Security Considerations</a>
      </h3>
      <p id="s-9-1">Security Considerations are addressed in the companion document <a class="xref" href="#draft-hallambaker-mesh-architecture">[draft-hallambaker-mesh-architecture]</a><a class="pilcrow" href="#s-9-1">&para;</a></p>
    </section>
    
    <section id="n-iana-considerations">
      <h3 id="s-10">
        <a class="selfRef" href="#s-10">10.</a>
        <a class="selfRef" href="#n-iana-considerations">IANA Considerations</a>
      </h3>
      <p id="s-10-1">This document specifies no actions for IANA<a class="pilcrow" href="#s-10-1">&para;</a></p>
    </section>
    
    <section id="n-acknowledgements">
      <h3 id="s-11">
        <a class="selfRef" href="#s-11">11.</a>
        <a class="selfRef" href="#n-acknowledgements">Acknowledgements</a>
      </h3>
      <p id="s-11-1">Comodo Group: Egemen Tas, Melhi Abdulhayoğlu, Rob Stradling, Robin Alden.<a class="pilcrow" href="#s-11-1">&para;</a></p>
    </section>
    
    <section id="n-references">
      <h2>
        <a class="selfRef" href="#n-references">References</a>
      </h2>
      <section id="n-normative">
        <h3>
          <a class="selfRef" href="#n-normative">Normative References</a>
        </h3>
        <dl class="reference">
          <dt id="RFC4716">[RFC4716]</dt>
          <dd>
            <span class="refAuthor">J. Galbraith</span>
            <span>and</span>
            <span class="refAuthor">R. Thayer</span>
            "<span class="refTitle">The Secure Shell (SSH) Public Key File Format</span>"
            <span Class="refSeries">
              <span class="refSeriesName">RFC</span>
              <span class="refSeriesValue">4716</span>
            </span>
            <span Class="refSeries">
              <span class="refSeriesName">DOI</span>
              <span class="refSeriesValue">10.17487/RFC4716</span>
            </span>
            <time class="refDate" datetime="2006-11">November 2006</time>
          </dd>
        </dl>
      </section>
      
      <section id="n-informative">
        <h3>
          <a class="selfRef" href="#n-informative">Informative References</a>
        </h3>
        <dl class="reference">
          <dt id="RFC6892">[RFC6892]</dt>
          <dd>
            <span class="refAuthor">E. Wilde</span>
            "<span class="refTitle">The 'describes' Link Relation Type</span>"
            <span Class="refSeries">
              <span class="refSeriesName">RFC</span>
              <span class="refSeriesValue">6892</span>
            </span>
            <span Class="refSeries">
              <span class="refSeriesName">DOI</span>
              <span class="refSeriesValue">10.17487/RFC6892</span>
            </span>
            <time class="refDate" datetime="2013-03">March 2013</time>
          </dd>
          <dt id="draft-hallambaker-mesh-architecture">[draft-hallambaker-mesh-architecture]</dt>
          <dd>
            <span class="refAuthor">Phillip Hallam-Baker</span>
            "<span class="refTitle">Mathematical Mesh 3.0 Part I: Architecture Guide</span>"
            <span Class="refSeries">
              <span class="refSeriesName">Internet-Draft</span>
              <span class="refSeriesValue">draft-hallambaker-mesh-architecture-16</span>
            </span>
            &lt;<a class="refTarget">https://www.ietf.org/archive/id/draft-hallambaker-mesh-architecture-16.txt</a>&gt;
            <time class="refDate" datetime="2021-01-13">13 January 2021</time>
          </dd>
          <dt id="draft-hallambaker-mesh-developer">[draft-hallambaker-mesh-developer]</dt>
          <dd>
            <span class="refAuthor">Phillip Hallam-Baker</span>
            "<span class="refTitle">Mathematical Mesh: Reference Implementation</span>"
            <span Class="refSeries">
              <span class="refSeriesName">Internet-Draft</span>
              <span class="refSeriesValue">draft-hallambaker-mesh-developer-10</span>
            </span>
            &lt;<a class="refTarget">https://www.ietf.org/archive/id/draft-hallambaker-mesh-developer-10.txt</a>&gt;
            <time class="refDate" datetime="2020-07-27">27 July 2020</time>
          </dd>
          <dt id="VS2017">[VS2017]</dt>
          <dd>
            "<span class="refTitle">[Reference Not Found!]</span>"
            <time class="refDate" datetime=""></time>
          </dd>
          <dt id="PHB2017">[PHB2017]</dt>
          <dd>
            "<span class="refTitle">[Reference Not Found!]</span>"
            <time class="refDate" datetime=""></time>
          </dd>
        </dl>
      </section>
      
    </section>
    
    <section id="n-authors">
      <h2>
        <a class="selfRef" href="#n-authors">Author's Address</a>
      </h2>
      <hr class="addr"/>
      <address class="vcard">
        <div class="nameRole">
          <span class="fn">Phillip Hallam-Baker</span>
        </div>
        <div>
          <span>Email:</span>
          <a class="email" href="mailto:phill@hallambaker.com ">phill@hallambaker.com </a>
        </div>
      </address>
    </section>
    
    <div class="docInfo">
      <span class="prepared">
        Prepared: 
        <time datetime="2021-08-05">2021-08-05</time>
      </span>
      <span class="rendered">
        Rendered: 
        <time datetime="2021-08-05">2021-08-05</time>
      </span>
    </div>
    
    <script src="xml2rfc.js" type="text/javascript"></script>
  </body>
</html>
