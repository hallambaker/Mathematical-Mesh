<?xml version='1.0' encoding='utf-8'?>
<rfc xmlns:xi="http://www.w3.org/2001/XInclude" category="info" docName="draft-hallambaker-mesh-architecture-17" indexInclude="false" ipr="trust200902" prepTime="2021-08-05T16:56:44Z" scripts="Common,Latin" sortRefs="true" submissionType="independent" symRefs="true" tocDepth="3" tocInclude="true" version="3" xml:lang="en"><front>
<title abbrev="Mesh Architecture 3.0">Mathematical Mesh 3.0 Part I: Architecture Guide</title>
<seriesInfo name="Internet-Draft" value="draft-hallambaker-mesh-architecture" stream="independent"/>
<author fullname="Phillip Hallam-Baker" initials="P. M." surname="Hallam-Baker"><organization>ThresholdSecrets.com</organization>
<address>
<email>phill@hallambaker.com</email>
</address>
</author>
<date day="5" month="August" year="2021"/>
<area/>
<workgroup/>
<abstract>
<t>The Mathematical Mesh is a Threshold Key Infrastructure that makes computers easier to use by making them more secure. Application of threshold cryptography to key generation and use enables users to make use of public key cryptography across multiple devices with minimal impact on the user experience.</t>
<t>This document provides an overview of the Mesh data structures, protocols and examples of its use.</t>
<t>[Note to Readers] Discussion of this draft takes place on the MATHMESH mailing list (mathmesh@ietf.org), which is archived at https://mailarchive.ietf.org/arch/search/?email_list=mathmesh.</t>
<t>This document is also available online at <eref target="http://mathmesh.com/Documents/draft-hallambaker-mesh-architecture.html"></eref>.</t>
</abstract>
</front>
<middle>
<section title="Introduction" anchor="n-introduction"><t>The Mathematical Mesh (Mesh) is a Threshold Key Infrastructure (TKI) that uses cryptography to make computers easier to use. This document describes version 3.0 of the Mesh architecture and protocols.</t>
<t>In 1977, Public Key cryptography laid out a powerful proposition: If Alice and Bob have private keys on their devices and each knows the public key of the other, Alice and Bob can communicate with confidentiality and integrity. The realization of this proposition at Internet scale was vested in a technology called Public Key Infrastructure (PKI) whose principal function is to provide a trustworthy means by which Alice and Bob can discover each other's public key.</t>
<t>Yet despite the power of PKI, Internet security remains a work in progress. While PKI has proved an effective means of authenticating services to users, attempts to apply PKI to the equally important task of authenticating users to services and securing data at rest have been confined to the margins. One critical reason for that failure is that <em>Public</em> Key Infrastructure has only provided effective tools for managing <em>public</em> keys. If we are to achieve comprehensive Internet security, we must provide every user with the ability to manage <em>private</em> keys across their devices with zero effort on their part.</t>
<t>Threshold cryptography is a sub-field of public key cryptography that defines operations on cryptographic keys, including operations on private keys. Threshold cryptography allows Key generation and key use operations may be split between multiple devices. These tools make zero effort management of private keys practical.</t>
<t>The Mesh is a TKI that addresses the three principal concerns that have proved obstacles to the use of end-to-end security in computer applications:</t>
<ul>
<li>Device management.</li>
<li>Exchange of trusted credentials.</li>
<li>Application configuration management.</li>
</ul>
<t>The infrastructure developed to address these original motivating concerns can be used to facilitate deployment and use of existing security protocols (OpenPGP, S/MIME, SSH) and as a platform for building end-to-end secure network applications. Current Mesh applications include:</t>
<ul>
<li>Multi-factor authentication and confirmation</li>
<li>Credential management </li>
<li>Bookmark/Citation management</li>
<li>Task and workflow management</li>
</ul>
<t>A core principle of the design of the Mesh is <em>autonomy</em>. That is each user has full control over their digital environment and is their own source of authority. They may choose to delegate that authority to another to act on their behalf (i.e. a Trusted Third Party) and they may choose to surrender parts of that authority to others (e.g. an employer) without surrendering their autonomy. Delegation of authority is always for limited times and limited purposes.</t>
<t>Thus, from the user's point of view, the Mesh is divided into two parts: The part of the Mesh that belongs to them and everything else. As with the Internet, which is a network of networks, a Mesh of Meshes has certain properties that are similar to those of its constituent parts and some that are quite different.</t>
<t>This document is not normative. It provides an overview of the Mesh comprising a description of the architecture, and a discussion of typical use cases and requirements. The remainder of the document series provides a summary of the principal components of the Mesh architecture and their relationship to each other.</t>
<t>Normative descriptions of the individual Mesh encodings, data structures and protocols are provided in separate documents addressing each component in turn.</t>
<t>The currently available Mesh document series comprises:</t>
<dl>
<dt>I. Architecture (This document.)</dt>
<dd>
<t>Provides an overview of the Mesh as a system and the relationship between its constituent parts.</t>
</dd>
<dt>II. Uniform Data Fingerprint <xref target="draft-hallambaker-mesh-udf"></xref>.</dt>
<dd>
<t>Describes the UDF format used to represent cryptographic nonces, keys and content digests in the Mesh and the use of Encrypted Authenticated Resource Locators (EARLs) and Strong Internet Names (SINs) that build on the UDF platform.</t>
</dd>
<dt>III. Data at Rest Encryption <xref target="draft-hallambaker-mesh-dare"></xref>.</dt>
<dd>
<t>Describes the cryptographic message and append-only sequence formats used in Mesh applications and the Mesh Service protocol.</t>
</dd>
<dt>IV. Schema Reference <xref target="draft-hallambaker-mesh-schema"></xref>.</dt>
<dd>
<t>Describes the syntax and semantics of Mesh Profiles, Container Entries and Mesh Messages and their use in Mesh Applications.</t>
</dd>
<dt>V. Protocol Reference <xref target="draft-hallambaker-mesh-protocol"></xref>.</dt>
<dd>
<t>Describes the Mesh Service Protocol.</t>
</dd>
<dt>VI. Reliable User Datagram <xref target="draft-hallambaker-mesh-rud"></xref>.</dt>
<dd>
<t>Describes the Mesh presentation and transport layer.</t>
</dd>
<dt>VII Mesh Callsign Service <xref target="draft-hallambaker-mesh-callsign"></xref>.</dt>
<dd>
<t>Describes the Mesh Callsign Service that supports mapping of Mesh callsigns to the corresponding Mesh Service Provider.</t>
</dd>
<dt>VIII. Security Considerations <xref target="draft-hallambaker-mesh-security"></xref></dt>
<dd>
<t>Describes the recommended and required algorithm suites and the security considerations for the Mesh protocol suite.</t>
</dd>
<dt>IX. Cryptographic Algorithms <xref target="draft-hallambaker-mesh-security"></xref></dt>
<dd>
<t>Describes the cryptographic algorithm suites used in the Mesh and the implementation of Multi-Party Encryption and Multi-Party Key Generation used in the Mesh.</t>
</dd>
</dl>
<t>The following documents describe technologies that are used in the Mesh but do not form part of the Mesh specification suite:</t>
<dl>
<dt>X. The Trust Mesh <xref target="draft-hallambaker-mesh-trust"></xref>.</dt>
<dd>
<t>Describes the social work factor metric used to evaluate the effectiveness of different approaches to exchange of credentials between users and organizations in various contexts and argues for a hybrid approach taking advantage of direct trust, Web of Trust and Trusted Third Party models to provide introductions.</t>
</dd>
<dt>JSON-BCD Encoding <xref target="draft-hallambaker-jsonbcd"></xref>.</dt>
<dd>
<t>Describes extensions to the JSON serialization format to allow direct encoding of binary data (JSON-B), compressed encoding (JSON-C) and extended binary data encoding (JSON-D). Each of these encodings is a superset of the previous one so that JSON-B is a superset of JSON, JSON-C is a superset of JSON-B and JSON-D is a superset of JSON-C.</t>
</dd>
<dt>DNS Web Service Discovery <xref target="draft-hallambaker-web-service-discovery"></xref>.</dt>
<dd>
<t>Describes the means by which prefixed DNS SRV and TXT records are used to perform discovery of Web Services.</t>
</dd>
<dt>Threshold Modes in Elliptic Curves <xref target="draft-hallambaker-threshold"></xref>.</dt>
<dd>
<t>Describes threshold key generation and key agreement operations for the Ed25519, Ed448, X25519 and X448 elliptic curves.</t>
</dd>
</dl>
<t>The following documents describe aspects of the Mesh Reference implementation:</t>
<dl>
<dt>Mesh Developer <xref target="draft-hallambaker-mesh-developer"></xref>.</dt>
<dd>
<t>Describes the reference code distribution license terms, implementation status and currently supported functions.</t>
</dd>
<dt>Mesh Platform <xref target="draft-hallambaker-mesh-platform"></xref>.</dt>
<dd>
<t>Describes how platform specific functionality such as secure key storage and trustworthy computing features are employed in the Mesh.</t>
</dd>
</dl>
</section>
<section title="Definitions" anchor="n-definitions"><t>This section presents the related specifications and standards on which the Mesh is built, the terms that are used as terms of art within the Mesh protocols and applications and the terms used as requirements language.</t>
<section title="Related Specifications" anchor="n-related-specifications"><t>Besides the documents that form the Mesh core, the Mesh makes use of many existing Internet standards, including:</t>
<dl>
<dt>Cryptographic Algorithms</dt>
<dd>
<t>The <bcp14>RECOMMENDED</bcp14> and <bcp14>REQUIRED</bcp14> cryptographic algorithms for Mesh implementations are specified in <xref target="draft-hallambaker-mesh-cryptography"></xref>.</t>
<t>In addition, Mesh Devices used to administer non-Mesh applications require support for the cryptographic algorithm suites relevant to the application. </t>
</dd>
<dt>Transport</dt>
<dd>
<t>All Mesh Services make use of multiple layers of security. Protection against traffic analysis and metadata attacks are provided by use of Transport Layer Security <xref target="RFC5246"></xref>. At present, the HTTP/1.1 <xref target="RFC7231"></xref> protocol is used to provide framing of transaction messages.</t>
</dd>
<dt>Encoding</dt>
<dd>
<t>All Mesh protocols and data structures are expressed in the JSON data model and all Mesh applications accept data in standard JSON encoding <xref target="RFC7159"></xref>. The JOSE Signature <xref target="RFC7515"></xref> and Encryption <xref target="RFC7516"></xref> standards are used as the basis for object signing and encryption.</t>
</dd>
</dl>
</section>
<section title="Defined Terms" anchor="n-defined-terms"><t>TBS</t>
</section>
<section title="Requirements Language" anchor="n-requirements-language"><t>The key words "<bcp14>MUST</bcp14>", "<bcp14>MUST NOT</bcp14>", "<bcp14>REQUIRED</bcp14>", "<bcp14>SHALL</bcp14>", "<bcp14>SHALL NOT</bcp14>", "<bcp14>SHOULD</bcp14>", "<bcp14>SHOULD NOT</bcp14>", "<bcp14>RECOMMENDED</bcp14>", "<bcp14>MAY</bcp14>", and "<bcp14>OPTIONAL</bcp14>" in this document are to be interpreted as described in RFC 2119 <xref target="RFC2119"></xref>.</t>
</section>
<section title="Implementation Status" anchor="n-implementation-status"><t>The implementation status of the reference code base is described in the companion document <xref target="draft-hallambaker-mesh-developer"></xref>.</t>
<t>The examples in this document were created on 8/5/2021 4:37:46 PM.  Out of 147 examples, 42 failed. </t>
</section>
</section>
<section title="Requirements" anchor="n-requirements"><t>The Mathematical Mesh (Mesh) is a Threshold Key Infrastructure that uses cryptography to make computers easier to use. </t>
<t>For several decades, it has been widely noted that most users are either unwilling or unable to make even the slightest efforts to protect their security, still less those of other parties. Yet despite this observation being widespread, the efforts of the IT security community have largely focused on changing this user behavior rather that designing applications that respect it. Real users have real work to do and have neither the time nor the inclination to use tools that will negatively impact their performance.</t>
<t>The Mesh is based on the principle that if the Internet is to be secure, if must become effortless to use applications securely. Rather than beginning the design process by imagining all the possible modes of attack and working out how to address these as best as possible without unnecessary inconvenience to the user, we must reverse the question and ask how much security can be provided without requiring any effort whatsoever from the user. This principle is called<strong> Zero Effort Security</strong>.</t>
<t>Today's technology requires users to put their trust in an endless variety of devices, software and services they cannot fully understand let alone control. Even the humble television of the 20th century has been replaced by a 'smart' TV with 15 million lines of code whose undeclared capabilities may well include placing the room in which it is placed under continuous audio and video surveillance.</t>
<t>Every technology deployment by necessity requires some degree of trust on the owner/user's part. But this trust should not compromise the user's autonomy. Delegation of trust should be limited and subject to accountability. If manufacturers continue to fail in this regard, they risk a backlash in which users seek to restore their rights through litigation, legislation or worst of all, simply not buying more technology that they have learned to distrust through their own experience.</t>
<t>The Mesh is based on the principle of radical distrust, that is, if a party is capable of defecting, we assume that they will. As the Russian proverb goes: ???????, ?? ????????: trust, but verify.</t>
<t>In the 1990s, the suggestion that 'hackers' might seek to make financial gains from their activities was denounced as 'fear-mongering'. The suggestion that email or anonymous currencies might be abused received a similar response. Today malware, ransomware and spam have become so ubiquitous that they are no longer news unless the circumstances are particularly egregious. In 1949, Edward A. Murphy Jr. proposed his now eponymous law which states, 'Anything that can go wrong will go wrong'. We must now apply a similar principle to Internet security: 'Anything that can be made to go wrong is already being made to go wrong and will only get worse until something is done to stop it.'</t>
<t>We must dispense with the notion that it is improper or impolite to question the good faith of technology suppliers of any kind whether they be manufacturers, service providers, software authors or reviewers. Modern supply chains are complex, typically involving hundreds if not thousands of potential points of deliberate or accidental compromise. The technology provider who relies on the presumption of good faith on their part risks serious damage to their reputation when others assert that a capability added to their product may have malign uses.</t>
<t>Radical distrust means that we apply the principles of least principle and accountability at every level to the design of the Mesh:</t>
<ul>
<li>Cryptographic keys installed in a product during manufacture are only used for the limited purpose of putting that device under control of the user. </li>
<li>Cryptographic keys and assertions related to management of devices are only visible to the user they belong to and are never exposed to external parties.</li>
<li>Mesh Accounts belong to and are under control of the user they belong to and not the Mesh Service provider which the user can change at will with minimal inconvenience.</li>
<li>Mesh Services do not have access to the plaintext of any Mesh Messages or Mesh Catalog data except for the threshold catalog used by the service as the source of access control policy.</li>
<li>All Mesh Messages are subject to access control by both the inbound and outbound Mesh Service to mitigate messaging abuse.</li>
</ul>
<t>Security is risk management and not the elimination of all possibility of any risk. Radical distrust means that we raise the bar for attackers to the point where for most attackers the risk is greater than the reward. It does not demand that we immediately address every issue with perfection or delay deployment of technologies that are capable of controlling <em>many</em> risks until we have achieved the control of <em>every</em> risk.</t>
<t>In addition to distrusting technology providers the Mesh Architecture allows the user to limit the degree of trust they place in themselves. In the real world, devices are lost or stolen, passwords and activation codes are forgotten, natural or man-made catastrophes cause property and data to be lost. The Mesh permits but does not require use of escrow techniques that allow recovery from such situations.</t>
<section title="The Device Management Challenge" anchor="n-the-device-management-challenge"><t>Existing PKIs were developed in an era when the 'personal computer' was still coming into being. Only a small number of people owned a computer and an even smaller number owned more than one. In these circumstances, it arguably sufficed to provision a user with a single private key on the single device they were likely to use.</t>
<t>Today, computers are ubiquitous and a typical home in the developed world contains several hundred of which a dozen or more may have some form of network access. The modern consumer faces a problem of device management that is considerably more complex than the IT administrator of a small business might have faced in the 1990s but without any of the network management tools such an administrator would expect to have available.</t>
<t>One important consequence of the proliferation of devices is that end-to-end security is no longer sufficient. To be acceptable to users, a system must be ends-to-ends secure. That is, a user must be able to read their encrypted email message on their laptop, tablet, phone, or watch with exactly the same ease of use as if the mail were unencrypted. A cryptographic security control that impedes the user is a control that is not going to be used.</t>
<t>Each personal Mesh contains a device catalog in which the cryptographic credentials and device specific application configurations for each connected device are stored.</t>
<t>Management of the device catalog is restricted to a subset of devices that the owner of the Mesh has specifically authorized for that purpose as administration devices. Only a device with access to a duly authorized administration key can add or remove devices from a personal Mesh.</t>
</section>
<section title="Exchange of trusted credentials." anchor="n-exchange-of-trusted-credentials"><t>One of the most challenging, certainly the most contentious issues in PKI is the means by which cryptographic credentials are published and validated. Here there are two different challenges.</t>
<t>Developing an infrastructure that provides a mapping to a cryptographic key from a name that serves no other purpose than identifying the key is relatively easy. Developing an infrastructure that maps existing names with semantics that are already established is considerably harder.</t>
<t>The Mesh does not attempt to impose criteria for accepting credentials as valid as no such set of criteria can be comprehensive. Rather the Mesh provides an internal trust infrastructure that makes use of a <em>direct trust</em> model similar to that of PGP fingerprints to which external names may be mapped using whatever validation criteria users consider are appropriate to the purpose for which they intend to use them.</t>
<t>The principles of providing extended trust management in the Mesh are further described in <xref target="draft-hallambaker-mesh-trust"></xref>.</t>
</section>
<section title="Application configuration management" anchor="n-application-configuration-management"><t>Configuration of cryptographic applications is typically worse than an afterthought. Configuration of one popular mail user agent to use S/MIME security requires 17 steps to be performed using four separate application programs. And since S/MIME certificates expire, the user is required to repeat these steps every few years. Contrary to the public claims made by one major software vendor it is not necessary to perform 'usability testing' to recognize abject stupidity.</t>
<t>Rather than writing down configuration steps and giving them to the user, we should turn them into code and give them to a machine. Users should never be required to do the work of the machine. Nor should any programmer be allowed to insult the user by casting their effort aside and requiring it to be re-entered.</t>
<t>While most computer professionals who are required to do such tasks on a regular basis will create a tool for the purpose, most users do not have that option. And of those who do write their own tools, only a few have the time and the knowledge to do the job without introducing security vulnerabilities. </t>
</section>
<section title="The Mesh as platform" anchor="n-the-mesh-as-platform"><t>Meeting the core objectives of the Mesh required new naming, communication and cryptographic capabilities provided to be developed. These capabilities may in turn be used to develop new end-to-end secure applications.</t>
<t>For example, the Mesh Catalogs used to maintain collections of device descriptions, bookmarks, credentials, etc. might be used in an electronic records infrastructure to maintain chain of custody of digital evidence.</t>
</section>
<section title="Security" anchor="n-security"><t>The Mesh is designed to provide the greatest practical level of security that does not detract from the user experience. The usual CIA triad is considered:</t>
<dl>
<dt>Confidentiality</dt>
<dd>
<t>The confidentiality of user content should be protected at all times and against all unauthorized parties including their MSP.</t>
<t>Reasonable efforts should be taken to protect user data against traffic analysis and metadata attacks. It is not necessary to consider disclosure of this information to MSPs. Metadata must be shielded from external parties but controls to prevent traffic analysis may be left to implementers.</t>
</dd>
<dt>Integrity</dt>
<dd>
<t>The design should consider unauthorized modification of data to be at least as serious as disclosure.</t>
</dd>
<dt>Availability </dt>
<dd>
<t>The design should consider loss of data likely to be at least as serious as disclosure.</t>
</dd>
</dl>
<t>In addition to protecting the user's data, the Mesh is designed to protect the user's autonomy. While the use of any electronic device or service entails a degree of trust, the user should have the right to decide which devices and which service providers to trust and to have the practical ability to revoke that trust at any time they choose.</t>
</section>
<section title="Enterprise Deployment" anchor="n-enterprise-deployment"><t>Development of PKI has traditionally focused on the needs of large enterprises. The Mesh is focused on the individual user. While this change of focus is in part a recognition of the need to reverse the traditional bias, it is also a recognition of the fact that we must understand the needs of the individual user before attempting to understand the additional needs of an enterprise IT department serving a large number of users.</t>
</section>
</section>
<section title="User Experience" anchor="n-user-experience"><t>This section describes the Mesh in use. These <em>use cases</em> described here are re-visited in the companion Mesh Schema Reference <xref target="draft-hallambaker-mesh-schema"></xref> and Mesh Protocol Reference <xref target="draft-hallambaker-mesh-protocol"></xref> with further details and additional examples.</t>
<t>For clarity and compactness of exposition, these use cases are illustrated using the command line tool <em>meshman</em>, a tool that makes the cryptographic operations explicit. This does not represent the ideal user experience in which Zero-effort security is achieved. Such a user experience requires that the Mesh operations be seamlessly integrated into the user's applications so that instead of using the meshman tool to encrypt or decrypt document, the word processor application itself would be extended to read and write documents encrypted in the DARE format.</t>
<section title="Creating a Mesh Account" anchor="n-creating-a-mesh-account"><t>From the user's perspective, their personal Mesh consists of a collection of devices that communicate seamlessly and securely through a Mesh account serviced by a Mesh Service Provider (MSP).</t>
<figure>
<name>
Alice's personal Mesh.</name>
<!-- Include SVG File ../Images/ArchMeshConnectedDevices.svg --><artwork type="svg">
<svg width="528" height="201" xmlns="http://www.w3.org/2000/svg" >
<g transform="translate(8,16)">
  <path d="M 16,0 L 368,0" fill="none" stroke="black" />
  <path d="M 40,48 L 112,48" fill="none" stroke="black" />
  <path d="M 152,48 L 224,48" fill="none" stroke="black" />
  <path d="M 264,48 L 336,48" fill="none" stroke="black" />
  <path d="M 448,64 L 496,64" fill="none" stroke="black" />
  <path d="M 40,80 L 112,80" fill="none" stroke="black" />
  <path d="M 152,80 L 224,80" fill="none" stroke="black" />
  <path d="M 264,80 L 336,80" fill="none" stroke="black" />
  <path d="M 392,96 L 424,96" fill="none" stroke="black" />
  <path d="M 96,112 L 168,112" fill="none" stroke="black" />
  <path d="M 208,112 L 280,112" fill="none" stroke="black" />
  <path d="M 448,128 L 496,128" fill="none" stroke="black" />
  <path d="M 96,144 L 168,144" fill="none" stroke="black" />
  <path d="M 208,144 L 280,144" fill="none" stroke="black" />
  <path d="M 16,176 L 368,176" fill="none" stroke="black" />
  <path d="M 0,16 L 0,160" fill="none" stroke="black" />
  <path d="M 40,48 L 40,80" fill="none" stroke="black" />
  <path d="M 96,112 L 96,144" fill="none" stroke="black" />
  <path d="M 112,48 L 112,80" fill="none" stroke="black" />
  <path d="M 152,48 L 152,80" fill="none" stroke="black" />
  <path d="M 168,112 L 168,144" fill="none" stroke="black" />
  <path d="M 208,112 L 208,144" fill="none" stroke="black" />
  <path d="M 224,48 L 224,80" fill="none" stroke="black" />
  <path d="M 264,48 L 264,80" fill="none" stroke="black" />
  <path d="M 280,112 L 280,144" fill="none" stroke="black" />
  <path d="M 336,48 L 336,80" fill="none" stroke="black" />
  <path d="M 384,16 L 384,160" fill="none" stroke="black" />
  <path d="M 432,80 L 432,112" fill="none" stroke="black" />
  <path d="M 512,80 L 512,112" fill="none" stroke="black" />
  <polygon points="400.000000,96.000000 388.000000,90.400002 388.000000,101.599998" fill="black" transform="rotate(180.000000, 392.000000, 96.000000)" />
  <polygon points="432.000000,96.000000 420.000000,90.400002 420.000000,101.599998" fill="black" transform="rotate(0.000000, 424.000000, 96.000000)" />
  <path d="M 16,0 A 16,16 0 0,0 0,16" fill="none" stroke="black" />
  <path d="M 368,0 A 16,16 0 0,1 384,16" fill="none" stroke="black" />
  <path d="M 448,64 A 16,16 0 0,0 432,80" fill="none" stroke="black" />
  <path d="M 496,64 A 16,16 0 0,1 512,80" fill="none" stroke="black" />
  <path d="M 432,112 A 16,16 0 0,0 448,128" fill="none" stroke="black" />
  <path d="M 512,112 A 16,16 0 0,1 496,128" fill="none" stroke="black" />
  <path d="M 0,160 A 16,16 0 0,0 16,176" fill="none" stroke="black" />
  <path d="M 384,160 A 16,16 0 0,1 368,176" fill="none" stroke="black" />
  <text text-anchor="middle" font-family="sans-serif" x="200" y="20">o</text>
  <text text-anchor="middle" font-family="sans-serif" x="288" y="68">a</text>
  <text text-anchor="middle" font-family="sans-serif" x="480" y="84">s</text>
  <text text-anchor="middle" font-family="sans-serif" x="208" y="20">n</text>
  <text text-anchor="middle" font-family="sans-serif" x="264" y="20">h</text>
  <text text-anchor="middle" font-family="sans-serif" x="448" y="100">S</text>
  <text text-anchor="middle" font-family="sans-serif" x="464" y="100">r</text>
  <text text-anchor="middle" font-family="sans-serif" x="480" y="116">i</text>
  <text text-anchor="middle" font-family="sans-serif" x="456" y="100">e</text>
  <text text-anchor="middle" font-family="sans-serif" x="176" y="20">e</text>
  <text text-anchor="middle" font-family="sans-serif" x="184" y="20">r</text>
  <text text-anchor="middle" font-family="sans-serif" x="256" y="20">s</text>
  <text text-anchor="middle" font-family="sans-serif" x="504" y="116">r</text>
  <text text-anchor="middle" font-family="sans-serif" x="128" y="132">f</text>
  <text text-anchor="middle" font-family="sans-serif" x="192" y="20">s</text>
  <text text-anchor="middle" font-family="sans-serif" x="248" y="20">e</text>
  <text text-anchor="middle" font-family="sans-serif" x="64" y="68">a</text>
  <text text-anchor="middle" font-family="sans-serif" x="80" y="68">t</text>
  <text text-anchor="middle" font-family="sans-serif" x="176" y="68">h</text>
  <text text-anchor="middle" font-family="sans-serif" x="464" y="84">M</text>
  <text text-anchor="middle" font-family="sans-serif" x="488" y="116">d</text>
  <text text-anchor="middle" font-family="sans-serif" x="200" y="68">e</text>
  <text text-anchor="middle" font-family="sans-serif" x="488" y="100">c</text>
  <text text-anchor="middle" font-family="sans-serif" x="496" y="116">e</text>
  <text text-anchor="middle" font-family="sans-serif" x="216" y="20">a</text>
  <text text-anchor="middle" font-family="sans-serif" x="56" y="68">L</text>
  <text text-anchor="middle" font-family="sans-serif" x="296" y="68">t</text>
  <text text-anchor="middle" font-family="sans-serif" x="488" y="84">h</text>
  <text text-anchor="middle" font-family="sans-serif" x="480" y="100">i</text>
  <text text-anchor="middle" font-family="sans-serif" x="456" y="116">r</text>
  <text text-anchor="middle" font-family="sans-serif" x="312" y="68">h</text>
  <text text-anchor="middle" font-family="sans-serif" x="472" y="100">v</text>
  <text text-anchor="middle" font-family="sans-serif" x="128" y="20">c</text>
  <text text-anchor="middle" font-family="sans-serif" x="224" y="20">l</text>
  <text text-anchor="middle" font-family="sans-serif" x="448" y="116">P</text>
  <text text-anchor="middle" font-family="sans-serif" x="120" y="132">o</text>
  <text text-anchor="middle" font-family="sans-serif" x="120" y="20">i</text>
  <text text-anchor="middle" font-family="sans-serif" x="144" y="20">'</text>
  <text text-anchor="middle" font-family="sans-serif" x="496" y="100">e</text>
  <text text-anchor="middle" font-family="sans-serif" x="136" y="132">f</text>
  <text text-anchor="middle" font-family="sans-serif" x="112" y="20">l</text>
  <text text-anchor="middle" font-family="sans-serif" x="136" y="20">e</text>
  <text text-anchor="middle" font-family="sans-serif" x="152" y="20">s</text>
  <text text-anchor="middle" font-family="sans-serif" x="192" y="68">n</text>
  <text text-anchor="middle" font-family="sans-serif" x="152" y="132">e</text>
  <text text-anchor="middle" font-family="sans-serif" x="240" y="20">M</text>
  <text text-anchor="middle" font-family="sans-serif" x="96" y="68">p</text>
  <text text-anchor="middle" font-family="sans-serif" x="472" y="116">v</text>
  <text text-anchor="middle" font-family="sans-serif" x="112" y="132">C</text>
  <text text-anchor="middle" font-family="sans-serif" x="248" y="132">V</text>
  <text text-anchor="middle" font-family="sans-serif" x="168" y="68">P</text>
  <text text-anchor="middle" font-family="sans-serif" x="472" y="84">e</text>
  <text text-anchor="middle" font-family="sans-serif" x="104" y="20">A</text>
  <text text-anchor="middle" font-family="sans-serif" x="88" y="68">o</text>
  <text text-anchor="middle" font-family="sans-serif" x="304" y="68">c</text>
  <text text-anchor="middle" font-family="sans-serif" x="464" y="116">o</text>
  <text text-anchor="middle" font-family="sans-serif" x="240" y="132">T</text>
  <text text-anchor="middle" font-family="sans-serif" x="168" y="20">P</text>
  <text text-anchor="middle" font-family="sans-serif" x="72" y="68">p</text>
  <text text-anchor="middle" font-family="sans-serif" x="184" y="68">o</text>
  <text text-anchor="middle" font-family="sans-serif" x="280" y="68">W</text>
  <text text-anchor="middle" font-family="sans-serif" x="144" y="132">e</text>
</g></svg>
</artwork>
</figure>
<t>As with an email service provider, the user is only likely to be aware of their interactions with their MSP in the case of a service interruption. As far as the user is concerned the data is replicated across their devices automatically unless there is a problem.</t>
<t>While the term 'account' is used because it is the term a user is familiar with that most closely describes its functions, Mesh accounts are different from traditional Internet accounts in one important respect: In order to realize the principle of 'autonomy', Mesh accounts are created by and <em>belong to</em> the user and not the service provider. Should a serious problem occur, a user may opt to change their MSP. But unlike a changing an SMTP email provider, this change is made seamless and cost free.</t>
<t>Another important difference between the Mesh and SMTP is that all Mesh data is encrypted end to end. The MSP does not have access to any user content and does not have access to any user meta-data except that which is strictly necessary to service the account.</t>
<t>The only Mesh catalogs associated with a Mesh account that can be read by an MSP are the Access Catalog which serves as the basis for specifying and enforcing access control policy on the resources associated with the account and the Publications Catalog which is an index of encrypted data published through the account.</t>
<t>To create a Mesh account, the user need only specify the account name and the initial MSP:</t>
<t>The user specifies the initial account address to be used (alice@example.com). Use of this address is of course dependent on authorization by the Mesh Service Provider (example.com) and is likely to require authentication and possibly payment. </t>
<sourcecode>Alice&gt; account create alice@example.com
Account=alice@example.com
UDF=MC44-IZC3-IWZT-VCVZ-L2AG-HI4E-LOV2
</sourcecode>
<t>The command returns the value of Alice's Mesh Account fingerprint .  This value is used as a unique identifier that is cryptographically bound to the signature key used to authenticate the account profile. </t>
<t>Note that the user does not specify the cryptographic algorithms to use. Choice of cryptographic algorithm is primarily the concern of the protocol designer, not the user. The only circumstance in which users would normally be involved in algorithm selection is when there is a transition in progress from one algorithm suite to another.</t>
<section title="Encrypting and Decrypting files." anchor="n-encrypting-and-decrypting-files"><t>Having created an account, Alice can use it to encrypt files and decrypt them on the same machine.</t>
<t>Alice encrypts the text file plaintext.txt to create an encrypted version readable only by Alice: </t>
<sourcecode>Alice&gt; type plaintext.txt
This is a test
Alice&gt; dare encode plaintext.txt ciphertext.dare /encrypt ^
    alice@example.com
Alice&gt; dare verify ciphertext.dare
File: ciphertext.dare
    Bytes: 16
    Encryption Algorithm: A256CBC
        Recipient: MCQX-PF7A-LY3G-3ZPI-AIYO-LR5D-YG6W
    Digest Algorithm: S512
    Payload Digest: F278784250269134EA19DB35B1D42263D2FDF3FF799CFF232
7AC396D040C4F5B60DF45FEA7FF5C56E16D87C07E47879FC68FC2999E44FD5317DCC3
115E427FA0
</sourcecode>
<t>Alice can recover the file at any time using the decryption command: </t>
<sourcecode>Alice&gt; dare decode ciphertext.dare plaintext1.txt
Alice&gt; type plaintext1.txt
This is a test
</sourcecode>
<t>Although the encrypted file can be accessed by Alice with precisely the same ease as the plaintext version, the contents of the encrypted file are not readable by any other user of the machine unless  Alice explicitly grants access. The encrypted file may be stored on a shared drive, cloud file system or removable storage without disclosing the contents. </t>
<t>While encrypting and decrypting files using a tool provides the desired functionality, it does not meet our objectives for usability. These capabilities should be integrated into applications or the platform itself.</t>
</section>
<section title="Catalogs" anchor="n-catalogs"><t>Every Mesh account is created with a set of catalogs and spools. For example, the bookmarks catalog maintains a list of the user's Web bookmarks. The credentials catalog maintains a list of the user's usernames and passwords for the various network services they use. As with the file encryption example, these capabilities are clearly going to be most effective when incorporated into the user's applications, (i.e. their Web browser).</t>
<t>Alice adds the username and password she uses to access her weather service account  to her credentials catalog: </t>
<sourcecode>Alice&gt; password add ftp.example.com alice1 password
alice1@ftp.example.com = [password]

Alice&gt; password add www.example.com alice@example.com newpassword
alice@example.com@www.example.com = [newpassword]

</sourcecode>
<t>As with all Mesh Catalogs, the catalog data is encrypted and cannot be accessed by any unauthorized party including the Mesh Service Provider. </t>
<t>If needed, she can retrieve the credentials from the catalog by specifying the network resource to which access is required: </t>
<sourcecode>Alice&gt; password get ftp.example.com
alice1@ftp.example.com = [password]

</sourcecode>
<t>This capability provides a means of preventing one of the most common causes of enterprise password breach in which a system administrator encodes the access credentials for a service into a  script used to access the service. A script containing a command to extract the credentials from a Mesh catalog will only work for a user authorized to access the credentials in the Mesh. </t>
</section>
</section>
<section title="Adding devices" anchor="n-adding-devices"><t>Computers have become ubiquitous and inexpensive. Most people living in affluent countries interact with several dozen computer systems every day. Every household appliance from the television to the coffee pot has become or is in the process of becoming a computer. It is this circumstance that has exposed the critical flaw in traditional PKI: The lack of practical means of managing private keys across multiple devices.</t>
<t>The Mesh allows users to connect all their devices together so that they may be considered part of a single entity whose component parts communicate and interact seamlessly and securely.</t>
<t>Although any type of network capable device may be connected to a Mesh profile, some devices are better suited for use with certain applications than others. Connecting an oven to a Mesh profile could allow it to be controlled through entries to the user's recipe and calendar catalogs and alert the user when the meal is ready but attempting to use it to read emails or manage Mesh profiles. The Mesh allows the principle of least privilege when connecting a device granting precisely the set of capabilities required to perform its intended function.</t>
<t>Multiple connection mechanisms are specified, each of which provides strong mutual authentication. In each case, the connection request must be approved by a device provisioned with the Mesh administration privilege: </t>
<dl>
<dt>Direct</dt>
<dd>
<t>The connection request is initiated on the device being requested and approved on the administration device. Authentication of the connection request is performed by comparing witness values presented on the connecting device and the administration device.</t>
</dd>
<dt>PIN</dt>
<dd>
<t>A PIN code is generated on an administration device and passed to the connecting device out of band. The connecting device provides proof of knowledge of this PIN code when making the connection request allowing an administration device to approve the request automatically without further user interaction.</t>
</dd>
<dt>Dynamic QR</dt>
<dd>
<t>This connection mechanism is a variation of the PIN connection mechanism in which administration device presents the PIN code value to the connecting device in the form of a QR code. This allows a connecting device with a camera to connect with minimal user effort.</t>
</dd>
<dt>Static QR</dt>
<dd>
<t>This connection method is designed to support connection of constrained IoT devices that lack a camera or display capability. An administration device equipped with a camera reads a static QR code printed on the device that provides the information used to enable the administration device to establish a local network connection (e.g. WiFi, Bluetooth, strobe, IR) that can be used to complete the connection.</t>
</dd>
</dl>
<t>For example, Alice connects a second device using the direct connection mechanism:</t>
<t>The connection request is initiated on the device being connected: </t>
<sourcecode>Alice2&gt; device request alice@example.com
   Device UDF = MCV4-LGJA-J6TI-ZJ4D-SXJW-BOK2-HCZL
   Witness value = BVVL-2ATV-2U2Q-V3AL-HU54-C55J-XZKU
</sourcecode>
<t>Using her administration device, Alice gets a list of pending requests. Seeing that there is a pending request matching the witness value presented by the device, Alice accepts the request, granting the new device the messaging and web roles: </t>
<sourcecode>Alice&gt; device pending
MessageID: BVVL-2ATV-2U2Q-V3AL-HU54-C55J-XZKU
        Connection Request::
        MessageID: BVVL-2ATV-2U2Q-V3AL-HU54-C55J-XZKU
        To:  From:
        Device:  MCV4-LGJA-J6TI-ZJ4D-SXJW-BOK2-HCZL
        Witness: BVVL-2ATV-2U2Q-V3AL-HU54-C55J-XZKU
Alice&gt; device accept BVVL-2ATV-2U2Q-V3AL-HU54-C55J-XZKU /message /web
</sourcecode>
<t>Alice can now synchronize her newly connected device to her account: </t>
<sourcecode>Alice2&gt; device complete
   Device UDF = MCV4-LGJA-J6TI-ZJ4D-SXJW-BOK2-HCZL
   Account = alice@example.com
   Account UDF = MC44-IZC3-IWZT-VCVZ-L2AG-HI4E-LOV2
</sourcecode>
<t>These connection mechanisms are described in detail in the Mesh Protocol Reference <xref target="draft-hallambaker-mesh-protocol"></xref>.</t>
<section title="Decrypting files on the new device" anchor="n-decrypting-files-on-the-new-device"><t>Having connected a second device and granted it 'Web' rights, Alice can use it to decrypt files and access her bookmark and password catalogs in exactly the same fashion as the first. If a password is changed on one device, all her connected devices receive the update.</t>
<t>For example, bacause Alice granted the device the Web role, she can now access her credential  catalog and decrypt the file she encrypted on her first device from the new device: </t>
<sourcecode>Missing example 1</sourcecode>
<t>Should the new device be lost, stolen or simply broken, Alice can prevent further use of the device to decrypt her data by disconnecting it from her Mesh:</t>
<t>Alice disconnects the new device: </t>
<sourcecode>Alice&gt; device delete MCV4-LGJA-J6TI-ZJ4D-SXJW-BOK2-HCZL
</sourcecode>
<t>The device can no longer access the password catalog: </t>
<sourcecode>Alice2&gt; account sync
Alice2&gt; dare decode ciphertext.dare plaintext2.txt
</sourcecode>
<t>The use of threshold decryption allows the Mesh Service Provider to control the use of decryption by Alice's devices without having the ability to decrypt the content itself.</t>
</section>
<section title="Applications" anchor="n-applications"><t>Connected devices can also make use of connected applications for which they are granted the necessary rights.</t>
<t>Alice creates an SSH profile within her Mesh on the administrative device. </t>
<sourcecode>Missing example 3</sourcecode>
<t>After configuring an SSH server to accept her new SSH credential, she can use any of her devices  that has been granted the SSH right to connect to it. </t>
<t>In this case Alice has chosen to use an SSH configuration in which a single client key is shared across multiple devices. The Mesh is in principle capable of supporting more sophisticated configurations in which use of the client key is under control of a threshold service and/or each device has its own individual private. Consideration of these configuration modes is currently outside the scope of work for the Mesh and is probably more usefully considered as part of an effort to integrate Mesh functionality into the SSH system. This would also allow support for features such as recording SSH server key fingerprints in the Mesh Contacts catalog.</t>
<t>Alice could enable use of OpenPGP and S/MIME on her connected devices that have been granted the <tt>messaging</tt> right in a similar way. All the network and security configuration data required to use one of her email accounts is stored in her Mesh applications catalog. The Mesh client performs all the steps required to obtain and install CA issued certificates. As with the SSH example, while it is quite possible to support all the necessary functionality through the Mesh alone, a better result is likely to be achieved by modifying the SMTP email clients and Certificate Authority infrastructures.</t>
</section>
</section>
<section title="Mesh Messaging" anchor="n-mesh-messaging"><t>The Mesh Messaging system is a push messaging system analogous to SMTP, but its purpose is limited to secure exchange of control plane messages. This leads to some important differences:</t>
<ul>
<li>Every message is signed and end-to-end encrypted </li>
<li>The only communication pattern supported is a four-corner model in which users exchange messages through their respective MSPs.</li>
<li>Every message is subject to access control at the inbound and outbound MSP.</li>
<li>Message content is limited to 32KB.</li>
</ul>
<t>This size restriction ensures that exchange of Mesh Messages does not impose an undue burden on the inbound and outbound MSP. It is not necessary for a sender to transfer multiple MB message before the receiver decides to refuse it for some reason. Connected devices may efficiently synchronize their message spools even over limited bandwidth connections. A short message is never blocked by a larger one.</t>
<t>Should exchange of longer messages be desired, a pull model is employed. A Mesh message is used to send a message advising the recipient's client of the location from which the full content may be obtained. This approach has many benefits over the SMTP push model. There is no longer a need for any limitation on message size. The same messaging platform can be used to send a short text message, a spreadsheet or raw video files.</t>
<t>Exchange of certain content types naturally leads to security concerns. These concerns are mitigated in the Mesh by performing access control on every message. When accepting Bob as a partner, Alice can choose the types of Mesh Message and the types of content she is willing to accept from him. Thus, Alice might be willing to accept a spreadsheet containing macro code from Bob but not from Carol or Mallet. And she might not want to accept anything at all from Susan because of past abuse.</t>
<t>While there are important technical differences between Mesh Messaging and SMTP, these are not visible to Alice or Bob except insofar as there is no restriction on message size other than the storage capacity of the machine they wish to receive the messages on, there is very little scope for messaging abuse and (unless the Mesh becomes ubiquitous) they can only use Mesh Messaging to communicate with other Mesh users. Thus, while Mesh messaging has been designed to enable replacement of SMTP in the long term, it is not currently a focus for the client implementations. Use of Mesh messaging is thus currently limited to support for applications built on the Mesh platform. One of those applications is the device connection protocol describe earlier. Another is the contact exchange protocol used to acquire contact information from other Mesh users.</t>
<section title="Contact exchange" anchor="n-contact-exchange"><t>Besides management of private keys across devices, the biggest obstacle to effective use of existing security protocols such as SSH, OpenPGP and S/MIME is the difficulty of obtaining the authentic public keys of the counterparties.</t>
<t>The question of issue and validation of credentials is a complex and difficult one that does not have a single answer that is valid for every use case. For certain applications credentials issued by a Trusted Third Party are appropriate. For others, the Web of Trust proposed in OpenPGP provides a better fit to the requirements and constraints. These issues are discussed in <xref target="draft-hallambaker-mesh-trust"></xref>.</t>
<t>Rather than imposing a single trust model for credential acquisition, the Mesh allows the use of whatever model is best for validating a credential for a particular use. It is unlikely Alice would have the same security concerns for communication with her employer, her friends, her bank, etc.</t>
<t>For many applications, Trust After First Use provides an adequate basis for credential acquisition.</t>
<t>Alice wants to exchange Mesh messages with Bob. Although Alice knows Bob's Mesh address  (bob@example.com), she does not (yet) have permission to send any message to Bob excepting a request to exchange contact information. </t>
<t>Bob sends Alice a contact exchange request: </t>
<sourcecode>Bob&gt; message contact alice@example.com
Envelope ID: MCG2-IRWQ-RZUE-YG57-P7EC-43FA-CX7O
Message ID: NDIB-OGS2-XXZG-D2M2-5YJI-QQXN-2IVO
Response ID: MDIP-WVY2-OH4C-BBQQ-IWOX-3IA3-NIV3
</sourcecode>
<t>Alice checks his Mesh messages and approves Bob's request: </t>
<sourcecode>Alice&gt; account sync
Alice&gt; message pending
MessageID: NDIB-OGS2-XXZG-D2M2-5YJI-QQXN-2IVO
        Contact Request::
        MessageID: NDIB-OGS2-XXZG-D2M2-5YJI-QQXN-2IVO
        To: alice@example.com From: bob@example.com
        PIN: AAKO-AYTU-YH3M-DWOO-SLKU-N7ZD-SKUA
Alice&gt; message accept NDIB-OGS2-XXZG-D2M2-5YJI-QQXN-2IVO
Alice&gt; contact list
Entry: MC44-IZC3-IWZT-VCVZ-L2AG-HI4E-LOV2
  Person MC44-IZC3-IWZT-VCVZ-L2AG-HI4E-LOV2
  Anchor MC44-IZC3-IWZT-VCVZ-L2AG-HI4E-LOV2
  Address alice@example.com

Entry: NAJX-T6KH-4NGQ-ES47-AIIU-6633-XMB6
  Person
  Anchor MA6I-MJ5Z-7BBO-TEBA-HQF6-LNR6-72SF
  Address bob@example.com

</sourcecode>
<t>Bob can now collect Alice's contact: </t>
<sourcecode>Bob&gt; account sync /auto
Bob&gt; contact list
Entry: MA6I-MJ5Z-7BBO-TEBA-HQF6-LNR6-72SF
  Person MA6I-MJ5Z-7BBO-TEBA-HQF6-LNR6-72SF
  Anchor MA6I-MJ5Z-7BBO-TEBA-HQF6-LNR6-72SF
  Address bob@example.com

Entry: NCTK-FA6N-VGLJ-XAXE-QEDD-6WXC-7ALP
  Person
  Anchor MC44-IZC3-IWZT-VCVZ-L2AG-HI4E-LOV2
  Address alice@example.com

</sourcecode>
<t>At this point Alice and Bob can exchange Mesh messages of any type with seamless end to end security. Every Mesh message is signed and encrypted without exception. If Alice and Bob have used the Mesh to configure their email accounts for OpenPGP or S/MIME, they can use these to exchange end-to-end secure SMTP mail.</t>
<t>Alternatively, Bob might have opted to grant Alice only specific messaging access. Bob might choose to restrict synchronous messaging modalities such as instant messaging or voice that interrupt his workflow to specific colleagues. The fact that Alice wants to speak to Bob does not necessarily mean she is interested in what he might say in reply. Thus, messaging access need not be reciprocated.</t>
<t>As with device connection, multiple contact exchange methods are supported including the use of a QR code printed on a business card or presented on a mobile device. These methods are also described in <xref target="draft-hallambaker-mesh-protocol"></xref>.</t>
<t>As a respected figure within the cryptographic community, Alice might employ a curation service for credential requests advising her that Bob's credentials appear to be in order while Mallet's are suspicious. Such services might be offered by her MSP or another provider. Alice might be willing to accept contact requests from members of professional associations she is a member of or who have attended certain conferences in her field. A variety of approaches might be followed for curation of other requests including Machine Learning approaches.</t>
</section>
<section title="Confirmation service" anchor="n-confirmation-service"><t>The Mesh confirmation service is an improvement of traditional second factor authentication techniques offering offers far greater usability and security.</t>
<t>Instead of being asked to present a meaningless numeric code, Alice is presented a request from a named, authenticated source to confirm a specific action. Alice's response will be signed using a signature key that is unique to the particular confirmation device she uses, thus providing a non-repudiable record of her decision.</t>
<t>Alice attempts to log into a secure console in the control room. The secure console recognizes  Alice but a second factor is required. The console issues a challenge to Alice at her registered account asking if she would like to log into the secure console: </t>
<sourcecode>Console&gt; message confirm alice@example.com start
Envelope ID: MAHP-YGCF-WQAV-CSRH-Y6GA-AAP3-VKLY
Message ID: NBLG-QNFG-5NRO-K2PT-JIBB-4AVX-X2L6
Response ID: MDKO-2LBI-LVRI-6F7K-FSQC-NYLV-E76L
</sourcecode>
<t>Alice checks her pending messages and accepts the request: </t>
<sourcecode>Alice&gt; message accept NBLG-QNFG-5NRO-K2PT-JIBB-4AVX-X2L6
</sourcecode>
<t>The secure console verifies the response and grants access: </t>
<sourcecode>Console&gt; message status MDKO-2LBI-LVRI-6F7K-FSQC-NYLV-E76L
Accept
</sourcecode>
<t>In an enterprise environment, tying the confirmation process to a specific source, a specific action and specific device allows for confirmation interactions to be used to implement business processes with attribution and thus accountability.</t>
<t>Using traditional second factor approaches, a system administrator presents their credentials to authenticate access to the machine at which point they can perform any action permitted by their current privileges. This typically includes modification of any access logs that might be kept. Using the confirmation approach the individual actions of the system administrator may be authenticated, traced and logged. If a user account is added to the system, it is known which administrator is responsible and the device that was used. This information may then be used if it becomes necessary to unwind the consequences of a breach or an insider threat.</t>
</section>
</section>
<section title="Encryption Groups" anchor="n-encryption-groups"><t>As seen earlier, the Mesh allows encrypted files to be shared with other named users. While this capability is sufficient for simple messaging type use cases, decades of experience prove that it is inadequate to meet the needs of protecting data at rest. In the simple messaging case the list of recipients is known to the sender at the time a message is sent. In the general case the party encrypting the data cannot know the list of intended readers because that will change over time.</t>
<t>Even in the smallest organization, employees join and leave. A new employee must be granted access to all the information they need for their work. The access rights of a terminated employee must also terminate.</t>
<t>Traditional 'Digital Rights Management' product employ key management techniques originating in the field of copyright enforcement to control access to content by controlling disclosure of symmetric decryption keys. This provides the necessary flexibility to control access to the data but leaves the decryption keys vulnerable to a server breach. Such systems do not provide 'end-to-end' security in any useful sense.</t>
<t>Use of threshold techniques allows a threshold service to control decryption of the data without having the ability to decrypt. Sharing data through a Mesh group allows access to be controlled without loss of end-to-end encryption. </t>
<t>Alice creates the recryption group groupw@example.com to share confidential information with her closest friends: </t>
<sourcecode>Alice&gt; group create groupw@example.com
Account=groupw@example.com
UDF=MCTZ-HSH7-NUNV-MQ3Z-XNJ6-XGB3-VBPX
</sourcecode>
<t>Alice encrypts a test file but he can't decrypt it because she hasn't added herself  to the group yet. </t>
<sourcecode>Alice&gt; dare encode grouptext.txt groupsecret.dare /encrypt ^
    groupw@example.com
Alice&gt; dare decode groupsecret.dare grouptext_bob.dare
ERROR - No decryption key is available
</sourcecode>
<t>Alice adds herself to the group, now she can decrypt: </t>
<sourcecode>Alice&gt; group add groupw@example.com alice@example.com
{
  "ContactAddress": "alice@example.com",
  "MemberCapabilityId": "MCHU-Q4TP-GE2Y-6DNU-UYEF-P3BF-LZTB",
  "ServiceCapabilityId": "NA3H-TSPB-TVND-S6NK-57T4-6TYM-ZT3Z"}
Alice&gt; account sync /auto
Alice&gt; dare decode groupsecret.dare grouptext_alice.dare
Alice&gt; type grouptext_alice.dare
The group secret handshake
</sourcecode>
<t>At this point, Bob can't encrypt or decrypt messages because he doesn't know the  public key and he isn't in the group. Alice could allow Bob to encrypt but not decrypt by sending him the group contact information. Instead she adds Bob to  the group: </t>
<sourcecode>Alice&gt; group add groupw@example.com bob@example.com
{
  "ContactAddress": "bob@example.com",
  "MemberCapabilityId": "MCHU-Q4TP-GE2Y-6DNU-UYEF-P3BF-LZTB",
  "ServiceCapabilityId": "NBDJ-WYQO-UIEH-OVLK-B3UM-J5TN-AQ3P"}
</sourcecode>
<t>Adding Bob to the group gives him immediate access to any file encrypted under the group key without making any change to the encrypted files: </t>
<sourcecode>Missing example 4</sourcecode>
<t>Removing Bob from the group immediately withdraws his access. </t>
<sourcecode>Missing example 5</sourcecode>
<t>Bob cannot decrypt any more files (but he may have kept copies of files he decrypted  earlier). </t>
<sourcecode>Missing example 6</sourcecode>
</section>
<section title="Escrow and Recovery" anchor="n-escrow-and-recovery"><t>While disclosure of sensitive data might cause serious harm to its owner it is very rarely the case that the consequences of disclosure are greater than the consequences of loss. Thus, whenever static data is to be encrypted, the question of key recovery must be considered.</t>
<t>Alice decides to create a recovery key set. To do this, she specifies the number of key shares to be created and the number required for recovery:</t>
<sourcecode>Alice&gt; account escrow
Share: SAQL-G6IN-REG2-KFQW-43NB-6ZJL-6UGE-J2TV-ELBC-QV2Y-OI2K-ICIU-6E
YP-XKVO-P2SA
Share: SAQZ-54IY-TLPG-EUP6-RWUO-4UQK-X5NQ-QB7B-SYA5-S5XT-D4T7-J327-LP
QH-VQY6-76YA
Share: SARI-U2JD-VSXR-7DPG-GR33-2PXJ-RGU4-WJKO-BFAY-VFUN-ZQNU-LVNJ-Y2
H7-TW4P-QC6A
</sourcecode>
<t>Recovery of the key data requires the key recovery record and a quorum of the key shares:</t>
<sourcecode>Missing example 2</sourcecode>
</section>
<section title="Future Applications" anchor="n-future-applications"><t>The Mesh is a Threshold Key Infrastructure and as with any infrastructure, it is designed as a platform to support as wide a range of future developments as possible. As shown previously, the Mesh Messaging system provides an improved superset of the functions of SMTP. It is also capable of being extended to support every current communication modality with true end-to-end protection of data confidentiality.</t>
<section title="Synchronous Messaging" anchor="n-synchronous-messaging"><t>Addition of a presence service capability to the MSP would allow Mesh Messaging to be used to support the full range of synchronous messaging services from text chat (e.g. xmpp) to video and VOIP.</t>
<t>The main technical issue to be addressed to enable such a service is specifying a means of layering Mesh Messages direct over UDP transport. This is currently at the concept phase. While the precise means of layering audio and video formats onto a network connection is a complex problem, it is one that has already been solved by existing standards.</t>
</section>
<section title="Social Media" anchor="n-social-media"><t>One of the chief distinctions between messaging and 'social media' and is that the former is typically used to describe a synchronous interaction between a closed group of users while most social media consists of asynchronous interactions which are frequently (but not always) public.</t>
<t>The Data At Rest Envelope technology used in the Mesh was originally designed to support asynchronous social media interactions with full end-to-end confidentiality. The service hosting a forum or discussion board need not have access to the content of the messages to support the complete range of user interactions.</t>
</section>
</section>
</section>
<section title="Mesh Cryptography" anchor="n-mesh-cryptography"><t>All the cryptographic algorithms used in the Mesh are either industry standards or present a work factor that is provably equivalent to an industry standard approach. Since threshold cryptography is not currently part of the 'canon' from which designers of cryptographic security protocols work, much of the cryptography used in the Mesh has been designed for the Mesh. Despite this fact, it is properly regarded as part of the Internet platform on which the Mesh is built rather than a part of the Mesh itself.</t>
<t>Existing Internet security protocols are based on approaches developed in the 1990s when performance tradeoffs were a prime consideration in the design of cryptographic protocols. Security was focused on the transport layer as it provided the best security possible given the available resources.</t>
<t>With rare exceptions, most computing devices manufactured in the past ten years offer either considerably more computing power than was typical of 1990s era Internet connected machines or considerably less. The Mesh architecture is designed to provide security infrastructure both classes of machine but with the important constraint that the less capable 'constrained' devices are considered to be 'network capable' rather than 'Internet capable' and that the majority of Mesh related processing will be offloaded to another device.</t>
<t>For example, Alice uses her Desktop and Laptop to exchange end-to-end secure Mesh Messages and documents but her Internet-of-Things food blender and light bulb are limited in the range of functions they support and the telemetry information they provide. The IoT devices connect to a Mesh Hub which acts as an always-on point of presence for the device state and allows complex cryptographic operations to be offloaded if necessary. </t>
<figure>
<name>
Constrained Devices connected through a Mesh Hub.</name>
<!-- Include SVG File ../Images/ArchConstrainedDevice.svg --><artwork type="svg">
<svg width="584" height="281" xmlns="http://www.w3.org/2000/svg" >
<g transform="translate(8,16)">
  <path d="M 56,0 L 280,0" fill="none" stroke="black" />
  <path d="M 56,32 L 280,32" fill="none" stroke="black" />
  <path d="M 16,96 L 88,96" fill="none" stroke="black" />
  <path d="M 128,96 L 200,96" fill="none" stroke="black" />
  <path d="M 240,96 L 312,96" fill="none" stroke="black" />
  <path d="M 16,128 L 88,128" fill="none" stroke="black" />
  <path d="M 128,128 L 200,128" fill="none" stroke="black" />
  <path d="M 240,128 L 312,128" fill="none" stroke="black" />
  <path d="M 232,176 L 280,176" fill="none" stroke="black" />
  <path d="M 280,176 L 344,176" fill="none" stroke="black" />
  <path d="M 192,224 L 264,224" fill="none" stroke="black" />
  <path d="M 304,224 L 376,224" fill="none" stroke="black" />
  <path d="M 192,256 L 264,256" fill="none" stroke="black" />
  <path d="M 304,256 L 376,256" fill="none" stroke="black" />
  <path d="M 16,96 L 16,128" fill="none" stroke="black" />
  <path d="M 56,48 L 56,80" fill="none" stroke="black" />
  <path d="M 88,96 L 88,128" fill="none" stroke="black" />
  <path d="M 128,96 L 128,128" fill="none" stroke="black" />
  <path d="M 168,48 L 168,80" fill="none" stroke="black" />
  <path d="M 192,224 L 192,256" fill="none" stroke="black" />
  <path d="M 200,96 L 200,128" fill="none" stroke="black" />
  <path d="M 232,176 L 232,208" fill="none" stroke="black" />
  <path d="M 240,96 L 240,128" fill="none" stroke="black" />
  <path d="M 264,224 L 264,256" fill="none" stroke="black" />
  <path d="M 280,48 L 280,80" fill="none" stroke="black" />
  <path d="M 280,144 L 280,176" fill="none" stroke="black" />
  <path d="M 304,224 L 304,256" fill="none" stroke="black" />
  <path d="M 312,96 L 312,128" fill="none" stroke="black" />
  <path d="M 344,176 L 344,208" fill="none" stroke="black" />
  <path d="M 376,224 L 376,256" fill="none" stroke="black" />
  <path d="M 56,40 L 56,48" fill="none" stroke="black" />
  <polygon points="72.000000,48.000000 60.000000,42.400002 60.000000,53.599998" fill="black" transform="rotate(270.000000, 56.000000, 48.000000)" />
  <path d="M 56,80 L 56,88" fill="none" stroke="black" />
  <polygon points="72.000000,80.000000 60.000000,74.400002 60.000000,85.599998" fill="black" transform="rotate(90.000000, 56.000000, 80.000000)" />
  <path d="M 168,40 L 168,48" fill="none" stroke="black" />
  <polygon points="184.000000,48.000000 172.000000,42.400002 172.000000,53.599998" fill="black" transform="rotate(270.000000, 168.000000, 48.000000)" />
  <path d="M 168,80 L 168,88" fill="none" stroke="black" />
  <polygon points="184.000000,80.000000 172.000000,74.400002 172.000000,85.599998" fill="black" transform="rotate(90.000000, 168.000000, 80.000000)" />
  <path d="M 232,208 L 232,216" fill="none" stroke="black" />
  <polygon points="248.000000,208.000000 236.000000,202.399994 236.000000,213.600006" fill="black" transform="rotate(90.000000, 232.000000, 208.000000)" />
  <path d="M 280,40 L 280,48" fill="none" stroke="black" />
  <polygon points="296.000000,48.000000 284.000000,42.400002 284.000000,53.599998" fill="black" transform="rotate(270.000000, 280.000000, 48.000000)" />
  <path d="M 280,80 L 280,88" fill="none" stroke="black" />
  <polygon points="296.000000,80.000000 284.000000,74.400002 284.000000,85.599998" fill="black" transform="rotate(90.000000, 280.000000, 80.000000)" />
  <path d="M 280,136 L 280,144" fill="none" stroke="black" />
  <polygon points="296.000000,144.000000 284.000000,138.399994 284.000000,149.600006" fill="black" transform="rotate(270.000000, 280.000000, 144.000000)" />
  <path d="M 344,208 L 344,216" fill="none" stroke="black" />
  <polygon points="360.000000,208.000000 348.000000,202.399994 348.000000,213.600006" fill="black" transform="rotate(90.000000, 344.000000, 208.000000)" />
  <path d="M 56,0 A 16,16 0 0,0 40,16" fill="none" stroke="black" />
  <path d="M 280,0 A 16,16 0 0,1 296,16" fill="none" stroke="black" />
  <path d="M 40,16 A 16,16 0 0,0 56,32" fill="none" stroke="black" />
  <path d="M 296,16 A 16,16 0 0,1 280,32" fill="none" stroke="black" />
  <text text-anchor="middle" font-family="sans-serif" x="136" y="20">e</text>
  <text text-anchor="middle" font-family="sans-serif" x="224" y="68">s</text>
  <text text-anchor="middle" font-family="sans-serif" x="64" y="116">o</text>
  <text text-anchor="middle" font-family="sans-serif" x="280" y="116">b</text>
  <text text-anchor="middle" font-family="sans-serif" x="104" y="20">s</text>
  <text text-anchor="middle" font-family="sans-serif" x="248" y="20">r</text>
  <text text-anchor="middle" font-family="sans-serif" x="136" y="68">s</text>
  <text text-anchor="middle" font-family="sans-serif" x="208" y="68">e</text>
  <text text-anchor="middle" font-family="sans-serif" x="248" y="68">e</text>
  <text text-anchor="middle" font-family="sans-serif" x="168" y="116">t</text>
  <text text-anchor="middle" font-family="sans-serif" x="128" y="20">S</text>
  <text text-anchor="middle" font-family="sans-serif" x="200" y="20">r</text>
  <text text-anchor="middle" font-family="sans-serif" x="272" y="116">u</text>
  <text text-anchor="middle" font-family="sans-serif" x="208" y="244">l</text>
  <text text-anchor="middle" font-family="sans-serif" x="336" y="244">u</text>
  <text text-anchor="middle" font-family="sans-serif" x="208" y="20">o</text>
  <text text-anchor="middle" font-family="sans-serif" x="128" y="68">e</text>
  <text text-anchor="middle" font-family="sans-serif" x="200" y="68">M</text>
  <text text-anchor="middle" font-family="sans-serif" x="240" y="68">g</text>
  <text text-anchor="middle" font-family="sans-serif" x="328" y="244">B</text>
  <text text-anchor="middle" font-family="sans-serif" x="168" y="20">c</text>
  <text text-anchor="middle" font-family="sans-serif" x="72" y="116">p</text>
  <text text-anchor="middle" font-family="sans-serif" x="240" y="244">e</text>
  <text text-anchor="middle" font-family="sans-serif" x="160" y="116">k</text>
  <text text-anchor="middle" font-family="sans-serif" x="144" y="20">r</text>
  <text text-anchor="middle" font-family="sans-serif" x="192" y="20">P</text>
  <text text-anchor="middle" font-family="sans-serif" x="88" y="68">e</text>
  <text text-anchor="middle" font-family="sans-serif" x="96" y="68">s</text>
  <text text-anchor="middle" font-family="sans-serif" x="216" y="68">s</text>
  <text text-anchor="middle" font-family="sans-serif" x="256" y="68">s</text>
  <text text-anchor="middle" font-family="sans-serif" x="136" y="116">D</text>
  <text text-anchor="middle" font-family="sans-serif" x="224" y="244">n</text>
  <text text-anchor="middle" font-family="sans-serif" x="352" y="244">b</text>
  <text text-anchor="middle" font-family="sans-serif" x="240" y="20">e</text>
  <text text-anchor="middle" font-family="sans-serif" x="112" y="68">a</text>
  <text text-anchor="middle" font-family="sans-serif" x="152" y="116">s</text>
  <text text-anchor="middle" font-family="sans-serif" x="200" y="244">B</text>
  <text text-anchor="middle" font-family="sans-serif" x="344" y="244">l</text>
  <text text-anchor="middle" font-family="sans-serif" x="152" y="20">v</text>
  <text text-anchor="middle" font-family="sans-serif" x="216" y="20">v</text>
  <text text-anchor="middle" font-family="sans-serif" x="32" y="116">L</text>
  <text text-anchor="middle" font-family="sans-serif" x="232" y="244">d</text>
  <text text-anchor="middle" font-family="sans-serif" x="176" y="20">e</text>
  <text text-anchor="middle" font-family="sans-serif" x="120" y="68">g</text>
  <text text-anchor="middle" font-family="sans-serif" x="144" y="116">e</text>
  <text text-anchor="middle" font-family="sans-serif" x="264" y="116">H</text>
  <text text-anchor="middle" font-family="sans-serif" x="216" y="244">e</text>
  <text text-anchor="middle" font-family="sans-serif" x="248" y="244">r</text>
  <text text-anchor="middle" font-family="sans-serif" x="96" y="20">e</text>
  <text text-anchor="middle" font-family="sans-serif" x="112" y="20">h</text>
  <text text-anchor="middle" font-family="sans-serif" x="232" y="68">a</text>
  <text text-anchor="middle" font-family="sans-serif" x="56" y="116">t</text>
  <text text-anchor="middle" font-family="sans-serif" x="160" y="20">i</text>
  <text text-anchor="middle" font-family="sans-serif" x="224" y="20">i</text>
  <text text-anchor="middle" font-family="sans-serif" x="104" y="68">s</text>
  <text text-anchor="middle" font-family="sans-serif" x="48" y="116">p</text>
  <text text-anchor="middle" font-family="sans-serif" x="176" y="116">o</text>
  <text text-anchor="middle" font-family="sans-serif" x="184" y="116">p</text>
  <text text-anchor="middle" font-family="sans-serif" x="88" y="20">M</text>
  <text text-anchor="middle" font-family="sans-serif" x="232" y="20">d</text>
  <text text-anchor="middle" font-family="sans-serif" x="80" y="68">M</text>
  <text text-anchor="middle" font-family="sans-serif" x="40" y="116">a</text>
</g></svg>
</artwork>
</figure>
<section title="Best Practice by Default" anchor="n-best-practice-by-default"><t>Except where support for external applications demand otherwise, the Mesh requires that the following 'best practices' be followed:</t>
<dl>
<dt>Industry Standard Algorithms</dt>
<dd>
<t>All cryptographic protocols make use of the most recently adopted industry standard algorithms. </t>
</dd>
<dt>Strongest Work Factor</dt>
<dd>
<t>Only the strongest modes of each cipher algorithm are used. All symmetric encryption is performed with 256-bit session keys and all digest algorithms are used in 512-bit output length mode. </t>
</dd>
<dt>Key Hygiene</dt>
<dd>
<t>Separate public key pairs are used for all cryptographic functions: Encryption, Signature and Authentication. This enables separate control regimes for the separate functions and partitioning of cryptographic functions within the application itself.  </t>
</dd>
<dt>Bound Device Keys</dt>
<dd>
<t>Each device has a separate set of Encryption, Signature and Authentication key pairs. These <bcp14>MAY</bcp14> be bound to the device to which they are assigned using hardware or other techniques to prevent or discourage export.</t>
</dd>
<dt>No Optional Extras</dt>
<dd>
<t>Traditional approaches to security have treated many functions as being 'advanced' and thus suited for use by only the most sophisticated users. The Mesh rejects this approach noting that all users operate in precisely the same environment facing precisely the same threats.</t>
</dd>
</dl>
</section>
<section title="Multi-Level Security" anchor="n-multilevel-security"><t>All Mesh protocol transactions are protected at the Transport, Message and Data level. This provides security in depth that cannot be achieved by applying security at the separate levels independently. Data level encryption provides end-to-end confidentiality and non-repudiation, Message level authentication provides the basis for access control and Transport level encryption provides a degree of protection against traffic analysis.</t>
</section>
<section title="Threshold Decryption" anchor="n-threshold-decryption"><t>Traditional public key encryption algorithms have two keys, one for encryption and another for decryption. The Mesh makes use of threshold cryptography techniques to allow the decryption key to be split into two or more parts.</t>
<t>For example, if we have a private key <em>z</em>, we can use this to perform a key agreement with a public key <em>S</em> to obtain the key agreement value A. But if <em>z</em> = (<em>x+y</em>) mod <em>g</em> (where g is the order of the group). we can obtain the exact same result by applying the private keys <em>x</em> and <em>y</em> to <em>S</em> separately and combining the results:</t>
<figure>
<name>
Two key decryption.</name>
<!-- Include SVG File ../Images/ArchDistributed.svg --><artwork type="svg">
<svg width="544" height="137" xmlns="http://www.w3.org/2000/svg" >
<g transform="translate(8,16)">
  <path d="M 0,0 L 152,0" fill="none" stroke="black" />
  <path d="M 344,16 L 480,16" fill="none" stroke="black" />
  <path d="M 152,48 L 320,48" fill="none" stroke="black" />
  <path d="M 160,64 L 328,64" fill="none" stroke="black" />
  <path d="M 344,96 L 480,96" fill="none" stroke="black" />
  <path d="M 0,112 L 152,112" fill="none" stroke="black" />
  <path d="M 0,0 L 0,112" fill="none" stroke="black" />
  <path d="M 152,0 L 152,48" fill="none" stroke="black" />
  <path d="M 152,48 L 152,112" fill="none" stroke="black" />
  <path d="M 328,32 L 328,64" fill="none" stroke="black" />
  <path d="M 328,64 L 328,80" fill="none" stroke="black" />
  <path d="M 496,32 L 496,80" fill="none" stroke="black" />
  <polygon points="168.000000,64.000000 156.000000,58.400002 156.000000,69.599998" fill="black" transform="rotate(180.000000, 160.000000, 64.000000)" />
  <polygon points="328.000000,48.000000 316.000000,42.400002 316.000000,53.599998" fill="black" transform="rotate(0.000000, 320.000000, 48.000000)" />
  <path d="M 344,16 A 16,16 0 0,0 328,32" fill="none" stroke="black" />
  <path d="M 480,16 A 16,16 0 0,1 496,32" fill="none" stroke="black" />
  <path d="M 328,80 A 16,16 0 0,0 344,96" fill="none" stroke="black" />
  <path d="M 496,80 A 16,16 0 0,1 480,96" fill="none" stroke="black" />
  <text text-anchor="middle" font-family="sans-serif" x="120" y="36">)</text>
  <text text-anchor="middle" font-family="sans-serif" x="96" y="52">m</text>
  <text text-anchor="middle" font-family="sans-serif" x="376" y="52">s</text>
  <text text-anchor="middle" font-family="sans-serif" x="64" y="100">x</text>
  <text text-anchor="middle" font-family="sans-serif" x="240" y="36">S</text>
  <text text-anchor="middle" font-family="sans-serif" x="392" y="52">a</text>
  <text text-anchor="middle" font-family="sans-serif" x="104" y="84">.</text>
  <text text-anchor="middle" font-family="sans-serif" x="240" y="84">.</text>
  <text text-anchor="middle" font-family="sans-serif" x="432" y="36">e</text>
  <text text-anchor="middle" font-family="sans-serif" x="72" y="52">y</text>
  <text text-anchor="middle" font-family="sans-serif" x="48" y="84">u</text>
  <text text-anchor="middle" font-family="sans-serif" x="120" y="100">.</text>
  <text text-anchor="middle" font-family="sans-serif" x="56" y="20">D</text>
  <text text-anchor="middle" font-family="sans-serif" x="32" y="52">=</text>
  <text text-anchor="middle" font-family="sans-serif" x="88" y="36">i</text>
  <text text-anchor="middle" font-family="sans-serif" x="24" y="84">a</text>
  <text text-anchor="middle" font-family="sans-serif" x="64" y="84">a</text>
  <text text-anchor="middle" font-family="sans-serif" x="368" y="84">a</text>
  <text text-anchor="middle" font-family="sans-serif" x="128" y="100">S</text>
  <text text-anchor="middle" font-family="sans-serif" x="96" y="36">s</text>
  <text text-anchor="middle" font-family="sans-serif" x="408" y="36">v</text>
  <text text-anchor="middle" font-family="sans-serif" x="16" y="52">z</text>
  <text text-anchor="middle" font-family="sans-serif" x="80" y="52">)</text>
  <text text-anchor="middle" font-family="sans-serif" x="456" y="84">S</text>
  <text text-anchor="middle" font-family="sans-serif" x="80" y="100">S</text>
  <text text-anchor="middle" font-family="sans-serif" x="88" y="20">c</text>
  <text text-anchor="middle" font-family="sans-serif" x="32" y="84">l</text>
  <text text-anchor="middle" font-family="sans-serif" x="112" y="84">S</text>
  <text text-anchor="middle" font-family="sans-serif" x="376" y="84">l</text>
  <text text-anchor="middle" font-family="sans-serif" x="424" y="84">e</text>
  <text text-anchor="middle" font-family="sans-serif" x="80" y="20">i</text>
  <text text-anchor="middle" font-family="sans-serif" x="368" y="52">(</text>
  <text text-anchor="middle" font-family="sans-serif" x="16" y="84">C</text>
  <text text-anchor="middle" font-family="sans-serif" x="408" y="84">a</text>
  <text text-anchor="middle" font-family="sans-serif" x="48" y="36">h</text>
  <text text-anchor="middle" font-family="sans-serif" x="400" y="36">e</text>
  <text text-anchor="middle" font-family="sans-serif" x="72" y="36">e</text>
  <text text-anchor="middle" font-family="sans-serif" x="112" y="36">x</text>
  <text text-anchor="middle" font-family="sans-serif" x="64" y="52">+</text>
  <text text-anchor="middle" font-family="sans-serif" x="432" y="52">s</text>
  <text text-anchor="middle" font-family="sans-serif" x="96" y="84">x</text>
  <text text-anchor="middle" font-family="sans-serif" x="232" y="84">y</text>
  <text text-anchor="middle" font-family="sans-serif" x="72" y="100">.</text>
  <text text-anchor="middle" font-family="sans-serif" x="96" y="20">e</text>
  <text text-anchor="middle" font-family="sans-serif" x="56" y="36">a</text>
  <text text-anchor="middle" font-family="sans-serif" x="56" y="52">x</text>
  <text text-anchor="middle" font-family="sans-serif" x="400" y="52">r</text>
  <text text-anchor="middle" font-family="sans-serif" x="72" y="84">t</text>
  <text text-anchor="middle" font-family="sans-serif" x="64" y="20">e</text>
  <text text-anchor="middle" font-family="sans-serif" x="64" y="36">r</text>
  <text text-anchor="middle" font-family="sans-serif" x="48" y="52">(</text>
  <text text-anchor="middle" font-family="sans-serif" x="112" y="52">d</text>
  <text text-anchor="middle" font-family="sans-serif" x="408" y="52">e</text>
  <text text-anchor="middle" font-family="sans-serif" x="424" y="52">i</text>
  <text text-anchor="middle" font-family="sans-serif" x="56" y="84">l</text>
  <text text-anchor="middle" font-family="sans-serif" x="392" y="84">u</text>
  <text text-anchor="middle" font-family="sans-serif" x="48" y="100">=</text>
  <text text-anchor="middle" font-family="sans-serif" x="72" y="20">v</text>
  <text text-anchor="middle" font-family="sans-serif" x="128" y="52">g</text>
  <text text-anchor="middle" font-family="sans-serif" x="456" y="52">)</text>
  <text text-anchor="middle" font-family="sans-serif" x="80" y="84">e</text>
  <text text-anchor="middle" font-family="sans-serif" x="416" y="84">t</text>
  <text text-anchor="middle" font-family="sans-serif" x="448" y="84">.</text>
  <text text-anchor="middle" font-family="sans-serif" x="40" y="84">c</text>
  <text text-anchor="middle" font-family="sans-serif" x="360" y="84">C</text>
  <text text-anchor="middle" font-family="sans-serif" x="384" y="84">c</text>
  <text text-anchor="middle" font-family="sans-serif" x="440" y="84">y</text>
  <text text-anchor="middle" font-family="sans-serif" x="112" y="100">y</text>
  <text text-anchor="middle" font-family="sans-serif" x="32" y="100">S</text>
  <text text-anchor="middle" font-family="sans-serif" x="40" y="36">s</text>
  <text text-anchor="middle" font-family="sans-serif" x="392" y="36">S</text>
  <text text-anchor="middle" font-family="sans-serif" x="416" y="36">i</text>
  <text text-anchor="middle" font-family="sans-serif" x="104" y="52">o</text>
  <text text-anchor="middle" font-family="sans-serif" x="384" y="52">h</text>
  <text text-anchor="middle" font-family="sans-serif" x="400" y="84">l</text>
  <text text-anchor="middle" font-family="sans-serif" x="24" y="100">.</text>
  <text text-anchor="middle" font-family="sans-serif" x="96" y="100">+</text>
  <text text-anchor="middle" font-family="sans-serif" x="32" y="36">(</text>
  <text text-anchor="middle" font-family="sans-serif" x="424" y="36">c</text>
  <text text-anchor="middle" font-family="sans-serif" x="448" y="52">y</text>
  <text text-anchor="middle" font-family="sans-serif" x="248" y="84">S</text>
  <text text-anchor="middle" font-family="sans-serif" x="16" y="100">z</text>
</g></svg>
</artwork>
</figure>
<t>The approach to threshold decryption used in the Mesh was originally inspired by the work of Matt Blaze et. al. on proxy re-encryption. But the approach used may also be considered a form of Torben Pedersen's Distributed Key generation which is in turn one form of threshold cryptography.</t>
<t>This technique is used in the Mesh to allow use of decryption key held by a user to be controlled by a cloud service without giving the cloud service the ability to decrypt by itself.</t>
<t>These techniques are described in detail in <xref target="draft-hallambaker-threshold"></xref>.</t>
</section>
<section title="Threshold Key Generation" anchor="n-threshold-key-generation"><t>The mathematics that support threshold decryption are also the basis for the multi-party key generation mechanism that is applied at multiple levels in the Mesh. The basis for the multi-party key generation used in the Mesh is that for any Diffie-Hellman type cryptographic scheme, given two keypairs { <em>x</em>, <em>X</em> }, { <em>y</em>, <em>Y</em> }, we calculate the public key corresponding to the private key <em>x </em>+ <em>y</em> using just the public key values <em>X </em>and <em>Y</em>.</t>
<figure>
<name>
Two party key pair generation.</name>
<!-- Include SVG File ../Images/ArchCogen.svg --><artwork type="svg">
<svg width="464" height="217" xmlns="http://www.w3.org/2000/svg" >
<g transform="translate(8,16)">
  <path d="M 112,32 L 312,32" fill="none" stroke="black" />
  <path d="M 112,80 L 312,80" fill="none" stroke="black" />
  <path d="M 112,160 L 312,160" fill="none" stroke="black" />
  <polygon points="320.000000,32.000000 308.000000,26.400000 308.000000,37.599998" fill="black" transform="rotate(0.000000, 312.000000, 32.000000)" />
  <polygon points="320.000000,80.000000 308.000000,74.400002 308.000000,85.599998" fill="black" transform="rotate(0.000000, 312.000000, 80.000000)" />
  <polygon points="320.000000,160.000000 308.000000,154.399994 308.000000,165.600006" fill="black" transform="rotate(0.000000, 312.000000, 160.000000)" />
  <text text-anchor="middle" font-family="sans-serif" x="408" y="196">)</text>
  <text text-anchor="middle" font-family="sans-serif" x="72" y="4">e</text>
  <text text-anchor="middle" font-family="sans-serif" x="416" y="4">K</text>
  <text text-anchor="middle" font-family="sans-serif" x="416" y="84">.</text>
  <text text-anchor="middle" font-family="sans-serif" x="24" y="164">x</text>
  <text text-anchor="middle" font-family="sans-serif" x="368" y="164">x</text>
  <text text-anchor="middle" font-family="sans-serif" x="64" y="4">K</text>
  <text text-anchor="middle" font-family="sans-serif" x="368" y="4">u</text>
  <text text-anchor="middle" font-family="sans-serif" x="408" y="36">x</text>
  <text text-anchor="middle" font-family="sans-serif" x="416" y="36">.</text>
  <text text-anchor="middle" font-family="sans-serif" x="32" y="84">y</text>
  <text text-anchor="middle" font-family="sans-serif" x="376" y="164">.</text>
  <text text-anchor="middle" font-family="sans-serif" x="32" y="4">a</text>
  <text text-anchor="middle" font-family="sans-serif" x="32" y="36">x</text>
  <text text-anchor="middle" font-family="sans-serif" x="24" y="4">v</text>
  <text text-anchor="middle" font-family="sans-serif" x="392" y="36">=</text>
  <text text-anchor="middle" font-family="sans-serif" x="392" y="84">=</text>
  <text text-anchor="middle" font-family="sans-serif" x="32" y="164">+</text>
  <text text-anchor="middle" font-family="sans-serif" x="392" y="196">+</text>
  <text text-anchor="middle" font-family="sans-serif" x="40" y="164">y</text>
  <text text-anchor="middle" font-family="sans-serif" x="48" y="4">e</text>
  <text text-anchor="middle" font-family="sans-serif" x="424" y="36">P</text>
  <text text-anchor="middle" font-family="sans-serif" x="408" y="84">y</text>
  <text text-anchor="middle" font-family="sans-serif" x="384" y="196">x</text>
  <text text-anchor="middle" font-family="sans-serif" x="376" y="36">X</text>
  <text text-anchor="middle" font-family="sans-serif" x="424" y="84">P</text>
  <text text-anchor="middle" font-family="sans-serif" x="16" y="4">i</text>
  <text text-anchor="middle" font-family="sans-serif" x="384" y="4">l</text>
  <text text-anchor="middle" font-family="sans-serif" x="432" y="164">P</text>
  <text text-anchor="middle" font-family="sans-serif" x="80" y="4">y</text>
  <text text-anchor="middle" font-family="sans-serif" x="376" y="4">b</text>
  <text text-anchor="middle" font-family="sans-serif" x="376" y="84">Y</text>
  <text text-anchor="middle" font-family="sans-serif" x="408" y="132">Y</text>
  <text text-anchor="middle" font-family="sans-serif" x="392" y="132">X</text>
  <text text-anchor="middle" font-family="sans-serif" x="400" y="148">=</text>
  <text text-anchor="middle" font-family="sans-serif" x="400" y="164">+</text>
  <text text-anchor="middle" font-family="sans-serif" x="376" y="196">(</text>
  <text text-anchor="middle" font-family="sans-serif" x="40" y="4">t</text>
  <text text-anchor="middle" font-family="sans-serif" x="416" y="164">y</text>
  <text text-anchor="middle" font-family="sans-serif" x="424" y="164">.</text>
  <text text-anchor="middle" font-family="sans-serif" x="400" y="196">y</text>
  <text text-anchor="middle" font-family="sans-serif" x="424" y="196">P</text>
  <text text-anchor="middle" font-family="sans-serif" x="400" y="132">+</text>
  <text text-anchor="middle" font-family="sans-serif" x="400" y="180">=</text>
  <text text-anchor="middle" font-family="sans-serif" x="8" y="4">r</text>
  <text text-anchor="middle" font-family="sans-serif" x="424" y="4">e</text>
  <text text-anchor="middle" font-family="sans-serif" x="0" y="4">P</text>
  <text text-anchor="middle" font-family="sans-serif" x="392" y="4">i</text>
  <text text-anchor="middle" font-family="sans-serif" x="400" y="4">c</text>
  <text text-anchor="middle" font-family="sans-serif" x="416" y="196">.</text>
  <text text-anchor="middle" font-family="sans-serif" x="360" y="4">P</text>
  <text text-anchor="middle" font-family="sans-serif" x="432" y="4">y</text>
  <text text-anchor="middle" font-family="sans-serif" x="384" y="164">P</text>
</g></svg>
</artwork>
</figure>
<t>Threshold key generation ensures that keys used to bind devices to a personal Mesh or within a Mesh account are 'safe' if any of the contributions to the generation process are safe.</t>
<t>These techniques are also described in detail in <xref target="draft-hallambaker-threshold"></xref>.</t>
</section>
<section title="Threshold Signature" anchor="n-threshold-signature"><t>The techniques that support threshold decryption and key generation are also applicable to signature albeit with some very important constraints. Incorrect implementation of the techniques used to create ECDSA signatures can result in disclosure of the private key. It is therefore essential that a threshold signature algorithm is rigorously reviewed.</t>
<t>This technique is used in the mesh to partition the use of administration keys so that the consequences of losing an administrative device can be mitigated.</t>
<t>These techniques are described in detail in <xref target="draft-hallambaker-threshold-sigs"></xref>.</t>
</section>
<section title="Data At Rest Encryption" anchor="n-data-at-rest-encryption"><t>The Data At Rest Encryption (DARE) format is used for all confidentiality and integrity enhancements. The DARE format is based on the JOSE Signature and Encryption formats and the use of an extended version of the JSON encoding allowing direct encoding of binary objects.</t>
<section title="DARE Envelope" anchor="n-dare-envelope"><t>The DARE Envelope format offers similar capabilities to existing formats such as OpenPGP and CMS without the need for onerous encoding schemes. DARE Assertions are presented as DARE Envelopes.</t>
<t>A feature of the DARE Envelope format not supported in existing schemes is the ability to encrypt and authenticate sets of data attributes separately from the payload. This allows features such as the ability to encrypt a subject line or content type for a message separately from the payload.</t>
</section>
<section title="Dare Container" anchor="n-dare-container"><t>A DARE Container is an append-only sequence of DARE Envelopes. A key feature of the DARE Container format is that entries <bcp14>MAY</bcp14> be encrypted and/or authenticated incrementally. Individual entries <bcp14>MAY</bcp14> be extracted from a DARE Container to create a stand-alone DARE Envelope.</t>
<t>Containers may be authenticated by means of a Merkle tree of digest values on the individual frames. This allows similar demonstrations of integrity to those afforded by Blockchain to be provided but with much greater efficiency.</t>
<t>Unlike traditional encryption formats which require a new public key exchange for each encrypted payload, the DARE Container format allows multiple entries to be encrypted under a single key exchange operation. This is particularly useful in applications such as encrypting server transaction logs. The server need only perform a single key exchange operation each time it starts to establish a new shared secret for that session. The shared secret is then used to create fresh symmetric keying material for each entry in the log using a unique nonce per entry. </t>
<figure>
<name>
DARE Container containing a transaction log.</name>
<!-- Include SVG File ../Images/ArchLog.svg --><artwork type="svg">
<svg width="376" height="361" xmlns="http://www.w3.org/2000/svg" >
<g transform="translate(8,16)">
  <path d="M 0,0 L 272,0" fill="none" stroke="black" />
  <path d="M 272,32 L 328,32" fill="none" stroke="black" />
  <path d="M 0,64 L 272,64" fill="none" stroke="black" />
  <path d="M 280,96 L 328,96" fill="none" stroke="black" />
  <path d="M 0,112 L 272,112" fill="none" stroke="black" />
  <path d="M 280,144 L 328,144" fill="none" stroke="black" />
  <path d="M 0,160 L 272,160" fill="none" stroke="black" />
  <path d="M 272,192 L 312,192" fill="none" stroke="black" />
  <path d="M 0,224 L 272,224" fill="none" stroke="black" />
  <path d="M 280,256 L 328,256" fill="none" stroke="black" />
  <path d="M 0,272 L 272,272" fill="none" stroke="black" />
  <path d="M 280,304 L 312,304" fill="none" stroke="black" />
  <path d="M 0,320 L 272,320" fill="none" stroke="black" />
  <path d="M 0,0 L 0,64" fill="none" stroke="black" />
  <path d="M 0,64 L 0,112" fill="none" stroke="black" />
  <path d="M 0,112 L 0,160" fill="none" stroke="black" />
  <path d="M 0,160 L 0,224" fill="none" stroke="black" />
  <path d="M 0,224 L 0,272" fill="none" stroke="black" />
  <path d="M 0,272 L 0,320" fill="none" stroke="black" />
  <path d="M 0,320 L 0,336" fill="none" stroke="black" />
  <path d="M 272,0 L 272,32" fill="none" stroke="black" />
  <path d="M 272,32 L 272,64" fill="none" stroke="black" />
  <path d="M 272,64 L 272,112" fill="none" stroke="black" />
  <path d="M 272,112 L 272,160" fill="none" stroke="black" />
  <path d="M 272,160 L 272,192" fill="none" stroke="black" />
  <path d="M 272,192 L 272,224" fill="none" stroke="black" />
  <path d="M 272,224 L 272,272" fill="none" stroke="black" />
  <path d="M 272,272 L 272,320" fill="none" stroke="black" />
  <path d="M 272,320 L 272,336" fill="none" stroke="black" />
  <path d="M 312,192 L 312,240" fill="none" stroke="black" />
  <path d="M 312,272 L 312,304" fill="none" stroke="black" />
  <path d="M 328,32 L 328,96" fill="none" stroke="black" />
  <path d="M 328,96 L 328,144" fill="none" stroke="black" />
  <path d="M 328,144 L 328,256" fill="none" stroke="black" />
  <path d="M 312,240 L 312,248" fill="none" stroke="black" />
  <path d="M 312,264 L 312,272" fill="none" stroke="black" />
  <polygon points="288.000000,96.000000 276.000000,90.400002 276.000000,101.599998" fill="black" transform="rotate(180.000000, 280.000000, 96.000000)" />
  <polygon points="288.000000,144.000000 276.000000,138.399994 276.000000,149.600006" fill="black" transform="rotate(180.000000, 280.000000, 144.000000)" />
  <polygon points="288.000000,256.000000 276.000000,250.399994 276.000000,261.600006" fill="black" transform="rotate(180.000000, 280.000000, 256.000000)" />
  <polygon points="288.000000,304.000000 276.000000,298.399994 276.000000,309.600006" fill="black" transform="rotate(180.000000, 280.000000, 304.000000)" />
  <text text-anchor="middle" font-family="sans-serif" x="104" y="84">F</text>
  <text text-anchor="middle" font-family="sans-serif" x="224" y="100">,</text>
  <text text-anchor="middle" font-family="sans-serif" x="216" y="212">3</text>
  <text text-anchor="middle" font-family="sans-serif" x="224" y="212">,</text>
  <text text-anchor="middle" font-family="sans-serif" x="200" y="260">K</text>
  <text text-anchor="middle" font-family="sans-serif" x="248" y="260">4</text>
  <text text-anchor="middle" font-family="sans-serif" x="224" y="308">,</text>
  <text text-anchor="middle" font-family="sans-serif" x="56" y="36">g</text>
  <text text-anchor="middle" font-family="sans-serif" x="128" y="244">m</text>
  <text text-anchor="middle" font-family="sans-serif" x="48" y="36">A</text>
  <text text-anchor="middle" font-family="sans-serif" x="16" y="100">N</text>
  <text text-anchor="middle" font-family="sans-serif" x="24" y="148">o</text>
  <text text-anchor="middle" font-family="sans-serif" x="168" y="308">D</text>
  <text text-anchor="middle" font-family="sans-serif" x="96" y="196">e</text>
  <text text-anchor="middle" font-family="sans-serif" x="144" y="212">=</text>
  <text text-anchor="middle" font-family="sans-serif" x="240" y="260">n</text>
  <text text-anchor="middle" font-family="sans-serif" x="152" y="292">5</text>
  <text text-anchor="middle" font-family="sans-serif" x="104" y="180">F</text>
  <text text-anchor="middle" font-family="sans-serif" x="120" y="308">e</text>
  <text text-anchor="middle" font-family="sans-serif" x="128" y="340">m</text>
  <text text-anchor="middle" font-family="sans-serif" x="32" y="36">y</text>
  <text text-anchor="middle" font-family="sans-serif" x="152" y="196">3</text>
  <text text-anchor="middle" font-family="sans-serif" x="112" y="20">r</text>
  <text text-anchor="middle" font-family="sans-serif" x="192" y="148">(</text>
  <text text-anchor="middle" font-family="sans-serif" x="16" y="212">N</text>
  <text text-anchor="middle" font-family="sans-serif" x="112" y="260">K</text>
  <text text-anchor="middle" font-family="sans-serif" x="200" y="308">K</text>
  <text text-anchor="middle" font-family="sans-serif" x="48" y="196">A</text>
  <text text-anchor="middle" font-family="sans-serif" x="120" y="292">a</text>
  <text text-anchor="middle" font-family="sans-serif" x="40" y="100">c</text>
  <text text-anchor="middle" font-family="sans-serif" x="160" y="52">K</text>
  <text text-anchor="middle" font-family="sans-serif" x="256" y="100">)</text>
  <text text-anchor="middle" font-family="sans-serif" x="72" y="100">n</text>
  <text text-anchor="middle" font-family="sans-serif" x="64" y="196">r</text>
  <text text-anchor="middle" font-family="sans-serif" x="72" y="212">n</text>
  <text text-anchor="middle" font-family="sans-serif" x="216" y="308">3</text>
  <text text-anchor="middle" font-family="sans-serif" x="48" y="52">e</text>
  <text text-anchor="middle" font-family="sans-serif" x="72" y="36">e</text>
  <text text-anchor="middle" font-family="sans-serif" x="256" y="260">)</text>
  <text text-anchor="middle" font-family="sans-serif" x="136" y="36">K</text>
  <text text-anchor="middle" font-family="sans-serif" x="128" y="84">m</text>
  <text text-anchor="middle" font-family="sans-serif" x="160" y="100">K</text>
  <text text-anchor="middle" font-family="sans-serif" x="56" y="212">:</text>
  <text text-anchor="middle" font-family="sans-serif" x="104" y="340">F</text>
  <text text-anchor="middle" font-family="sans-serif" x="80" y="36">e</text>
  <text text-anchor="middle" font-family="sans-serif" x="120" y="212">e</text>
  <text text-anchor="middle" font-family="sans-serif" x="40" y="308">c</text>
  <text text-anchor="middle" font-family="sans-serif" x="40" y="52">c</text>
  <text text-anchor="middle" font-family="sans-serif" x="104" y="196">n</text>
  <text text-anchor="middle" font-family="sans-serif" x="192" y="260">(</text>
  <text text-anchor="middle" font-family="sans-serif" x="192" y="308">(</text>
  <text text-anchor="middle" font-family="sans-serif" x="152" y="132">2</text>
  <text text-anchor="middle" font-family="sans-serif" x="200" y="100">K</text>
  <text text-anchor="middle" font-family="sans-serif" x="168" y="148">D</text>
  <text text-anchor="middle" font-family="sans-serif" x="208" y="212">A</text>
  <text text-anchor="middle" font-family="sans-serif" x="216" y="260">0</text>
  <text text-anchor="middle" font-family="sans-serif" x="136" y="292">e</text>
  <text text-anchor="middle" font-family="sans-serif" x="248" y="52">0</text>
  <text text-anchor="middle" font-family="sans-serif" x="32" y="52">n</text>
  <text text-anchor="middle" font-family="sans-serif" x="48" y="100">e</text>
  <text text-anchor="middle" font-family="sans-serif" x="224" y="148">,</text>
  <text text-anchor="middle" font-family="sans-serif" x="144" y="148">=</text>
  <text text-anchor="middle" font-family="sans-serif" x="240" y="148">n</text>
  <text text-anchor="middle" font-family="sans-serif" x="120" y="196">:</text>
  <text text-anchor="middle" font-family="sans-serif" x="120" y="260">e</text>
  <text text-anchor="middle" font-family="sans-serif" x="72" y="148">n</text>
  <text text-anchor="middle" font-family="sans-serif" x="176" y="212">F</text>
  <text text-anchor="middle" font-family="sans-serif" x="208" y="308">A</text>
  <text text-anchor="middle" font-family="sans-serif" x="120" y="340">a</text>
  <text text-anchor="middle" font-family="sans-serif" x="200" y="148">K</text>
  <text text-anchor="middle" font-family="sans-serif" x="160" y="260">K</text>
  <text text-anchor="middle" font-family="sans-serif" x="136" y="20">e</text>
  <text text-anchor="middle" font-family="sans-serif" x="16" y="260">N</text>
  <text text-anchor="middle" font-family="sans-serif" x="240" y="308">n</text>
  <text text-anchor="middle" font-family="sans-serif" x="120" y="36">:</text>
  <text text-anchor="middle" font-family="sans-serif" x="48" y="148">e</text>
  <text text-anchor="middle" font-family="sans-serif" x="152" y="244">4</text>
  <text text-anchor="middle" font-family="sans-serif" x="208" y="52">A</text>
  <text text-anchor="middle" font-family="sans-serif" x="216" y="52">0</text>
  <text text-anchor="middle" font-family="sans-serif" x="112" y="148">K</text>
  <text text-anchor="middle" font-family="sans-serif" x="24" y="196">e</text>
  <text text-anchor="middle" font-family="sans-serif" x="56" y="100">:</text>
  <text text-anchor="middle" font-family="sans-serif" x="40" y="148">c</text>
  <text text-anchor="middle" font-family="sans-serif" x="256" y="148">)</text>
  <text text-anchor="middle" font-family="sans-serif" x="144" y="260">=</text>
  <text text-anchor="middle" font-family="sans-serif" x="152" y="84">1</text>
  <text text-anchor="middle" font-family="sans-serif" x="16" y="308">N</text>
  <text text-anchor="middle" font-family="sans-serif" x="136" y="132">e</text>
  <text text-anchor="middle" font-family="sans-serif" x="32" y="148">n</text>
  <text text-anchor="middle" font-family="sans-serif" x="104" y="292">F</text>
  <text text-anchor="middle" font-family="sans-serif" x="48" y="212">e</text>
  <text text-anchor="middle" font-family="sans-serif" x="128" y="100">y</text>
  <text text-anchor="middle" font-family="sans-serif" x="96" y="36">e</text>
  <text text-anchor="middle" font-family="sans-serif" x="56" y="52">:</text>
  <text text-anchor="middle" font-family="sans-serif" x="80" y="148">2</text>
  <text text-anchor="middle" font-family="sans-serif" x="32" y="260">n</text>
  <text text-anchor="middle" font-family="sans-serif" x="104" y="20">F</text>
  <text text-anchor="middle" font-family="sans-serif" x="128" y="308">y</text>
  <text text-anchor="middle" font-family="sans-serif" x="72" y="52">n</text>
  <text text-anchor="middle" font-family="sans-serif" x="112" y="100">K</text>
  <text text-anchor="middle" font-family="sans-serif" x="112" y="180">r</text>
  <text text-anchor="middle" font-family="sans-serif" x="168" y="52">D</text>
  <text text-anchor="middle" font-family="sans-serif" x="72" y="308">n</text>
  <text text-anchor="middle" font-family="sans-serif" x="112" y="84">r</text>
  <text text-anchor="middle" font-family="sans-serif" x="160" y="212">K</text>
  <text text-anchor="middle" font-family="sans-serif" x="40" y="260">c</text>
  <text text-anchor="middle" font-family="sans-serif" x="128" y="292">m</text>
  <text text-anchor="middle" font-family="sans-serif" x="80" y="212">3</text>
  <text text-anchor="middle" font-family="sans-serif" x="48" y="260">e</text>
  <text text-anchor="middle" font-family="sans-serif" x="72" y="260">n</text>
  <text text-anchor="middle" font-family="sans-serif" x="112" y="52">K</text>
  <text text-anchor="middle" font-family="sans-serif" x="192" y="212">(</text>
  <text text-anchor="middle" font-family="sans-serif" x="248" y="212">3</text>
  <text text-anchor="middle" font-family="sans-serif" x="208" y="260">A</text>
  <text text-anchor="middle" font-family="sans-serif" x="120" y="100">e</text>
  <text text-anchor="middle" font-family="sans-serif" x="176" y="100">F</text>
  <text text-anchor="middle" font-family="sans-serif" x="136" y="196">K</text>
  <text text-anchor="middle" font-family="sans-serif" x="112" y="244">r</text>
  <text text-anchor="middle" font-family="sans-serif" x="80" y="308">5</text>
  <text text-anchor="middle" font-family="sans-serif" x="80" y="100">1</text>
  <text text-anchor="middle" font-family="sans-serif" x="248" y="100">1</text>
  <text text-anchor="middle" font-family="sans-serif" x="56" y="148">:</text>
  <text text-anchor="middle" font-family="sans-serif" x="112" y="212">K</text>
  <text text-anchor="middle" font-family="sans-serif" x="192" y="100">(</text>
  <text text-anchor="middle" font-family="sans-serif" x="136" y="180">e</text>
  <text text-anchor="middle" font-family="sans-serif" x="40" y="212">c</text>
  <text text-anchor="middle" font-family="sans-serif" x="24" y="36">e</text>
  <text text-anchor="middle" font-family="sans-serif" x="80" y="260">4</text>
  <text text-anchor="middle" font-family="sans-serif" x="128" y="212">y</text>
  <text text-anchor="middle" font-family="sans-serif" x="120" y="244">a</text>
  <text text-anchor="middle" font-family="sans-serif" x="144" y="36">A</text>
  <text text-anchor="middle" font-family="sans-serif" x="72" y="196">e</text>
  <text text-anchor="middle" font-family="sans-serif" x="256" y="52">)</text>
  <text text-anchor="middle" font-family="sans-serif" x="128" y="132">m</text>
  <text text-anchor="middle" font-family="sans-serif" x="112" y="196">t</text>
  <text text-anchor="middle" font-family="sans-serif" x="24" y="308">o</text>
  <text text-anchor="middle" font-family="sans-serif" x="176" y="148">F</text>
  <text text-anchor="middle" font-family="sans-serif" x="152" y="180">3</text>
  <text text-anchor="middle" font-family="sans-serif" x="248" y="308">5</text>
  <text text-anchor="middle" font-family="sans-serif" x="24" y="100">o</text>
  <text text-anchor="middle" font-family="sans-serif" x="104" y="244">F</text>
  <text text-anchor="middle" font-family="sans-serif" x="128" y="20">m</text>
  <text text-anchor="middle" font-family="sans-serif" x="120" y="148">e</text>
  <text text-anchor="middle" font-family="sans-serif" x="168" y="100">D</text>
  <text text-anchor="middle" font-family="sans-serif" x="168" y="260">D</text>
  <text text-anchor="middle" font-family="sans-serif" x="224" y="52">,</text>
  <text text-anchor="middle" font-family="sans-serif" x="128" y="148">y</text>
  <text text-anchor="middle" font-family="sans-serif" x="192" y="52">(</text>
  <text text-anchor="middle" font-family="sans-serif" x="176" y="52">F</text>
  <text text-anchor="middle" font-family="sans-serif" x="200" y="52">K</text>
  <text text-anchor="middle" font-family="sans-serif" x="56" y="196">g</text>
  <text text-anchor="middle" font-family="sans-serif" x="256" y="212">)</text>
  <text text-anchor="middle" font-family="sans-serif" x="256" y="308">)</text>
  <text text-anchor="middle" font-family="sans-serif" x="104" y="36">n</text>
  <text text-anchor="middle" font-family="sans-serif" x="112" y="36">t</text>
  <text text-anchor="middle" font-family="sans-serif" x="240" y="100">n</text>
  <text text-anchor="middle" font-family="sans-serif" x="56" y="260">:</text>
  <text text-anchor="middle" font-family="sans-serif" x="176" y="308">F</text>
  <text text-anchor="middle" font-family="sans-serif" x="88" y="36">m</text>
  <text text-anchor="middle" font-family="sans-serif" x="120" y="52">e</text>
  <text text-anchor="middle" font-family="sans-serif" x="144" y="52">=</text>
  <text text-anchor="middle" font-family="sans-serif" x="216" y="148">0</text>
  <text text-anchor="middle" font-family="sans-serif" x="80" y="196">e</text>
  <text text-anchor="middle" font-family="sans-serif" x="88" y="196">m</text>
  <text text-anchor="middle" font-family="sans-serif" x="200" y="212">K</text>
  <text text-anchor="middle" font-family="sans-serif" x="144" y="308">=</text>
  <text text-anchor="middle" font-family="sans-serif" x="64" y="36">r</text>
  <text text-anchor="middle" font-family="sans-serif" x="152" y="340">6</text>
  <text text-anchor="middle" font-family="sans-serif" x="120" y="84">a</text>
  <text text-anchor="middle" font-family="sans-serif" x="32" y="100">n</text>
  <text text-anchor="middle" font-family="sans-serif" x="248" y="148">2</text>
  <text text-anchor="middle" font-family="sans-serif" x="160" y="308">K</text>
  <text text-anchor="middle" font-family="sans-serif" x="152" y="36">0</text>
  <text text-anchor="middle" font-family="sans-serif" x="104" y="132">F</text>
  <text text-anchor="middle" font-family="sans-serif" x="16" y="148">N</text>
  <text text-anchor="middle" font-family="sans-serif" x="144" y="196">A</text>
  <text text-anchor="middle" font-family="sans-serif" x="176" y="260">F</text>
  <text text-anchor="middle" font-family="sans-serif" x="208" y="100">A</text>
  <text text-anchor="middle" font-family="sans-serif" x="216" y="100">0</text>
  <text text-anchor="middle" font-family="sans-serif" x="32" y="212">n</text>
  <text text-anchor="middle" font-family="sans-serif" x="240" y="212">n</text>
  <text text-anchor="middle" font-family="sans-serif" x="32" y="308">n</text>
  <text text-anchor="middle" font-family="sans-serif" x="112" y="292">r</text>
  <text text-anchor="middle" font-family="sans-serif" x="16" y="52">N</text>
  <text text-anchor="middle" font-family="sans-serif" x="120" y="180">a</text>
  <text text-anchor="middle" font-family="sans-serif" x="128" y="180">m</text>
  <text text-anchor="middle" font-family="sans-serif" x="32" y="196">y</text>
  <text text-anchor="middle" font-family="sans-serif" x="112" y="308">K</text>
  <text text-anchor="middle" font-family="sans-serif" x="144" y="100">=</text>
  <text text-anchor="middle" font-family="sans-serif" x="120" y="132">a</text>
  <text text-anchor="middle" font-family="sans-serif" x="136" y="84">e</text>
  <text text-anchor="middle" font-family="sans-serif" x="24" y="260">o</text>
  <text text-anchor="middle" font-family="sans-serif" x="16" y="36">K</text>
  <text text-anchor="middle" font-family="sans-serif" x="160" y="148">K</text>
  <text text-anchor="middle" font-family="sans-serif" x="24" y="212">o</text>
  <text text-anchor="middle" font-family="sans-serif" x="80" y="52">0</text>
  <text text-anchor="middle" font-family="sans-serif" x="208" y="148">A</text>
  <text text-anchor="middle" font-family="sans-serif" x="16" y="196">K</text>
  <text text-anchor="middle" font-family="sans-serif" x="128" y="260">y</text>
  <text text-anchor="middle" font-family="sans-serif" x="224" y="260">,</text>
  <text text-anchor="middle" font-family="sans-serif" x="136" y="340">e</text>
  <text text-anchor="middle" font-family="sans-serif" x="240" y="52">n</text>
  <text text-anchor="middle" font-family="sans-serif" x="152" y="20">0</text>
  <text text-anchor="middle" font-family="sans-serif" x="128" y="52">y</text>
  <text text-anchor="middle" font-family="sans-serif" x="136" y="244">e</text>
  <text text-anchor="middle" font-family="sans-serif" x="48" y="308">e</text>
  <text text-anchor="middle" font-family="sans-serif" x="24" y="52">o</text>
  <text text-anchor="middle" font-family="sans-serif" x="112" y="132">r</text>
  <text text-anchor="middle" font-family="sans-serif" x="168" y="212">D</text>
  <text text-anchor="middle" font-family="sans-serif" x="56" y="308">:</text>
  <text text-anchor="middle" font-family="sans-serif" x="112" y="340">r</text>
  <text text-anchor="middle" font-family="sans-serif" x="120" y="20">a</text>
</g></svg>
</artwork>
</figure>
<t>Integrity is provided by a Merkle tree calculated over the sequence of log entries. The tree apex is signed at regular intervals to provide non-repudiation.</t>
<t>Three types of DARE Containers are used in the mesh</t>
<dl>
<dt>Catalogs</dt>
<dd>
<t>A DARE Container whose entries track the status of a set of related objects which may be added, updated, or deleted.</t>
</dd>
<dt>Spools</dt>
<dd>
<t>A DARE Container whose entries track the status of a series of Mesh Messages.</t>
</dd>
<dt>Archives</dt>
<dd>
<t>A DARE Container used to provide a file archive with optional confidentiality and/or integrity enhancements. </t>
</dd>
</dl>
</section>
</section>
<section title="Uniform Data Fingerprints." anchor="n-uniform-data-fingerprints"><t>The Uniform Data Fingerprint (UDF) format provides a compact means of presenting cryptographic nonces, keys and digest values using Base32 encoding that resists semantic substitution attacks. UDF provides a convenient format for data entry. Since the encoding used is case-insensitive, UDFs may if necessary be read out over a voice link without excessive inconvenience.</t>
<t>The following are examples of UDF values:</t>
<sourcecode>ND5L-Y3E6-GDDZ-KICR-NPDL-5WWM-4QSA
OZHU-CJNI-D7EY-IUIO-I42D-ESL2-2I
SAQM-JPZ2-TI3G-ZC4N-HNMZ-HREO-EVNC-A
MB5S-R4AJ-3FBT-7NHO-T26Z-2E6Y-WFH4
KCM5-7VB6-IJXJ-WKHX-NZQF-OKGZ-EWVN
AAOG-WMPP-ROVD-47TA-ZN5N-LOIN-EH3X</sourcecode>
<t>UDF content digests are used to support a direct trust model similar to that of OpenPGP. Every Mesh Profile is authenticated by the UDF fingerprint of its signature key. Mesh Friendly Names and UDF Fingerprints thus serve analogous functions to DNS names and IP Addresses. Like DNS names, Friendly Names provide the basis for application-layer interactions while the UDF Fingerprints are used as to provide the foundation for security.</t>
<section title="Friendly Names" anchor="n-friendly-names"><t>Internet addressing schemes are designed to provide a globally unique (or at minimum unambiguous) name for a host, service or account. In the early days of the Internet, this resulted in addresses such as 10.2.3.4 and alice@example.com which from a usability point of view might be considered serviceable if not ideal. Today the Internet is a global infrastructure servicing billions of users and tens of billions of devices and accounts are more likely to be alice.lastname.1934@example.com than something memorable.</t>
<t>Friendly names provide a user or community specific means of identifying resources that may take advantage of geographic location or other cues to resolve possible ambiguity. If Alice says to her voice activated device "close the garage door" it is implicit that it is her garage door that she wishes to close. And should Alice be fortunate enough to own two houses with a garage, it is implicit that it is the garage door of the house she is presently using that she wishes to close.</t>
<t>The Mesh Device Catalog provides a directory mapping friendly names to devices that is available to all Alice's connected devices so that she may give and instruction to any of her devices using the same friendly name and expect consistent results.</t>
</section>
<section title="Encrypted Authenticated Resource Locators" anchor="n-encrypted-authenticated-resource-locators"><t>Various schemes have been used to employ QR Codes as a means of device and/or user authentication. In many of these schemes a QR code contains a challenge nonce that is used to authenticate the connection request.</t>
<t>The Mesh supports a QR code connection mode employing the Encrypted Authenticated Resource Locator (EARL) format. An EARL is an identifier which allows an encrypted data object to be retrieved and decrypted. In this case, the encrypted data object contains the information needed to complete the interaction. </t>
<t>An EARL contains the domain name of the service providing the resolution service and an encryption master key:</t>
<sourcecode>
~~~~</sourcecode>
<t>The EARL may be expressed as a QR code:</t>
<figure>
<name>
QR Code representation of the EARL</name>
<!-- Include SVG File ..\Generated\UDFDigestEARLRAW.svg --><artwork type="svg">
<svg width="287" height="287" xmlns="http://www.w3.org/2000/svg" >
<rect x="0" y="0" width="287" height="287" fill="#FFFFFF" />
<rect x="28" y="28" width="7" height="7" fill="#000000" />
<rect x="28" y="35" width="7" height="7" fill="#000000" />
<rect x="28" y="42" width="7" height="7" fill="#000000" />
<rect x="28" y="49" width="7" height="7" fill="#000000" />
<rect x="28" y="56" width="7" height="7" fill="#000000" />
<rect x="28" y="63" width="7" height="7" fill="#000000" />
<rect x="28" y="70" width="7" height="7" fill="#000000" />
<rect x="28" y="84" width="7" height="7" fill="#000000" />
<rect x="28" y="119" width="7" height="7" fill="#000000" />
<rect x="28" y="133" width="7" height="7" fill="#000000" />
<rect x="28" y="140" width="7" height="7" fill="#000000" />
<rect x="28" y="147" width="7" height="7" fill="#000000" />
<rect x="28" y="154" width="7" height="7" fill="#000000" />
<rect x="28" y="161" width="7" height="7" fill="#000000" />
<rect x="28" y="182" width="7" height="7" fill="#000000" />
<rect x="28" y="196" width="7" height="7" fill="#000000" />
<rect x="28" y="210" width="7" height="7" fill="#000000" />
<rect x="28" y="217" width="7" height="7" fill="#000000" />
<rect x="28" y="224" width="7" height="7" fill="#000000" />
<rect x="28" y="231" width="7" height="7" fill="#000000" />
<rect x="28" y="238" width="7" height="7" fill="#000000" />
<rect x="28" y="245" width="7" height="7" fill="#000000" />
<rect x="28" y="252" width="7" height="7" fill="#000000" />
<rect x="35" y="28" width="7" height="7" fill="#000000" />
<rect x="35" y="70" width="7" height="7" fill="#000000" />
<rect x="35" y="84" width="7" height="7" fill="#000000" />
<rect x="35" y="91" width="7" height="7" fill="#000000" />
<rect x="35" y="98" width="7" height="7" fill="#000000" />
<rect x="35" y="147" width="7" height="7" fill="#000000" />
<rect x="35" y="161" width="7" height="7" fill="#000000" />
<rect x="35" y="182" width="7" height="7" fill="#000000" />
<rect x="35" y="196" width="7" height="7" fill="#000000" />
<rect x="35" y="210" width="7" height="7" fill="#000000" />
<rect x="35" y="252" width="7" height="7" fill="#000000" />
<rect x="42" y="28" width="7" height="7" fill="#000000" />
<rect x="42" y="42" width="7" height="7" fill="#000000" />
<rect x="42" y="49" width="7" height="7" fill="#000000" />
<rect x="42" y="56" width="7" height="7" fill="#000000" />
<rect x="42" y="70" width="7" height="7" fill="#000000" />
<rect x="42" y="84" width="7" height="7" fill="#000000" />
<rect x="42" y="98" width="7" height="7" fill="#000000" />
<rect x="42" y="126" width="7" height="7" fill="#000000" />
<rect x="42" y="133" width="7" height="7" fill="#000000" />
<rect x="42" y="140" width="7" height="7" fill="#000000" />
<rect x="42" y="147" width="7" height="7" fill="#000000" />
<rect x="42" y="168" width="7" height="7" fill="#000000" />
<rect x="42" y="182" width="7" height="7" fill="#000000" />
<rect x="42" y="189" width="7" height="7" fill="#000000" />
<rect x="42" y="210" width="7" height="7" fill="#000000" />
<rect x="42" y="224" width="7" height="7" fill="#000000" />
<rect x="42" y="231" width="7" height="7" fill="#000000" />
<rect x="42" y="238" width="7" height="7" fill="#000000" />
<rect x="42" y="252" width="7" height="7" fill="#000000" />
<rect x="49" y="28" width="7" height="7" fill="#000000" />
<rect x="49" y="42" width="7" height="7" fill="#000000" />
<rect x="49" y="49" width="7" height="7" fill="#000000" />
<rect x="49" y="56" width="7" height="7" fill="#000000" />
<rect x="49" y="70" width="7" height="7" fill="#000000" />
<rect x="49" y="91" width="7" height="7" fill="#000000" />
<rect x="49" y="105" width="7" height="7" fill="#000000" />
<rect x="49" y="119" width="7" height="7" fill="#000000" />
<rect x="49" y="126" width="7" height="7" fill="#000000" />
<rect x="49" y="140" width="7" height="7" fill="#000000" />
<rect x="49" y="147" width="7" height="7" fill="#000000" />
<rect x="49" y="154" width="7" height="7" fill="#000000" />
<rect x="49" y="175" width="7" height="7" fill="#000000" />
<rect x="49" y="182" width="7" height="7" fill="#000000" />
<rect x="49" y="196" width="7" height="7" fill="#000000" />
<rect x="49" y="210" width="7" height="7" fill="#000000" />
<rect x="49" y="224" width="7" height="7" fill="#000000" />
<rect x="49" y="231" width="7" height="7" fill="#000000" />
<rect x="49" y="238" width="7" height="7" fill="#000000" />
<rect x="49" y="252" width="7" height="7" fill="#000000" />
<rect x="56" y="28" width="7" height="7" fill="#000000" />
<rect x="56" y="42" width="7" height="7" fill="#000000" />
<rect x="56" y="49" width="7" height="7" fill="#000000" />
<rect x="56" y="56" width="7" height="7" fill="#000000" />
<rect x="56" y="70" width="7" height="7" fill="#000000" />
<rect x="56" y="91" width="7" height="7" fill="#000000" />
<rect x="56" y="98" width="7" height="7" fill="#000000" />
<rect x="56" y="105" width="7" height="7" fill="#000000" />
<rect x="56" y="126" width="7" height="7" fill="#000000" />
<rect x="56" y="133" width="7" height="7" fill="#000000" />
<rect x="56" y="140" width="7" height="7" fill="#000000" />
<rect x="56" y="147" width="7" height="7" fill="#000000" />
<rect x="56" y="161" width="7" height="7" fill="#000000" />
<rect x="56" y="175" width="7" height="7" fill="#000000" />
<rect x="56" y="189" width="7" height="7" fill="#000000" />
<rect x="56" y="210" width="7" height="7" fill="#000000" />
<rect x="56" y="224" width="7" height="7" fill="#000000" />
<rect x="56" y="231" width="7" height="7" fill="#000000" />
<rect x="56" y="238" width="7" height="7" fill="#000000" />
<rect x="56" y="252" width="7" height="7" fill="#000000" />
<rect x="63" y="28" width="7" height="7" fill="#000000" />
<rect x="63" y="70" width="7" height="7" fill="#000000" />
<rect x="63" y="84" width="7" height="7" fill="#000000" />
<rect x="63" y="98" width="7" height="7" fill="#000000" />
<rect x="63" y="105" width="7" height="7" fill="#000000" />
<rect x="63" y="119" width="7" height="7" fill="#000000" />
<rect x="63" y="133" width="7" height="7" fill="#000000" />
<rect x="63" y="140" width="7" height="7" fill="#000000" />
<rect x="63" y="147" width="7" height="7" fill="#000000" />
<rect x="63" y="161" width="7" height="7" fill="#000000" />
<rect x="63" y="175" width="7" height="7" fill="#000000" />
<rect x="63" y="196" width="7" height="7" fill="#000000" />
<rect x="63" y="210" width="7" height="7" fill="#000000" />
<rect x="63" y="252" width="7" height="7" fill="#000000" />
<rect x="70" y="28" width="7" height="7" fill="#000000" />
<rect x="70" y="35" width="7" height="7" fill="#000000" />
<rect x="70" y="42" width="7" height="7" fill="#000000" />
<rect x="70" y="49" width="7" height="7" fill="#000000" />
<rect x="70" y="56" width="7" height="7" fill="#000000" />
<rect x="70" y="63" width="7" height="7" fill="#000000" />
<rect x="70" y="70" width="7" height="7" fill="#000000" />
<rect x="70" y="84" width="7" height="7" fill="#000000" />
<rect x="70" y="98" width="7" height="7" fill="#000000" />
<rect x="70" y="112" width="7" height="7" fill="#000000" />
<rect x="70" y="126" width="7" height="7" fill="#000000" />
<rect x="70" y="140" width="7" height="7" fill="#000000" />
<rect x="70" y="154" width="7" height="7" fill="#000000" />
<rect x="70" y="168" width="7" height="7" fill="#000000" />
<rect x="70" y="182" width="7" height="7" fill="#000000" />
<rect x="70" y="196" width="7" height="7" fill="#000000" />
<rect x="70" y="210" width="7" height="7" fill="#000000" />
<rect x="70" y="217" width="7" height="7" fill="#000000" />
<rect x="70" y="224" width="7" height="7" fill="#000000" />
<rect x="70" y="231" width="7" height="7" fill="#000000" />
<rect x="70" y="238" width="7" height="7" fill="#000000" />
<rect x="70" y="245" width="7" height="7" fill="#000000" />
<rect x="70" y="252" width="7" height="7" fill="#000000" />
<rect x="77" y="98" width="7" height="7" fill="#000000" />
<rect x="77" y="112" width="7" height="7" fill="#000000" />
<rect x="77" y="147" width="7" height="7" fill="#000000" />
<rect x="77" y="154" width="7" height="7" fill="#000000" />
<rect x="77" y="196" width="7" height="7" fill="#000000" />
<rect x="84" y="28" width="7" height="7" fill="#000000" />
<rect x="84" y="35" width="7" height="7" fill="#000000" />
<rect x="84" y="56" width="7" height="7" fill="#000000" />
<rect x="84" y="63" width="7" height="7" fill="#000000" />
<rect x="84" y="70" width="7" height="7" fill="#000000" />
<rect x="84" y="77" width="7" height="7" fill="#000000" />
<rect x="84" y="84" width="7" height="7" fill="#000000" />
<rect x="84" y="98" width="7" height="7" fill="#000000" />
<rect x="84" y="105" width="7" height="7" fill="#000000" />
<rect x="84" y="119" width="7" height="7" fill="#000000" />
<rect x="84" y="133" width="7" height="7" fill="#000000" />
<rect x="84" y="140" width="7" height="7" fill="#000000" />
<rect x="84" y="147" width="7" height="7" fill="#000000" />
<rect x="84" y="189" width="7" height="7" fill="#000000" />
<rect x="84" y="196" width="7" height="7" fill="#000000" />
<rect x="84" y="203" width="7" height="7" fill="#000000" />
<rect x="84" y="217" width="7" height="7" fill="#000000" />
<rect x="84" y="238" width="7" height="7" fill="#000000" />
<rect x="84" y="245" width="7" height="7" fill="#000000" />
<rect x="84" y="252" width="7" height="7" fill="#000000" />
<rect x="91" y="35" width="7" height="7" fill="#000000" />
<rect x="91" y="56" width="7" height="7" fill="#000000" />
<rect x="91" y="84" width="7" height="7" fill="#000000" />
<rect x="91" y="91" width="7" height="7" fill="#000000" />
<rect x="91" y="105" width="7" height="7" fill="#000000" />
<rect x="91" y="112" width="7" height="7" fill="#000000" />
<rect x="91" y="126" width="7" height="7" fill="#000000" />
<rect x="91" y="154" width="7" height="7" fill="#000000" />
<rect x="91" y="161" width="7" height="7" fill="#000000" />
<rect x="91" y="168" width="7" height="7" fill="#000000" />
<rect x="91" y="189" width="7" height="7" fill="#000000" />
<rect x="91" y="196" width="7" height="7" fill="#000000" />
<rect x="91" y="203" width="7" height="7" fill="#000000" />
<rect x="91" y="217" width="7" height="7" fill="#000000" />
<rect x="91" y="224" width="7" height="7" fill="#000000" />
<rect x="91" y="238" width="7" height="7" fill="#000000" />
<rect x="91" y="252" width="7" height="7" fill="#000000" />
<rect x="98" y="35" width="7" height="7" fill="#000000" />
<rect x="98" y="42" width="7" height="7" fill="#000000" />
<rect x="98" y="49" width="7" height="7" fill="#000000" />
<rect x="98" y="56" width="7" height="7" fill="#000000" />
<rect x="98" y="70" width="7" height="7" fill="#000000" />
<rect x="98" y="77" width="7" height="7" fill="#000000" />
<rect x="98" y="84" width="7" height="7" fill="#000000" />
<rect x="98" y="91" width="7" height="7" fill="#000000" />
<rect x="98" y="147" width="7" height="7" fill="#000000" />
<rect x="98" y="154" width="7" height="7" fill="#000000" />
<rect x="98" y="175" width="7" height="7" fill="#000000" />
<rect x="98" y="182" width="7" height="7" fill="#000000" />
<rect x="98" y="189" width="7" height="7" fill="#000000" />
<rect x="98" y="210" width="7" height="7" fill="#000000" />
<rect x="98" y="217" width="7" height="7" fill="#000000" />
<rect x="98" y="224" width="7" height="7" fill="#000000" />
<rect x="98" y="245" width="7" height="7" fill="#000000" />
<rect x="105" y="28" width="7" height="7" fill="#000000" />
<rect x="105" y="42" width="7" height="7" fill="#000000" />
<rect x="105" y="56" width="7" height="7" fill="#000000" />
<rect x="105" y="63" width="7" height="7" fill="#000000" />
<rect x="105" y="77" width="7" height="7" fill="#000000" />
<rect x="105" y="98" width="7" height="7" fill="#000000" />
<rect x="105" y="112" width="7" height="7" fill="#000000" />
<rect x="105" y="133" width="7" height="7" fill="#000000" />
<rect x="105" y="154" width="7" height="7" fill="#000000" />
<rect x="105" y="168" width="7" height="7" fill="#000000" />
<rect x="105" y="189" width="7" height="7" fill="#000000" />
<rect x="105" y="210" width="7" height="7" fill="#000000" />
<rect x="105" y="224" width="7" height="7" fill="#000000" />
<rect x="105" y="245" width="7" height="7" fill="#000000" />
<rect x="112" y="28" width="7" height="7" fill="#000000" />
<rect x="112" y="35" width="7" height="7" fill="#000000" />
<rect x="112" y="42" width="7" height="7" fill="#000000" />
<rect x="112" y="70" width="7" height="7" fill="#000000" />
<rect x="112" y="77" width="7" height="7" fill="#000000" />
<rect x="112" y="112" width="7" height="7" fill="#000000" />
<rect x="112" y="119" width="7" height="7" fill="#000000" />
<rect x="112" y="126" width="7" height="7" fill="#000000" />
<rect x="112" y="133" width="7" height="7" fill="#000000" />
<rect x="112" y="168" width="7" height="7" fill="#000000" />
<rect x="112" y="175" width="7" height="7" fill="#000000" />
<rect x="112" y="182" width="7" height="7" fill="#000000" />
<rect x="112" y="189" width="7" height="7" fill="#000000" />
<rect x="112" y="224" width="7" height="7" fill="#000000" />
<rect x="112" y="231" width="7" height="7" fill="#000000" />
<rect x="112" y="238" width="7" height="7" fill="#000000" />
<rect x="112" y="245" width="7" height="7" fill="#000000" />
<rect x="119" y="35" width="7" height="7" fill="#000000" />
<rect x="119" y="56" width="7" height="7" fill="#000000" />
<rect x="119" y="84" width="7" height="7" fill="#000000" />
<rect x="119" y="91" width="7" height="7" fill="#000000" />
<rect x="119" y="105" width="7" height="7" fill="#000000" />
<rect x="119" y="112" width="7" height="7" fill="#000000" />
<rect x="119" y="126" width="7" height="7" fill="#000000" />
<rect x="119" y="140" width="7" height="7" fill="#000000" />
<rect x="119" y="147" width="7" height="7" fill="#000000" />
<rect x="119" y="161" width="7" height="7" fill="#000000" />
<rect x="119" y="168" width="7" height="7" fill="#000000" />
<rect x="119" y="182" width="7" height="7" fill="#000000" />
<rect x="119" y="196" width="7" height="7" fill="#000000" />
<rect x="119" y="203" width="7" height="7" fill="#000000" />
<rect x="119" y="217" width="7" height="7" fill="#000000" />
<rect x="119" y="224" width="7" height="7" fill="#000000" />
<rect x="119" y="238" width="7" height="7" fill="#000000" />
<rect x="119" y="252" width="7" height="7" fill="#000000" />
<rect x="126" y="35" width="7" height="7" fill="#000000" />
<rect x="126" y="42" width="7" height="7" fill="#000000" />
<rect x="126" y="49" width="7" height="7" fill="#000000" />
<rect x="126" y="56" width="7" height="7" fill="#000000" />
<rect x="126" y="70" width="7" height="7" fill="#000000" />
<rect x="126" y="77" width="7" height="7" fill="#000000" />
<rect x="126" y="84" width="7" height="7" fill="#000000" />
<rect x="126" y="91" width="7" height="7" fill="#000000" />
<rect x="126" y="126" width="7" height="7" fill="#000000" />
<rect x="126" y="133" width="7" height="7" fill="#000000" />
<rect x="126" y="140" width="7" height="7" fill="#000000" />
<rect x="126" y="147" width="7" height="7" fill="#000000" />
<rect x="126" y="182" width="7" height="7" fill="#000000" />
<rect x="126" y="189" width="7" height="7" fill="#000000" />
<rect x="126" y="196" width="7" height="7" fill="#000000" />
<rect x="126" y="203" width="7" height="7" fill="#000000" />
<rect x="126" y="238" width="7" height="7" fill="#000000" />
<rect x="126" y="245" width="7" height="7" fill="#000000" />
<rect x="126" y="252" width="7" height="7" fill="#000000" />
<rect x="133" y="28" width="7" height="7" fill="#000000" />
<rect x="133" y="42" width="7" height="7" fill="#000000" />
<rect x="133" y="56" width="7" height="7" fill="#000000" />
<rect x="133" y="63" width="7" height="7" fill="#000000" />
<rect x="133" y="77" width="7" height="7" fill="#000000" />
<rect x="133" y="98" width="7" height="7" fill="#000000" />
<rect x="133" y="112" width="7" height="7" fill="#000000" />
<rect x="133" y="133" width="7" height="7" fill="#000000" />
<rect x="133" y="154" width="7" height="7" fill="#000000" />
<rect x="133" y="168" width="7" height="7" fill="#000000" />
<rect x="133" y="182" width="7" height="7" fill="#000000" />
<rect x="133" y="189" width="7" height="7" fill="#000000" />
<rect x="133" y="196" width="7" height="7" fill="#000000" />
<rect x="133" y="210" width="7" height="7" fill="#000000" />
<rect x="133" y="231" width="7" height="7" fill="#000000" />
<rect x="133" y="238" width="7" height="7" fill="#000000" />
<rect x="133" y="245" width="7" height="7" fill="#000000" />
<rect x="140" y="28" width="7" height="7" fill="#000000" />
<rect x="140" y="35" width="7" height="7" fill="#000000" />
<rect x="140" y="42" width="7" height="7" fill="#000000" />
<rect x="140" y="70" width="7" height="7" fill="#000000" />
<rect x="140" y="77" width="7" height="7" fill="#000000" />
<rect x="140" y="112" width="7" height="7" fill="#000000" />
<rect x="140" y="119" width="7" height="7" fill="#000000" />
<rect x="140" y="126" width="7" height="7" fill="#000000" />
<rect x="140" y="133" width="7" height="7" fill="#000000" />
<rect x="140" y="140" width="7" height="7" fill="#000000" />
<rect x="140" y="154" width="7" height="7" fill="#000000" />
<rect x="140" y="161" width="7" height="7" fill="#000000" />
<rect x="140" y="168" width="7" height="7" fill="#000000" />
<rect x="140" y="175" width="7" height="7" fill="#000000" />
<rect x="140" y="196" width="7" height="7" fill="#000000" />
<rect x="140" y="203" width="7" height="7" fill="#000000" />
<rect x="140" y="217" width="7" height="7" fill="#000000" />
<rect x="140" y="224" width="7" height="7" fill="#000000" />
<rect x="140" y="252" width="7" height="7" fill="#000000" />
<rect x="147" y="42" width="7" height="7" fill="#000000" />
<rect x="147" y="49" width="7" height="7" fill="#000000" />
<rect x="147" y="56" width="7" height="7" fill="#000000" />
<rect x="147" y="63" width="7" height="7" fill="#000000" />
<rect x="147" y="84" width="7" height="7" fill="#000000" />
<rect x="147" y="112" width="7" height="7" fill="#000000" />
<rect x="147" y="147" width="7" height="7" fill="#000000" />
<rect x="147" y="154" width="7" height="7" fill="#000000" />
<rect x="147" y="182" width="7" height="7" fill="#000000" />
<rect x="147" y="196" width="7" height="7" fill="#000000" />
<rect x="147" y="203" width="7" height="7" fill="#000000" />
<rect x="147" y="210" width="7" height="7" fill="#000000" />
<rect x="147" y="224" width="7" height="7" fill="#000000" />
<rect x="147" y="231" width="7" height="7" fill="#000000" />
<rect x="147" y="252" width="7" height="7" fill="#000000" />
<rect x="154" y="42" width="7" height="7" fill="#000000" />
<rect x="154" y="63" width="7" height="7" fill="#000000" />
<rect x="154" y="70" width="7" height="7" fill="#000000" />
<rect x="154" y="77" width="7" height="7" fill="#000000" />
<rect x="154" y="91" width="7" height="7" fill="#000000" />
<rect x="154" y="105" width="7" height="7" fill="#000000" />
<rect x="154" y="119" width="7" height="7" fill="#000000" />
<rect x="154" y="140" width="7" height="7" fill="#000000" />
<rect x="154" y="161" width="7" height="7" fill="#000000" />
<rect x="154" y="168" width="7" height="7" fill="#000000" />
<rect x="154" y="175" width="7" height="7" fill="#000000" />
<rect x="154" y="189" width="7" height="7" fill="#000000" />
<rect x="154" y="210" width="7" height="7" fill="#000000" />
<rect x="154" y="238" width="7" height="7" fill="#000000" />
<rect x="161" y="28" width="7" height="7" fill="#000000" />
<rect x="161" y="42" width="7" height="7" fill="#000000" />
<rect x="161" y="49" width="7" height="7" fill="#000000" />
<rect x="161" y="77" width="7" height="7" fill="#000000" />
<rect x="161" y="84" width="7" height="7" fill="#000000" />
<rect x="161" y="98" width="7" height="7" fill="#000000" />
<rect x="161" y="105" width="7" height="7" fill="#000000" />
<rect x="161" y="112" width="7" height="7" fill="#000000" />
<rect x="161" y="126" width="7" height="7" fill="#000000" />
<rect x="161" y="140" width="7" height="7" fill="#000000" />
<rect x="161" y="154" width="7" height="7" fill="#000000" />
<rect x="161" y="161" width="7" height="7" fill="#000000" />
<rect x="161" y="168" width="7" height="7" fill="#000000" />
<rect x="161" y="182" width="7" height="7" fill="#000000" />
<rect x="161" y="203" width="7" height="7" fill="#000000" />
<rect x="161" y="210" width="7" height="7" fill="#000000" />
<rect x="161" y="224" width="7" height="7" fill="#000000" />
<rect x="161" y="238" width="7" height="7" fill="#000000" />
<rect x="161" y="245" width="7" height="7" fill="#000000" />
<rect x="168" y="35" width="7" height="7" fill="#000000" />
<rect x="168" y="56" width="7" height="7" fill="#000000" />
<rect x="168" y="70" width="7" height="7" fill="#000000" />
<rect x="168" y="84" width="7" height="7" fill="#000000" />
<rect x="168" y="91" width="7" height="7" fill="#000000" />
<rect x="168" y="98" width="7" height="7" fill="#000000" />
<rect x="168" y="112" width="7" height="7" fill="#000000" />
<rect x="168" y="119" width="7" height="7" fill="#000000" />
<rect x="168" y="140" width="7" height="7" fill="#000000" />
<rect x="168" y="147" width="7" height="7" fill="#000000" />
<rect x="168" y="154" width="7" height="7" fill="#000000" />
<rect x="168" y="161" width="7" height="7" fill="#000000" />
<rect x="168" y="175" width="7" height="7" fill="#000000" />
<rect x="168" y="189" width="7" height="7" fill="#000000" />
<rect x="168" y="196" width="7" height="7" fill="#000000" />
<rect x="168" y="210" width="7" height="7" fill="#000000" />
<rect x="168" y="217" width="7" height="7" fill="#000000" />
<rect x="168" y="231" width="7" height="7" fill="#000000" />
<rect x="168" y="238" width="7" height="7" fill="#000000" />
<rect x="175" y="42" width="7" height="7" fill="#000000" />
<rect x="175" y="84" width="7" height="7" fill="#000000" />
<rect x="175" y="91" width="7" height="7" fill="#000000" />
<rect x="175" y="112" width="7" height="7" fill="#000000" />
<rect x="175" y="175" width="7" height="7" fill="#000000" />
<rect x="175" y="182" width="7" height="7" fill="#000000" />
<rect x="175" y="224" width="7" height="7" fill="#000000" />
<rect x="175" y="231" width="7" height="7" fill="#000000" />
<rect x="175" y="238" width="7" height="7" fill="#000000" />
<rect x="175" y="252" width="7" height="7" fill="#000000" />
<rect x="182" y="28" width="7" height="7" fill="#000000" />
<rect x="182" y="35" width="7" height="7" fill="#000000" />
<rect x="182" y="49" width="7" height="7" fill="#000000" />
<rect x="182" y="56" width="7" height="7" fill="#000000" />
<rect x="182" y="63" width="7" height="7" fill="#000000" />
<rect x="182" y="70" width="7" height="7" fill="#000000" />
<rect x="182" y="77" width="7" height="7" fill="#000000" />
<rect x="182" y="98" width="7" height="7" fill="#000000" />
<rect x="182" y="119" width="7" height="7" fill="#000000" />
<rect x="182" y="140" width="7" height="7" fill="#000000" />
<rect x="182" y="147" width="7" height="7" fill="#000000" />
<rect x="182" y="161" width="7" height="7" fill="#000000" />
<rect x="182" y="168" width="7" height="7" fill="#000000" />
<rect x="182" y="189" width="7" height="7" fill="#000000" />
<rect x="182" y="196" width="7" height="7" fill="#000000" />
<rect x="182" y="203" width="7" height="7" fill="#000000" />
<rect x="182" y="210" width="7" height="7" fill="#000000" />
<rect x="182" y="238" width="7" height="7" fill="#000000" />
<rect x="189" y="56" width="7" height="7" fill="#000000" />
<rect x="189" y="77" width="7" height="7" fill="#000000" />
<rect x="189" y="84" width="7" height="7" fill="#000000" />
<rect x="189" y="98" width="7" height="7" fill="#000000" />
<rect x="189" y="112" width="7" height="7" fill="#000000" />
<rect x="189" y="119" width="7" height="7" fill="#000000" />
<rect x="189" y="126" width="7" height="7" fill="#000000" />
<rect x="189" y="133" width="7" height="7" fill="#000000" />
<rect x="189" y="154" width="7" height="7" fill="#000000" />
<rect x="189" y="175" width="7" height="7" fill="#000000" />
<rect x="189" y="182" width="7" height="7" fill="#000000" />
<rect x="189" y="196" width="7" height="7" fill="#000000" />
<rect x="189" y="210" width="7" height="7" fill="#000000" />
<rect x="189" y="217" width="7" height="7" fill="#000000" />
<rect x="189" y="224" width="7" height="7" fill="#000000" />
<rect x="189" y="245" width="7" height="7" fill="#000000" />
<rect x="189" y="252" width="7" height="7" fill="#000000" />
<rect x="196" y="28" width="7" height="7" fill="#000000" />
<rect x="196" y="42" width="7" height="7" fill="#000000" />
<rect x="196" y="49" width="7" height="7" fill="#000000" />
<rect x="196" y="70" width="7" height="7" fill="#000000" />
<rect x="196" y="77" width="7" height="7" fill="#000000" />
<rect x="196" y="91" width="7" height="7" fill="#000000" />
<rect x="196" y="98" width="7" height="7" fill="#000000" />
<rect x="196" y="105" width="7" height="7" fill="#000000" />
<rect x="196" y="140" width="7" height="7" fill="#000000" />
<rect x="196" y="147" width="7" height="7" fill="#000000" />
<rect x="196" y="161" width="7" height="7" fill="#000000" />
<rect x="196" y="168" width="7" height="7" fill="#000000" />
<rect x="196" y="196" width="7" height="7" fill="#000000" />
<rect x="196" y="203" width="7" height="7" fill="#000000" />
<rect x="196" y="210" width="7" height="7" fill="#000000" />
<rect x="196" y="217" width="7" height="7" fill="#000000" />
<rect x="196" y="224" width="7" height="7" fill="#000000" />
<rect x="196" y="238" width="7" height="7" fill="#000000" />
<rect x="196" y="245" width="7" height="7" fill="#000000" />
<rect x="196" y="252" width="7" height="7" fill="#000000" />
<rect x="203" y="84" width="7" height="7" fill="#000000" />
<rect x="203" y="105" width="7" height="7" fill="#000000" />
<rect x="203" y="133" width="7" height="7" fill="#000000" />
<rect x="203" y="140" width="7" height="7" fill="#000000" />
<rect x="203" y="161" width="7" height="7" fill="#000000" />
<rect x="203" y="189" width="7" height="7" fill="#000000" />
<rect x="203" y="196" width="7" height="7" fill="#000000" />
<rect x="203" y="224" width="7" height="7" fill="#000000" />
<rect x="203" y="231" width="7" height="7" fill="#000000" />
<rect x="203" y="238" width="7" height="7" fill="#000000" />
<rect x="203" y="245" width="7" height="7" fill="#000000" />
<rect x="203" y="252" width="7" height="7" fill="#000000" />
<rect x="210" y="28" width="7" height="7" fill="#000000" />
<rect x="210" y="35" width="7" height="7" fill="#000000" />
<rect x="210" y="42" width="7" height="7" fill="#000000" />
<rect x="210" y="49" width="7" height="7" fill="#000000" />
<rect x="210" y="56" width="7" height="7" fill="#000000" />
<rect x="210" y="63" width="7" height="7" fill="#000000" />
<rect x="210" y="70" width="7" height="7" fill="#000000" />
<rect x="210" y="84" width="7" height="7" fill="#000000" />
<rect x="210" y="91" width="7" height="7" fill="#000000" />
<rect x="210" y="105" width="7" height="7" fill="#000000" />
<rect x="210" y="112" width="7" height="7" fill="#000000" />
<rect x="210" y="119" width="7" height="7" fill="#000000" />
<rect x="210" y="140" width="7" height="7" fill="#000000" />
<rect x="210" y="147" width="7" height="7" fill="#000000" />
<rect x="210" y="161" width="7" height="7" fill="#000000" />
<rect x="210" y="168" width="7" height="7" fill="#000000" />
<rect x="210" y="182" width="7" height="7" fill="#000000" />
<rect x="210" y="196" width="7" height="7" fill="#000000" />
<rect x="210" y="210" width="7" height="7" fill="#000000" />
<rect x="210" y="224" width="7" height="7" fill="#000000" />
<rect x="210" y="238" width="7" height="7" fill="#000000" />
<rect x="210" y="252" width="7" height="7" fill="#000000" />
<rect x="217" y="28" width="7" height="7" fill="#000000" />
<rect x="217" y="70" width="7" height="7" fill="#000000" />
<rect x="217" y="84" width="7" height="7" fill="#000000" />
<rect x="217" y="91" width="7" height="7" fill="#000000" />
<rect x="217" y="112" width="7" height="7" fill="#000000" />
<rect x="217" y="119" width="7" height="7" fill="#000000" />
<rect x="217" y="126" width="7" height="7" fill="#000000" />
<rect x="217" y="133" width="7" height="7" fill="#000000" />
<rect x="217" y="140" width="7" height="7" fill="#000000" />
<rect x="217" y="161" width="7" height="7" fill="#000000" />
<rect x="217" y="168" width="7" height="7" fill="#000000" />
<rect x="217" y="175" width="7" height="7" fill="#000000" />
<rect x="217" y="182" width="7" height="7" fill="#000000" />
<rect x="217" y="189" width="7" height="7" fill="#000000" />
<rect x="217" y="196" width="7" height="7" fill="#000000" />
<rect x="217" y="224" width="7" height="7" fill="#000000" />
<rect x="217" y="252" width="7" height="7" fill="#000000" />
<rect x="224" y="28" width="7" height="7" fill="#000000" />
<rect x="224" y="42" width="7" height="7" fill="#000000" />
<rect x="224" y="49" width="7" height="7" fill="#000000" />
<rect x="224" y="56" width="7" height="7" fill="#000000" />
<rect x="224" y="70" width="7" height="7" fill="#000000" />
<rect x="224" y="84" width="7" height="7" fill="#000000" />
<rect x="224" y="133" width="7" height="7" fill="#000000" />
<rect x="224" y="154" width="7" height="7" fill="#000000" />
<rect x="224" y="182" width="7" height="7" fill="#000000" />
<rect x="224" y="189" width="7" height="7" fill="#000000" />
<rect x="224" y="196" width="7" height="7" fill="#000000" />
<rect x="224" y="203" width="7" height="7" fill="#000000" />
<rect x="224" y="210" width="7" height="7" fill="#000000" />
<rect x="224" y="217" width="7" height="7" fill="#000000" />
<rect x="224" y="224" width="7" height="7" fill="#000000" />
<rect x="224" y="231" width="7" height="7" fill="#000000" />
<rect x="224" y="238" width="7" height="7" fill="#000000" />
<rect x="224" y="252" width="7" height="7" fill="#000000" />
<rect x="231" y="28" width="7" height="7" fill="#000000" />
<rect x="231" y="42" width="7" height="7" fill="#000000" />
<rect x="231" y="49" width="7" height="7" fill="#000000" />
<rect x="231" y="56" width="7" height="7" fill="#000000" />
<rect x="231" y="70" width="7" height="7" fill="#000000" />
<rect x="231" y="91" width="7" height="7" fill="#000000" />
<rect x="231" y="112" width="7" height="7" fill="#000000" />
<rect x="231" y="119" width="7" height="7" fill="#000000" />
<rect x="231" y="133" width="7" height="7" fill="#000000" />
<rect x="231" y="140" width="7" height="7" fill="#000000" />
<rect x="231" y="147" width="7" height="7" fill="#000000" />
<rect x="231" y="161" width="7" height="7" fill="#000000" />
<rect x="231" y="182" width="7" height="7" fill="#000000" />
<rect x="231" y="189" width="7" height="7" fill="#000000" />
<rect x="231" y="196" width="7" height="7" fill="#000000" />
<rect x="231" y="217" width="7" height="7" fill="#000000" />
<rect x="231" y="224" width="7" height="7" fill="#000000" />
<rect x="231" y="231" width="7" height="7" fill="#000000" />
<rect x="231" y="245" width="7" height="7" fill="#000000" />
<rect x="238" y="28" width="7" height="7" fill="#000000" />
<rect x="238" y="42" width="7" height="7" fill="#000000" />
<rect x="238" y="49" width="7" height="7" fill="#000000" />
<rect x="238" y="56" width="7" height="7" fill="#000000" />
<rect x="238" y="70" width="7" height="7" fill="#000000" />
<rect x="238" y="91" width="7" height="7" fill="#000000" />
<rect x="238" y="119" width="7" height="7" fill="#000000" />
<rect x="238" y="154" width="7" height="7" fill="#000000" />
<rect x="238" y="175" width="7" height="7" fill="#000000" />
<rect x="238" y="182" width="7" height="7" fill="#000000" />
<rect x="238" y="210" width="7" height="7" fill="#000000" />
<rect x="238" y="231" width="7" height="7" fill="#000000" />
<rect x="238" y="238" width="7" height="7" fill="#000000" />
<rect x="245" y="28" width="7" height="7" fill="#000000" />
<rect x="245" y="70" width="7" height="7" fill="#000000" />
<rect x="245" y="84" width="7" height="7" fill="#000000" />
<rect x="245" y="98" width="7" height="7" fill="#000000" />
<rect x="245" y="112" width="7" height="7" fill="#000000" />
<rect x="245" y="119" width="7" height="7" fill="#000000" />
<rect x="245" y="126" width="7" height="7" fill="#000000" />
<rect x="245" y="189" width="7" height="7" fill="#000000" />
<rect x="245" y="203" width="7" height="7" fill="#000000" />
<rect x="245" y="217" width="7" height="7" fill="#000000" />
<rect x="245" y="231" width="7" height="7" fill="#000000" />
<rect x="245" y="238" width="7" height="7" fill="#000000" />
<rect x="252" y="28" width="7" height="7" fill="#000000" />
<rect x="252" y="35" width="7" height="7" fill="#000000" />
<rect x="252" y="42" width="7" height="7" fill="#000000" />
<rect x="252" y="49" width="7" height="7" fill="#000000" />
<rect x="252" y="56" width="7" height="7" fill="#000000" />
<rect x="252" y="63" width="7" height="7" fill="#000000" />
<rect x="252" y="70" width="7" height="7" fill="#000000" />
<rect x="252" y="84" width="7" height="7" fill="#000000" />
<rect x="252" y="91" width="7" height="7" fill="#000000" />
<rect x="252" y="98" width="7" height="7" fill="#000000" />
<rect x="252" y="105" width="7" height="7" fill="#000000" />
<rect x="252" y="119" width="7" height="7" fill="#000000" />
<rect x="252" y="126" width="7" height="7" fill="#000000" />
<rect x="252" y="133" width="7" height="7" fill="#000000" />
<rect x="252" y="140" width="7" height="7" fill="#000000" />
<rect x="252" y="147" width="7" height="7" fill="#000000" />
<rect x="252" y="154" width="7" height="7" fill="#000000" />
<rect x="252" y="168" width="7" height="7" fill="#000000" />
<rect x="252" y="175" width="7" height="7" fill="#000000" />
<rect x="252" y="182" width="7" height="7" fill="#000000" />
<rect x="252" y="196" width="7" height="7" fill="#000000" />
<rect x="252" y="203" width="7" height="7" fill="#000000" />
<rect x="252" y="210" width="7" height="7" fill="#000000" />
<rect x="252" y="217" width="7" height="7" fill="#000000" />
<rect x="252" y="224" width="7" height="7" fill="#000000" />
<rect x="252" y="231" width="7" height="7" fill="#000000" />
<rect x="252" y="238" width="7" height="7" fill="#000000" />
<rect x="252" y="252" width="7" height="7" fill="#000000" /></svg>
</artwork>
</figure>
<t>An EARL is resolved by presenting the content digest fingerprint of the encryption key to a Web service hosted at the specified domain. The service returns a DARE Envelope whose payload is encrypted and authenticated under the specified master key. Since the content is stored on the service under the fingerprint of the key and not the key itself, the service cannot decrypt the plaintext. Only a party that has access to the encryption key in the QR code can decrypt the message.</t>
</section>
<section title="Secure Internet Names" anchor="n-secure-internet-names"><t>Secure Internet Names bind an Internet address such as a URL or an email address to a Security Policy by means of a UDF content digest of a document describing the security policy. This binding enables a SIN-aware Internet client to ensure that the security policy is applied when connecting to the address. For example, ensuring that an email sent to an address must be end-to-end encrypted under a particular public key or that access to a Web Service requires a particular set of security enhancements.</t>
<dl>
<dt>alice@example.com </dt>
<dd>
<t>Alice's regular email address (not a SIN).  </t>
</dd>
<dt>alice@mm--uuuu-uuuu-uuuu.example.com </dt>
<dd>
<t>A strong email address for Alice that can be used by a regular email client. </t>
</dd>
<dt>alice@example.com.mm--uuuu-uuuu-uuuu </dt>
<dd>
<t>A strong email address for Alice that can only used by an email client that can process SINs.  </t>
</dd>
</dl>
<t>Using an email address that has the Security Policy element as a prefix allows a DNS wildcard element to be defined that allows the address to be used with any email client. Presenting the Security Policy element as a suffix means it can only be resolved by a SIN-aware client.</t>
</section>
</section>
<section title="Personal Key Escrow" anchor="n-personal-key-escrow"><t>One of the core objectives of the Mesh is to make data level encryption ubiquitous. While data level encryption provides robust protection of data confidentiality, loss of the ability to decrypt means data loss.</t>
<t>For many Internet users, data availability is a considerably greater concern than confidentiality. Ten years later, there is no way to replace pictures of the children at five years old. Recognizing the need to guarantee data recovery, the Mesh provides a robust personal key escrow and recovery mechanism. Lawful access is not supported as a requirement.</t>
<t>Besides supporting key recovery in the case of loss, the Mesh protocols potentially support key recovery in the case of the key holder's death. The chief difficulty faced in implementing such a scheme being developing an acceptable user interface which allows the user to specify which of their data should survive them and which should not. As the apothegm goes: Mallet wants his beneficiaries to know where he buried Aunt Agatha's jewels but not where he buried Aunt Agatha.</t>
<t>The Mesh supports use of Shamir/Lagrange secret sharing and recovery to split a secret key into a set of shares, a predetermined number of which may be used to recover the original secret. For convenience secret shares are represented using UDF allowing presentation in Base32 (i.e. text format) for easy transcription or QR code presentation if preferred.</t>
<t>To facilitate escrow and recovery, all the public key pairs and key shares associated with a Mesh profile are generated from a seed value using a deterministic algorithm. Thus, escrow of the seed value is sufficient to permit recovery of the private key data.</t>
<t>For example, Alice escrows her Mesh Profile creating three recovery shares, two of which are required to recover the master secret:</t>
<figure>
<name>
Use of Shamir/Lagrange Secret Sharing to create a recovery record.</name>
<!-- Include SVG File ../Images/ArchSecretShare.svg --><artwork type="svg">
<svg width="472" height="233" xmlns="http://www.w3.org/2000/svg" >
<g transform="translate(8,16)">
  <path d="M 0,0 L 160,0" fill="none" stroke="black" />
  <path d="M 296,0 L 456,0" fill="none" stroke="black" />
  <path d="M 160,16 L 224,16" fill="none" stroke="black" />
  <path d="M 224,16 L 288,16" fill="none" stroke="black" />
  <path d="M 0,48 L 160,48" fill="none" stroke="black" />
  <path d="M 296,48 L 456,48" fill="none" stroke="black" />
  <path d="M 296,80 L 456,80" fill="none" stroke="black" />
  <path d="M 224,96 L 288,96" fill="none" stroke="black" />
  <path d="M 296,128 L 456,128" fill="none" stroke="black" />
  <path d="M 296,160 L 456,160" fill="none" stroke="black" />
  <path d="M 224,176 L 288,176" fill="none" stroke="black" />
  <path d="M 296,208 L 456,208" fill="none" stroke="black" />
  <path d="M 0,0 L 0,48" fill="none" stroke="black" />
  <path d="M 160,0 L 160,16" fill="none" stroke="black" />
  <path d="M 160,16 L 160,48" fill="none" stroke="black" />
  <path d="M 224,16 L 224,96" fill="none" stroke="black" />
  <path d="M 224,96 L 224,176" fill="none" stroke="black" />
  <path d="M 296,0 L 296,48" fill="none" stroke="black" />
  <path d="M 296,80 L 296,128" fill="none" stroke="black" />
  <path d="M 296,160 L 296,208" fill="none" stroke="black" />
  <path d="M 456,0 L 456,48" fill="none" stroke="black" />
  <path d="M 456,80 L 456,128" fill="none" stroke="black" />
  <path d="M 456,160 L 456,208" fill="none" stroke="black" />
  <polygon points="296.000000,16.000000 284.000000,10.400000 284.000000,21.600000" fill="black" transform="rotate(0.000000, 288.000000, 16.000000)" />
  <polygon points="296.000000,96.000000 284.000000,90.400002 284.000000,101.599998" fill="black" transform="rotate(0.000000, 288.000000, 96.000000)" />
  <polygon points="296.000000,176.000000 284.000000,170.399994 284.000000,181.600006" fill="black" transform="rotate(0.000000, 288.000000, 176.000000)" />
  <text text-anchor="middle" font-family="sans-serif" x="384" y="180">e</text>
  <text text-anchor="middle" font-family="sans-serif" x="72" y="20">c</text>
  <text text-anchor="middle" font-family="sans-serif" x="96" y="20">t</text>
  <text text-anchor="middle" font-family="sans-serif" x="368" y="20">a</text>
  <text text-anchor="middle" font-family="sans-serif" x="360" y="180">h</text>
  <text text-anchor="middle" font-family="sans-serif" x="360" y="196">F</text>
  <text text-anchor="middle" font-family="sans-serif" x="392" y="196">n</text>
  <text text-anchor="middle" font-family="sans-serif" x="400" y="196">d</text>
  <text text-anchor="middle" font-family="sans-serif" x="80" y="20">r</text>
  <text text-anchor="middle" font-family="sans-serif" x="416" y="36">e</text>
  <text text-anchor="middle" font-family="sans-serif" x="376" y="100">r</text>
  <text text-anchor="middle" font-family="sans-serif" x="400" y="116">)</text>
  <text text-anchor="middle" font-family="sans-serif" x="408" y="196">)</text>
  <text text-anchor="middle" font-family="sans-serif" x="344" y="36">f</text>
  <text text-anchor="middle" font-family="sans-serif" x="368" y="100">a</text>
  <text text-anchor="middle" font-family="sans-serif" x="400" y="180">3</text>
  <text text-anchor="middle" font-family="sans-serif" x="392" y="36">S</text>
  <text text-anchor="middle" font-family="sans-serif" x="368" y="116">B</text>
  <text text-anchor="middle" font-family="sans-serif" x="352" y="180">S</text>
  <text text-anchor="middle" font-family="sans-serif" x="64" y="20">e</text>
  <text text-anchor="middle" font-family="sans-serif" x="72" y="36">e</text>
  <text text-anchor="middle" font-family="sans-serif" x="336" y="36">O</text>
  <text text-anchor="middle" font-family="sans-serif" x="400" y="36">a</text>
  <text text-anchor="middle" font-family="sans-serif" x="384" y="100">e</text>
  <text text-anchor="middle" font-family="sans-serif" x="360" y="20">h</text>
  <text text-anchor="middle" font-family="sans-serif" x="368" y="36">c</text>
  <text text-anchor="middle" font-family="sans-serif" x="376" y="180">r</text>
  <text text-anchor="middle" font-family="sans-serif" x="376" y="20">r</text>
  <text text-anchor="middle" font-family="sans-serif" x="352" y="196">(</text>
  <text text-anchor="middle" font-family="sans-serif" x="80" y="36">e</text>
  <text text-anchor="middle" font-family="sans-serif" x="400" y="100">2</text>
  <text text-anchor="middle" font-family="sans-serif" x="400" y="20">1</text>
  <text text-anchor="middle" font-family="sans-serif" x="328" y="36">(</text>
  <text text-anchor="middle" font-family="sans-serif" x="360" y="100">h</text>
  <text text-anchor="middle" font-family="sans-serif" x="360" y="116">(</text>
  <text text-anchor="middle" font-family="sans-serif" x="368" y="196">r</text>
  <text text-anchor="middle" font-family="sans-serif" x="376" y="196">i</text>
  <text text-anchor="middle" font-family="sans-serif" x="56" y="20">S</text>
  <text text-anchor="middle" font-family="sans-serif" x="384" y="116">n</text>
  <text text-anchor="middle" font-family="sans-serif" x="368" y="180">a</text>
  <text text-anchor="middle" font-family="sans-serif" x="352" y="20">S</text>
  <text text-anchor="middle" font-family="sans-serif" x="376" y="36">e</text>
  <text text-anchor="middle" font-family="sans-serif" x="392" y="116">k</text>
  <text text-anchor="middle" font-family="sans-serif" x="88" y="20">e</text>
  <text text-anchor="middle" font-family="sans-serif" x="424" y="36">)</text>
  <text text-anchor="middle" font-family="sans-serif" x="88" y="36">d</text>
  <text text-anchor="middle" font-family="sans-serif" x="352" y="100">S</text>
  <text text-anchor="middle" font-family="sans-serif" x="376" y="116">a</text>
  <text text-anchor="middle" font-family="sans-serif" x="384" y="20">e</text>
  <text text-anchor="middle" font-family="sans-serif" x="64" y="36">S</text>
  <text text-anchor="middle" font-family="sans-serif" x="352" y="36">f</text>
  <text text-anchor="middle" font-family="sans-serif" x="360" y="36">i</text>
  <text text-anchor="middle" font-family="sans-serif" x="408" y="36">f</text>
  <text text-anchor="middle" font-family="sans-serif" x="384" y="196">e</text>
</g></svg>
</artwork>
</figure>
<t>To recover the master secret, Alice presents the necessary number of key shares. These are used to recover the master secret which is used to generate the decryption key:</t>
<figure>
<name>
Use of Shamir/Lagrange Secret Recovery to recover a master key set.</name>
<!-- Include SVG File ../Images/ArchSecretRecover.svg --><artwork type="svg">
<svg width="472" height="217" xmlns="http://www.w3.org/2000/svg" >
<g transform="translate(8,16)">
  <path d="M 0,0 L 160,0" fill="none" stroke="black" />
  <path d="M 160,16 L 224,16" fill="none" stroke="black" />
  <path d="M 296,32 L 456,32" fill="none" stroke="black" />
  <path d="M 0,48 L 160,48" fill="none" stroke="black" />
  <path d="M 224,48 L 288,48" fill="none" stroke="black" />
  <path d="M 224,64 L 288,64" fill="none" stroke="black" />
  <path d="M 0,80 L 160,80" fill="none" stroke="black" />
  <path d="M 296,80 L 376,80" fill="none" stroke="black" />
  <path d="M 376,80 L 456,80" fill="none" stroke="black" />
  <path d="M 160,96 L 224,96" fill="none" stroke="black" />
  <path d="M 0,128 L 160,128" fill="none" stroke="black" />
  <path d="M 296,144 L 456,144" fill="none" stroke="black" />
  <path d="M 296,192 L 456,192" fill="none" stroke="black" />
  <path d="M 0,0 L 0,48" fill="none" stroke="black" />
  <path d="M 0,80 L 0,128" fill="none" stroke="black" />
  <path d="M 160,0 L 160,16" fill="none" stroke="black" />
  <path d="M 160,16 L 160,48" fill="none" stroke="black" />
  <path d="M 160,80 L 160,96" fill="none" stroke="black" />
  <path d="M 160,96 L 160,128" fill="none" stroke="black" />
  <path d="M 224,16 L 224,48" fill="none" stroke="black" />
  <path d="M 224,48 L 224,64" fill="none" stroke="black" />
  <path d="M 224,64 L 224,96" fill="none" stroke="black" />
  <path d="M 296,32 L 296,80" fill="none" stroke="black" />
  <path d="M 296,144 L 296,192" fill="none" stroke="black" />
  <path d="M 376,80 L 376,128" fill="none" stroke="black" />
  <path d="M 456,32 L 456,80" fill="none" stroke="black" />
  <path d="M 456,144 L 456,192" fill="none" stroke="black" />
  <polygon points="296.000000,48.000000 284.000000,42.400002 284.000000,53.599998" fill="black" transform="rotate(0.000000, 288.000000, 48.000000)" />
  <polygon points="296.000000,64.000000 284.000000,58.400002 284.000000,69.599998" fill="black" transform="rotate(0.000000, 288.000000, 64.000000)" />
  <path d="M 376,128 L 376,136" fill="none" stroke="black" />
  <polygon points="392.000000,128.000000 380.000000,122.400002 380.000000,133.600006" fill="black" transform="rotate(90.000000, 376.000000, 128.000000)" />
  <text text-anchor="middle" font-family="sans-serif" x="80" y="20">r</text>
  <text text-anchor="middle" font-family="sans-serif" x="32" y="36">(</text>
  <text text-anchor="middle" font-family="sans-serif" x="376" y="52">a</text>
  <text text-anchor="middle" font-family="sans-serif" x="376" y="68">v</text>
  <text text-anchor="middle" font-family="sans-serif" x="72" y="100">a</text>
  <text text-anchor="middle" font-family="sans-serif" x="56" y="116">(</text>
  <text text-anchor="middle" font-family="sans-serif" x="376" y="164">r</text>
  <text text-anchor="middle" font-family="sans-serif" x="392" y="68">r</text>
  <text text-anchor="middle" font-family="sans-serif" x="64" y="116">F</text>
  <text text-anchor="middle" font-family="sans-serif" x="80" y="36">e</text>
  <text text-anchor="middle" font-family="sans-serif" x="104" y="36">a</text>
  <text text-anchor="middle" font-family="sans-serif" x="88" y="100">e</text>
  <text text-anchor="middle" font-family="sans-serif" x="368" y="164">c</text>
  <text text-anchor="middle" font-family="sans-serif" x="384" y="164">e</text>
  <text text-anchor="middle" font-family="sans-serif" x="392" y="164">t</text>
  <text text-anchor="middle" font-family="sans-serif" x="400" y="68">y</text>
  <text text-anchor="middle" font-family="sans-serif" x="80" y="116">i</text>
  <text text-anchor="middle" font-family="sans-serif" x="352" y="68">e</text>
  <text text-anchor="middle" font-family="sans-serif" x="352" y="164">S</text>
  <text text-anchor="middle" font-family="sans-serif" x="360" y="180">S</text>
  <text text-anchor="middle" font-family="sans-serif" x="384" y="180">d</text>
  <text text-anchor="middle" font-family="sans-serif" x="96" y="36">S</text>
  <text text-anchor="middle" font-family="sans-serif" x="104" y="116">d</text>
  <text text-anchor="middle" font-family="sans-serif" x="400" y="52">e</text>
  <text text-anchor="middle" font-family="sans-serif" x="104" y="100">3</text>
  <text text-anchor="middle" font-family="sans-serif" x="96" y="116">n</text>
  <text text-anchor="middle" font-family="sans-serif" x="64" y="20">h</text>
  <text text-anchor="middle" font-family="sans-serif" x="56" y="100">S</text>
  <text text-anchor="middle" font-family="sans-serif" x="88" y="116">e</text>
  <text text-anchor="middle" font-family="sans-serif" x="72" y="36">c</text>
  <text text-anchor="middle" font-family="sans-serif" x="72" y="116">r</text>
  <text text-anchor="middle" font-family="sans-serif" x="72" y="20">a</text>
  <text text-anchor="middle" font-family="sans-serif" x="104" y="20">1</text>
  <text text-anchor="middle" font-family="sans-serif" x="40" y="36">O</text>
  <text text-anchor="middle" font-family="sans-serif" x="360" y="68">c</text>
  <text text-anchor="middle" font-family="sans-serif" x="360" y="164">e</text>
  <text text-anchor="middle" font-family="sans-serif" x="368" y="180">e</text>
  <text text-anchor="middle" font-family="sans-serif" x="352" y="52">a</text>
  <text text-anchor="middle" font-family="sans-serif" x="384" y="52">n</text>
  <text text-anchor="middle" font-family="sans-serif" x="368" y="68">o</text>
  <text text-anchor="middle" font-family="sans-serif" x="88" y="20">e</text>
  <text text-anchor="middle" font-family="sans-serif" x="48" y="36">f</text>
  <text text-anchor="middle" font-family="sans-serif" x="344" y="52">L</text>
  <text text-anchor="middle" font-family="sans-serif" x="392" y="52">g</text>
  <text text-anchor="middle" font-family="sans-serif" x="384" y="68">e</text>
  <text text-anchor="middle" font-family="sans-serif" x="56" y="20">S</text>
  <text text-anchor="middle" font-family="sans-serif" x="56" y="36">f</text>
  <text text-anchor="middle" font-family="sans-serif" x="64" y="36">i</text>
  <text text-anchor="middle" font-family="sans-serif" x="120" y="36">e</text>
  <text text-anchor="middle" font-family="sans-serif" x="344" y="68">R</text>
  <text text-anchor="middle" font-family="sans-serif" x="112" y="116">)</text>
  <text text-anchor="middle" font-family="sans-serif" x="376" y="180">e</text>
  <text text-anchor="middle" font-family="sans-serif" x="112" y="36">f</text>
  <text text-anchor="middle" font-family="sans-serif" x="128" y="36">)</text>
  <text text-anchor="middle" font-family="sans-serif" x="360" y="52">g</text>
  <text text-anchor="middle" font-family="sans-serif" x="368" y="52">r</text>
  <text text-anchor="middle" font-family="sans-serif" x="64" y="100">h</text>
  <text text-anchor="middle" font-family="sans-serif" x="80" y="100">r</text>
</g></svg>
</artwork>
</figure>
<t>A user may choose to store their encrypted recovery record themselves or make use of the EARL mechanism to store the information at one or more cloud services using the fingerprint of the master secret as the locator.</t>
</section>
</section>
<section title="Mesh Architecture" anchor="n-mesh-architecture"><t>The Mesh infrastructure is supported by a compact set of structures and protocols. These are discussed in detail in the Schema Reference <xref target="draft-hallambaker-mesh-schema"></xref> and Protocol Reference <xref target="draft-hallambaker-mesh-protocol"></xref> documents.</t>
<t>The JSON object model and JSON or JSON-B serialization <xref target="draft-hallambaker-jsonbcd"></xref> are used for all Mesh data structures. These include:</t>
<dl>
<dt>Assertions</dt>
<dd>
<t>A DARE envelope containing a signed data object. Assertions include Profiles and Connections.</t>
</dd>
<dt>Profile</dt>
<dd>
<t>A self-signed assertion describing a Mesh principal. Principals include Accounts, Devices and Services.</t>
<t>Every profile specifies a profile signature key under which it is signed. The UDF fingerprint of the profile signature key is used as a unique identifier for the profile. Thus, all attributes declared in the profile such as authentication keys and encryption keys are bound to the unique identifier for the profile.</t>
</dd>
<dt>Connection</dt>
<dd>
<t>An assertion signed by one principal delegating rights to another. Connection assertions are used to bind devices to accounts and hosts to a service.</t>
</dd>
<dt>Activation</dt>
<dd>
<t>A DARE envelope encrypted under the encryption key of a principal that grant rights or capabilities to that principal. This is typically but not always achieved through use of threshold key techniques.</t>
</dd>
<dt>Message</dt>
<dd>
<t>A DARE envelope signed by the sender that is encrypted under the encryption key of the intended recipient(s) whose content is a Mesh messaging object.</t>
</dd>
<dt>Entry</dt>
<dd>
<t>An object stored in a catalog that carries an identifier that is unique for that catalog.</t>
</dd>
</dl>
<section title="Actors" anchor="n-actors"><t>Three Mesh actors are defined: Accounts, Devices and Services. Each of these is described by a specific type of profile.</t>
<section title="Account" anchor="n-account"><t>Two types of Mesh account are currently specified: personal accounts and group accounts. For concise exposition, this document is limited to the description of personal accounts. Group accounts are specified in the Schema Reference <xref target="draft-hallambaker-mesh-schema"></xref>.</t>
<t>A Mesh account is an abstraction which may be loosely regarded as the thing to which a collection of devices (in the case of a user account) or a collection of members (in the case of a group account) belong.</t>
<t>Each personal account profile specifies:</t>
<dl>
<dt>Profile Signature Key</dt>
<dd>
<t>Used to authenticate the profile. Updates to the profile require use of the Profile Signature Key. The Profile Signature Key cannot be changed but a profile may be replaced by a new profile.</t>
</dd>
<dt>Uniform Data Fingerprint</dt>
<dd>
<t>The UDF fingerprint of the Profile Signature Key. This is used as a unique identifier for the account.</t>
</dd>
<dt>Account Name</dt>
<dd>
<t>The account name through which the profile is serviced.</t>
</dd>
<dt>Administration Keys</dt>
<dd>
<t>UDF fingerprint of keys that are authorized to sign device connection assertions and update the Device Catalog.</t>
</dd>
<dt>Signature Key</dt>
<dd>
<t>Public parameters of the account signature key. This is the key that counterparties will use to verify messages sent by the account holder.</t>
</dd>
<dt>Encryption Key</dt>
<dd>
<t>Public parameters of the account encryption key. This is the key that counterparties will use to encrypt messages sent to the account holder.</t>
</dd>
<dt>Authentication Key</dt>
<dd>
<t>Public parameters of the account authentication key. This is the key that counterparties will use to establish authenticated exchanges with the account holder.</t>
</dd>
</dl>
<t>The public keys for encryption, authentication and signature specified in the account profile are the only keys that will (in normal circumstances) be visible to other Mesh accounts.</t>
</section>
<section title="Device" anchor="n-device"><t>A Mesh Device is any device that is connected to a Mesh Account through a Device profile. A given physical device may have multiple device profiles associated with it but for the purposes of the Mesh, these are considered to be separate devices. A given device profile may be connected to more than one account</t>
<t>The device profile specifies:</t>
<dl>
<dt>Profile Signature Key</dt>
<dd>
<t>Used to authenticate the profile. Updates to the profile require use of the Profile Signature Key. The Profile Signature Key cannot be changed but a profile may be replaced by a new profile.</t>
</dd>
<dt>Uniform Data Fingerprint</dt>
<dd>
<t>The UDF fingerprint of the Profile Signature Key. This is used as a unique identifier for the device.</t>
</dd>
<dt>Signature Key</dt>
<dd>
<t>Public parameters of the device signature key share. This key share is used as a contribution to the signature key the device will use in the context of the account and to authenticate device connection requests.</t>
</dd>
<dt>Encryption Key</dt>
<dd>
<t>Public parameters of the account encryption key share. This key share is used as a contribution to the encryption key the device will use in the context of the account and to decrypt activation records sent in response to device connection requests.</t>
</dd>
<dt>Authentication Key</dt>
<dd>
<t>Public parameters of the account authentication key share. This key share is used as a contribution to the authentication key the device will use in the context of the account.</t>
</dd>
<dt>Description</dt>
<dd>
<t>Optional information describing the device provided by the manufacturer. E.g. model, serial number, date of manufacture etc. </t>
</dd>
</dl>
<t>A Mesh Device is connected to an account through the creation of an activation record and a connection record.</t>
<t>The activation record contains key shares that are overlaid on the corresponding shares specified in the device profile to create the set of encryption, authentication and signature keys the device will use in the context of the account. Since the private keys corresponding to the device profile keys are only used to enable the connection of the device to an account, these keys are only trusted to a minimal degree.</t>
<figure>
<name>
Activation of an account key set.</name>
<!-- Include SVG File ../Images/ArchActivationAccount.svg --><artwork type="svg">
<svg width="432" height="457" xmlns="http://www.w3.org/2000/svg" >
<g transform="translate(8,16)">
  <path d="M 16,0 L 128,0" fill="none" stroke="black" />
  <path d="M 280,0 L 392,0" fill="none" stroke="black" />
  <path d="M 144,48 L 256,48" fill="none" stroke="black" />
  <path d="M 184,64 L 256,64" fill="none" stroke="black" />
  <path d="M 144,96 L 256,96" fill="none" stroke="black" />
  <path d="M 200,112 L 256,112" fill="none" stroke="black" />
  <path d="M 144,144 L 256,144" fill="none" stroke="black" />
  <path d="M 216,160 L 256,160" fill="none" stroke="black" />
  <path d="M 16,192 L 128,192" fill="none" stroke="black" />
  <path d="M 280,192 L 392,192" fill="none" stroke="black" />
  <path d="M 16,224 L 128,224" fill="none" stroke="black" />
  <path d="M 144,272 L 184,272" fill="none" stroke="black" />
  <path d="M 144,320 L 200,320" fill="none" stroke="black" />
  <path d="M 144,368 L 216,368" fill="none" stroke="black" />
  <path d="M 16,416 L 128,416" fill="none" stroke="black" />
  <path d="M 0,16 L 0,176" fill="none" stroke="black" />
  <path d="M 0,240 L 0,400" fill="none" stroke="black" />
  <path d="M 144,16 L 144,48" fill="none" stroke="black" />
  <path d="M 144,48 L 144,96" fill="none" stroke="black" />
  <path d="M 144,96 L 144,144" fill="none" stroke="black" />
  <path d="M 144,144 L 144,176" fill="none" stroke="black" />
  <path d="M 144,240 L 144,272" fill="none" stroke="black" />
  <path d="M 144,272 L 144,320" fill="none" stroke="black" />
  <path d="M 144,320 L 144,368" fill="none" stroke="black" />
  <path d="M 144,368 L 144,400" fill="none" stroke="black" />
  <path d="M 184,64 L 184,80" fill="none" stroke="black" />
  <path d="M 184,112 L 184,128" fill="none" stroke="black" />
  <path d="M 184,160 L 184,272" fill="none" stroke="black" />
  <path d="M 200,112 L 200,128" fill="none" stroke="black" />
  <path d="M 200,160 L 200,320" fill="none" stroke="black" />
  <path d="M 216,160 L 216,368" fill="none" stroke="black" />
  <path d="M 264,16 L 264,176" fill="none" stroke="black" />
  <path d="M 408,16 L 408,176" fill="none" stroke="black" />
  <path d="M 184,80 L 184,88" fill="none" stroke="black" />
  <path d="M 184,104 L 184,112" fill="none" stroke="black" />
  <path d="M 184,128 L 184,136" fill="none" stroke="black" />
  <path d="M 184,152 L 184,160" fill="none" stroke="black" />
  <path d="M 200,128 L 200,136" fill="none" stroke="black" />
  <path d="M 200,152 L 200,160" fill="none" stroke="black" />
  <polygon points="264.000000,48.000000 252.000000,42.400002 252.000000,53.599998" fill="black" transform="rotate(0.000000, 256.000000, 48.000000)" />
  <polygon points="264.000000,64.000000 252.000000,58.400002 252.000000,69.599998" fill="black" transform="rotate(0.000000, 256.000000, 64.000000)" />
  <polygon points="264.000000,96.000000 252.000000,90.400002 252.000000,101.599998" fill="black" transform="rotate(0.000000, 256.000000, 96.000000)" />
  <polygon points="264.000000,112.000000 252.000000,106.400002 252.000000,117.599998" fill="black" transform="rotate(0.000000, 256.000000, 112.000000)" />
  <polygon points="264.000000,144.000000 252.000000,138.399994 252.000000,149.600006" fill="black" transform="rotate(0.000000, 256.000000, 144.000000)" />
  <polygon points="264.000000,160.000000 252.000000,154.399994 252.000000,165.600006" fill="black" transform="rotate(0.000000, 256.000000, 160.000000)" />
  <path d="M 16,0 A 16,16 0 0,0 0,16" fill="none" stroke="black" />
  <path d="M 128,0 A 16,16 0 0,1 144,16" fill="none" stroke="black" />
  <path d="M 280,0 A 16,16 0 0,0 264,16" fill="none" stroke="black" />
  <path d="M 392,0 A 16,16 0 0,1 408,16" fill="none" stroke="black" />
  <path d="M 0,176 A 16,16 0 0,0 16,192" fill="none" stroke="black" />
  <path d="M 144,176 A 16,16 0 0,1 128,192" fill="none" stroke="black" />
  <path d="M 264,176 A 16,16 0 0,0 280,192" fill="none" stroke="black" />
  <path d="M 408,176 A 16,16 0 0,1 392,192" fill="none" stroke="black" />
  <path d="M 16,224 A 16,16 0 0,0 0,240" fill="none" stroke="black" />
  <path d="M 128,224 A 16,16 0 0,1 144,240" fill="none" stroke="black" />
  <path d="M 0,400 A 16,16 0 0,0 16,416" fill="none" stroke="black" />
  <path d="M 144,400 A 16,16 0 0,1 128,416" fill="none" stroke="black" />
  <text text-anchor="middle" font-family="sans-serif" x="40" y="164">h</text>
  <text text-anchor="middle" font-family="sans-serif" x="48" y="276">v</text>
  <text text-anchor="middle" font-family="sans-serif" x="24" y="20">e</text>
  <text text-anchor="middle" font-family="sans-serif" x="312" y="52">D</text>
  <text text-anchor="middle" font-family="sans-serif" x="320" y="100">e</text>
  <text text-anchor="middle" font-family="sans-serif" x="336" y="164">i</text>
  <text text-anchor="middle" font-family="sans-serif" x="32" y="388">t</text>
  <text text-anchor="middle" font-family="sans-serif" x="96" y="68">o</text>
  <text text-anchor="middle" font-family="sans-serif" x="288" y="164">u</text>
  <text text-anchor="middle" font-family="sans-serif" x="88" y="324">y</text>
  <text text-anchor="middle" font-family="sans-serif" x="40" y="340">i</text>
  <text text-anchor="middle" font-family="sans-serif" x="72" y="340">t</text>
  <text text-anchor="middle" font-family="sans-serif" x="72" y="372">l</text>
  <text text-anchor="middle" font-family="sans-serif" x="312" y="20">c</text>
  <text text-anchor="middle" font-family="sans-serif" x="352" y="116">r</text>
  <text text-anchor="middle" font-family="sans-serif" x="312" y="148">D</text>
  <text text-anchor="middle" font-family="sans-serif" x="336" y="148">i</text>
  <text text-anchor="middle" font-family="sans-serif" x="56" y="292">r</text>
  <text text-anchor="middle" font-family="sans-serif" x="304" y="68">n</text>
  <text text-anchor="middle" font-family="sans-serif" x="40" y="244">c</text>
  <text text-anchor="middle" font-family="sans-serif" x="64" y="244">v</text>
  <text text-anchor="middle" font-family="sans-serif" x="104" y="244">n</text>
  <text text-anchor="middle" font-family="sans-serif" x="96" y="20">f</text>
  <text text-anchor="middle" font-family="sans-serif" x="120" y="20">e</text>
  <text text-anchor="middle" font-family="sans-serif" x="336" y="68">p</text>
  <text text-anchor="middle" font-family="sans-serif" x="304" y="164">h</text>
  <text text-anchor="middle" font-family="sans-serif" x="64" y="276">r</text>
  <text text-anchor="middle" font-family="sans-serif" x="24" y="388">u</text>
  <text text-anchor="middle" font-family="sans-serif" x="32" y="20">v</text>
  <text text-anchor="middle" font-family="sans-serif" x="328" y="20">i</text>
  <text text-anchor="middle" font-family="sans-serif" x="56" y="68">r</text>
  <text text-anchor="middle" font-family="sans-serif" x="24" y="164">u</text>
  <text text-anchor="middle" font-family="sans-serif" x="80" y="164">c</text>
  <text text-anchor="middle" font-family="sans-serif" x="344" y="164">c</text>
  <text text-anchor="middle" font-family="sans-serif" x="64" y="340">a</text>
  <text text-anchor="middle" font-family="sans-serif" x="352" y="100">e</text>
  <text text-anchor="middle" font-family="sans-serif" x="16" y="164">A</text>
  <text text-anchor="middle" font-family="sans-serif" x="88" y="164">a</text>
  <text text-anchor="middle" font-family="sans-serif" x="72" y="292">p</text>
  <text text-anchor="middle" font-family="sans-serif" x="72" y="68">p</text>
  <text text-anchor="middle" font-family="sans-serif" x="64" y="100">a</text>
  <text text-anchor="middle" font-family="sans-serif" x="96" y="164">t</text>
  <text text-anchor="middle" font-family="sans-serif" x="112" y="164">o</text>
  <text text-anchor="middle" font-family="sans-serif" x="296" y="164">t</text>
  <text text-anchor="middle" font-family="sans-serif" x="328" y="164">t</text>
  <text text-anchor="middle" font-family="sans-serif" x="48" y="244">t</text>
  <text text-anchor="middle" font-family="sans-serif" x="48" y="324">v</text>
  <text text-anchor="middle" font-family="sans-serif" x="40" y="372">O</text>
  <text text-anchor="middle" font-family="sans-serif" x="72" y="20">P</text>
  <text text-anchor="middle" font-family="sans-serif" x="368" y="20">d</text>
  <text text-anchor="middle" font-family="sans-serif" x="344" y="52">c</text>
  <text text-anchor="middle" font-family="sans-serif" x="80" y="100">e</text>
  <text text-anchor="middle" font-family="sans-serif" x="344" y="100">c</text>
  <text text-anchor="middle" font-family="sans-serif" x="320" y="116">n</text>
  <text text-anchor="middle" font-family="sans-serif" x="56" y="276">e</text>
  <text text-anchor="middle" font-family="sans-serif" x="80" y="340">u</text>
  <text text-anchor="middle" font-family="sans-serif" x="88" y="340">r</text>
  <text text-anchor="middle" font-family="sans-serif" x="56" y="372">e</text>
  <text text-anchor="middle" font-family="sans-serif" x="336" y="100">i</text>
  <text text-anchor="middle" font-family="sans-serif" x="80" y="276">a</text>
  <text text-anchor="middle" font-family="sans-serif" x="40" y="324">O</text>
  <text text-anchor="middle" font-family="sans-serif" x="352" y="20">t</text>
  <text text-anchor="middle" font-family="sans-serif" x="368" y="68">n</text>
  <text text-anchor="middle" font-family="sans-serif" x="48" y="164">e</text>
  <text text-anchor="middle" font-family="sans-serif" x="376" y="164">o</text>
  <text text-anchor="middle" font-family="sans-serif" x="64" y="292">y</text>
  <text text-anchor="middle" font-family="sans-serif" x="72" y="388">i</text>
  <text text-anchor="middle" font-family="sans-serif" x="80" y="388">c</text>
  <text text-anchor="middle" font-family="sans-serif" x="352" y="52">e</text>
  <text text-anchor="middle" font-family="sans-serif" x="72" y="116">t</text>
  <text text-anchor="middle" font-family="sans-serif" x="80" y="116">u</text>
  <text text-anchor="middle" font-family="sans-serif" x="320" y="20">t</text>
  <text text-anchor="middle" font-family="sans-serif" x="320" y="52">e</text>
  <text text-anchor="middle" font-family="sans-serif" x="88" y="68">i</text>
  <text text-anchor="middle" font-family="sans-serif" x="64" y="116">a</text>
  <text text-anchor="middle" font-family="sans-serif" x="88" y="244">i</text>
  <text text-anchor="middle" font-family="sans-serif" x="48" y="372">v</text>
  <text text-anchor="middle" font-family="sans-serif" x="96" y="388">t</text>
  <text text-anchor="middle" font-family="sans-serif" x="120" y="388">n</text>
  <text text-anchor="middle" font-family="sans-serif" x="104" y="292">n</text>
  <text text-anchor="middle" font-family="sans-serif" x="16" y="388">A</text>
  <text text-anchor="middle" font-family="sans-serif" x="40" y="20">i</text>
  <text text-anchor="middle" font-family="sans-serif" x="56" y="20">e</text>
  <text text-anchor="middle" font-family="sans-serif" x="56" y="100">B</text>
  <text text-anchor="middle" font-family="sans-serif" x="40" y="116">i</text>
  <text text-anchor="middle" font-family="sans-serif" x="344" y="116">u</text>
  <text text-anchor="middle" font-family="sans-serif" x="352" y="148">e</text>
  <text text-anchor="middle" font-family="sans-serif" x="296" y="68">E</text>
  <text text-anchor="middle" font-family="sans-serif" x="352" y="68">i</text>
  <text text-anchor="middle" font-family="sans-serif" x="312" y="100">D</text>
  <text text-anchor="middle" font-family="sans-serif" x="296" y="116">S</text>
  <text text-anchor="middle" font-family="sans-serif" x="320" y="164">n</text>
  <text text-anchor="middle" font-family="sans-serif" x="368" y="164">i</text>
  <text text-anchor="middle" font-family="sans-serif" x="32" y="292">E</text>
  <text text-anchor="middle" font-family="sans-serif" x="16" y="20">D</text>
  <text text-anchor="middle" font-family="sans-serif" x="64" y="52">a</text>
  <text text-anchor="middle" font-family="sans-serif" x="80" y="52">e</text>
  <text text-anchor="middle" font-family="sans-serif" x="56" y="148">B</text>
  <text text-anchor="middle" font-family="sans-serif" x="352" y="164">a</text>
  <text text-anchor="middle" font-family="sans-serif" x="72" y="244">a</text>
  <text text-anchor="middle" font-family="sans-serif" x="56" y="324">e</text>
  <text text-anchor="middle" font-family="sans-serif" x="48" y="340">g</text>
  <text text-anchor="middle" font-family="sans-serif" x="56" y="388">n</text>
  <text text-anchor="middle" font-family="sans-serif" x="80" y="20">r</text>
  <text text-anchor="middle" font-family="sans-serif" x="88" y="20">o</text>
  <text text-anchor="middle" font-family="sans-serif" x="304" y="20">A</text>
  <text text-anchor="middle" font-family="sans-serif" x="312" y="68">c</text>
  <text text-anchor="middle" font-family="sans-serif" x="328" y="148">v</text>
  <text text-anchor="middle" font-family="sans-serif" x="360" y="164">t</text>
  <text text-anchor="middle" font-family="sans-serif" x="80" y="244">t</text>
  <text text-anchor="middle" font-family="sans-serif" x="48" y="20">c</text>
  <text text-anchor="middle" font-family="sans-serif" x="344" y="20">a</text>
  <text text-anchor="middle" font-family="sans-serif" x="328" y="68">y</text>
  <text text-anchor="middle" font-family="sans-serif" x="360" y="116">e</text>
  <text text-anchor="middle" font-family="sans-serif" x="320" y="148">e</text>
  <text text-anchor="middle" font-family="sans-serif" x="88" y="276">y</text>
  <text text-anchor="middle" font-family="sans-serif" x="56" y="340">n</text>
  <text text-anchor="middle" font-family="sans-serif" x="48" y="388">e</text>
  <text text-anchor="middle" font-family="sans-serif" x="336" y="116">t</text>
  <text text-anchor="middle" font-family="sans-serif" x="344" y="148">c</text>
  <text text-anchor="middle" font-family="sans-serif" x="312" y="164">e</text>
  <text text-anchor="middle" font-family="sans-serif" x="40" y="292">n</text>
  <text text-anchor="middle" font-family="sans-serif" x="88" y="292">i</text>
  <text text-anchor="middle" font-family="sans-serif" x="88" y="388">a</text>
  <text text-anchor="middle" font-family="sans-serif" x="48" y="116">g</text>
  <text text-anchor="middle" font-family="sans-serif" x="88" y="116">r</text>
  <text text-anchor="middle" font-family="sans-serif" x="64" y="148">a</text>
  <text text-anchor="middle" font-family="sans-serif" x="40" y="276">O</text>
  <text text-anchor="middle" font-family="sans-serif" x="80" y="372">a</text>
  <text text-anchor="middle" font-family="sans-serif" x="88" y="372">y</text>
  <text text-anchor="middle" font-family="sans-serif" x="112" y="20">l</text>
  <text text-anchor="middle" font-family="sans-serif" x="336" y="52">i</text>
  <text text-anchor="middle" font-family="sans-serif" x="72" y="100">s</text>
  <text text-anchor="middle" font-family="sans-serif" x="72" y="324">l</text>
  <text text-anchor="middle" font-family="sans-serif" x="80" y="324">a</text>
  <text text-anchor="middle" font-family="sans-serif" x="40" y="388">h</text>
  <text text-anchor="middle" font-family="sans-serif" x="32" y="116">S</text>
  <text text-anchor="middle" font-family="sans-serif" x="32" y="164">t</text>
  <text text-anchor="middle" font-family="sans-serif" x="104" y="164">i</text>
  <text text-anchor="middle" font-family="sans-serif" x="96" y="244">o</text>
  <text text-anchor="middle" font-family="sans-serif" x="32" y="68">E</text>
  <text text-anchor="middle" font-family="sans-serif" x="56" y="164">n</text>
  <text text-anchor="middle" font-family="sans-serif" x="120" y="164">n</text>
  <text text-anchor="middle" font-family="sans-serif" x="280" y="164">A</text>
  <text text-anchor="middle" font-family="sans-serif" x="64" y="324">r</text>
  <text text-anchor="middle" font-family="sans-serif" x="48" y="68">c</text>
  <text text-anchor="middle" font-family="sans-serif" x="104" y="68">n</text>
  <text text-anchor="middle" font-family="sans-serif" x="328" y="116">a</text>
  <text text-anchor="middle" font-family="sans-serif" x="72" y="148">s</text>
  <text text-anchor="middle" font-family="sans-serif" x="32" y="244">A</text>
  <text text-anchor="middle" font-family="sans-serif" x="64" y="388">t</text>
  <text text-anchor="middle" font-family="sans-serif" x="104" y="388">i</text>
  <text text-anchor="middle" font-family="sans-serif" x="104" y="20">i</text>
  <text text-anchor="middle" font-family="sans-serif" x="336" y="20">v</text>
  <text text-anchor="middle" font-family="sans-serif" x="360" y="20">e</text>
  <text text-anchor="middle" font-family="sans-serif" x="56" y="52">B</text>
  <text text-anchor="middle" font-family="sans-serif" x="328" y="100">v</text>
  <text text-anchor="middle" font-family="sans-serif" x="304" y="116">i</text>
  <text text-anchor="middle" font-family="sans-serif" x="72" y="276">l</text>
  <text text-anchor="middle" font-family="sans-serif" x="48" y="292">c</text>
  <text text-anchor="middle" font-family="sans-serif" x="80" y="68">t</text>
  <text text-anchor="middle" font-family="sans-serif" x="320" y="68">r</text>
  <text text-anchor="middle" font-family="sans-serif" x="360" y="68">o</text>
  <text text-anchor="middle" font-family="sans-serif" x="384" y="164">n</text>
  <text text-anchor="middle" font-family="sans-serif" x="56" y="244">i</text>
  <text text-anchor="middle" font-family="sans-serif" x="32" y="340">S</text>
  <text text-anchor="middle" font-family="sans-serif" x="328" y="52">v</text>
  <text text-anchor="middle" font-family="sans-serif" x="64" y="68">y</text>
  <text text-anchor="middle" font-family="sans-serif" x="344" y="68">t</text>
  <text text-anchor="middle" font-family="sans-serif" x="56" y="116">n</text>
  <text text-anchor="middle" font-family="sans-serif" x="96" y="116">e</text>
  <text text-anchor="middle" font-family="sans-serif" x="80" y="148">e</text>
  <text text-anchor="middle" font-family="sans-serif" x="96" y="340">e</text>
  <text text-anchor="middle" font-family="sans-serif" x="40" y="68">n</text>
  <text text-anchor="middle" font-family="sans-serif" x="64" y="164">t</text>
  <text text-anchor="middle" font-family="sans-serif" x="72" y="164">i</text>
  <text text-anchor="middle" font-family="sans-serif" x="80" y="292">t</text>
  <text text-anchor="middle" font-family="sans-serif" x="96" y="292">o</text>
  <text text-anchor="middle" font-family="sans-serif" x="64" y="372">r</text>
  <text text-anchor="middle" font-family="sans-serif" x="112" y="388">o</text>
  <text text-anchor="middle" font-family="sans-serif" x="72" y="52">s</text>
  <text text-anchor="middle" font-family="sans-serif" x="312" y="116">g</text>
</g></svg>
</artwork>
</figure>
<t>In the ideal case, the device profile keys are fixed to the device such that they may be used to perform private key operations without the ability to extract the private key data from the device. Since the device profile is only trusted for the limited purpose of connecting the device to an account, the device profile may be created during manufacture without undue concern for either disclosure of the private key on the part of the account holder or a reputation attack alleging disclosure of the private key on the part of the manufacturer.</t>
<t>The device connection record is functionally a certificate that the device may use to interact with the Mesh Service or to other devices connected to the same account. Note however that use of threshold cryptography means that Mesh devices would not normally present their device connection record to any other party since all communication with external parties takes place through the keys published in the account profile.</t>
</section>
<section title="Service" anchor="n-service"><t>A Mesh Service is an abstract network service that is provided by one or more hosts. The properties of the service are described by the service profile.</t>
<t>The service profile specifies:</t>
<dl>
<dt>Profile Signature Key</dt>
<dd>
<t>Used to authenticate the profile. Updates to the profile require use of the Profile Signature Key. The Profile Signature Key cannot be changed but a profile may be replaced by a new profile.</t>
</dd>
<dt>Uniform Data Fingerprint</dt>
<dd>
<t>The UDF fingerprint of the Profile Signature Key. This is used as a unique identifier for the device.</t>
</dd>
<dt>Signature Key</dt>
<dd>
<t>Public parameters of the service signature key. This is the key that counterparties will use to verify messages sent by the service.</t>
</dd>
<dt>Encryption Key</dt>
<dd>
<t>Public parameters of the service encryption key. This is the key that counterparties will use to encrypt messages sent to the service.</t>
</dd>
<dt>Authentication Key</dt>
<dd>
<t>Public parameters of the account authentication key. This is the key that counterparties will use to establish authenticated exchanges with the service.</t>
</dd>
</dl>
<t>Hosts are Mesh Devices that have been granted a Host Activation and Host Connection by a service administrator. These are used in the same fashion as the device activation and connection records.</t>
</section>
</section>
<section title="Stores" anchor="n-stores"><t>Mesh Stores are append-only sequences that are used to represent collections of objects, messages and data. All Mesh stores are implemented as DARE Sequences authenticated by means of a Merkle tree. The payload of each envelope in the sequence is usually encrypted.</t>
<t>Three types of Mesh store are currently defined:</t>
<dl>
<dt>Catalog</dt>
<dd>
<t>A set of Mesh objects, each of which has an identifier that is unique in the scope of the catalog. Objects may be added, updated, and deleted.</t>
</dd>
<dt>Spool</dt>
<dd>
<t>A sequence of Mesh Messages.</t>
</dd>
</dl>
<t>All the state represented within a Mesh account is contained in Mesh stores bound to the account. Thus, to synchronize a device to the state of the account, it is sufficient to synchronize the collection of stores the device is permitted to read. Since every store is an append-only sequence, it is sufficient for the Mesh service to return the envelopes added to each of the stores since the device was last synchronized.</t>
<t>Rapid synchronization of catalogs and spools is ensured by limiting the size of entries to each. Implementations may further improve performance by redacting stores to remove obsolete entries that have been updated or deleted. Alternatively, a device may maintain a complete record of the state of the store to allow erroneous changes to the store to be unwound.</t>
<section title="Catalogs" anchor="n-catalogs-0"><t>Mesh Catalogs track a collection of entries. Every Mesh account contains a Threshold Catalog that is used by Mesh services as the source of access control policy. The Threshold Catalog is unique in that it is the only catalog whose contents can be read by the Mesh Service. Every other Mesh Catalog connected to a Mesh account is end-to-end encrypted so that it can only be read by devices connected to the account.</t>
<t>The Mesh specifies various catalogs that are used to track information relevant to a Mesh Account:</t>
<dl>
<dt>Device</dt>
<dd>
<t>The devices connected to the corresponding Mesh profile.</t>
</dd>
<dt>Contact</dt>
<dd>
<t>Logical and physical contact information for people and organizations.</t>
</dd>
<dt>Bookmark</dt>
<dd>
<t>Web bookmarks and citations.</t>
</dd>
<dt>Credential</dt>
<dd>
<t>Username and password information for network resources.</t>
</dd>
<dt>Calendar</dt>
<dd>
<t>Appointments and tasks.</t>
</dd>
<dt>Network</dt>
<dd>
<t>Network access configuration information allowing access to wireless networks and VPNs.</t>
</dd>
<dt>Application</dt>
<dd>
<t>Configuration information for applications including mail (SMTP, IMAP, OpenPGP, S/MIME, etc) and SSH.</t>
</dd>
</dl>
<t>Each catalog connected to an account has a unique identifier of the form <tt>mmm_&lt;&lt;name&gt;</tt>. Applications may specify additional catalogs without risk of collision with future Mesh catalogs by using an appropriate IANA assigned protocol label.</t>
</section>
<section title="Spools" anchor="n-spools"><t>Spools are used to track inbound and outbound messages. Three spools are currently defined:</t>
<dl>
<dt>Inbound</dt>
<dd>
<t>Messages that have been received by the service and accepted for delivery to the account.</t>
</dd>
<dt>Outbound</dt>
<dd>
<t>Messages that have been sent from the account through the service.</t>
</dd>
<dt>Local</dt>
<dd>
<t>A spool used to exchange messages with devices connecting to the device.</t>
</dd>
</dl>
</section>
</section>
<section title="Mesh Service Protocol" anchor="n-mesh-service-protocol"><t>Mesh services communicate with Mesh devices and other Mesh Services through the Mesh Service Protocol. Despite the wide range of Mesh functionality, the Mesh protocol is remarkably compact. The bulk of the semantics associated with the Mesh are expressed in the schemas describing Mesh Messages and Catalogs. The objective of reducing the degree of trust in the Mesh service to the absolute minimum by necessity requires that the Mesh Service be extremely simple.</t>
<t>Mesh Service Protocol transactions are divided into the following groups:</t>
<dl>
<dt>Service Description</dt>
<dd>
<t>The Hello transaction returns a description of the service including information used to authenticate future interactions with the service.</t>
</dd>
<dt>Account Management</dt>
<dd>
<t>The <tt>Create</tt> and <tt>Delete</tt> transactions are used to bind an account to a service.</t>
</dd>
<dt>Device Connection</dt>
<dd>
<t>The <tt>Connect</tt> and <tt>Complete</tt> transactions are used to connect devices to an account</t>
</dd>
<dt>Synchronization</dt>
<dd>
<t>The <tt>Status</tt>, <tt>Download</tt> and <tt>Transact</tt> transactions are used to update stores connected to an account.</t>
</dd>
<dt>Messaging</dt>
<dd>
<t>The <tt>Post</tt> transaction is used by one Mesh Service to transfer a message from one of its users to a different Mesh Service serving one of the recipients.</t>
</dd>
<dt>Publication</dt>
<dd>
<t>The <tt>Publish</tt>, <tt>Claim</tt> and <tt>PollClaim</tt> transactions are used to publish and retrieve data objects through an account.</t>
</dd>
<dt>Cryptographic</dt>
<dd>
<t>The <tt>Operate</tt> transaction requests that the service performs a cryptographic operation on behalf of the account. This is used to provide execution of threshold operations on behalf of the account holder for both internal and external users.</t>
</dd>
</dl>
<t>Future versions of the Mesh Service Protocol may support additional transactions to support features such as providing DNS resolution. </t>
<section title="Protocol Interactions" anchor="n-protocol-interactions"><t>Every Mesh Service Protocol transaction consists of a single request from a Mesh client followed by a single response. Requests and responses are authenticated and encrypted under a key established between the client and the service. This application layer enhancement is in addition to any transport layer enhancement that may be employed (e.g. TLS).</t>
<t>Mesh Service Protocol messages may be exchanged through any binding advertised by the service by means of the Hello transaction. Currently only one binding is defined, mapping Mesh requests and responses to the content data of HTTP POST requests and responses layers over a TLS transport.</t>
<t>While the use of up to three layers of encryption may be regarded as excessive, each layer provides separate protections:</t>
<dl>
<dt>Transport Layer</dt>
<dd>
<t>Provides confidentiality for metadata and limited traffic analysis protections.</t>
</dd>
<dt>Application Layer</dt>
<dd>
<t>Encryption and authentication of requests and responses using keys bound to the specific device and service performing the interaction provides the basis for access control.</t>
</dd>
<dt>Data Layer</dt>
<dd>
<t>Encryption of stored data (catalog data, device activations, etc.) provides end to end security between the devices connected to the account.</t>
</dd>
</dl>
</section>
</section>
<section title="The Threshold Catalog" anchor="n-the-threshold-catalog"><t>The Threshold Catalog of a Mesh account provides the basis through which the service implements the access control policy specified by the account.</t>
<t>Each entry in the catalog specifies an operation that the service will perform when it receives a request that is authenticated and authorized by the access control policy specified in the entry. Operations include:</t>
<dl>
<dt>Inbound Message Filtering</dt>
<dd>
<t>Messages received by the service that match the specified criteria will be appended to the inbound message spool.</t>
</dd>
<dt>Threshold Key Generation</dt>
<dd>
<t>Performs a threshold key splitting operation of a private key held by the service and encrypts one part under a key known only to the service and encrypts the other under a public key specified by the party making the request.</t>
</dd>
<dt>Key Agreement</dt>
<dd>
<t>Performs a key agreement operation on a private key held by the service. This may be used as a component in a threshold key agreement scheme.</t>
</dd>
<dt>Signature</dt>
<dd>
<t>Performs a signature operation on a private key held by the service. This may be used as a component in a threshold signature scheme.</t>
</dd>
</dl>
<t>These operations provide the vocabulary from which a Threshold Key Infrastructure is built. Keys that are bound to a service using threshold techniques can only be applied with the co-operation of that service. </t>
</section>
<section title="Mesh Messaging Protocol" anchor="n-mesh-messaging-protocol"><t>Mesh devices connected to an account interact with the Mesh Service through the Mesh Service protocol. Mesh devices interact with other Mesh devices through the Mesh Messaging Protocols, each of which provides a distinct application functionality:</t>
<ul>
<li>Connection Protocol</li>
<li>Confirmation Protocol</li>
<li>Contact Exchange Protocol</li>
</ul>
<t>Each of these protocols is described in depth in the Mesh Protocol Reference <xref target="draft-hallambaker-mesh-protocol"></xref>.</t>
<t>Mesh Messages provide a means of communication between Mesh Service Accounts with capabilities that are not possible or poorly supported in traditional SMTP mail messaging:</t>
<ul>
<li>End-to-end confidentiality and authentication by default.</li>
<li>Abuse mitigation by applying access control to every inbound and outbound message.</li>
<li>End-to-end secure group messaging.</li>
<li>Transfer of exceptionally large data sets (Terabytes).</li>
</ul>
<t>Note that although Mesh Messaging is designed to facilitate the transfer of very large data sets, the size of Mesh Messages themselves is severely restricted. The current default maximum size being 64 KB. This approach allows Mesh </t>
<t>In addition, the platform anticipates but does not currently support additional cryptographic security capabilities:</t>
<ul>
<li>Traffic analysis resistance using mix networks (Chaum).</li>
<li>Simultaneous contract binding using fair contract signing (Micali).</li>
</ul>
<t>While these capabilities might in time cause Mesh Messaging to replace SMTP, this is not a near term goal. The short-term goal of Mesh Messaging is to support the Contact Exchange and Confirmation applications.</t>
<t>Two important classes of application that are not currently supported directly are payments and presence. While prototypes of these applications have been considered, it is not clear if these are best implemented as special cases of the Confirmation and Contact Exchange applications or as separate applications in their own right.</t>
<t>Messages exchanged between Mesh Users <bcp14>MUST</bcp14> be mediated by a Mesh Service for both sending and receipt. This 'four corner' pattern permits ingress and egress controls to be enforced on the messages and that every message is properly recorded in the appropriate spools.</t>
<figure>
<name>
Four Corner Messaging Model</name>
<!-- Include SVG File ../Images/ArchFourCorner.svg --><artwork type="svg">
<svg width="448" height="217" xmlns="http://www.w3.org/2000/svg" >
<g transform="translate(8,16)">
  <path d="M 16,0 L 144,0" fill="none" stroke="black" />
  <path d="M 288,0 L 416,0" fill="none" stroke="black" />
  <path d="M 160,32 L 264,32" fill="none" stroke="black" />
  <path d="M 16,64 L 144,64" fill="none" stroke="black" />
  <path d="M 288,64 L 352,64" fill="none" stroke="black" />
  <path d="M 352,64 L 416,64" fill="none" stroke="black" />
  <path d="M 0,128 L 80,128" fill="none" stroke="black" />
  <path d="M 80,128 L 160,128" fill="none" stroke="black" />
  <path d="M 272,128 L 432,128" fill="none" stroke="black" />
  <path d="M 0,192 L 160,192" fill="none" stroke="black" />
  <path d="M 272,192 L 432,192" fill="none" stroke="black" />
  <path d="M 0,16 L 0,48" fill="none" stroke="black" />
  <path d="M 0,128 L 0,192" fill="none" stroke="black" />
  <path d="M 80,80 L 80,128" fill="none" stroke="black" />
  <path d="M 160,16 L 160,32" fill="none" stroke="black" />
  <path d="M 160,32 L 160,48" fill="none" stroke="black" />
  <path d="M 160,128 L 160,192" fill="none" stroke="black" />
  <path d="M 272,16 L 272,48" fill="none" stroke="black" />
  <path d="M 272,128 L 272,192" fill="none" stroke="black" />
  <path d="M 352,64 L 352,112" fill="none" stroke="black" />
  <path d="M 432,16 L 432,48" fill="none" stroke="black" />
  <path d="M 432,128 L 432,192" fill="none" stroke="black" />
  <path d="M 80,72 L 80,80" fill="none" stroke="black" />
  <polygon points="96.000000,80.000000 84.000000,74.400002 84.000000,85.599998" fill="black" transform="rotate(270.000000, 80.000000, 80.000000)" />
  <polygon points="272.000000,32.000000 260.000000,26.400000 260.000000,37.599998" fill="black" transform="rotate(0.000000, 264.000000, 32.000000)" />
  <path d="M 352,112 L 352,120" fill="none" stroke="black" />
  <polygon points="368.000000,112.000000 356.000000,106.400002 356.000000,117.599998" fill="black" transform="rotate(90.000000, 352.000000, 112.000000)" />
  <path d="M 16,0 A 16,16 0 0,0 0,16" fill="none" stroke="black" />
  <path d="M 144,0 A 16,16 0 0,1 160,16" fill="none" stroke="black" />
  <path d="M 288,0 A 16,16 0 0,0 272,16" fill="none" stroke="black" />
  <path d="M 416,0 A 16,16 0 0,1 432,16" fill="none" stroke="black" />
  <path d="M 0,48 A 16,16 0 0,0 16,64" fill="none" stroke="black" />
  <path d="M 160,48 A 16,16 0 0,1 144,64" fill="none" stroke="black" />
  <path d="M 272,48 A 16,16 0 0,0 288,64" fill="none" stroke="black" />
  <path d="M 432,48 A 16,16 0 0,1 416,64" fill="none" stroke="black" />
  <text text-anchor="middle" font-family="sans-serif" x="64" y="164">A</text>
  <text text-anchor="middle" font-family="sans-serif" x="96" y="164">e</text>
  <text text-anchor="middle" font-family="sans-serif" x="360" y="164">b</text>
  <text text-anchor="middle" font-family="sans-serif" x="344" y="20">o</text>
  <text text-anchor="middle" font-family="sans-serif" x="368" y="20">s</text>
  <text text-anchor="middle" font-family="sans-serif" x="80" y="36">S</text>
  <text text-anchor="middle" font-family="sans-serif" x="352" y="20">b</text>
  <text text-anchor="middle" font-family="sans-serif" x="88" y="36">P</text>
  <text text-anchor="middle" font-family="sans-serif" x="344" y="36">M</text>
  <text text-anchor="middle" font-family="sans-serif" x="360" y="36">P</text>
  <text text-anchor="middle" font-family="sans-serif" x="80" y="164">i</text>
  <text text-anchor="middle" font-family="sans-serif" x="56" y="20">A</text>
  <text text-anchor="middle" font-family="sans-serif" x="80" y="20">c</text>
  <text text-anchor="middle" font-family="sans-serif" x="336" y="20">B</text>
  <text text-anchor="middle" font-family="sans-serif" x="344" y="164">B</text>
  <text text-anchor="middle" font-family="sans-serif" x="88" y="164">c</text>
  <text text-anchor="middle" font-family="sans-serif" x="64" y="20">l</text>
  <text text-anchor="middle" font-family="sans-serif" x="104" y="20">s</text>
  <text text-anchor="middle" font-family="sans-serif" x="360" y="20">'</text>
  <text text-anchor="middle" font-family="sans-serif" x="72" y="36">M</text>
  <text text-anchor="middle" font-family="sans-serif" x="352" y="36">S</text>
  <text text-anchor="middle" font-family="sans-serif" x="72" y="164">l</text>
  <text text-anchor="middle" font-family="sans-serif" x="352" y="164">o</text>
  <text text-anchor="middle" font-family="sans-serif" x="72" y="20">i</text>
  <text text-anchor="middle" font-family="sans-serif" x="88" y="20">e</text>
  <text text-anchor="middle" font-family="sans-serif" x="96" y="20">'</text>
</g></svg>
</artwork>
</figure>
<t>For example, to send a message to Alice, Bob posts it to one of the Mesh Services connected to the Mesh Account from which the message is to be sent. The Mesh Service checks to see that both the message and Bob's pattern of behavior comply with their acceptable use policy and if satisfactory, forwards the message to the receiving service example.com.</t>
<figure>
<name>
Performing Access Control on Outbound Messages</name>
<!-- Include SVG File ../Images/ArchOutboundAccessControl.svg --><artwork type="svg">
<svg width="552" height="137" xmlns="http://www.w3.org/2000/svg" >
<g transform="translate(8,16)">
  <path d="M 0,0 L 160,0" fill="none" stroke="black" />
  <path d="M 288,0 L 416,0" fill="none" stroke="black" />
  <path d="M 160,32 L 264,32" fill="none" stroke="black" />
  <path d="M 0,64 L 160,64" fill="none" stroke="black" />
  <path d="M 288,64 L 408,64" fill="none" stroke="black" />
  <path d="M 432,64 L 536,64" fill="none" stroke="black" />
  <path d="M 288,96 L 408,96" fill="none" stroke="black" />
  <path d="M 288,112 L 416,112" fill="none" stroke="black" />
  <path d="M 0,0 L 0,64" fill="none" stroke="black" />
  <path d="M 160,0 L 160,32" fill="none" stroke="black" />
  <path d="M 160,32 L 160,64" fill="none" stroke="black" />
  <path d="M 272,16 L 272,96" fill="none" stroke="black" />
  <path d="M 288,64 L 288,96" fill="none" stroke="black" />
  <path d="M 408,64 L 408,96" fill="none" stroke="black" />
  <path d="M 432,16 L 432,64" fill="none" stroke="black" />
  <path d="M 432,64 L 432,96" fill="none" stroke="black" />
  <polygon points="272.000000,32.000000 260.000000,26.400000 260.000000,37.599998" fill="black" transform="rotate(0.000000, 264.000000, 32.000000)" />
  <polygon points="544.000000,64.000000 532.000000,58.400002 532.000000,69.599998" fill="black" transform="rotate(0.000000, 536.000000, 64.000000)" />
  <path d="M 288,0 A 16,16 0 0,0 272,16" fill="none" stroke="black" />
  <path d="M 416,0 A 16,16 0 0,1 432,16" fill="none" stroke="black" />
  <path d="M 272,96 A 16,16 0 0,0 288,112" fill="none" stroke="black" />
  <path d="M 432,96 A 16,16 0 0,1 416,112" fill="none" stroke="black" />
  <text text-anchor="middle" font-family="sans-serif" x="312" y="84">i</text>
  <text text-anchor="middle" font-family="sans-serif" x="360" y="84">l</text>
  <text text-anchor="middle" font-family="sans-serif" x="304" y="84">S</text>
  <text text-anchor="middle" font-family="sans-serif" x="496" y="36">v</text>
  <text text-anchor="middle" font-family="sans-serif" x="480" y="52">s</text>
  <text text-anchor="middle" font-family="sans-serif" x="512" y="52">e</text>
  <text text-anchor="middle" font-family="sans-serif" x="368" y="84">i</text>
  <text text-anchor="middle" font-family="sans-serif" x="344" y="36">M</text>
  <text text-anchor="middle" font-family="sans-serif" x="456" y="36">A</text>
  <text text-anchor="middle" font-family="sans-serif" x="352" y="36">S</text>
  <text text-anchor="middle" font-family="sans-serif" x="72" y="36">l</text>
  <text text-anchor="middle" font-family="sans-serif" x="464" y="36">p</text>
  <text text-anchor="middle" font-family="sans-serif" x="480" y="36">r</text>
  <text text-anchor="middle" font-family="sans-serif" x="512" y="36">d</text>
  <text text-anchor="middle" font-family="sans-serif" x="472" y="52">e</text>
  <text text-anchor="middle" font-family="sans-serif" x="496" y="52">a</text>
  <text text-anchor="middle" font-family="sans-serif" x="504" y="52">g</text>
  <text text-anchor="middle" font-family="sans-serif" x="368" y="20">'</text>
  <text text-anchor="middle" font-family="sans-serif" x="360" y="20">e</text>
  <text text-anchor="middle" font-family="sans-serif" x="376" y="20">s</text>
  <text text-anchor="middle" font-family="sans-serif" x="88" y="36">c</text>
  <text text-anchor="middle" font-family="sans-serif" x="96" y="36">e</text>
  <text text-anchor="middle" font-family="sans-serif" x="504" y="36">e</text>
  <text text-anchor="middle" font-family="sans-serif" x="352" y="84">o</text>
  <text text-anchor="middle" font-family="sans-serif" x="376" y="84">c</text>
  <text text-anchor="middle" font-family="sans-serif" x="352" y="20">c</text>
  <text text-anchor="middle" font-family="sans-serif" x="64" y="36">A</text>
  <text text-anchor="middle" font-family="sans-serif" x="360" y="36">P</text>
  <text text-anchor="middle" font-family="sans-serif" x="328" y="20">A</text>
  <text text-anchor="middle" font-family="sans-serif" x="344" y="20">i</text>
  <text text-anchor="middle" font-family="sans-serif" x="80" y="36">i</text>
  <text text-anchor="middle" font-family="sans-serif" x="472" y="36">p</text>
  <text text-anchor="middle" font-family="sans-serif" x="328" y="84">e</text>
  <text text-anchor="middle" font-family="sans-serif" x="344" y="84">p</text>
  <text text-anchor="middle" font-family="sans-serif" x="336" y="20">l</text>
  <text text-anchor="middle" font-family="sans-serif" x="464" y="52">M</text>
  <text text-anchor="middle" font-family="sans-serif" x="488" y="52">s</text>
  <text text-anchor="middle" font-family="sans-serif" x="320" y="84">t</text>
  <text text-anchor="middle" font-family="sans-serif" x="384" y="84">y</text>
  <text text-anchor="middle" font-family="sans-serif" x="488" y="36">o</text>
</g></svg>
</artwork>
</figure>
<t>The receiving service uses the recipient's contact catalog and other information to determine if the message should be accepted. If accepted, the message is added to the recipient's inbound message spool to be collected by her device(s) when needed.</t>
<figure>
<name>
Performing Access Control on Inbound Messages</name>
<!-- Include SVG File ../Images/ArchInboundAccessControl.svg --><artwork type="svg">
<svg width="552" height="201" xmlns="http://www.w3.org/2000/svg" >
<g transform="translate(8,16)">
  <path d="M 120,0 L 248,0" fill="none" stroke="black" />
  <path d="M 0,32 L 96,32" fill="none" stroke="black" />
  <path d="M 376,32 L 536,32" fill="none" stroke="black" />
  <path d="M 120,64 L 240,64" fill="none" stroke="black" />
  <path d="M 264,64 L 368,64" fill="none" stroke="black" />
  <path d="M 120,96 L 240,96" fill="none" stroke="black" />
  <path d="M 376,96 L 536,96" fill="none" stroke="black" />
  <path d="M 120,128 L 240,128" fill="none" stroke="black" />
  <path d="M 120,160 L 240,160" fill="none" stroke="black" />
  <path d="M 120,176 L 248,176" fill="none" stroke="black" />
  <path d="M 104,16 L 104,160" fill="none" stroke="black" />
  <path d="M 120,64 L 120,96" fill="none" stroke="black" />
  <path d="M 120,128 L 120,160" fill="none" stroke="black" />
  <path d="M 240,64 L 240,96" fill="none" stroke="black" />
  <path d="M 240,128 L 240,160" fill="none" stroke="black" />
  <path d="M 264,16 L 264,64" fill="none" stroke="black" />
  <path d="M 264,64 L 264,160" fill="none" stroke="black" />
  <path d="M 376,32 L 376,96" fill="none" stroke="black" />
  <path d="M 536,32 L 536,96" fill="none" stroke="black" />
  <polygon points="104.000000,32.000000 92.000000,26.400000 92.000000,37.599998" fill="black" transform="rotate(0.000000, 96.000000, 32.000000)" />
  <polygon points="376.000000,64.000000 364.000000,58.400002 364.000000,69.599998" fill="black" transform="rotate(0.000000, 368.000000, 64.000000)" />
  <path d="M 120,0 A 16,16 0 0,0 104,16" fill="none" stroke="black" />
  <path d="M 248,0 A 16,16 0 0,1 264,16" fill="none" stroke="black" />
  <path d="M 104,160 A 16,16 0 0,0 120,176" fill="none" stroke="black" />
  <path d="M 264,160 A 16,16 0 0,1 248,176" fill="none" stroke="black" />
  <text text-anchor="middle" font-family="sans-serif" x="176" y="36">M</text>
  <text text-anchor="middle" font-family="sans-serif" x="320" y="36">p</text>
  <text text-anchor="middle" font-family="sans-serif" x="296" y="52">M</text>
  <text text-anchor="middle" font-family="sans-serif" x="456" y="68">o</text>
  <text text-anchor="middle" font-family="sans-serif" x="160" y="84">e</text>
  <text text-anchor="middle" font-family="sans-serif" x="184" y="148">o</text>
  <text text-anchor="middle" font-family="sans-serif" x="144" y="148">B</text>
  <text text-anchor="middle" font-family="sans-serif" x="208" y="148">c</text>
  <text text-anchor="middle" font-family="sans-serif" x="56" y="20">g</text>
  <text text-anchor="middle" font-family="sans-serif" x="64" y="20">e</text>
  <text text-anchor="middle" font-family="sans-serif" x="296" y="36">c</text>
  <text text-anchor="middle" font-family="sans-serif" x="448" y="68">B</text>
  <text text-anchor="middle" font-family="sans-serif" x="192" y="84">l</text>
  <text text-anchor="middle" font-family="sans-serif" x="200" y="84">i</text>
  <text text-anchor="middle" font-family="sans-serif" x="216" y="148">y</text>
  <text text-anchor="middle" font-family="sans-serif" x="336" y="36">e</text>
  <text text-anchor="middle" font-family="sans-serif" x="344" y="36">d</text>
  <text text-anchor="middle" font-family="sans-serif" x="144" y="84">i</text>
  <text text-anchor="middle" font-family="sans-serif" x="312" y="52">s</text>
  <text text-anchor="middle" font-family="sans-serif" x="184" y="84">o</text>
  <text text-anchor="middle" font-family="sans-serif" x="152" y="148">o</text>
  <text text-anchor="middle" font-family="sans-serif" x="192" y="148">l</text>
  <text text-anchor="middle" font-family="sans-serif" x="344" y="52">e</text>
  <text text-anchor="middle" font-family="sans-serif" x="464" y="68">b</text>
  <text text-anchor="middle" font-family="sans-serif" x="16" y="20">M</text>
  <text text-anchor="middle" font-family="sans-serif" x="32" y="20">s</text>
  <text text-anchor="middle" font-family="sans-serif" x="192" y="20">'</text>
  <text text-anchor="middle" font-family="sans-serif" x="304" y="36">c</text>
  <text text-anchor="middle" font-family="sans-serif" x="304" y="52">e</text>
  <text text-anchor="middle" font-family="sans-serif" x="328" y="52">a</text>
  <text text-anchor="middle" font-family="sans-serif" x="136" y="84">S</text>
  <text text-anchor="middle" font-family="sans-serif" x="200" y="148">i</text>
  <text text-anchor="middle" font-family="sans-serif" x="168" y="20">B</text>
  <text text-anchor="middle" font-family="sans-serif" x="176" y="20">o</text>
  <text text-anchor="middle" font-family="sans-serif" x="184" y="20">b</text>
  <text text-anchor="middle" font-family="sans-serif" x="200" y="20">s</text>
  <text text-anchor="middle" font-family="sans-serif" x="192" y="36">P</text>
  <text text-anchor="middle" font-family="sans-serif" x="216" y="84">y</text>
  <text text-anchor="middle" font-family="sans-serif" x="176" y="148">P</text>
  <text text-anchor="middle" font-family="sans-serif" x="24" y="20">e</text>
  <text text-anchor="middle" font-family="sans-serif" x="48" y="20">a</text>
  <text text-anchor="middle" font-family="sans-serif" x="312" y="36">e</text>
  <text text-anchor="middle" font-family="sans-serif" x="320" y="52">s</text>
  <text text-anchor="middle" font-family="sans-serif" x="336" y="52">g</text>
  <text text-anchor="middle" font-family="sans-serif" x="160" y="148">b</text>
  <text text-anchor="middle" font-family="sans-serif" x="208" y="84">c</text>
  <text text-anchor="middle" font-family="sans-serif" x="40" y="20">s</text>
  <text text-anchor="middle" font-family="sans-serif" x="184" y="36">S</text>
  <text text-anchor="middle" font-family="sans-serif" x="288" y="36">A</text>
  <text text-anchor="middle" font-family="sans-serif" x="328" y="36">t</text>
  <text text-anchor="middle" font-family="sans-serif" x="152" y="84">t</text>
  <text text-anchor="middle" font-family="sans-serif" x="176" y="84">P</text>
</g></svg>
</artwork>
</figure>
<t>For efficiency and to limit the scope for abuse, all inbound Mesh Messages are subject to access control and limited in size to 32KB or less. This limit has proved adequate to support transfer of complex control messages and short content messages. Transfer of data objects of arbitrary size may be achieved by sending a control message containing a URI for the main content which may then be fetched using a protocol such as HTTP. </t>
<t>This approach makes transfers of exceptionally large data sets (i.e. multiple Terabytes) practical as the 'push' phase of the protocol is limited to the transfer of the initial control message. The bulk transfer is implemented as a 'pull' protocol allowing support for features such as continuous integrity checking and resumption of an interrupted transfer.</t>
</section>
<section title="Using the Mesh with Applications" anchor="n-using-the-mesh-with-applications"><t>The Mesh provides an infrastructure for supporting existing Internet security applications and a set security features that may be used to build new ones.</t>
<t>For example, Alice uses the Mesh to provision and maintain the keys she uses for OpenPGP, S/MIME, SSH and IPSEC. She also uses the credential catalog for end-to-end secure management of the usernames and passwords for her Web browsing and other purposes:</t>
<figure>
<name>
Each of Alice's devices have access to the shared context of her personal account.</name>
<!-- Include SVG File ../Images/ArchAliceDevices.svg --><artwork type="svg">
<svg width="400" height="361" xmlns="http://www.w3.org/2000/svg" >
<g transform="translate(8,16)">
  <path d="M 16,0 L 368,0" fill="none" stroke="black" />
  <path d="M 40,80 L 120,80" fill="none" stroke="black" />
  <path d="M 272,80 L 320,80" fill="none" stroke="black" />
  <path d="M 128,96 L 160,96" fill="none" stroke="black" />
  <path d="M 216,96 L 248,96" fill="none" stroke="black" />
  <path d="M 40,112 L 120,112" fill="none" stroke="black" />
  <path d="M 272,112 L 320,112" fill="none" stroke="black" />
  <path d="M 40,144 L 120,144" fill="none" stroke="black" />
  <path d="M 272,144 L 320,144" fill="none" stroke="black" />
  <path d="M 128,160 L 160,160" fill="none" stroke="black" />
  <path d="M 216,160 L 248,160" fill="none" stroke="black" />
  <path d="M 40,176 L 120,176" fill="none" stroke="black" />
  <path d="M 272,176 L 320,176" fill="none" stroke="black" />
  <path d="M 160,192 L 216,192" fill="none" stroke="black" />
  <path d="M 40,208 L 120,208" fill="none" stroke="black" />
  <path d="M 272,208 L 320,208" fill="none" stroke="black" />
  <path d="M 128,224 L 160,224" fill="none" stroke="black" />
  <path d="M 216,224 L 248,224" fill="none" stroke="black" />
  <path d="M 40,240 L 120,240" fill="none" stroke="black" />
  <path d="M 272,240 L 320,240" fill="none" stroke="black" />
  <path d="M 40,272 L 120,272" fill="none" stroke="black" />
  <path d="M 272,272 L 320,272" fill="none" stroke="black" />
  <path d="M 128,288 L 160,288" fill="none" stroke="black" />
  <path d="M 216,288 L 248,288" fill="none" stroke="black" />
  <path d="M 40,304 L 120,304" fill="none" stroke="black" />
  <path d="M 272,304 L 320,304" fill="none" stroke="black" />
  <path d="M 16,336 L 368,336" fill="none" stroke="black" />
  <path d="M 0,16 L 0,320" fill="none" stroke="black" />
  <path d="M 40,80 L 40,112" fill="none" stroke="black" />
  <path d="M 40,144 L 40,176" fill="none" stroke="black" />
  <path d="M 40,208 L 40,240" fill="none" stroke="black" />
  <path d="M 40,272 L 40,304" fill="none" stroke="black" />
  <path d="M 120,80 L 120,96" fill="none" stroke="black" />
  <path d="M 120,96 L 120,112" fill="none" stroke="black" />
  <path d="M 120,144 L 120,160" fill="none" stroke="black" />
  <path d="M 120,160 L 120,176" fill="none" stroke="black" />
  <path d="M 120,208 L 120,224" fill="none" stroke="black" />
  <path d="M 120,224 L 120,240" fill="none" stroke="black" />
  <path d="M 120,272 L 120,288" fill="none" stroke="black" />
  <path d="M 120,288 L 120,304" fill="none" stroke="black" />
  <path d="M 160,96 L 160,160" fill="none" stroke="black" />
  <path d="M 160,160 L 160,192" fill="none" stroke="black" />
  <path d="M 160,192 L 160,224" fill="none" stroke="black" />
  <path d="M 160,224 L 160,288" fill="none" stroke="black" />
  <path d="M 216,96 L 216,160" fill="none" stroke="black" />
  <path d="M 216,160 L 216,192" fill="none" stroke="black" />
  <path d="M 216,192 L 216,224" fill="none" stroke="black" />
  <path d="M 216,224 L 216,288" fill="none" stroke="black" />
  <path d="M 384,16 L 384,320" fill="none" stroke="black" />
  <polygon points="136.000000,96.000000 124.000000,90.400002 124.000000,101.599998" fill="black" transform="rotate(180.000000, 128.000000, 96.000000)" />
  <polygon points="136.000000,160.000000 124.000000,154.399994 124.000000,165.600006" fill="black" transform="rotate(180.000000, 128.000000, 160.000000)" />
  <polygon points="136.000000,224.000000 124.000000,218.399994 124.000000,229.600006" fill="black" transform="rotate(180.000000, 128.000000, 224.000000)" />
  <polygon points="136.000000,288.000000 124.000000,282.399994 124.000000,293.600006" fill="black" transform="rotate(180.000000, 128.000000, 288.000000)" />
  <polygon points="256.000000,96.000000 244.000000,90.400002 244.000000,101.599998" fill="black" transform="rotate(0.000000, 248.000000, 96.000000)" />
  <polygon points="256.000000,160.000000 244.000000,154.399994 244.000000,165.600006" fill="black" transform="rotate(0.000000, 248.000000, 160.000000)" />
  <polygon points="256.000000,224.000000 244.000000,218.399994 244.000000,229.600006" fill="black" transform="rotate(0.000000, 248.000000, 224.000000)" />
  <polygon points="256.000000,288.000000 244.000000,282.399994 244.000000,293.600006" fill="black" transform="rotate(0.000000, 248.000000, 288.000000)" />
  <path d="M 16,0 A 16,16 0 0,0 0,16" fill="none" stroke="black" />
  <path d="M 368,0 A 16,16 0 0,1 384,16" fill="none" stroke="black" />
  <path d="M 272,80 A 16,16 0 0,0 256,96" fill="none" stroke="black" />
  <path d="M 320,80 A 16,16 0 0,1 336,96" fill="none" stroke="black" />
  <path d="M 256,96 A 16,16 0 0,0 272,112" fill="none" stroke="black" />
  <path d="M 336,96 A 16,16 0 0,1 320,112" fill="none" stroke="black" />
  <path d="M 272,144 A 16,16 0 0,0 256,160" fill="none" stroke="black" />
  <path d="M 320,144 A 16,16 0 0,1 336,160" fill="none" stroke="black" />
  <path d="M 256,160 A 16,16 0 0,0 272,176" fill="none" stroke="black" />
  <path d="M 336,160 A 16,16 0 0,1 320,176" fill="none" stroke="black" />
  <path d="M 272,208 A 16,16 0 0,0 256,224" fill="none" stroke="black" />
  <path d="M 320,208 A 16,16 0 0,1 336,224" fill="none" stroke="black" />
  <path d="M 256,224 A 16,16 0 0,0 272,240" fill="none" stroke="black" />
  <path d="M 336,224 A 16,16 0 0,1 320,240" fill="none" stroke="black" />
  <path d="M 272,272 A 16,16 0 0,0 256,288" fill="none" stroke="black" />
  <path d="M 320,272 A 16,16 0 0,1 336,288" fill="none" stroke="black" />
  <path d="M 256,288 A 16,16 0 0,0 272,304" fill="none" stroke="black" />
  <path d="M 336,288 A 16,16 0 0,1 320,304" fill="none" stroke="black" />
  <path d="M 0,320 A 16,16 0 0,0 16,336" fill="none" stroke="black" />
  <path d="M 384,320 A 16,16 0 0,1 368,336" fill="none" stroke="black" />
  <text text-anchor="middle" font-family="sans-serif" x="312" y="228">r</text>
  <text text-anchor="middle" font-family="sans-serif" x="280" y="292">l</text>
  <text text-anchor="middle" font-family="sans-serif" x="304" y="292">d</text>
  <text text-anchor="middle" font-family="sans-serif" x="136" y="20">e</text>
  <text text-anchor="middle" font-family="sans-serif" x="96" y="228">p</text>
  <text text-anchor="middle" font-family="sans-serif" x="72" y="292">f</text>
  <text text-anchor="middle" font-family="sans-serif" x="312" y="292">a</text>
  <text text-anchor="middle" font-family="sans-serif" x="288" y="164">t</text>
  <text text-anchor="middle" font-family="sans-serif" x="80" y="228">t</text>
  <text text-anchor="middle" font-family="sans-serif" x="184" y="20">r</text>
  <text text-anchor="middle" font-family="sans-serif" x="192" y="20">s</text>
  <text text-anchor="middle" font-family="sans-serif" x="240" y="20">M</text>
  <text text-anchor="middle" font-family="sans-serif" x="320" y="100">d</text>
  <text text-anchor="middle" font-family="sans-serif" x="72" y="228">p</text>
  <text text-anchor="middle" font-family="sans-serif" x="264" y="228">B</text>
  <text text-anchor="middle" font-family="sans-serif" x="168" y="20">P</text>
  <text text-anchor="middle" font-family="sans-serif" x="176" y="20">e</text>
  <text text-anchor="middle" font-family="sans-serif" x="320" y="292">r</text>
  <text text-anchor="middle" font-family="sans-serif" x="88" y="292">e</text>
  <text text-anchor="middle" font-family="sans-serif" x="96" y="292">e</text>
  <text text-anchor="middle" font-family="sans-serif" x="304" y="100">o</text>
  <text text-anchor="middle" font-family="sans-serif" x="264" y="164">C</text>
  <text text-anchor="middle" font-family="sans-serif" x="64" y="228">a</text>
  <text text-anchor="middle" font-family="sans-serif" x="264" y="292">C</text>
  <text text-anchor="middle" font-family="sans-serif" x="128" y="20">c</text>
  <text text-anchor="middle" font-family="sans-serif" x="104" y="52">s</text>
  <text text-anchor="middle" font-family="sans-serif" x="304" y="164">c</text>
  <text text-anchor="middle" font-family="sans-serif" x="320" y="228">k</text>
  <text text-anchor="middle" font-family="sans-serif" x="144" y="20">'</text>
  <text text-anchor="middle" font-family="sans-serif" x="96" y="52">e</text>
  <text text-anchor="middle" font-family="sans-serif" x="296" y="52">a</text>
  <text text-anchor="middle" font-family="sans-serif" x="312" y="164">t</text>
  <text text-anchor="middle" font-family="sans-serif" x="80" y="52">i</text>
  <text text-anchor="middle" font-family="sans-serif" x="88" y="52">c</text>
  <text text-anchor="middle" font-family="sans-serif" x="296" y="164">a</text>
  <text text-anchor="middle" font-family="sans-serif" x="312" y="100">r</text>
  <text text-anchor="middle" font-family="sans-serif" x="272" y="164">o</text>
  <text text-anchor="middle" font-family="sans-serif" x="200" y="20">o</text>
  <text text-anchor="middle" font-family="sans-serif" x="280" y="52">a</text>
  <text text-anchor="middle" font-family="sans-serif" x="272" y="52">C</text>
  <text text-anchor="middle" font-family="sans-serif" x="328" y="52">s</text>
  <text text-anchor="middle" font-family="sans-serif" x="272" y="100">a</text>
  <text text-anchor="middle" font-family="sans-serif" x="280" y="100">s</text>
  <text text-anchor="middle" font-family="sans-serif" x="80" y="164">o</text>
  <text text-anchor="middle" font-family="sans-serif" x="56" y="228">L</text>
  <text text-anchor="middle" font-family="sans-serif" x="248" y="20">e</text>
  <text text-anchor="middle" font-family="sans-serif" x="64" y="52">e</text>
  <text text-anchor="middle" font-family="sans-serif" x="88" y="228">o</text>
  <text text-anchor="middle" font-family="sans-serif" x="272" y="228">o</text>
  <text text-anchor="middle" font-family="sans-serif" x="296" y="100">w</text>
  <text text-anchor="middle" font-family="sans-serif" x="64" y="164">P</text>
  <text text-anchor="middle" font-family="sans-serif" x="312" y="52">o</text>
  <text text-anchor="middle" font-family="sans-serif" x="64" y="100">a</text>
  <text text-anchor="middle" font-family="sans-serif" x="88" y="100">o</text>
  <text text-anchor="middle" font-family="sans-serif" x="288" y="100">s</text>
  <text text-anchor="middle" font-family="sans-serif" x="96" y="164">e</text>
  <text text-anchor="middle" font-family="sans-serif" x="288" y="228">k</text>
  <text text-anchor="middle" font-family="sans-serif" x="104" y="20">A</text>
  <text text-anchor="middle" font-family="sans-serif" x="216" y="20">a</text>
  <text text-anchor="middle" font-family="sans-serif" x="56" y="292">C</text>
  <text text-anchor="middle" font-family="sans-serif" x="272" y="292">a</text>
  <text text-anchor="middle" font-family="sans-serif" x="224" y="20">l</text>
  <text text-anchor="middle" font-family="sans-serif" x="80" y="100">t</text>
  <text text-anchor="middle" font-family="sans-serif" x="304" y="52">l</text>
  <text text-anchor="middle" font-family="sans-serif" x="88" y="164">n</text>
  <text text-anchor="middle" font-family="sans-serif" x="296" y="292">n</text>
  <text text-anchor="middle" font-family="sans-serif" x="120" y="20">i</text>
  <text text-anchor="middle" font-family="sans-serif" x="256" y="20">s</text>
  <text text-anchor="middle" font-family="sans-serif" x="320" y="52">g</text>
  <text text-anchor="middle" font-family="sans-serif" x="264" y="100">P</text>
  <text text-anchor="middle" font-family="sans-serif" x="280" y="164">n</text>
  <text text-anchor="middle" font-family="sans-serif" x="320" y="164">s</text>
  <text text-anchor="middle" font-family="sans-serif" x="64" y="292">o</text>
  <text text-anchor="middle" font-family="sans-serif" x="208" y="20">n</text>
  <text text-anchor="middle" font-family="sans-serif" x="288" y="52">t</text>
  <text text-anchor="middle" font-family="sans-serif" x="72" y="52">v</text>
  <text text-anchor="middle" font-family="sans-serif" x="96" y="100">p</text>
  <text text-anchor="middle" font-family="sans-serif" x="264" y="20">h</text>
  <text text-anchor="middle" font-family="sans-serif" x="56" y="52">D</text>
  <text text-anchor="middle" font-family="sans-serif" x="56" y="100">L</text>
  <text text-anchor="middle" font-family="sans-serif" x="72" y="100">p</text>
  <text text-anchor="middle" font-family="sans-serif" x="72" y="164">h</text>
  <text text-anchor="middle" font-family="sans-serif" x="280" y="228">o</text>
  <text text-anchor="middle" font-family="sans-serif" x="112" y="20">l</text>
  <text text-anchor="middle" font-family="sans-serif" x="152" y="20">s</text>
  <text text-anchor="middle" font-family="sans-serif" x="80" y="292">f</text>
  <text text-anchor="middle" font-family="sans-serif" x="288" y="292">e</text>
  <text text-anchor="middle" font-family="sans-serif" x="296" y="228">m</text>
  <text text-anchor="middle" font-family="sans-serif" x="304" y="228">a</text>
</g></svg>
</artwork>
</figure>
<t>The Mesh design is highly modular allowing components that were originally designed to support a specific requirement within the Mesh to be applied generally.</t>
<section title="Future Applications" anchor="n-future-applications-0"><t>Since a wide range of network applications may be reduced to synchronization of sets and lists, the basic primitives of Catalogs and Spools may be applied to achieve end-to-end security in an even wider variety of applications.</t>
<t>For example, a Spool may be used to maintain a mailing list, track comments on a Web forum or record annotations on a document. Encrypting the container entries under a multi-party encryption group allows such communications to be shared with a group of users while maintaining full end-to-end security and without requiring every party writing to the spool to know the public encryption key of every recipient.</t>
<t>Another interesting possibility is the use of DARE Containers as a file archive mechanism. A single signature on the final Merkle Tree digest value would be sufficient to authenticate every file in the archive. Updates to the archive might be performed using the same container synchronization primitives provided by a Mesh Service. This approach could afford a robust, secure, and efficient mechanism for software distribution and update.</t>
</section>
</section>
</section>
<section title="Security Considerations" anchor="n-security-considerations"><t>The security considerations for use and implementation of Mesh services and applications are described in the Mesh Security Considerations guide <xref target="draft-hallambaker-mesh-security"></xref>.</t>
</section>
<section title="IANA Considerations" anchor="n-iana-considerations"><t>This document does not contain actions for IANA</t>
</section>
<section title="Acknowledgements" anchor="n-acknowledgements"><t>Comodo Group: Egemen Tas, Melhi Abdulhayo?lu, Rob Stradling, Robin Alden.</t>
<t></t>
</section>
</middle>
<back>
<references title="Normative References"><reference anchor="RFC5246"><front>
<title>The Transport Layer Security (TLS) Protocol Version 1.2</title>
<author fullname="T. Dierks" initials="T." surname="Dierks"><organization/>
<address>
</address>
</author>
<author fullname="E. Rescorla" initials="E." surname="Rescorla"><organization/>
<address>
</address>
</author>
<date month="August" year="2008"/>
</front>
<seriesInfo name="RFC" value="5246"/>
<seriesInfo name="DOI" value="10.17487/RFC5246"/>
</reference>
<reference anchor="draft-hallambaker-mesh-cryptography"><front>
<title>Mathematical Mesh 3.0 Part VIII: Cryptographic Algorithms</title>
<author fullname="Phillip Hallam-Baker"><address>
</address>
</author>
<date day="2" month="November" year="2020"/>
</front>
<seriesInfo name="Internet-Draft" value="draft-hallambaker-mesh-cryptography-07"/>
<format type="TXT" target="https://www.ietf.org/archive/id/draft-hallambaker-mesh-cryptography-07.txt"/>
</reference>
<reference anchor="draft-hallambaker-mesh-platform"><front>
<title>Mathematical Mesh: Platform Configuration</title>
<author fullname="Phillip Hallam-Baker"><address>
</address>
</author>
<date day="27" month="July" year="2020"/>
</front>
<seriesInfo name="Internet-Draft" value="draft-hallambaker-mesh-platform-06"/>
<format type="TXT" target="https://www.ietf.org/archive/id/draft-hallambaker-mesh-platform-06.txt"/>
</reference>
<reference anchor="draft-hallambaker-mesh-developer"><front>
<title>Mathematical Mesh: Reference Implementation</title>
<author fullname="Phillip Hallam-Baker"><address>
</address>
</author>
<date day="27" month="July" year="2020"/>
</front>
<seriesInfo name="Internet-Draft" value="draft-hallambaker-mesh-developer-10"/>
<format type="TXT" target="https://www.ietf.org/archive/id/draft-hallambaker-mesh-developer-10.txt"/>
</reference>
<reference anchor="draft-hallambaker-threshold"><front>
<title>Threshold Modes in Elliptic Curves</title>
<author fullname="Phillip Hallam-Baker"><organization>ThresholdSecrets.com</organization>
<address>
</address>
</author>
<date day="13" month="January" year="2021"/>
</front>
<seriesInfo name="Internet-Draft" value="draft-hallambaker-threshold-05"/>
<format type="TXT" target="https://www.ietf.org/archive/id/draft-hallambaker-threshold-05.txt"/>
</reference>
<reference anchor="draft-hallambaker-web-service-discovery"><front>
<title>DNS Web Service Discovery</title>
<author fullname="Phillip Hallam-Baker"><address>
</address>
</author>
<date day="13" month="January" year="2021"/>
</front>
<seriesInfo name="Internet-Draft" value="draft-hallambaker-web-service-discovery-05"/>
<format type="TXT" target="https://www.ietf.org/archive/id/draft-hallambaker-web-service-discovery-05.txt"/>
</reference>
<reference anchor="draft-hallambaker-jsonbcd"><front>
<title>Binary Encodings for JavaScript Object Notation: JSON-B, JSON-C, JSON-D</title>
<author fullname="Phillip Hallam-Baker"><address>
</address>
</author>
<date day="13" month="January" year="2021"/>
</front>
<seriesInfo name="Internet-Draft" value="draft-hallambaker-jsonbcd-20"/>
<format type="TXT" target="https://www.ietf.org/archive/id/draft-hallambaker-jsonbcd-20.txt"/>
</reference>
<reference anchor="draft-hallambaker-mesh-security"><front>
<title>Mathematical Mesh 3.0 Part VII: Security Considerations</title>
<author fullname="Phillip Hallam-Baker"><organization>ThresholdSecrets.com</organization>
<address>
</address>
</author>
<date day="2" month="November" year="2020"/>
</front>
<seriesInfo name="Internet-Draft" value="draft-hallambaker-mesh-security-06"/>
<format type="TXT" target="https://www.ietf.org/archive/id/draft-hallambaker-mesh-security-06.txt"/>
</reference>
<reference anchor="draft-hallambaker-mesh-callsign"><front>
<title>Mathematical Mesh 3.0 Part VII: Mesh Callsign Service</title>
<author fullname="Phillip Hallam-Baker"><organization>ThresholdSecrets.com</organization>
<address>
</address>
</author>
<date day="3" month="April" year="2021"/>
</front>
<seriesInfo name="Internet-Draft" value="draft-hallambaker-mesh-callsign-00"/>
<format type="TXT" target="https://www.ietf.org/archive/id/draft-hallambaker-mesh-callsign-00.txt"/>
</reference>
<reference anchor="draft-hallambaker-mesh-protocol"><front>
<title>Mathematical Mesh 3.0 Part V: Protocol Reference</title>
<author fullname="Phillip Hallam-Baker"><organization>ThresholdSecrets.com</organization>
<address>
</address>
</author>
<date day="13" month="January" year="2021"/>
</front>
<seriesInfo name="Internet-Draft" value="draft-hallambaker-mesh-protocol-08"/>
<format type="TXT" target="https://www.ietf.org/archive/id/draft-hallambaker-mesh-protocol-08.txt"/>
</reference>
<reference anchor="draft-hallambaker-mesh-schema"><front>
<title>Mathematical Mesh 3.0 Part IV: Schema Reference</title>
<author fullname="Phillip Hallam-Baker"><organization>ThresholdSecrets.com</organization>
<address>
</address>
</author>
<date day="13" month="January" year="2021"/>
</front>
<seriesInfo name="Internet-Draft" value="draft-hallambaker-mesh-schema-07"/>
<format type="TXT" target="https://www.ietf.org/archive/id/draft-hallambaker-mesh-schema-07.txt"/>
</reference>
<reference anchor="draft-hallambaker-mesh-dare"><front>
<title>Mathematical Mesh 3.0 Part III : Data At Rest Encryption (DARE)</title>
<author fullname="Phillip Hallam-Baker"><organization>ThresholdSecrets.com</organization>
<address>
</address>
</author>
<date day="13" month="January" year="2021"/>
</front>
<seriesInfo name="Internet-Draft" value="draft-hallambaker-mesh-dare-11"/>
<format type="TXT" target="https://www.ietf.org/archive/id/draft-hallambaker-mesh-dare-11.txt"/>
</reference>
<reference anchor="draft-hallambaker-mesh-udf"><front>
<title>Mathematical Mesh 3.0 Part II: Uniform Data Fingerprint.</title>
<author fullname="Phillip Hallam-Baker"><organization>ThresholdSecrets.com</organization>
<address>
</address>
</author>
<date day="13" month="January" year="2021"/>
</front>
<seriesInfo name="Internet-Draft" value="draft-hallambaker-mesh-udf-12"/>
<format type="TXT" target="https://www.ietf.org/archive/id/draft-hallambaker-mesh-udf-12.txt"/>
</reference>
<reference anchor="RFC2119"><front>
<title>Key words for use in RFCs to Indicate Requirement Levels</title>
<author fullname="S. Bradner" initials="S." surname="Bradner"><organization/>
<address>
</address>
</author>
<date month="March" year="1997"/>
</front>
<seriesInfo name="BCP" value="14"/>
<seriesInfo name="RFC" value="2119"/>
<seriesInfo name="DOI" value="10.17487/RFC2119"/>
</reference>
<reference anchor="RFC7516"><front>
<title>JSON Web Encryption (JWE)</title>
<author fullname="M. Jones" initials="M." surname="Jones"><organization/>
<address>
</address>
</author>
<author fullname="J. Hildebrand" initials="J." surname="Hildebrand"><organization/>
<address>
</address>
</author>
<date month="May" year="2015"/>
</front>
<seriesInfo name="RFC" value="7516"/>
<seriesInfo name="DOI" value="10.17487/RFC7516"/>
</reference>
<reference anchor="RFC7515"><front>
<title>JSON Web Signature (JWS)</title>
<author fullname="M. Jones" initials="M." surname="Jones"><organization/>
<address>
</address>
</author>
<author fullname="J. Bradley" initials="J." surname="Bradley"><organization/>
<address>
</address>
</author>
<author fullname="N. Sakimura" initials="N." surname="Sakimura"><organization/>
<address>
</address>
</author>
<date month="May" year="2015"/>
</front>
<seriesInfo name="RFC" value="7515"/>
<seriesInfo name="DOI" value="10.17487/RFC7515"/>
</reference>
<reference anchor="RFC7159"><front>
<title>The JavaScript Object Notation (JSON) Data Interchange Format</title>
<author fullname="T. Bray" initials="T." surname="Bray"><organization/>
<address>
</address>
</author>
<date month="March" year="2014"/>
</front>
<seriesInfo name="RFC" value="7159"/>
<seriesInfo name="DOI" value="10.17487/RFC7159"/>
</reference>
<reference anchor="RFC7231"><front>
<title>Hypertext Transfer Protocol (HTTP/1.1): Semantics and Content</title>
<author fullname="R. Fielding" initials="R." surname="Fielding"><organization/>
<address>
</address>
</author>
<author fullname="J. Reschke" initials="J." surname="Reschke"><organization/>
<address>
</address>
</author>
<date month="June" year="2014"/>
</front>
<seriesInfo name="RFC" value="7231"/>
<seriesInfo name="DOI" value="10.17487/RFC7231"/>
</reference>
<reference anchor="draft-hallambaker-threshold-sigs"><front>
<title>Threshold Signatures in Elliptic Curves</title>
<author fullname="Phillip Hallam-Baker"><organization>ThresholdSecrets.com</organization>
<address>
</address>
</author>
<date day="13" month="January" year="2021"/>
</front>
<seriesInfo name="Internet-Draft" value="draft-hallambaker-threshold-sigs-06"/>
<format type="TXT" target="https://www.ietf.org/archive/id/draft-hallambaker-threshold-sigs-06.txt"/>
</reference>
<reference anchor="draft-hallambaker-mesh-rud"><front>
<title>[Reference Not Found!]</title>
<author initials="" surname=""><organization/>
<address>
</address>
</author>
<date/>
</front>
</reference>
</references>
<references title="Informative References"><reference anchor="draft-hallambaker-mesh-trust"><front>
<title>Mathematical Mesh 3.0 Part IX: The Trust Mesh</title>
<author fullname="Phillip Hallam-Baker"><organization>ThresholdSecrets.com</organization>
<address>
</address>
</author>
<date day="13" month="January" year="2021"/>
</front>
<seriesInfo name="Internet-Draft" value="draft-hallambaker-mesh-trust-08"/>
<format type="TXT" target="https://www.ietf.org/archive/id/draft-hallambaker-mesh-trust-08.txt"/>
</reference>
</references>
</back>
</rfc>
