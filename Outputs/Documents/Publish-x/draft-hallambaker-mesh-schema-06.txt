Independent Submission                             Phillip Hallam-Baker
INTERNET-DRAFT                                      ThresholdSecrets.com
Intended Status:                                        November 3, 2020
Expires: May 7, 2021


            Mathematical Mesh 3.0 Part IV: Schema Reference
                    draft-hallambaker-mesh-schema-06

Abstract

   The Mathematical Mesh 'The Mesh' is an end-to-end secure
   infrastructure that facilitates the exchange of configuration and
   credential data between multiple user devices. The core protocols of
   the Mesh are described with examples of common use cases and
   reference data.

   [Note to Readers]

   Discussion of this draft takes place on the MATHMESH mailing list
   (mathmesh@ietf.org), which is archived at
   https://mailarchive.ietf.org/arch/search/?email_list=mathmesh.

   This document is also available online at .

Status of This Memo

   This Internet-Draft is submitted in full conformance with the
   provisions of BCP 78 and BCP 79.

   Internet-Drafts are working documents of the Internet Engineering
   Task Force (IETF).  Note that other groups may also distribute
   working documents as Internet-Drafts. The list of current Internet-
   Drafts is at http://datatracker.ietf.org/drafts/current/.

   Internet-Drafts are draft documents valid for a maximum of six months
   and may be updated, replaced, or obsoleted by other documents at any
   time.It is inappropriate to use Internet-Drafts as reference material
   or to cite them other than as "work in progress."

   This Internet-Draft will expire on May 7, 2021

Copyright Notice

   Copyright (c) IETF Trust and the persons identified as the document
   authors. All rights reserved.

   This document is subject to BCP 78 and the IETF Trust's Legal
   Provisions Relating to IETF Documents
   (http://trustee.ietf.org/license-info) in effect on the date of
   publication of this document. Please review these documents
   carefully, as they describe your rights and restrictions with respect
   to this document.



Hallam-Baker              Expires May 7, 2021                   [Page 1]

                         Mesh Schema Reference             November 2020























































Hallam-Baker              Expires May 7, 2021                   [Page 2]

                         Mesh Schema Reference             November 2020

Table of Contents

   1.  Introduction . . . . . . . . . . . . . . . . . . . . . . . . .  7
   2.  Definitions  . . . . . . . . . . . . . . . . . . . . . . . . .  7
      2.1.  Requirements Language . . . . . . . . . . . . . . . . . .  7
      2.2.  Defined Terms . . . . . . . . . . . . . . . . . . . . . .  7
      2.3.  Related Specifications  . . . . . . . . . . . . . . . . .  7
      2.4.  Implementation Status . . . . . . . . . . . . . . . . . .  7
   3.  Actors . . . . . . . . . . . . . . . . . . . . . . . . . . . .  8
      3.1.  Accounts  . . . . . . . . . . . . . . . . . . . . . . . .  8
      3.2.  Device  . . . . . . . . . . . . . . . . . . . . . . . . .  9
         3.2.1.  Activation . . . . . . . . . . . . . . . . . . . . . 11
      3.3.  Service . . . . . . . . . . . . . . . . . . . . . . . . . 13
   4.  Catalogs . . . . . . . . . . . . . . . . . . . . . . . . . . . 13
      4.1.  Access  . . . . . . . . . . . . . . . . . . . . . . . . . 14
      4.2.  Application . . . . . . . . . . . . . . . . . . . . . . . 15
         4.2.1.  Mesh Account . . . . . . . . . . . . . . . . . . . . 15
         4.2.2.  SSH  . . . . . . . . . . . . . . . . . . . . . . . . 15
         4.2.3.  Mail . . . . . . . . . . . . . . . . . . . . . . . . 15
      4.3.  Bookmark  . . . . . . . . . . . . . . . . . . . . . . . . 16
      4.4.  Contact . . . . . . . . . . . . . . . . . . . . . . . . . 16
      4.5.  Credential  . . . . . . . . . . . . . . . . . . . . . . . 19
      4.6.  Device  . . . . . . . . . . . . . . . . . . . . . . . . . 20
      4.7.  Network . . . . . . . . . . . . . . . . . . . . . . . . . 20
      4.8.  Publication . . . . . . . . . . . . . . . . . . . . . . . 20
      4.9.  Task  . . . . . . . . . . . . . . . . . . . . . . . . . . 20
   5.  Spools . . . . . . . . . . . . . . . . . . . . . . . . . . . . 20
      5.1.  Outbound  . . . . . . . . . . . . . . . . . . . . . . . . 21
      5.2.  Inbound . . . . . . . . . . . . . . . . . . . . . . . . . 21
      5.3.  Local . . . . . . . . . . . . . . . . . . . . . . . . . . 22
   6.  Cryptographic Operations . . . . . . . . . . . . . . . . . . . 22
      6.1.  Key Derivation from Seed  . . . . . . . . . . . . . . . . 22
      6.2.  Message Response Identifier . . . . . . . . . . . . . . . 23
      6.3.  Proof of Knowledge of PIN . . . . . . . . . . . . . . . . 23
      6.4.  EARL  . . . . . . . . . . . . . . . . . . . . . . . . . . 24
      6.5.  Key Agreement . . . . . . . . . . . . . . . . . . . . . . 25
      6.6.  Service Cryptographic Operations  . . . . . . . . . . . . 25
   7.  Mesh Assertions  . . . . . . . . . . . . . . . . . . . . . . . 26
      7.1.  Encoding  . . . . . . . . . . . . . . . . . . . . . . . . 26
      7.2.  Mesh Profiles . . . . . . . . . . . . . . . . . . . . . . 27
      7.3.  Mesh Connections  . . . . . . . . . . . . . . . . . . . . 28
   8.  Architecture . . . . . . . . . . . . . . . . . . . . . . . . . 28
      8.1.  Device Management . . . . . . . . . . . . . . . . . . . . 29
         8.1.1.  Master Profile . . . . . . . . . . . . . . . . . . . 29
         8.1.2.  Mesh Devices . . . . . . . . . . . . . . . . . . . . 31
      8.2.  Mesh Accounts . . . . . . . . . . . . . . . . . . . . . . 32
         8.2.1.  Creating a ProfileAccount  . . . . . . . . . . . . . 33
         8.2.2.  Connecting a Device to an Account  . . . . . . . . . 33
         8.2.3.  Binding and Account to a Service . . . . . . . . . . 33
      8.3.  Mesh Services . . . . . . . . . . . . . . . . . . . . . . 33
         8.3.1.  Creating a ProfileService  . . . . . . . . . . . . . 34



Hallam-Baker              Expires May 7, 2021                   [Page 3]

                         Mesh Schema Reference             November 2020

         8.3.2.  Creating a ProfileHost . . . . . . . . . . . . . . . 34
         8.3.3.  Creating a ConnectionHost  . . . . . . . . . . . . . 34
      8.4.  Mesh Messaging  . . . . . . . . . . . . . . . . . . . . . 35
         8.4.1.  Traffic Analysis . . . . . . . . . . . . . . . . . . 35
   9.  Mesh Messages  . . . . . . . . . . . . . . . . . . . . . . . . 36
      9.1.  PIN . . . . . . . . . . . . . . . . . . . . . . . . . . . 36
      9.2.  Completion  . . . . . . . . . . . . . . . . . . . . . . . 36
      9.3.  Connection  . . . . . . . . . . . . . . . . . . . . . . . 37
      9.4.  Contact . . . . . . . . . . . . . . . . . . . . . . . . . 44
      9.5.  Confirmation  . . . . . . . . . . . . . . . . . . . . . . 46
   10.  Publications  . . . . . . . . . . . . . . . . . . . . . . . . 47
      10.1.  Contact Exchange . . . . . . . . . . . . . . . . . . . . 47
      10.2.  Device Preconfiguration  . . . . . . . . . . . . . . . . 47
   11.  Schema  . . . . . . . . . . . . . . . . . . . . . . . . . . . 49
      11.1.  Shared Classes   . . . . . . . . . . . . . . . . . . . . 49
         11.1.1.  Classes describing keys   . . . . . . . . . . . . . 49
         11.1.2.  Structure: KeyData  . . . . . . . . . . . . . . . . 50
         11.1.3.  Structure: CompositePrivate   . . . . . . . . . . . 50
      11.2.  Assertion classes  . . . . . . . . . . . . . . . . . . . 50
         11.2.1.  Structure: Assertion  . . . . . . . . . . . . . . . 50
         11.2.2.  Structure: Condition  . . . . . . . . . . . . . . . 50
         11.2.3.  Base Classes  . . . . . . . . . . . . . . . . . . . 50
         11.2.4.  Structure: Connection   . . . . . . . . . . . . . . 50
         11.2.5.  Structure: Activation   . . . . . . . . . . . . . . 51
         11.2.6.  Structure: ActivationEntry  . . . . . . . . . . . . 51
         11.2.7.  Mesh Profile Classes  . . . . . . . . . . . . . . . 51
         11.2.8.  Structure: Profile  . . . . . . . . . . . . . . . . 51
         11.2.9.  Structure: ProfileDevice  . . . . . . . . . . . . . 51
         11.2.10.  Structure: ProfileAccount  . . . . . . . . . . . . 52
         11.2.11.  Structure: ProfileUser   . . . . . . . . . . . . . 52
         11.2.12.  Structure: ProfileGroup  . . . . . . . . . . . . . 52
         11.2.13.  Structure: ProfileService  . . . . . . . . . . . . 53
         11.2.14.  Structure: ProfileHost   . . . . . . . . . . . . . 53
         11.2.15.  Connection Assertions  . . . . . . . . . . . . . . 53
         11.2.16.  Structure: ConnectionDevice  . . . . . . . . . . . 53
         11.2.17.  Structure: ConnectionApplication   . . . . . . . . 53
         11.2.18.  Structure: ConnectionGroup   . . . . . . . . . . . 53
         11.2.19.  Structure: ConnectionService   . . . . . . . . . . 54
         11.2.20.  Structure: ConnectionHost  . . . . . . . . . . . . 54
         11.2.21.  Activation Assertions  . . . . . . . . . . . . . . 54
         11.2.22.  Structure: ActivationDevice  . . . . . . . . . . . 54
         11.2.23.  Structure: ActivationAccount   . . . . . . . . . . 54
         11.2.24.  Structure: ActivationApplication   . . . . . . . . 54
      11.3.  Data Structures  . . . . . . . . . . . . . . . . . . . . 55
         11.3.1.  Structure: Contact  . . . . . . . . . . . . . . . . 55
         11.3.2.  Structure: Anchor   . . . . . . . . . . . . . . . . 55
         11.3.3.  Structure: TaggedSource   . . . . . . . . . . . . . 55
         11.3.4.  Structure: ContactGroup   . . . . . . . . . . . . . 55
         11.3.5.  Structure: ContactPerson  . . . . . . . . . . . . . 56
         11.3.6.  Structure: ContactOrganization  . . . . . . . . . . 56
         11.3.7.  Structure: OrganizationName   . . . . . . . . . . . 56



Hallam-Baker              Expires May 7, 2021                   [Page 4]

                         Mesh Schema Reference             November 2020

         11.3.8.  Structure: PersonName   . . . . . . . . . . . . . . 56
         11.3.9.  Structure: NetworkAddress   . . . . . . . . . . . . 57
         11.3.10.  Structure: NetworkProtocol   . . . . . . . . . . . 57
         11.3.11.  Structure: Role  . . . . . . . . . . . . . . . . . 57
         11.3.12.  Structure: Location  . . . . . . . . . . . . . . . 57
         11.3.13.  Structure: Bookmark  . . . . . . . . . . . . . . . 57
         11.3.14.  Structure: Reference   . . . . . . . . . . . . . . 58
         11.3.15.  Structure: Task  . . . . . . . . . . . . . . . . . 58
      11.4.  Catalog Entries  . . . . . . . . . . . . . . . . . . . . 58
         11.4.1.  Structure: CatalogedEntry   . . . . . . . . . . . . 58
         11.4.2.  Structure: CatalogedDevice  . . . . . . . . . . . . 58
         11.4.3.  Structure: CatalogedPublication   . . . . . . . . . 59
         11.4.4.  Structure: CatalogedCredential  . . . . . . . . . . 59
         11.4.5.  Structure: CatalogedNetwork   . . . . . . . . . . . 60
         11.4.6.  Structure: CatalogedContact   . . . . . . . . . . . 60
         11.4.7.  Structure: CatalogedAccess  . . . . . . . . . . . . 60
         11.4.8.  Structure: CryptographicCapability  . . . . . . . . 60
         11.4.9.  Structure: CapabilityDecrypt  . . . . . . . . . . . 60
         11.4.10.  Structure: CapabilityDecryptPartial  . . . . . . . 60
         11.4.11.  Structure: CapabilityDecryptServiced   . . . . . . 61
         11.4.12.  Structure: CapabilitySign  . . . . . . . . . . . . 61
         11.4.13.  Structure: CapabilityKeyGenerate   . . . . . . . . 61
         11.4.14.  Structure: CapabilityFairExchange  . . . . . . . . 61
         11.4.15.  Structure: CatalogedBookmark   . . . . . . . . . . 61
         11.4.16.  Structure: CatalogedTask   . . . . . . . . . . . . 62
         11.4.17.  Structure: CatalogedApplication  . . . . . . . . . 62
         11.4.18.  Structure: CatalogedMember   . . . . . . . . . . . 62
         11.4.19.  Structure: CatalogedGroup  . . . . . . . . . . . . 62
         11.4.20.  Structure: CatalogedApplicationSSH   . . . . . . . 62
         11.4.21.  Structure: CatalogedApplicationMail  . . . . . . . 63
         11.4.22.  Structure: CatalogedApplicationNetwork   . . . . . 63
      11.5.  Publications   . . . . . . . . . . . . . . . . . . . . . 63
         11.5.1.  Structure: DevicePreconfiguration   . . . . . . . . 63
      11.6.  Messages   . . . . . . . . . . . . . . . . . . . . . . . 63
         11.6.1.  Structure: Message  . . . . . . . . . . . . . . . . 63
         11.6.2.  Structure: MessageError   . . . . . . . . . . . . . 63
         11.6.3.  Structure: MessageComplete  . . . . . . . . . . . . 63
         11.6.4.  Structure: MessagePinValidated  . . . . . . . . . . 64
         11.6.5.  Structure: MessagePin   . . . . . . . . . . . . . . 64
         11.6.6.  Structure: RequestConnection  . . . . . . . . . . . 64
         11.6.7.  Structure: AcknowledgeConnection  . . . . . . . . . 64
         11.6.8.  Structure: RespondConnection  . . . . . . . . . . . 65
         11.6.9.  Structure: MessageContact   . . . . . . . . . . . . 65
         11.6.10.  Structure: GroupInvitation   . . . . . . . . . . . 65
         11.6.11.  Structure: RequestConfirmation   . . . . . . . . . 65
         11.6.12.  Structure: ResponseConfirmation  . . . . . . . . . 65
         11.6.13.  Structure: RequestTask   . . . . . . . . . . . . . 65
         11.6.14.  Structure: MessageClaim  . . . . . . . . . . . . . 66
         11.6.15.  Structure: ProcessResult   . . . . . . . . . . . . 66
   12.  Security Considerations . . . . . . . . . . . . . . . . . . . 66
   13.  IANA Considerations . . . . . . . . . . . . . . . . . . . . . 66



Hallam-Baker              Expires May 7, 2021                   [Page 5]

                         Mesh Schema Reference             November 2020

   14.  Acknowledgements  . . . . . . . . . . . . . . . . . . . . . . 66
   15.  Appendix A: Example Container Organization (not normative)  . 66
      15.1.  Device . . . . . . . . . . . . . . . . . . . . . . . . . 67
         15.1.1.  Creating a new Mesh . . . . . . . . . . . . . . . . 67
         15.1.2.  Adding an Account . . . . . . . . . . . . . . . . . 67
         15.1.3.  Adding a Device . . . . . . . . . . . . . . . . . . 67
      15.2.  Service  . . . . . . . . . . . . . . . . . . . . . . . . 67
         15.2.1.  Creating a Service  . . . . . . . . . . . . . . . . 67
         15.2.2.  Adding an Account . . . . . . . . . . . . . . . . . 67
   16.  Appendix B: Collected Authentication and Encryption 
         Requirements . . . . . . . . . . . . . . . . . . . . . . . . 67
      16.1.  Mesh Messaging . . . . . . . . . . . . . . . . . . . . . 68
   References . . . . . . . . . . . . . . . . . . . . . . . . . . . . 68
      Normative References  . . . . . . . . . . . . . . . . . . . . . 68
      Informative References  . . . . . . . . . . . . . . . . . . . . 69
   Author's Address . . . . . . . . . . . . . . . . . . . . . . . . . 69






































Hallam-Baker              Expires May 7, 2021                   [Page 6]

                         Mesh Schema Reference             November 2020

1. Introduction

   This document describes the data structures of the Mathematical Mesh
   with illustrative examples. For an overview of the Mesh objectives
   and architecture, consult the accompanying Architecture Guide . For
   information on the implementation of the Mesh Service protocol,
   consult the accompanying Protocol Reference

   This document has two main sections. The first section presents
   examples of the Mesh assertions, catalog entry and messages in use.
   The second section contains the schema reference. All the material in
   both sections is generated from the Mesh reference implementation .

   Although some of the services described in this document could be
   used to replace existing Internet protocols including FTP and SMTP,
   the principal value of any communication protocol lies in the size of
   the audience it allows them to communicate with. Thus, while the Mesh
   Messaging service is designed to support efficient and reliable
   transfer of messages ranging in size from a few bytes to multiple
   terabytes, the near-term applications of these services will be to
   applications that are not adequately supported by existing protocols
   if at all.

2. Definitions

   This section presents the related specifications and standard, the
   terms that are used as terms of art within the documents and the
   terms used as requirements language.

2.1. Requirements Language

   The key words "MUST", "MUST NOT", "REQUIRED", "SHALL", "SHALL NOT",
   "SHOULD", "SHOULD NOT", "RECOMMENDED", "MAY", and "OPTIONAL" in this
   document are to be interpreted as described in .

2.2. Defined Terms

   The terms of art used in this document are described in the Mesh
   Architecture Guide .

2.3. Related Specifications

   The architecture of the Mathematical Mesh is described in the Mesh
   Architecture Guide . The Mesh documentation set and related
   specifications are described in this document.

2.4. Implementation Status

   The implementation status of the reference code base is described in
   the companion document .




Hallam-Baker              Expires May 7, 2021                   [Page 7]

                         Mesh Schema Reference             November 2020

3. Actors

   The Mesh mediates interactions between three principal actors:
   Accounts, Devices, and Services.

   Currently two account types are specified, user accounts which belong
   to an individual user and group accounts that are used to share
   access to confidential information between a group of users. It may
   prove useful to define new types of account over time or to eliminate
   the distinction entirely. When active a Mesh account is bound to a
   Mesh Service. The service to which an account is bound MAY be changed
   over time but an account can only be bound to a single service at a
   time.

   A Mesh account is an abstract construct that (when active) is
   instantiated across one or more physical machines called a device.
   Each device that is connected to an account has a separate set of
   cryptographic keys that are used to interact with other devices
   connected to the account and MAY be provisioned with access to the
   account private keys which MAY or MAY NOT be mediated by the current
   Mesh Service.

   A Mesh Service is an abstract construct that is provided by one or
   more physical machines called Hosts. A Mesh Host is a device that is
   attached to a service rather than an account.

3.1. Accounts

   A Mesh Account is described by a Profile descended from Profile
   Account and contains a set of Mesh stores. Currently two account
   profiles are defined:

         ProfileUser

         ProfileGroup

   Both types of profile specify the following fields:

         ProfileSignature

         AccountAddress

         ServiceUdf

         AdministratorSignature

         AccountEncryption

   User accounts specify two additional public keys, AccountSignature
   and AccountAuthentication which allow signature and authentication
   operations under the account context.



Hallam-Baker              Expires May 7, 2021                   [Page 8]

                         Mesh Schema Reference             November 2020


   Every account contains a set of catalogs and spools that are managed
   by the service as directed by the contents of the associated Access
   catalog.

   For example, the personal account profile Alice created is:

   {
     "ProfileUser":{
       "ProfileSignature":{
         "Udf":"MCDH-FIPQ-XWI3-2MLS-KZ6U-SAVO-EVSH",
         "PublicParameters":{
           "PublicKeyECDH":{
             "crv":"Ed448",
             "Public":"hQLIqgN0KQKuxG_-HtGWbPCIuFRoloTBz8ss2Z9mzxyU8
     PhHlXNsdn6wEI5DlSSd-xDTT5Dqe-8A"}}},
       "AccountAddress":"alice@example.com",
       "ServiceUdf":"MDQO-R66J-MVEO-BDL6-V6T7-FPII-U42Q",
       "AccountEncryption":{
         "Udf":"MCSM-JRCO-FDSE-HU2X-RZ6B-TZVO-EUWG",
         "PublicParameters":{
           "PublicKeyECDH":{
             "crv":"X448",
             "Public":"28mMM_tdArnhlajmrAuXKHBwXjgdW7NaeaNiVa1BCRCyB
     Ax1t49JEIQPQAplbezybYeZHLPxciQA"}}},
       "AdministratorSignature":{
         "Udf":"MCDH-FIPQ-XWI3-2MLS-KZ6U-SAVO-EVSH",
         "PublicParameters":{
           "PublicKeyECDH":{
             "crv":"Ed448",
             "Public":"hQLIqgN0KQKuxG_-HtGWbPCIuFRoloTBz8ss2Z9mzxyU8
     PhHlXNsdn6wEI5DlSSd-xDTT5Dqe-8A"}}},
       "AccountAuthentication":{
         "Udf":"MDHV-NL5I-FTNE-MEPP-T3LL-GV2P-3PQK",
         "PublicParameters":{
           "PublicKeyECDH":{
             "crv":"X448",
             "Public":"9Km5sPv4-2EXP5548xrayizrApYeTsKsRcHrJO3igCnL8
     90y_ilAojRlaJ-BPTG39A0QGtMun-8A"}}},
       "AccountSignature":{
         "Udf":"MBYB-3SKG-SIFR-KEFJ-DDUI-XURM-VG6N",
         "PublicParameters":{
           "PublicKeyECDH":{
             "crv":"Ed448",
             "Public":"eCujE9J56gn6h-GvBphDhz1qB5PKTSGmmjkiqHFjmDpA2
     7mCZlK4PkG_mhON_Cw71UZaAiomjhCA"}}}}}








Hallam-Baker              Expires May 7, 2021                   [Page 9]

                         Mesh Schema Reference             November 2020

3.2. Device

   Every Mesh device has a set of private keys that are unique to that
   device. These keys MAY be installed during manufacture, installed
   from an external source after manufacture or generated on the device.
   If the platform capabilities allow, device private keys SHOULD be
   bound to the device so that they cannot be extracted or exported
   without substantial effort.

   The public keys corresponding to the device private keys are
   specified in a ProfileDevice. This MUST contain at least the
   following fields:

         ProfileSignature

         BaseEncryption

         BaseAuthentication

         BaseSignature

   For example, the device profile corresponding to Alice's coffee pot
   device is:

   {
     "ProfileDevice":{
       "ProfileSignature":{
         "Udf":"MC67-GVFM-B45X-D6AS-YAVS-TJ57-UKVY",
         "PublicParameters":{
           "PublicKeyECDH":{
             "crv":"Ed448",
             "Public":"OdTzNZrT1fGNp370C4LuQXGYJIPVb2bRrTPq28JC_SXe6
     3dyJa3nRpVyr4exF1pIFE0WaeMBPtAA"}}},
       "BaseEncryption":{
         "Udf":"MCZE-Z7HA-MCIL-72US-VFFL-QFIB-AE47",
         "PublicParameters":{
           "PublicKeyECDH":{
             "crv":"X448",
             "Public":"pSzfHxxdrF6C6xtwr7HgwDqu5CVfNh3o2LFS9t6r6oGXT
     NMJyiyk0n4zJ_IUw9L9l1i8GJnP_IyA"}}},
       "BaseAuthentication":{
         "Udf":"MAPU-OCDS-27ZH-T7GB-NT62-YEAY-NL37",
         "PublicParameters":{
           "PublicKeyECDH":{
             "crv":"X448",
             "Public":"AhkZqgNobM0PclYuBY63wUJ8U-TgofPHJuGflr4hlk-SX
     BTYEuHD81EwToIKoMSQmy31HsUuzaMA"}}},
       "BaseSignature":{
         "Udf":"MBNK-CFXF-S57W-GFVQ-HO5H-BBJO-T4JD",
         "PublicParameters":{
           "PublicKeyECDH":{



Hallam-Baker              Expires May 7, 2021                  [Page 10]

                         Mesh Schema Reference             November 2020

             "crv":"Ed448",
             "Public":"KFEArX0e8l0z_HkmxOneYWkz2CsnxcjhmPR5tR5OxdISm
     2B4075Pjt6bvhcXwgPP6DcdalL-MN0A"}}}}}

3.2.1. Activation

   The device private keys are only used to perform cryptographic
   operations during the process of connecting a device to an account.
   During that connection process, a threshold key generation scheme is
   used to generate a second set of device keys bound to the account by
   combining the base key held by the device with a second device
   private key provided by the administration device approving the
   connection of the device to the account. The resulting key is
   referred to as the device key. The process of combining the base keys
   with the contributions to form the device keys is called Activation.

   The activation record for Alice's coffee pot device is:

   {
     "ActivationDevice":{
       "ActivationKey":"ZAAQ-G2RC-DJVV-IFII-2BJ3-XLYC-GPX6-KPI3-LGJB-J
   J52-A7O6-Y5GZ-GXTC-SRQP",
       "AccountUdf":"MC67-GVFM-B45X-D6AS-YAVS-TJ57-UKVY"}}

   The Mesh protocols are designed so that there is never a need to
   export or escrow private keys of any type associated with a device,
   neither the base key, nor the device key nor the contribution from
   the administration device.

   This approach to device configuration ensures that the keys that are
   used by the device when operating within the context of the account
   are entirely separate from those originally provided by the device
   manufacturer or generated on the device, provided only that the key
   contributions from the administration device are sufficiently random
   and unguessable.

   The public keys corresponding to the composite keys generated during
   the connection process are described in a ConnectionUser assertion
   signed by the administration key of the corresponding account.















Hallam-Baker              Expires May 7, 2021                  [Page 11]

                         Mesh Schema Reference             November 2020

   The connection record for Alice's coffee pot device is:

   {
     "ConnectionDevice":{
       "DeviceSignature":{
         "Udf":"MCUN-AHGM-A7JN-DFWA-BB6C-UPG4-KOTJ",
         "PublicParameters":{
           "PublicKeyECDH":{
             "crv":"Ed448",
             "Public":"PEtKSBO03Yncq7zeYUEG9DIhGoxjQX1W5UgfBbEIH-d6i
     bFxklJ5WD3inCeu30oLI0aoj6KkaGyA"}}},
       "DeviceEncryption":{
         "Udf":"MB6A-5AIN-EVO2-AXQN-NJRX-IQM3-MBEJ",
         "PublicParameters":{
           "PublicKeyECDH":{
             "crv":"X448",
             "Public":"t9xfIuQVc9LbMT8A0mpslDS8dd3I0Tdd4bgGPfABwYqAI
     Ws3lFgam87NBcBrihM42WZWOHTLp8AA"}}},
       "DeviceAuthentication":{
         "Udf":"MCXV-B6Z5-KWMQ-YYFS-F4FM-FODY-4KFC",
         "PublicParameters":{
           "PublicKeyECDH":{
             "crv":"X448",
             "Public":"291x6jkOqQzeYngKNzZO1Enii-oNqyYM_JtF2W3PP3EQN
     _hABBVvoTDmcy1w-DsOzRGBHBTbzzIA"}}}}}

   The ConnectionUser assertion MAY be used in the same fashion as an
   X.509v3/PKIX certificate to mediate interactions between devices
   connected to the same account without the need for interaction with
   the Mesh service. Thus, a coffee pot device connected to the account
   can receive and authenticate instructions issued by a voice
   recognition device connected to that account.

   While the ConnectionUser assertion MAY be used to mediate external
   interactions, this approach is typically undesirable as it provides
   the external parties with visibility to the internal configuration of
   the account, in particular which connected devices are being used on
   which occasions. Furthermore, the lack of the need to interact with
   the service means that the service is necessarily unable to mediate
   the exchange and enforce authorization policy on the interactions.

   Device keys are intended to be used to secure communications between
   devices connected to the same account. All communication between Mesh
   accounts SHOULD be mediated by a Mesh service. This enables abuse
   mitigation by applying access control to every outbound and every
   inbound message.

   Since Alice's coffee pot does not require the external communication
   right, the activation record for the coffee pot does not provide
   access to the account keys required to perform external
   communications. Alice's watch device does require access to the



Hallam-Baker              Expires May 7, 2021                  [Page 12]

                         Mesh Schema Reference             November 2020

   account keys so it can receive messages and task updates. But since
   it is a device that Alice has to carry on her person to use, it is a
   device that might easily be lost or stolen. Accordingly, the
   activation record for Alice's watch provides access to the account
   decryption and signature keys but in the form of threshold key shares
   mediated by the Mesh service. Thus, Alice's watch can sign and read
   message sent to the account but only under the control of the Mesh
   service.

3.3. Service

   Mesh services are described by a ProfileService. This specifies the
   encryption, and signature authentication keys used to interact with
   the abstract service.

   Since Mesh accounts and services are both abstract constructs, they
   cannot interact directly. A device connected to an account can only
   interact with a service by interacted with a device authorized to
   provide services on behalf of one or more accounts connected to the
   service. Such a device is called a Mesh Host.

   Mesh hosts MAY be managed using the same ProfileDevice and device
   connection mechanism provided for management of user devices or by
   whatever other management protocols prove convenient. The only part
   of the Service/Host interaction that is visible to devices connected
   to a profile and to hosts connected to other services is the
   ConnectionHost structure that describes the set of device keys to use
   in interactions with that specific host.

4. Catalogs

   Catalogs track sets of persistent objects associated with a Mesh
   Service Account. The Mesh Service has no access to the entries in any
   Mesh catalog except for the Device and Contacts catalog which are
   used in device authentication and authorization of inbound messages.

   Each Mesh Catalog managed by a Mesh Account has a name of the form:

   <prefix>_<name>

   Where <prefix> is the IANA assigned service name. The assigned
   service name for the Mathematical Mesh is mmm. Thus, all catalogs
   specified by the Mesh schema have names prefixed with the sequence
   mmm_.

   The following catalogs are currently specified within the
   Mathematical Mesh.







Hallam-Baker              Expires May 7, 2021                  [Page 13]

                         Mesh Schema Reference             November 2020

         Access: mmm_Access

         Application: mmm_Application

         Bookmark: mmm_Bookmark

         Contact: mmm_Contact

         Credential: mmm_Credential

         Device: mmm_Device

         Network: mmm_Network

         Member: mmm_Member

         Publication: mmm_Publication

         Task: mmm_CatalogTask

   The Access, Publication, Device and Member catalogs are involved in
   Mesh Service Protocol interactions. These interactions are further
   described in the Protocol Reference  .

   In many cases, the Mesh Catalog offers capabilities that represent a
   superset of the capabilities of an existing application. For example,
   the task catalog supports the appointment tracking functions of a
   traditional calendar application and the task tracking function of
   the traditional 'to do list' application. Combining these functions
   allows tasks to be triggered by other events other than the passage
   of time such as completion of other tasks, geographical presence,
   etc.

   In such cases, the Mesh Catalog entries are designed to provide a
   superset of the data representation capabilities of the legacy
   formats and (where available) recent extensions. Where a catalog
   entry is derived from input presented in a legacy format, the
   original data representation MAY be attached verbatim to facilitate
   interoperability.

4.1. Access

   The access catalog mmm_Access contains a list of access control
   entries granting a party authenticated using a particular
   cryptographic credential a specific privilege such as:

         *  Accept Mesh Messages of particular types

         *  Perform an operation on a private key known to the service.





Hallam-Baker              Expires May 7, 2021                  [Page 14]

                         Mesh Schema Reference             November 2020

   As with the publication catalog, the access catalog provides
   information that is necessary for the Mesh Service to act on behalf
   of the user. It is therefore necessary to grant a decryption
   capability for this catalog during the process of binding the account
   to a service.

4.2. Application

   The application catalog mmm_Application contains
   CatalogEntryApplication entries which describe the use of specific
   applications under the Mesh Service Account. Multiple application
   accounts for a single application MAY be connected to a single Mesh
   Service Account. Each account being specified in a separate entry.

   The CatalogEntryApplication entries only contain configuration
   information for the application as it applies to the account as a
   whole. If the application requires separate configuration for
   individual devices, this is specified in separate activation records
   specified in the corresponding ConnectionDevice.

4.2.1. Mesh Account

   Mesh Accounts are described by CatalogEntryAccount entries. The
   corresponding activation records for the connected devices contain
   the contributions used to derive the private keys for use of the
   account.

   The CatalogEntryAccount entry is described in the section describing
   Mesh accounts above.

4.2.2. SSH

   SSH configuration profiles are described by
   CatalogEntryApplicationSSH entries. The corresponding activation
   records for the connected devices contain the contributions used to
   derive the private keys.

   A user may have separate SSH configurations for separate purposes
   within a single Mesh Account. This allows a system administrator
   servicing multiple clients to maintain separate SSH profiles for each
   of her customers allowing credentials to be easily (and verifiably)
   revoked at contract termination.

   The SSH profile contains the information that is stored in the
   known_hosts and authorized_keys files of SSH clients and servers.

4.2.3. Mail

   Mail configuration profiles are described by one or more
   CatalogEntryApplicationMail entries, one for each email account
   connected to the Mesh profile. The corresponding activation records



Hallam-Baker              Expires May 7, 2021                  [Page 15]

                         Mesh Schema Reference             November 2020

   for the connected devices contain information used to provide the
   device with the necessary decryption information.

   Entries specify the email account address(es), the inbound and
   outbound server configuration and the cryptographic keys to be used
   for S/MIME and OpenPGP encryption.

4.3. Bookmark

   The bookmark catalog mmm_bookmark contains CatalogEntryBookmark
   entries which describe Web bookmarks and other citations allowing
   them to be shared between devices connected to the profile.

   The fields currently supported by the Bookmarks catalog are currently
   limited to the fields required for tracking Web bookmarks.
   Specification of additional fields to track full academic citations
   is a work in progress.

   {
     "CatalogedBookmark":{
       "Uri":"http://www.site1.com",
       "Title":"site1",
       "Path":"Sites.1"}}

4.4. Contact

   The contact catalog mmm_contact contains CatalogEntryContact entries
   which describe

   {
     "CatalogedContact":{
       "Key":"MCDH-FIPQ-XWI3-2MLS-KZ6U-SAVO-EVSH",
       "Self":true,
       "Contact":{
         "ContactPerson":{
           "Id":"MCDH-FIPQ-XWI3-2MLS-KZ6U-SAVO-EVSH",
           "Anchors":[{
               "Udf":"MCDH-FIPQ-XWI3-2MLS-KZ6U-SAVO-EVSH",
               "Validation":"Self"}
             ],
           "NetworkAddresses":[{
               "Address":"alice@example.com",
               "EnvelopedProfileAccount":[{
                   "EnvelopeID":"MCDH-FIPQ-XWI3-2MLS-KZ6U-SAVO-EVSH",
                   "dig":"S512",
                   "ContentMetaData":"ewogICJVbmlxdWVJRCI6ICJNQ0RILU
     ZJUFEtWFdJMy0yTUxTLUtaNlUtU0FWTy1FVlNIIiwKICAiTWVzc2FnZVR5cGUiOiA
     iUHJvZmlsZVVzZXIiLAogICJjdHkiOiAiYXBwbGljYXRpb24vbW1tL29iamVjdCIs
     CiAgIkNyZWF0ZWQiOiAiMjAyMC0xMS0wM1QwMTo1MDozOFoifQ"},
                 "ewogICJQcm9maWxlVXNlciI6IHsKICAgICJQcm9maWxlU2lnbm
     F0dXJlIjogewogICAgICAiVWRmIjogIk1DREgtRklQUS1YV0kzLTJNTFMtS1o2VS1



Hallam-Baker              Expires May 7, 2021                  [Page 16]

                         Mesh Schema Reference             November 2020

     TQVZPLUVWU0giLAogICAgICAiUHVibGljUGFyYW1ldGVycyI6IHsKICAgICAgICAi
     UHVibGljS2V5RUNESCI6IHsKICAgICAgICAgICJjcnYiOiAiRWQ0NDgiLAogICAgI
     CAgICAgIlB1YmxpYyI6ICJoUUxJcWdOMEtRS3V4R18tSHRHV2JQQ0l1RlJvbG9UQn
     o4c3MyWjltenh5VThQaEhsWE5zCiAgZG42d0VJNURsU1NkLXhEVFQ1RHFlLThBIn1
     9fSwKICAgICJBY2NvdW50QWRkcmVzcyI6ICJhbGljZUBleGFtcGxlLmNvbSIsCiAg
     ICAiU2VydmljZVVkZiI6ICJNRFFPLVI2NkotTVZFTy1CREw2LVY2VDctRlBJSS1VN
     DJRIiwKICAgICJBY2NvdW50RW5jcnlwdGlvbiI6IHsKICAgICAgIlVkZiI6ICJNQ1
     NNLUpSQ08tRkRTRS1IVTJYLVJaNkItVFpWTy1FVVdHIiwKICAgICAgIlB1YmxpY1B
     hcmFtZXRlcnMiOiB7CiAgICAgICAgIlB1YmxpY0tleUVDREgiOiB7CiAgICAgICAg
     ICAiY3J2IjogIlg0NDgiLAogICAgICAgICAgIlB1YmxpYyI6ICIyOG1NTV90ZEFyb
     mhsYWptckF1WEtIQndYamdkVzdOYWVhTmlWYTFCQ1JDeUJBeDF0NDlKCiAgRUlRUF
     FBcGxiZXp5YlllWkhMUHhjaVFBIn19fSwKICAgICJBZG1pbmlzdHJhdG9yU2lnbmF
     0dXJlIjogewogICAgICAiVWRmIjogIk1DREgtRklQUS1YV0kzLTJNTFMtS1o2VS1T
     QVZPLUVWU0giLAogICAgICAiUHVibGljUGFyYW1ldGVycyI6IHsKICAgICAgICAiU
     HVibGljS2V5RUNESCI6IHsKICAgICAgICAgICJjcnYiOiAiRWQ0NDgiLAogICAgIC
     AgICAgIlB1YmxpYyI6ICJoUUxJcWdOMEtRS3V4R18tSHRHV2JQQ0l1RlJvbG9UQno
     4c3MyWjltenh5VThQaEhsWE5zCiAgZG42d0VJNURsU1NkLXhEVFQ1RHFlLThBIn19
     fSwKICAgICJBY2NvdW50QXV0aGVudGljYXRpb24iOiB7CiAgICAgICJVZGYiOiAiT
     URIVi1OTDVJLUZUTkUtTUVQUC1UM0xMLUdWMlAtM1BRSyIsCiAgICAgICJQdWJsaW
     NQYXJhbWV0ZXJzIjogewogICAgICAgICJQdWJsaWNLZXlFQ0RIIjogewogICAgICA
     gICAgImNydiI6ICJYNDQ4IiwKICAgICAgICAgICJQdWJsaWMiOiAiOUttNXNQdjQt
     MkVYUDU1NDh4cmF5aXpyQXBZZVRzS3NSY0hySk8zaWdDbkw4OTB5X2lsQQogIG9qU
     mxhSi1CUFRHMzlBMFFHdE11bi04QSJ9fX0sCiAgICAiQWNjb3VudFNpZ25hdHVyZS
     I6IHsKICAgICAgIlVkZiI6ICJNQllCLTNTS0ctU0lGUi1LRUZKLUREVUktWFVSTS1
     WRzZOIiwKICAgICAgIlB1YmxpY1BhcmFtZXRlcnMiOiB7CiAgICAgICAgIlB1Ymxp
     Y0tleUVDREgiOiB7CiAgICAgICAgICAiY3J2IjogIkVkNDQ4IiwKICAgICAgICAgI
     CJQdWJsaWMiOiAiZUN1akU5SjU2Z242aC1HdkJwaERoejFxQjVQS1RTR21tamtpcU
     hGam1EcEEyN21DWmxLNAogIFBrR19taE9OX0N3NzFVWmFBaW9tamhDQSJ9fX19fQ",
                 {
                   "signatures":[{
                       "alg":"S512",
                       "kid":"MCDH-FIPQ-XWI3-2MLS-KZ6U-SAVO-EVSH",
                       "signature":"hPWd3iRqTx5tn_VAcFOl5NFiUhiSvTQ2
     Yrt3lMUaZlgEAjJvjav7zwgB6SfVt59eaBG3cAI6z_iA2mi3eDP314lD8xxbOALJp
     3r02TTvMaxxGx1R_HdneReMZYlrO12YdllyI9w14mkQDBGtY1bn4QsA"}
                     ],
                   "PayloadDigest":"j3iRsYIUPzWOAE1qN2MyfSZXb3DrEnqh
     tttoa8BgpGgZJb_A-1Nxi9Vk-wzz7kEh30HuWsfh2mYdprmNpeJDfw"}
                 ],
               "Protocols":[{
                   "Protocol":"mmm"}
                 ]}
             ],
           "Sources":[{
               "Validation":"Self",
               "EnvelopedSource":[{
                   "dig":"S512",
                   "ContentMetaData":"ewogICJNZXNzYWdlVHlwZSI6ICJDb2
     50YWN0UGVyc29uIiwKICAiY3R5IjogImFwcGxpY2F0aW9uL21tbS9vYmplY3QiLAo
     gICJDcmVhdGVkIjogIjIwMjAtMTEtMDNUMDE6NTA6MzhaIn0"},
                 "ewogICJDb250YWN0UGVyc29uIjogewogICAgIkFuY2hvcnMiOi



Hallam-Baker              Expires May 7, 2021                  [Page 17]

                         Mesh Schema Reference             November 2020

     BbewogICAgICAgICJVZGYiOiAiTUNESC1GSVBRLVhXSTMtMk1MUy1LWjZVLVNBVk8
     tRVZTSCIsCiAgICAgICAgIlZhbGlkYXRpb24iOiAiU2VsZiJ9XSwKICAgICJOZXR3
     b3JrQWRkcmVzc2VzIjogW3sKICAgICAgICAiQWRkcmVzcyI6ICJhbGljZUBleGFtc
     GxlLmNvbSIsCiAgICAgICAgIkVudmVsb3BlZFByb2ZpbGVBY2NvdW50IjogW3sKIC
     AgICAgICAgICAgIkVudmVsb3BlSUQiOiAiTUNESC1GSVBRLVhXSTMtMk1MUy1LWjZ
     VLVNBVk8tRVZTSCIsCiAgICAgICAgICAgICJkaWciOiAiUzUxMiIsCiAgICAgICAg
     ICAgICJDb250ZW50TWV0YURhdGEiOiAiZXdvZ0lDSlZibWx4ZFdWSlJDSTZJQ0pOU
     TBSSUxVWkpVRkV0V0ZkSk15MAogIHlUVXhUTFV0YU5sVXRVMEZXVHkxRlZsTklJaX
     dLSUNBaVRXVnpjMkZuWlZSNWNHVWlPaUFpVUhKdlptbHNaCiAgVlZ6WlhJaUxBb2d
     JQ0pqZEhraU9pQWlZWEJ3YkdsallYUnBiMjR2YlcxdEwyOWlhbVZqZENJc0NpQWdJ
     a04KICB5WldGMFpXUWlPaUFpTWpBeU1DMHhNUzB3TTFRd01UbzFNRG96T0ZvaWZRI
     n0sCiAgICAgICAgICAiZXdvZ0lDSlFjbTltYVd4bFZYTmxjaUk2SUhzS0lDQWdJQ0
     pRY205bWFXeAogIGxVMmxuYm1GMGRYSmxJam9nZXdvZ0lDQWdJQ0FpVldSbUlqb2d
     JazFEUkVndFJrbFFVUzFZVjBrekxUSk5UCiAgRk10UzFvMlZTMVRRVlpQTFVWV1Uw
     Z2lMQW9nSUNBZ0lDQWlVSFZpYkdsalVHRnlZVzFsZEdWeWN5STZJSHMKICBLSUNBZ
     0lDQWdJQ0FpVUhWaWJHbGpTMlY1UlVORVNDSTZJSHNLSUNBZ0lDQWdJQ0FnSUNKam
     NuWWlPaUFpUgogIFdRME5EZ2lMQW9nSUNBZ0lDQWdJQ0FnSWxCMVlteHBZeUk2SUN
     Kb1VVeEpjV2RPTUV0UlMzVjRSMTh0U0hSCiAgSFYySlFRMGwxUmxKdmJHOVVRbm80
     YzNNeVdqbHRlbmg1VlRoUWFFaHNXRTV6Q2lBZ1pHNDJkMFZKTlVSc1UKICAxTmtMW
     GhFVkZRMVJIRmxMVGhCSW4xOWZTd0tJQ0FnSUNKQlkyTnZkVzUwUVdSa2NtVnpjeU
     k2SUNKaGJHbAogIGpaVUJsZUdGdGNHeGxMbU52YlNJc0NpQWdJQ0FpVTJWeWRtbGp
     aVlZrWmlJNklDSk5SRkZQTFZJMk5rb3RUCiAgVlpGVHkxQ1JFdzJMVlkyVkRjdFJs
     QkpTUzFWTkRKUklpd0tJQ0FnSUNKQlkyTnZkVzUwUlc1amNubHdkR2wKICB2YmlJN
     klIc0tJQ0FnSUNBZ0lsVmtaaUk2SUNKTlExTk5MVXBTUTA4dFJrUlRSUzFJVlRKWU
     xWSmFOa0l0VgogIEZwV1R5MUZWVmRISWl3S0lDQWdJQ0FnSWxCMVlteHBZMUJoY21
     GdFpYUmxjbk1pT2lCN0NpQWdJQ0FnSUNBCiAgZ0lsQjFZbXhwWTB0bGVVVkRSRWdp
     T2lCN0NpQWdJQ0FnSUNBZ0lDQWlZM0oySWpvZ0lsZzBORGdpTEFvZ0kKICBDQWdJQ
     0FnSUNBZ0lsQjFZbXhwWXlJNklDSXlPRzFOVFY5MFpFRnlibWhzWVdwdGNrRjFXRX
     RJUW5kWWFtZAogIGtWemRPWVdWaFRtbFdZVEZDUTFKRGVVSkJlREYwTkRsS0NpQWd
     SVWxSVUZGQmNHeGlaWHA1WWxsbFdraE1VCiAgSGhqYVZGQkluMTlmU3dLSUNBZ0lD
     SkJaRzFwYm1semRISmhkRzl5VTJsbmJtRjBkWEpsSWpvZ2V3b2dJQ0EKICBnSUNBa
     VZXUm1Jam9nSWsxRFJFZ3RSa2xRVVMxWVYwa3pMVEpOVEZNdFMxbzJWUzFUUVZaUE
     xVVldVMGdpTAogIEFvZ0lDQWdJQ0FpVUhWaWJHbGpVR0Z5WVcxbGRHVnljeUk2SUh
     zS0lDQWdJQ0FnSUNBaVVIVmliR2xqUzJWCiAgNVJVTkVTQ0k2SUhzS0lDQWdJQ0Fn
     SUNBZ0lDSmpjbllpT2lBaVJXUTBORGdpTEFvZ0lDQWdJQ0FnSUNBZ0kKICBsQjFZb
     XhwWXlJNklDSm9VVXhKY1dkT01FdFJTM1Y0UjE4dFNIUkhWMkpRUTBsMVJsSnZiRz
     lVUW5vNGMzTQogIHlXamx0ZW5oNVZUaFFhRWhzV0U1ekNpQWdaRzQyZDBWSk5VUnN
     VMU5rTFhoRVZGUTFSSEZsTFRoQkluMTlmCiAgU3dLSUNBZ0lDSkJZMk52ZFc1MFFY
     VjBhR1Z1ZEdsallYUnBiMjRpT2lCN0NpQWdJQ0FnSUNKVlpHWWlPaUEKICBpVFVSS
     VZpMU9URFZKTFVaVVRrVXRUVVZRVUMxVU0weE1MVWRXTWxBdE0xQlJTeUlzQ2lBZ0
     lDQWdJQ0pRZAogIFdKc2FXTlFZWEpoYldWMFpYSnpJam9nZXdvZ0lDQWdJQ0FnSUN
     KUWRXSnNhV05MWlhsRlEwUklJam9nZXdvCiAgZ0lDQWdJQ0FnSUNBZ0ltTnlkaUk2
     SUNKWU5EUTRJaXdLSUNBZ0lDQWdJQ0FnSUNKUWRXSnNhV01pT2lBaU8KICBVdHROW
     E5RZGpRdE1rVllVRFUxTkRoNGNtRjVhWHB5UVhCWlpWUnpTM05TWTBoeVNrOHphV2
     REYmt3NE9UQgogIDVYMmxzUVFvZ0lHOXFVbXhoU2kxQ1VGUkhNemxCTUZGSGRFMTF
     iaTA0UVNKOWZYMHNDaUFnSUNBaVFXTmpiCiAgM1Z1ZEZOcFoyNWhkSFZ5WlNJNklI
     c0tJQ0FnSUNBZ0lsVmtaaUk2SUNKTlFsbENMVE5UUzBjdFUwbEdVaTEKICBMUlVaS
     0xVUkVWVWt0V0ZWU1RTMVdSelpPSWl3S0lDQWdJQ0FnSWxCMVlteHBZMUJoY21GdF
     pYUmxjbk1pTwogIGlCN0NpQWdJQ0FnSUNBZ0lsQjFZbXhwWTB0bGVVVkRSRWdpT2l
     CN0NpQWdJQ0FnSUNBZ0lDQWlZM0oySWpvCiAgZ0lrVmtORFE0SWl3S0lDQWdJQ0Fn
     SUNBZ0lDSlFkV0pzYVdNaU9pQWlaVU4xYWtVNVNqVTJaMjQyYUMxSGQKICBrSndhR



Hallam-Baker              Expires May 7, 2021                  [Page 18]

                         Mesh Schema Reference             November 2020

     VJvZWpGeFFqVlFTMVJUUjIxdGFtdHBjVWhHYW0xRWNFRXlOMjFEV214TE5Bb2dJRk
     JyUjE5dGFFOQogIE9YME4zTnpGVldtRkJhVzl0YW1oRFFTSjlmWDE5ZlEiLAogICA
     gICAgICAgewogICAgICAgICAgICAic2lnbmF0dXJlcyI6IFt7CiAgICAgICAgICAg
     ICAgICAiYWxnIjogIlM1MTIiLAogICAgICAgICAgICAgICAgImtpZCI6ICJNQ0RIL
     UZJUFEtWFdJMy0yTUxTLUtaNlUtU0FWTy1FVlNIIiwKICAgICAgICAgICAgICAgIC
     JzaWduYXR1cmUiOiAiaFBXZDNpUnFUeDV0bl9WQWNGT2w1TkZpVWhpU3ZUUTJZcnQ
     zbE1VYVpsZ0VBakp2agogIGF2N3p3Z0I2U2ZWdDU5ZWFCRzNjQUk2el9pQTJtaTNl
     RFAzMTRsRDh4eGJPQUxKcDNyMDJUVHZNYXh4R3gxCiAgUl9IZG5lUmVNWllsck8xM
     llkbGx5STl3MTRta1FEQkd0WTFibjRRc0EifV0sCiAgICAgICAgICAgICJQYXlsb2
     FkRGlnZXN0IjogImozaVJzWUlVUHpXT0FFMXFOMk15ZlNaWGIzRHJFbnFodHR0b2E
     4QmdwR2daSgogIGJfQS0xTnhpOVZrLXd6ejdrRWgzMEh1V3NmaDJtWWRwcm1OcGVK
     RGZ3In1dLAogICAgICAgICJQcm90b2NvbHMiOiBbewogICAgICAgICAgICAiUHJvd
     G9jb2wiOiAibW1tIn1dfV19fQ",
                 {
                   "signatures":[{
                       "alg":"S512",
                       "kid":"MBYB-3SKG-SIFR-KEFJ-DDUI-XURM-VG6N",
                       "signature":"Orf-ht-bmbAGT8TEVOWftjfx2q_h0Zfx
     _NFvD5Xu60sj7FU1W3c1MN10sSDTzHSvijTxKnzphz4AKpdaFO5FjoJ67m3nN8bz0
     lub-vfF93oTKrg3TkeXvwqY45dBROcXPsprqi9247P2W6GRvlqGRjIA"}
                     ],
                   "PayloadDigest":"Xw7Zg3PWqPsjf1Tnu1jbEaeb3Q2AhXMc
     BDWtnAh9400za0Sx9UIMJzp3Hnk0XUoCT8ETzg3nP2g3IJ89mABu0g"}
                 ]}
             ]}}}}

   The fields of the contact catalog provide a superset of the
   capabilities of vCard .

   The Contact catalog is typically used by the MeshService as a source
   of authorization information to perform access control on inbound and
   outbound message requests. For this reason, Mesh Service SHOULD be
   granted read access to the contacts catalog by providing a decryption
   entry for the service.

4.5. Credential

   The credential catalog mmm_credential contains CatalogEntryCredential
   entries which describe credentials used to access network resources.

   {
     "CatalogedCredential":{
       "Service":"ftp.example.com",
       "Username":"alice1",
       "Password":"password"}}

   Only username/password credentials are stored in the credential
   catalog. If public key credentials are to be used, these SHOULD be
   managed as an application profile allowing separate credentials to be
   created for each device.




Hallam-Baker              Expires May 7, 2021                  [Page 19]

                         Mesh Schema Reference             November 2020

4.6. Device

   The device catalog mmm_Device contains CatalogEntryDevice entries
   which describe the devices connected to the account and the
   permissions assigned to them.

   Each device connected to a Mesh Account has an associated
   CatalogEntryDevice entry that includes the activation and connection
   records for the account. These records are described in further
   detail in section  REF _Ref54628559 \r \h 0.

4.7. Network

   The network catalog contains CatalogEntryNetwork entries which
   describe network settings, IPSEC and TLS VPN configurations, etc.

   {
     "CatalogedNetwork":{
       "Service":"myWiFi",
       "Password":"securePassword"}}

4.8. Publication

   The publication catalog mmm_Publication contains
   CatalogEntryPublication entries which describe content published
   through the account.

4.9. Task

   The Task catalog mmm_Task contains CatalogEntryTask entries which
   describe tasks assigned to the user including calendar entries and to
   do lists.

   The fields of the task catalog currently reflect those offered by the
   iCalendar specification . Specification of additional fields to allow
   task triggering on geographic location and/or completion of other
   tasks is a work in progress.

   {
     "CatalogedTask":{
       "Title":"SomeItem",
       "Key":"NAZH-Z36Z-HJRC-KS5C-RVWH-XVSB-Z5A7"}}

5. Spools

   Spools are DARE Containers containing an append only list of messages
   sent or received by an account. Three spools are currently defined:







Hallam-Baker              Expires May 7, 2021                  [Page 20]

                         Mesh Schema Reference             November 2020

         Inbound

         Outbound

         Local

   Every Mesh Message has a unique message identifier. Messages created
   at the beginning of a new messaging protocol interaction are assigned
   a random message identifier. Responses to previous messages are
   assigned message identifiers formed from the message identifier to
   which they respond by means of a message digest function.

   Every Mesh Message stored in a spool is encapsulated in an envelope
   which bears a unique identifier that is formed by applying a message
   digest function to the message identifier. Each stored message has an
   associated state which is initially set to the state Initial and MAY
   be subsequently altered by one or more MessageComplete messages
   subsequently appended to the spool. The allowable message states
   depending upon the spool in question.

5.1. Outbound

   The outbound spool stores messages that are to be or have been sent
   and MessageComplete messages reporting changes to the status of the
   messages stored on the spool.

   Messages posted to the outbound spool have the state Initial, Sent,
   Received or Refused:

         Initial

         Sent

         Received

         Refused

   MessageComplete messages are only valid when posted to the spool by
   the service.

5.2. Inbound

   The inbound spool stores messages that have been received by the Mesh
   service servicing the account and MessageComplete messages reporting
   changes to the status of the messages stored on the spool.









Hallam-Baker              Expires May 7, 2021                  [Page 21]

                         Mesh Schema Reference             November 2020

   Messages posted to the outbound spool have the state Initial, Read:

         Initial

         Read

   A message previously marked as read MAY be returned to the unread
   state by marking it as being in the Initial state.

5.3. Local

   The local spool stores messages that are used for administrative
   functions. In normal circumstances, only administrator devices and
   the Mesh Service require access to the local spool.

   The local spool is used to store MessagePin messages used to notify
   administration devices that a PIN code has been registered for some
   purpose and RespondConnection messages used to inform a device of the
   result of a connection request.

   The local spool is used in a device connection operation to provide a
   device with the activation and connection records required to access
   the service as an authorized client. Servicing these requests
   requires that the service be able to access messages stored in the
   spool by envelope id.

   Messages posted to the outbound spool have the states Initial,
   Closed:

         Initial

         Closed

6. Cryptographic Operations

   The Mesh makes use of various cryptographic operations including
   threshold operations. For convenience, these are gathered here and
   specified as functions that are referenced by other parts of the
   specification.

6.1. Key Derivation from Seed

   Mesh Keys that derived from a seed value use the mechanism described
   in . Use of the keyname parameter allows multiple keys for different
   uses to be derived from a single key. Thus escrow of a single seed
   value permits recovery of all the private keys associated with the
   profile.

   The keyname parameter is a string formed by concatenating identifiers
   specifying the key type, the actor that will use the key and the key
   operation:



Hallam-Baker              Expires May 7, 2021                  [Page 22]

                         Mesh Schema Reference             November 2020


6.2. Message Response Identifier

   Every Mesh message has a unique MessageId. When encapsulated in a
   DARE Envelope, the EnvelopeId field of the envelope header is the UDF
   Content Digest of the enclosed MessageId as a string:

   public static string GetEnvelopeId(string messageID) =>
               UDF.ContentDigestOfUDF(messageID);

   When processing a Mesh message results in the creation of a response
   to the sender, the MessageId of the response is UDF Content Digest of
   the Binary Data Sequence of the original MessageId:

   static string MakeID(string udf, string content) {
       var (code, bds) = UDF.Parse(udf);
       return code switch
           {
               UdfTypeIdentifier.Digest_SHA_3_512 => 
                   UDF.ContentDigestOfDataString(
                   bds, content, cryptoAlgorithmId: 
                       CryptoAlgorithmId.SHA_3_512),
               _ => UDF.ContentDigestOfDataString(
               bds, content, cryptoAlgorithmId: 
                       CryptoAlgorithmId.SHA_2_512),
               };

   For example:

   [To be specified]

6.3. Proof of Knowledge of PIN

   Mesh Message classes that are subclasses of MessagePinValidated MAY
   be authenticated by means of a PIN. Currently two such messages are
   defined: MessageContact used in contact exchange and
   RequestConnection message used in device connection.

   The PIN codes used to authenticate MessagePinValidated messages are
   UDF Authenticator strings. The type code of the identifier specifies
   the algorithm to be used to authenticate the PIN code and the Binary
   Data Sequence value specifies the key.












Hallam-Baker              Expires May 7, 2021                  [Page 23]

                         Mesh Schema Reference             November 2020

   The inputs to the PIN proof of knowledge functions are:

         PIN: string

         Action: string

         Account: string

         ClientNonce: binary

         PayloadDigest: binary

   The following values of Action are currently defined:

   +---------------------+-------------------+-------------------+
   | Code                | Mesh Message      | Purpose           |
   +---------------------+-------------------+-------------------+
   | "MessageContact"    | MessageContact    | Contact exchange  |
   | "RequestConnection" | RequestConnection | Device connection |

   These inputs are used to derive values as follows:

   alg = UdfAlg (PIN)
   pinData = UdfBDS (PIN)
   saltedPINData = MAC (Action, pinData)
   saltedPIN = UDFPresent (Authenticator_HMAC_SHA_2_512 + saltedPINData)
   PinId = UDFPresent (MAC (Account, saltedPINData))
   witnessData = Account.ToUTF8() + ClientNonce + PayloadDigest
   witnessValue =  MAC (witnessData , saltedPINData)

   Eg.

   [To be specified]

   Where MAC(data, key) is the message authentication code algorithm
   specified by the value of alg.

   When an administrative device issues a PIN code, a Message PIN is
   appended to the local spool. This has the MessageId PinId and
   specifies the value saltedPIN in the field of that name.

   When PIN code authentication is used, a message of type
   MessagePinValidated specifies the values ClientNonce, PinWitness and
   PinId in the fields of those names.

   [To be specified]








Hallam-Baker              Expires May 7, 2021                  [Page 24]

                         Mesh Schema Reference             November 2020

6.4. EARL

   The UDF Encrypted Authenticated Resource Locator mechanism is used to
   publish data and provide means of authentication and access through a
   static identifier such as a QR code.

   This mechanism is used to allow contact exchange by means of a QR
   code printed on a business card and to connect a device to an account
   using a static identifier printed on the device in the form of a QR
   code.

   In both cases, the information is passed using the EARL format
   described in  .

6.5. Key Agreement

   All Mesh Protocol requests except for the HelloRequest and every
   response MUST be authenticated under the device key of the host or
   device making the request.

   Initial authentication is achieved by performing a Key agreement
   under the DeviceAuthentication key of each of the hosts and combining
   the result with nonce values provided by the requestor and respondent
   using a KDF function as follows:

   Two bindings are currently planned.

         DARE Envelope over HTTPS

         UDP Transport

   Once authentication has been performed, the same pair of devices MAY
   re-authenticate using the previously agreed key. To facilitate
   stateless implementation, a host specifies an opaque identifier to be
   used to identify the shared secret on subsequent uses which MAY be
   used to recover the shared secret from the opaque identifier.

   [To be specified]

6.6. Service Cryptographic Operations

   A Mesh Service acts as the counterparty for threshold operations
   allowing mitigation of the risk of compromise of an individual device
   connected to a user account or an insider threat from an individual
   member of a group account.

   When acting in this role, the Mesh service controls the use of the
   cryptographic function but does not have the ability to perform the
   action either by itself or by collaborating with other services to
   which the account has been bound in the past.




Hallam-Baker              Expires May 7, 2021                  [Page 25]

                         Mesh Schema Reference             November 2020

   Note that this approach limits rather than eliminates trust in the
   service. As with services presenting themselves as 'zero trust', a
   Mesh service becomes a trusted service after a sufficient number of
   breaches in other parts of the system have occurred. And the user
   trusts the service to provide availability of the service.

   Three service cryptographic operations are currently specified:

         Threshold Key Share

         Threshold Key Agreement

         Threshold Signature

   The implementation of the cryptographic operations described above is
   described in  and .

7. Mesh Assertions

   Mesh Assertions are signed DARE Envelopes that contain one of more
   claims. Mesh Assertions provide the basis for trust in the
   Mathematical Mesh.

   Mesh Assertions are divided into two classes. Mesh Profiles are self-
   signed assertions. Assertions that are not self-signed are called
   declarations. The only type of declaration currently defined is a
   Connection Declaration describing the connection of a device to an
   account.

7.1. Encoding

   The payload of a Mesh Assertion is a JSON encoded object that is a
   subclass of the Assertion class which defines the following fields:

         Identifier

         Updated

         NotaryToken

         Conditions

   The implementation of the NotaryToken and Conditions mechanisms is to
   be specified in  at a future date.

   Note that the implementation of Conditions differs significantly from
   that of SAML. Relying parties are required to process condition
   clauses in a SAML assertion to determine validity. Mesh Relying
   parties MAY verify the conditions clauses or rely on the
   trustworthiness of the provider.




Hallam-Baker              Expires May 7, 2021                  [Page 26]

                         Mesh Schema Reference             November 2020

   The reason for weakening the processing of conditions clauses in the
   Mesh is that it is only ever possible to validate a conditions clause
   of any type relative to a ground truth. In SAML applications, the
   relying party almost invariably has access to an independent source
   of ground truth. A Mesh device connected to a Mesh Service does not.
   Thus the types of verification that can be achieved in practice are
   limited to verifying the consistency of current and previous
   statements from the Mesh Service.

7.2. Mesh Profiles

   Mesh Profiles perform a similar role to X.509v3 certificates but with
   important differences:

         *  Profiles describe credentials, they do not make identity
            statements

         *  Profiles do not expire, there is therefore no need to
            support renewal processing.

         *  Profiles may be modified over time, the current and past
            status of a profile being recorded in an append only log.

   Profiles provide the axioms of trust for the Mesh PKI. Unlike in the
   PKIX model in which all trust flows from axioms of trust held by a
   small number of Certificate Authorities, every part in the Mesh
   contributes their own axiom of trust.

   It should be noted however that the role of Certificate Authorities
   is redefined rather than eliminated. Rather than making assertions
   whose subject is represented by identities which are inherently
   mutable and subjective, Certificate Authorities can now make
   assertions about immutable cryptographic keys.

   Every Profile MUST contain a SignatureKey field and MUST be signed by
   the key specified in that field.

   A Profile is valid if and only if:

         *  There is a SignatureKey field.

         *  The profile is signed under the key specified in the
            SignatureKey field.

   A profile has the status current if and only if:

         *  The Profile is valid

         *  Every Conditions clause in the profile is understood by the
            relying party and evaluates to true.




Hallam-Baker              Expires May 7, 2021                  [Page 27]

                         Mesh Schema Reference             November 2020

7.3. Mesh Connections

   A Mesh connection is an assertion describing the connection of a
   device or a member to an account.

   Mesh connections provide similar functionality to 'end-entity'
   certificates in PKIX but with the important proviso that they are
   only used to provide trust between a device connected to an account
   and the service to which that account is bound and between the
   devices connected to an account.

   A connection is valid with respect to an account with profile P if
   and only if:

         *  The profile P is valid

         *  The AuthorityUdf field of the connection is consistent with
            the UDF of P

         *  The profile is signed under the key specified in the
            AdministrationKey field of P.

         *  Any conditions specified in the profile are met

   A connection has the status current with respect to an account with
   profile if and only if:

         *  The connection is valid with respect to the account with
            profile P.

         *  The profile P is current.

   A device is authenticated with respect to an account with profile P
   if and only if:

         *  The connection is valid with respect to the account with
            profile P.

         *  The device has presented an appropriate proof of knowledge
            of the DeviceAuthentication key specified in the connection.

8. Architecture

   $$$$$$$$$$$ This has plenty or areas that need to be upgraded to the
   single master/account approach.









Hallam-Baker              Expires May 7, 2021                  [Page 28]

                         Mesh Schema Reference             November 2020

   The Mesh architecture has four principal components:

         Mesh Device Management

         Mesh Account

         Mesh Service

         Mesh Messaging

   Device management and Accounts components are defined by a data
   schema alone. The Service and Messaging components are defined by a
   data schema and a service protocol.

   The separation of accounts and services as separate components is a
   key distinction between the Mesh and earlier Internet applications. A
   Mesh account belongs to the owner of the Mesh and not the Mesh
   Service Provider which the user may change at any time of their
   choosing.

   A Mesh Account May be active or inactive. By definition, an active
   Mesh account is serviced by exactly one Mesh Service, an inactive
   Mesh account is not serviced by a Mesh Service. A Mesh Service
   Provider MAY offer a backup service for accounts hosted by other
   providers. In this case the backup provider is connected to the
   account as a Mesh device, thus allowing the backup provider to
   maintain a copy of the stores contained in the account and
   facilitating a rapid transfer of responsibility for servicing the
   account should that be desired. The use of backup providers is
   described further in .

8.1. Device Management

   Device Management provides the foundation for all Mesh functions
   allowing a collection of devices belonging to a user to function as a
   single personal Mesh.

   The device management layer of a personal Mesh consists of exactly
   one Master Profile and a catalog containing the entries describing
   the connected devices.

8.1.1. Master Profile

   A Mesh master profile provides the axiom of trust for a mesh user. It
   contains a Master Signature Key and one or more Administration
   Signature Keys. The unique identifier of the master profile is the
   UDF of the Master Signature Key.

   A Master Profile MUST specify an EscrowEncryption key. This key MAY
   be used to escrow private keys used for encryption of stored data.
   They SHOULD NOT be used to escrow authentication keys and MUST NOT be



Hallam-Baker              Expires May 7, 2021                  [Page 29]

                         Mesh Schema Reference             November 2020

   used to escrow signature keys.

   A user should not need to replace their account profile unless they
   intend to establish a separate identity. To minimize the risk of
   disclosure, the Profile Signature Key is only ever used to sign
   updates to the account profile itself. This allows the user to secure
   their Profile Signature Key by either keeping it on hardware token or
   device dedicated to that purpose or by using the escrow mechanism and
   paper recovery keys as described in this document.

8.1.1.1. Creating a ProfileMaster

   Creating a ProfileMaster comprises the steps of:

         0) Creating a Master Signature key.

         0) Creating an Online Signing Key

         0) Signing the ProfileMaster using the Master Signature Key

         0) Persisting the ProfileMaster on the administration device to
            the CatalogHost.

         0) (Optional) Connecting at least one Administration Device and
            granting it the ActivationAdministration activation.

8.1.1.2. Updating a ProfileMaster

   Updating a ProfileMaster comprises the steps of:

         0) Making the necessary changes.

         0) Signing the ProfileMaster using the Master Signature Key

         0) Persisting the ProfileMaster on the administration device to
            the CatalogHost.

8.1.1.3. The Device Catalog

   Each personal Mesh has a Device Catalog CatalogDevice associated with
   it. The Device Catalog is used to manage the connection of devices to
   the Personal Mesh and has a CatalogEntryDevice for each device
   currently connected to the catalog.

   Each Administration Device MUST have access to an up to date copy of
   the Device Catalog in order to manage the devices connected to the
   Mesh. The Mesh Service protocol MAY be used to synchronize the Device
   Catalog between administration devices in the case that there is more
   than one administration device.





Hallam-Baker              Expires May 7, 2021                  [Page 30]

                         Mesh Schema Reference             November 2020

   The CatalogEntryDevice contains fields for the device profile, device
   private and device connection.

8.1.2. Mesh Devices

   The principle of radical distrust requires us to consider the
   possibility that a device might be compromised during manufacture.
   Once consequence of this possibility is that when an administration
   device connects a new device to a user's personal Mesh, we cannot put
   our full trust in either the device being connected or the
   administration device connecting it.

   This concern is resolved by (at minimum) combining keying material
   generated from both sources to create the keys to be used in the
   context of the user's personal Mesh with the process being fully
   verified by both parties.

   Additional keying material sources could be added if protection
   against the possibility of compromise at both devices was required
   but this is not supported by the current specifications.

   A device profile provides the axiom of trust and the key
   contributions of the device. When bound to an account, the base keys
   specified in the Device Profile are combined with the key data
   provided in the Activation device to construct the keys the device
   will use in the context of the account.

   Unless exceptional circumstances require, a device should not require
   more than one Device profile even if the device supports use by
   multiple users under different accounts. But a device MAY have
   multiple profiles if this approach is more convenient for
   implementation.

   The derivation of the Connection encryption and signature keys from
   the Profile and Private contributions in this example is shown in .

8.1.2.1. Creating a ProfileDevice

   Creating a ProfileDevice comprises the steps of:

         0) Creating the necessary key

         0) Signing the ProfileDevice using the Master Signature Key

         0) Once created, a ProfileDevice is never changed. In the
            unlikely event that any modification is required, a
            completely new ProfileDevice MUST be created.







Hallam-Baker              Expires May 7, 2021                  [Page 31]

                         Mesh Schema Reference             November 2020

8.1.2.2. Connection to a Personal Mesh

   Devices are only connected to a personal Mesh by administration
   device. This comprises the steps of:

         0) Generating the PrivateDevice keys.

         0) Creating the ConnectionDevice data from the public
            components of the ProfileDevice and PrivateDevice keys and
            signing it using the administration key.

         0) Creating the Activations for the device and signing them
            using the administration key.

         0) Creating the CatalogEntryDevice for the device and adding it
            to the CatalogDevice of the Personal Mesh.

         0) If the Personal Mesh has accounts that are connected to a
            Mesh Service, synchronizing the CatalogEntryDevice to those
            services.

8.2. Mesh Accounts

   Mesh Accounts contains all the stateful information (contacts,
   calendar entries, inbound and outbound messages, etc.) related to a
   particular persona used by the owner.

   A Mesh Profile MAY be connected to multiple accounts at the same time
   allowing the user to maintain separate personas for separate
   purposes.

   Unlike traditional Internet application accounts, Mesh accounts are
   created by and belong to the user, not the Mesh Service provider. A
   user MAY change their Mesh Service provider at any time and
   disconnect the profile from all Mesh Services (e.g. to archive the
   account).

   Alice's personal account is connected to two Mesh services:

   The account profile specifies the online and offline signature keys
   used to maintain the profile and the encryption key to be used by the
   account.

   Each device connected to the account requires an activation record.
   This specifies the  key contribtions added to the manufacturer device
   profile keys:








Hallam-Baker              Expires May 7, 2021                  [Page 32]

                         Mesh Schema Reference             November 2020

   The resulting key set is specified in the device connection:

   All the above plus the ProfileDevice are combined to form the
   CatalogedDevice entry:

8.2.1. Creating a ProfileAccount

   Creating a ProfileAccount comprises the steps of:

         0) [TBS]

         0) .

         0) Signing the ProfileMaster using the Master Signature Key

8.2.2. Connecting a Device to an Account

   Adding a device to an account comprises the steps of:

         0) Creating a PrivateAccount instance for the device.

         0) Creating a ConnectionAccountDevice for the device using the
            public keys from the PrivateAccount instance and the
            ProfileDevice.

         0) Creating an ActivationAccount for the device containing the
            PrivateAccount and ConnectionAccountDevice instances.

         0) Adding the ActivationAccount to the CatalogEntryDevice of
            the device.

         0) If the Personal Mesh has accounts that are connected to a
            Mesh Service, synchronizing the CatalogEntryDevice to those
            services.

8.2.3. Binding and Account to a Service

   Binding a ProfileAccount to a Mesh Service the steps of:

         0) [TBS]

         0) .

         0) Signing the ProfileMaster using the Master Signature Key

8.3. Mesh Services

   A service profile provides the axiom of trust and cryptographic keys
   for a Mesh Service. A Mesh Service Host SHOULD return a copy of its
   ProfileHost and the parent ProfileService in response to a Hello
   transaction request.



Hallam-Baker              Expires May 7, 2021                  [Page 33]

                         Mesh Schema Reference             November 2020


   The credentials provided by the ProfileService and ProfileHost are
   distinct from those provided by the WebPKI that typically services
   TLS requests. WebPKI credentials provide service introduction and
   authentication while a Mesh ProfileHost only provides authentication.

   Unless exceptional circumstances require, a service should not need
   to revise its Service Profile unless it is intended to change its
   identity. Service Profiles MAY be countersigned by Trusted Third
   Parties to establish accountability.

   The service profile

   The host also has a profile

   And there should be a connection of the host to the service but this
   isn't implemented yet:

8.3.1. Creating a ProfileService

   [TBS]

   Creating a ProfileService comprises the steps of:

         0) [TBS]

         0) .

         0) [TBS]

         0)

         0) Signing the ProfileMaster using the Master Signature Key

8.3.2. Creating a ProfileHost

   Creating a ProfileHost comprises the steps of:

         0) [TBS]

         0) .

         0) [TBS]

         0)

         0) Signing the ConnectionHost using the Master Signature Key of
            the ProfileService.






Hallam-Baker              Expires May 7, 2021                  [Page 34]

                         Mesh Schema Reference             November 2020

8.3.3. Creating a ConnectionHost

   Creating a ConnectionHost comprises the steps of:

         0) [TBS]

         0) .

         0) Signing the ConnectionHost using the Master Signature Key of
            the ProfileService.

8.4. Mesh Messaging

   Mesh Messaging is an end-to-end secure messaging system used to
   exchange short (32KB) messages between Mesh devices and services. In
   cases where exchange of longer messages is required, Mesh Messaging
   MAY be used to provide a control plane to advise the intended message
   recipient(s) of the type of data being offered and the means of
   retrieval (e.g an EARL).

   A four-corner messaging model is enforced. Mesh Services only accept
   outbound messages from devices connected to accounts that it
   services. Inbound messages are only accepted from other Mesh
   Services. This model enables access control at both the outbound and
   inbound services

   The outbound Mesh Service checks to see that the request to send a
   message does not violate its acceptable use policy. Accounts that
   make a large number of message requests that result in complaints
   SHOULD be subject to consequences ranging from restriction of the
   number and type of messages sent to suspending or terminating
   messaging privileges. Services that fail to implement appropriate
   controls are likely to be subject to sanctions from either their
   users or from other services.

   The inbound Mesh Service also checks to see that messages received
   are consistent with the service Acceptable Use Policy and the user's
   personal access control settings.

   Mesh Services that fail to police abuse by their account holders
   SHOULD be subject to consequences in the same fashion as account
   holders.

8.4.1. Traffic Analysis

   The Mesh Messaging protocol as currently specified provides only
   limited protection against traffic analysis attacks. The use of TLS
   to encrypt communication between Mesh Services limits the
   effectiveness of na?ve traffic analysis mechanisms but does not
   prevent timing attacks unless dummy traffic is introduced to
   obfuscate traffic flows.



Hallam-Baker              Expires May 7, 2021                  [Page 35]

                         Mesh Schema Reference             November 2020


   The limitation of the message size is in part intended to facilitate
   use of mechanisms capable of providing high levels of traffic
   analysis such as mixmaster and onion routing but the current Mesh
   Service Protocol does not provide support for such approaches and
   there are no immediate plans to do so.

9. Mesh Messages

   All communications between Mesh accounts takes the form of a Mesh
   Message carried in a Dare Envelope. Mesh Messages are stored in two
   spools associated with the account, the SpoolOutbound and the
   SpoolInbound containing the messages sent and received respectively.

   This document only describes the representation of the messages
   within the message spool. The Mesh Service protocol by which the
   messages are exchanged between devices and services and between
   services is described in .

9.1. PIN

   One-time use 'PIN' codes are used to provide a means of out of band
   authentication in many Mesh Message applications. In particular the
   device connection and contact exchange message flows.

   For example, when Alice reads the connection request from the device
   in the architecture  examples, a completion message is added to
   Alice's inbound spool so that the device is not  activated a second
   time by mistake:

   {
     "MessagePin":{
       "MessageId":"ADPN-NW2M-7FVD-EN7C-FDA7-GB35-TMYZ",
       "Account":"alice@example.com",
       "Expires":"2020-11-04T01:50:44Z",
       "Automatic":true,
       "SaltedPin":"AAVT-FNF3-WCPJ-YLSC-ORUV-XNXJ-AEVJ",
       "Action":"Device"}}

   The details of the presentation and verification of the PIN code are
   further described in the section below.

9.2. Completion

   Completion messages are dummy messages that are added to a Mesh Spool
   to change the status of messages previously posted. Any message that
   is in the inbound spool and has not been erased or redacted MAY be
   marked as read, unread or deleted. Any message in the outbound spool
   MAY be marked as sent, received or deleted.





Hallam-Baker              Expires May 7, 2021                  [Page 36]

                         Mesh Schema Reference             November 2020

   Services MAY erase or redact messages in accordance with local site
   policy. Since messages are not removed from the spool on being marked
   deleted, they may be undeleted by marking them as read or unread.
   Marking a message deleted MAY make it more likely that the Service
   will purge the message however.

   Having processed a message, a completion message is added to the
   spool so that other devices  can see that it has been read.

   For example, when Alice's administration device uses the PIN
   registered above to  authenticate a device connection request, a
   completion message is added to Alice's  inbound spool so that the PIN
   cannot be reused to authenticate a second device:

   Missing example 90

9.3. Connection

   Connection requests are sent by a device requesting connection to a
   Mesh Service Account.

   The MessageConnectionRequest is originally sent by the device
   requesting connection to the Mesh Service associated with the
   account.

   If the connection request is accepted by the Mesh Service, it creates
   a MessageConnectionResponse containing the ServerNonce and Witness
   values used in the authentication of the response together with a
   verbatim copy of the original request. The MessageConnectionResponse
   is then returned to the device that made the original request and
   placed on the SpoolInbound of the account to which the request was
   directed.

   Further details of this mechanism are described in .

   Alice connects a watch to her account. Since the watch has a camera
   (to allow for  video calls) she can use the dynamic QR code
   connection mechanism.

   The watch reads the QR code generated on Alice's watch. This contains
   the device connection URI.

   QR = {Connect.ConnectQRURI}

   The URI tells the device the Mesh account to connect to and the PIN
   Code to be used to authenticate the request. The device requesting
   the connection adds its Profile device to create a RequestConnection
   message that will be presented to the service as a Connect
   transaction request.





Hallam-Baker              Expires May 7, 2021                  [Page 37]

                         Mesh Schema Reference             November 2020

   {
     "RequestConnection":{
       "MessageId":"NBJG-EOWT-BS2Z-RVSI-7C3N-CTDB-ACVI",
       "AuthenticatedData":[{
           "EnvelopeID":"MDGU-U5T6-5SRZ-3S6H-KV5K-FQVE-SRBJ",
           "dig":"S512",
           "ContentMetaData":"ewogICJVbmlxdWVJRCI6ICJNREdVLVU1VDYtNV
     NSWi0zUzZILUtWNUstRlFWRS1TUkJKIiwKICAiTWVzc2FnZVR5cGUiOiAiUHJvZml
     sZURldmljZSIsCiAgImN0eSI6ICJhcHBsaWNhdGlvbi9tbW0vb2JqZWN0IiwKICAi
     Q3JlYXRlZCI6ICIyMDIwLTExLTAzVDAxOjUwOjQ1WiJ9"},
         "ewogICJQcm9maWxlRGV2aWNlIjogewogICAgIlByb2ZpbGVTaWduYXR1cm
     UiOiB7CiAgICAgICJVZGYiOiAiTURHVS1VNVQ2LTVTUlotM1M2SC1LVjVLLUZRVkU
     tU1JCSiIsCiAgICAgICJQdWJsaWNQYXJhbWV0ZXJzIjogewogICAgICAgICJQdWJs
     aWNLZXlFQ0RIIjogewogICAgICAgICAgImNydiI6ICJFZDQ0OCIsCiAgICAgICAgI
     CAiUHVibGljIjogImdLTGU3MkhLUWYxSlhRTmE3SVJ6SEZLQVZJT3RpZDhTM2RaNU
     FMTjF3eHdjWElaWmtQSGsKICBLZVZGZ0xfYVRONXd0U3c4MEdwVGRZNkEifX19LAo
     gICAgIkJhc2VFbmNyeXB0aW9uIjogewogICAgICAiVWRmIjogIk1EVVItSFkyNS1W
     S1VZLUdEWEEtSkVKMy1FTjZNLUZFREwiLAogICAgICAiUHVibGljUGFyYW1ldGVyc
     yI6IHsKICAgICAgICAiUHVibGljS2V5RUNESCI6IHsKICAgICAgICAgICJjcnYiOi
     AiWDQ0OCIsCiAgICAgICAgICAiUHVibGljIjogIkJyWTRGd2ZkTDluemk2cDMteTZ
     ubjlhT0dPOXczMWNYZzBNU0VUeG1fNF92ZWpEOFhxMGgKICBCVERPajhIWmVOdElT
     X3FZVDFYUy1ZZ0EifX19LAogICAgIkJhc2VBdXRoZW50aWNhdGlvbiI6IHsKICAgI
     CAgIlVkZiI6ICJNRFhCLU9MUFQtRFZFSy1PQldKLVlLWTMtVjcyVC1FQTVKIiwKIC
     AgICAgIlB1YmxpY1BhcmFtZXRlcnMiOiB7CiAgICAgICAgIlB1YmxpY0tleUVDREg
     iOiB7CiAgICAgICAgICAiY3J2IjogIlg0NDgiLAogICAgICAgICAgIlB1YmxpYyI6
     ICJHZlpGMVZ0NjVNMENuWHc1aTNKbzVmMmc5djJSRzVKaGFUSFVxeGxNTE1MZzF5Y
     nFLYzVzCiAgUUd1RnBfal9kRXpyWlZDVVdwaUdSMS1BIn19fSwKICAgICJCYXNlU2
     lnbmF0dXJlIjogewogICAgICAiVWRmIjogIk1BRkYtTjNHVy1FUkNVLUNINVctVlF
     PTS03QVNBLUZEQ0oiLAogICAgICAiUHVibGljUGFyYW1ldGVycyI6IHsKICAgICAg
     ICAiUHVibGljS2V5RUNESCI6IHsKICAgICAgICAgICJjcnYiOiAiRWQ0NDgiLAogI
     CAgICAgICAgIlB1YmxpYyI6ICJveTRDRjBERUJsaFZhakhLZXd6VVN0eWlTdzExeX
     BodXQ4bjBYdEFaUWpwVUhOdDUtNWJhCiAgRFpwejhPMWtBWHdCMHBvaEhYcDFENHl
     BIn19fX19",
         {
           "signatures":[{
               "alg":"S512",
               "kid":"MDGU-U5T6-5SRZ-3S6H-KV5K-FQVE-SRBJ",
               "signature":"wAwYBP7IuNh82p9uKRJipvdZGxWflNeIx2SYxwes
     fNvIQ7dVHzyFf9rvyyIALZsp6fVzaXSwqqiA6RQeWQIAMOhSy2Znh1K5c-qATSAJj
     rukejmhXmeKcOCHKUnt2yIrxAoEclTf0HzxfiNbSeoOzj4A"}
             ],
           "PayloadDigest":"2SWl6GfRY2649Q7jtEYkgRRZlUpR-lPA7rcl-qr6
     9EWu6stHguJeD0rMNjE76rCCp5fzSYDi5AZBwKTjYq_4rA"}
         ],
       "ClientNonce":"AU_wpUkuSo_bilgcAJ7Cqw",
       "PinId":"ADPN-NW2M-7FVD-EN7C-FDA7-GB35-TMYZ",
       "PinWitness":"4tqsy27PFNSIqsvti8RHq0INDXLz9adRxIiiYgb0uwtvqoY
     ac4UZhv2lNkO8f0A7XTLVaeRpY-74c2luSywFLQ",
       "AccountAddress":"alice@example.com"}}

   The service generates an AcknowledgeConnection message which is



Hallam-Baker              Expires May 7, 2021                  [Page 38]

                         Mesh Schema Reference             November 2020
   returned to the device requesting the connection (via the Connect
   transaction response) and adds it to the inbound spool of the account
   for Alice's approval (or not).

   {
     "AcknowledgeConnection":{
       "MessageId":"2OAQ-RZZ5-P3BL-DAGR-7XKG-P3YQ-MBZQ",
       "EnvelopedRequestConnection":[{
           "EnvelopeID":"MASN-S6XP-2RIN-IIJA-EBON-ZJVN-3TML",
           "ContentMetaData":"ewogICJVbmlxdWVJRCI6ICJOQkpHLUVPV1QtQl
     MyWi1SVlNJLTdDM04tQ1REQi1BQ1ZJIiwKICAiTWVzc2FnZVR5cGUiOiAiUmVxdWV
     zdENvbm5lY3Rpb24iLAogICJjdHkiOiAiYXBwbGljYXRpb24vbW1tL29iamVjdCIs
     CiAgIkNyZWF0ZWQiOiAiMjAyMC0xMS0wM1QwMTo1MDo0NVoifQ"},
         "ewogICJSZXF1ZXN0Q29ubmVjdGlvbiI6IHsKICAgICJNZXNzYWdlSWQiOi
     AiTkJKRy1FT1dULUJTMlotUlZTSS03QzNOLUNUREItQUNWSSIsCiAgICAiQXV0aGV
     udGljYXRlZERhdGEiOiBbewogICAgICAgICJFbnZlbG9wZUlEIjogIk1ER1UtVTVU
     Ni01U1JaLTNTNkgtS1Y1Sy1GUVZFLVNSQkoiLAogICAgICAgICJkaWciOiAiUzUxM
     iIsCiAgICAgICAgIkNvbnRlbnRNZXRhRGF0YSI6ICJld29nSUNKVmJtbHhkV1ZKUk
     NJNklDSk5SRWRWTFZVMVZEWXROVk5TV2kwCiAgelV6WklMVXRXTlVzdFJsRldSUzF
     UVWtKS0lpd0tJQ0FpVFdWemMyRm5aVlI1Y0dVaU9pQWlVSEp2Wm1sc1oKICBVUmxk
     bWxqWlNJc0NpQWdJbU4wZVNJNklDSmhjSEJzYVdOaGRHbHZiaTl0YlcwdmIySnFaV
     04wSWl3S0lDQQogIGlRM0psWVhSbFpDSTZJQ0l5TURJd0xURXhMVEF6VkRBeE9qVX
     dPalExV2lKOSJ9LAogICAgICAiZXdvZ0lDSlFjbTltYVd4bFJHVjJhV05sSWpvZ2V
     3b2dJQ0FnSWxCeWIyWgogIHBiR1ZUYVdkdVlYUjFjbVVpT2lCN0NpQWdJQ0FnSUNK
     VlpHWWlPaUFpVFVSSFZTMVZOVlEyTFRWVFVsb3RNCiAgMU0yU0MxTFZqVkxMVVpSV
     mtVdFUxSkNTaUlzQ2lBZ0lDQWdJQ0pRZFdKc2FXTlFZWEpoYldWMFpYSnpJam8KIC
     BnZXdvZ0lDQWdJQ0FnSUNKUWRXSnNhV05MWlhsRlEwUklJam9nZXdvZ0lDQWdJQ0F
     nSUNBZ0ltTnlkaUk2SQogIENKRlpEUTBPQ0lzQ2lBZ0lDQWdJQ0FnSUNBaVVIVmli
     R2xqSWpvZ0ltZExUR1UzTWtoTFVXWXhTbGhSVG1FCiAgM1NWSjZTRVpMUVZaSlQzU
     nBaRGhUTTJSYU5VRk1UakYzZUhkaldFbGFXbXRRU0dzS0lDQkxaVlpHWjB4ZlkKIC
     BWUk9OWGQwVTNjNE1FZHdWR1JaTmtFaWZYMTlMQW9nSUNBZ0lrSmhjMlZGYm1OeWV
     YQjBhVzl1SWpvZ2V3bwogIGdJQ0FnSUNBaVZXUm1Jam9nSWsxRVZWSXRTRmt5TlMx
     V1MxVlpMVWRFV0VFdFNrVktNeTFGVGpaTkxVWkZSCiAgRXdpTEFvZ0lDQWdJQ0FpV
     UhWaWJHbGpVR0Z5WVcxbGRHVnljeUk2SUhzS0lDQWdJQ0FnSUNBaVVIVmliR2wKIC
     BqUzJWNVJVTkVTQ0k2SUhzS0lDQWdJQ0FnSUNBZ0lDSmpjbllpT2lBaVdEUTBPQ0l
     zQ2lBZ0lDQWdJQ0FnSQogIENBaVVIVmliR2xqSWpvZ0lrSnlXVFJHZDJaa1REbHVl
     bWsyY0RNdGVUWnViamxoVDBkUE9YY3pNV05ZWnpCCiAgTlUwVlVlRzFmTkY5MlpXc
     EVPRmh4TUdnS0lDQkNWRVJQYWpoSVdtVk9kRWxUWDNGWlZERllVeTFaWjBFaWYKIC
     BYMTlMQW9nSUNBZ0lrSmhjMlZCZFhSb1pXNTBhV05oZEdsdmJpSTZJSHNLSUNBZ0l
     DQWdJbFZrWmlJNklDSgogIE5SRmhDTFU5TVVGUXRSRlpGU3kxUFFsZEtMVmxMV1RN
     dFZqY3lWQzFGUVRWS0lpd0tJQ0FnSUNBZ0lsQjFZCiAgbXhwWTFCaGNtRnRaWFJsY
     25NaU9pQjdDaUFnSUNBZ0lDQWdJbEIxWW14cFkwdGxlVVZEUkVnaU9pQjdDaUEKIC
     BnSUNBZ0lDQWdJQ0FpWTNKMklqb2dJbGcwTkRnaUxBb2dJQ0FnSUNBZ0lDQWdJbEI
     xWW14cFl5STZJQ0pIWgogIGxwR01WWjBOalZOTUVOdVdIYzFhVE5LYnpWbU1tYzVk
     akpTUnpWS2FHRlVTRlZ4ZUd4TlRFMU1aekY1WW5GCiAgTFl6VnpDaUFnVVVkMVJuQ
     mZhbDlrUlhweVdsWkRWVmR3YVVkU01TMUJJbjE5ZlN3S0lDQWdJQ0pDWVhObFUKIC
     AybG5ibUYwZFhKbElqb2dld29nSUNBZ0lDQWlWV1JtSWpvZ0lrMUJSa1l0VGpOSFZ
     5MUZVa05WTFVOSU5WYwogIHRWbEZQVFMwM1FWTkJMVVpFUTBvaUxBb2dJQ0FnSUNB
     aVVIVmliR2xqVUdGeVlXMWxkR1Z5Y3lJNklIc0tJCiAgQ0FnSUNBZ0lDQWlVSFZpY
     kdsalMyVjVSVU5FU0NJNklIc0tJQ0FnSUNBZ0lDQWdJQ0pqY25ZaU9pQWlSV1EKIC
     AwTkRnaUxBb2dJQ0FnSUNBZ0lDQWdJbEIxWW14cFl5STZJQ0p2ZVRSRFJqQkVSVUp
     zYUZaaGFraExaWGQ2VgogIFZOMGVXbFRkekV4ZVhCb2RYUTRiakJZZEVGYVVXcHdW



Hallam-Baker              Expires May 7, 2021                  [Page 39]

                         Mesh Schema Reference             November 2020

     VWhPZERVdE5XSmhDaUFnUkZwd2VqaFBNV3RCV0hkCiAgQ01IQnZhRWhZY0RGRU5Ib
     EJJbjE5ZlgxOSIsCiAgICAgIHsKICAgICAgICAic2lnbmF0dXJlcyI6IFt7CiAgIC
     AgICAgICAgICJhbGciOiAiUzUxMiIsCiAgICAgICAgICAgICJraWQiOiAiTURHVS1
     VNVQ2LTVTUlotM1M2SC1LVjVLLUZRVkUtU1JCSiIsCiAgICAgICAgICAgICJzaWdu
     YXR1cmUiOiAid0F3WUJQN0l1Tmg4MnA5dUtSSmlwdmRaR3hXZmxOZUl4MlNZeHdlc
     2ZOdklRN2RWSAogIHp5RmY5cnZ5eUlBTFpzcDZmVnphWFN3cXFpQTZSUWVXUUlBTU
     9oU3kyWm5oMUs1Yy1xQVRTQUpqcnVrZWptCiAgaFhtZUtjT0NIS1VudDJ5SXJ4QW9
     FY2xUZjBIenhmaU5iU2VvT3pqNEEifV0sCiAgICAgICAgIlBheWxvYWREaWdlc3Qi
     OiAiMlNXbDZHZlJZMjY0OVE3anRFWWtnUlJabFVwUi1sUEE3cmNsLXFyNjlFV3U2C
     iAgc3RIZ3VKZUQwck1OakU3NnJDQ3A1ZnpTWURpNUFaQndLVGpZcV80ckEifV0sCi
     AgICAiQ2xpZW50Tm9uY2UiOiAiQVVfd3BVa3VTb19iaWxnY0FKN0NxdyIsCiAgICA
     iUGluSWQiOiAiQURQTi1OVzJNLTdGVkQtRU43Qy1GREE3LUdCMzUtVE1ZWiIsCiAg
     ICAiUGluV2l0bmVzcyI6ICI0dHFzeTI3UEZOU0lxc3Z0aThSSHEwSU5EWEx6OWFkU
     nhJaWlZZ2IwdXd0dnFvWWEKICBjNFVaaHYybE5rTzhmMEE3WFRMVmFlUnBZLTc0Yz
     JsdVN5d0ZMUSIsCiAgICAiQWNjb3VudEFkZHJlc3MiOiAiYWxpY2VAZXhhbXBsZS5
     jb20ifX0"
         ],
       "ServerNonce":"8CS217pvOW72A3jMg71BKQ",
       "Witness":"2OAQ-RZZ5-P3BL-DAGR-7XKG-P3YQ-MBZQ"}}

   Alice's administration device synchronizes to the service and
   receives the connection request acknowledgement from the service.
   Since the request is  authenticated by a PIN code that has been
   marked for automatic execution, the service can generate the
   assertions the device to participate in the account and appends the
   corresponding RespondConnection message to the local delivery  spool.

   {
     "RespondConnection":{
       "MessageId":"MAHM-UAAV-Q3YT-DXZA-LTMO-IAXO-BBFH",
       "Result":"Accept",
       "CatalogedDevice":{
         "Udf":"MD2A-K4C3-SUNV-NQMW-4TPI-WPMV-B333",
         "DeviceUdf":"MDGU-U5T6-5SRZ-3S6H-KV5K-FQVE-SRBJ",
         "EnvelopedProfileUser":[{
             "EnvelopeID":"MCDH-FIPQ-XWI3-2MLS-KZ6U-SAVO-EVSH",
             "dig":"S512",
             "ContentMetaData":"ewogICJVbmlxdWVJRCI6ICJNQ0RILUZJUFEt
     WFdJMy0yTUxTLUtaNlUtU0FWTy1FVlNIIiwKICAiTWVzc2FnZVR5cGUiOiAiUHJvZ
     mlsZVVzZXIiLAogICJjdHkiOiAiYXBwbGljYXRpb24vbW1tL29iamVjdCIsCiAgIk
     NyZWF0ZWQiOiAiMjAyMC0xMS0wM1QwMTo1MDozOFoifQ"},
           "ewogICJQcm9maWxlVXNlciI6IHsKICAgICJQcm9maWxlU2lnbmF0dXJl
     IjogewogICAgICAiVWRmIjogIk1DREgtRklQUS1YV0kzLTJNTFMtS1o2VS1TQVZPL
     UVWU0giLAogICAgICAiUHVibGljUGFyYW1ldGVycyI6IHsKICAgICAgICAiUHVibG
     ljS2V5RUNESCI6IHsKICAgICAgICAgICJjcnYiOiAiRWQ0NDgiLAogICAgICAgICA
     gIlB1YmxpYyI6ICJoUUxJcWdOMEtRS3V4R18tSHRHV2JQQ0l1RlJvbG9UQno4c3My
     Wjltenh5VThQaEhsWE5zCiAgZG42d0VJNURsU1NkLXhEVFQ1RHFlLThBIn19fSwKI
     CAgICJBY2NvdW50QWRkcmVzcyI6ICJhbGljZUBleGFtcGxlLmNvbSIsCiAgICAiU2
     VydmljZVVkZiI6ICJNRFFPLVI2NkotTVZFTy1CREw2LVY2VDctRlBJSS1VNDJRIiw
     KICAgICJBY2NvdW50RW5jcnlwdGlvbiI6IHsKICAgICAgIlVkZiI6ICJNQ1NNLUpS
     Q08tRkRTRS1IVTJYLVJaNkItVFpWTy1FVVdHIiwKICAgICAgIlB1YmxpY1BhcmFtZ



Hallam-Baker              Expires May 7, 2021                  [Page 40]

                         Mesh Schema Reference             November 2020

     XRlcnMiOiB7CiAgICAgICAgIlB1YmxpY0tleUVDREgiOiB7CiAgICAgICAgICAiY3
     J2IjogIlg0NDgiLAogICAgICAgICAgIlB1YmxpYyI6ICIyOG1NTV90ZEFybmhsYWp
     tckF1WEtIQndYamdkVzdOYWVhTmlWYTFCQ1JDeUJBeDF0NDlKCiAgRUlRUFFBcGxi
     ZXp5YlllWkhMUHhjaVFBIn19fSwKICAgICJBZG1pbmlzdHJhdG9yU2lnbmF0dXJlI
     jogewogICAgICAiVWRmIjogIk1DREgtRklQUS1YV0kzLTJNTFMtS1o2VS1TQVZPLU
     VWU0giLAogICAgICAiUHVibGljUGFyYW1ldGVycyI6IHsKICAgICAgICAiUHVibGl
     jS2V5RUNESCI6IHsKICAgICAgICAgICJjcnYiOiAiRWQ0NDgiLAogICAgICAgICAg
     IlB1YmxpYyI6ICJoUUxJcWdOMEtRS3V4R18tSHRHV2JQQ0l1RlJvbG9UQno4c3MyW
     jltenh5VThQaEhsWE5zCiAgZG42d0VJNURsU1NkLXhEVFQ1RHFlLThBIn19fSwKIC
     AgICJBY2NvdW50QXV0aGVudGljYXRpb24iOiB7CiAgICAgICJVZGYiOiAiTURIVi1
     OTDVJLUZUTkUtTUVQUC1UM0xMLUdWMlAtM1BRSyIsCiAgICAgICJQdWJsaWNQYXJh
     bWV0ZXJzIjogewogICAgICAgICJQdWJsaWNLZXlFQ0RIIjogewogICAgICAgICAgI
     mNydiI6ICJYNDQ4IiwKICAgICAgICAgICJQdWJsaWMiOiAiOUttNXNQdjQtMkVYUD
     U1NDh4cmF5aXpyQXBZZVRzS3NSY0hySk8zaWdDbkw4OTB5X2lsQQogIG9qUmxhSi1
     CUFRHMzlBMFFHdE11bi04QSJ9fX0sCiAgICAiQWNjb3VudFNpZ25hdHVyZSI6IHsK
     ICAgICAgIlVkZiI6ICJNQllCLTNTS0ctU0lGUi1LRUZKLUREVUktWFVSTS1WRzZOI
     iwKICAgICAgIlB1YmxpY1BhcmFtZXRlcnMiOiB7CiAgICAgICAgIlB1YmxpY0tleU
     VDREgiOiB7CiAgICAgICAgICAiY3J2IjogIkVkNDQ4IiwKICAgICAgICAgICJQdWJ
     saWMiOiAiZUN1akU5SjU2Z242aC1HdkJwaERoejFxQjVQS1RTR21tamtpcUhGam1E
     cEEyN21DWmxLNAogIFBrR19taE9OX0N3NzFVWmFBaW9tamhDQSJ9fX19fQ",
           {
             "signatures":[{
                 "alg":"S512",
                 "kid":"MCDH-FIPQ-XWI3-2MLS-KZ6U-SAVO-EVSH",
                 "signature":"hPWd3iRqTx5tn_VAcFOl5NFiUhiSvTQ2Yrt3lM
     UaZlgEAjJvjav7zwgB6SfVt59eaBG3cAI6z_iA2mi3eDP314lD8xxbOALJp3r02TT
     vMaxxGx1R_HdneReMZYlrO12YdllyI9w14mkQDBGtY1bn4QsA"}
               ],
             "PayloadDigest":"j3iRsYIUPzWOAE1qN2MyfSZXb3DrEnqhtttoa8
     BgpGgZJb_A-1Nxi9Vk-wzz7kEh30HuWsfh2mYdprmNpeJDfw"}
           ],
         "EnvelopedProfileDevice":[{
             "EnvelopeID":"MDGU-U5T6-5SRZ-3S6H-KV5K-FQVE-SRBJ",
             "dig":"S512",
             "ContentMetaData":"ewogICJVbmlxdWVJRCI6ICJNREdVLVU1VDYt
     NVNSWi0zUzZILUtWNUstRlFWRS1TUkJKIiwKICAiTWVzc2FnZVR5cGUiOiAiUHJvZ
     mlsZURldmljZSIsCiAgImN0eSI6ICJhcHBsaWNhdGlvbi9tbW0vb2JqZWN0IiwKIC
     AiQ3JlYXRlZCI6ICIyMDIwLTExLTAzVDAxOjUwOjQ1WiJ9"},
           "ewogICJQcm9maWxlRGV2aWNlIjogewogICAgIlByb2ZpbGVTaWduYXR1
     cmUiOiB7CiAgICAgICJVZGYiOiAiTURHVS1VNVQ2LTVTUlotM1M2SC1LVjVLLUZRV
     kUtU1JCSiIsCiAgICAgICJQdWJsaWNQYXJhbWV0ZXJzIjogewogICAgICAgICJQdW
     JsaWNLZXlFQ0RIIjogewogICAgICAgICAgImNydiI6ICJFZDQ0OCIsCiAgICAgICA
     gICAiUHVibGljIjogImdLTGU3MkhLUWYxSlhRTmE3SVJ6SEZLQVZJT3RpZDhTM2Ra
     NUFMTjF3eHdjWElaWmtQSGsKICBLZVZGZ0xfYVRONXd0U3c4MEdwVGRZNkEifX19L
     AogICAgIkJhc2VFbmNyeXB0aW9uIjogewogICAgICAiVWRmIjogIk1EVVItSFkyNS
     1WS1VZLUdEWEEtSkVKMy1FTjZNLUZFREwiLAogICAgICAiUHVibGljUGFyYW1ldGV
     ycyI6IHsKICAgICAgICAiUHVibGljS2V5RUNESCI6IHsKICAgICAgICAgICJjcnYi
     OiAiWDQ0OCIsCiAgICAgICAgICAiUHVibGljIjogIkJyWTRGd2ZkTDluemk2cDMte
     TZubjlhT0dPOXczMWNYZzBNU0VUeG1fNF92ZWpEOFhxMGgKICBCVERPajhIWmVOdE
     lTX3FZVDFYUy1ZZ0EifX19LAogICAgIkJhc2VBdXRoZW50aWNhdGlvbiI6IHsKICA
     gICAgIlVkZiI6ICJNRFhCLU9MUFQtRFZFSy1PQldKLVlLWTMtVjcyVC1FQTVKIiwK



Hallam-Baker              Expires May 7, 2021                  [Page 41]

                         Mesh Schema Reference             November 2020

     ICAgICAgIlB1YmxpY1BhcmFtZXRlcnMiOiB7CiAgICAgICAgIlB1YmxpY0tleUVDR
     EgiOiB7CiAgICAgICAgICAiY3J2IjogIlg0NDgiLAogICAgICAgICAgIlB1YmxpYy
     I6ICJHZlpGMVZ0NjVNMENuWHc1aTNKbzVmMmc5djJSRzVKaGFUSFVxeGxNTE1MZzF
     5YnFLYzVzCiAgUUd1RnBfal9kRXpyWlZDVVdwaUdSMS1BIn19fSwKICAgICJCYXNl
     U2lnbmF0dXJlIjogewogICAgICAiVWRmIjogIk1BRkYtTjNHVy1FUkNVLUNINVctV
     lFPTS03QVNBLUZEQ0oiLAogICAgICAiUHVibGljUGFyYW1ldGVycyI6IHsKICAgIC
     AgICAiUHVibGljS2V5RUNESCI6IHsKICAgICAgICAgICJjcnYiOiAiRWQ0NDgiLAo
     gICAgICAgICAgIlB1YmxpYyI6ICJveTRDRjBERUJsaFZhakhLZXd6VVN0eWlTdzEx
     eXBodXQ4bjBYdEFaUWpwVUhOdDUtNWJhCiAgRFpwejhPMWtBWHdCMHBvaEhYcDFEN
     HlBIn19fX19",
           {
             "signatures":[{
                 "alg":"S512",
                 "kid":"MDGU-U5T6-5SRZ-3S6H-KV5K-FQVE-SRBJ",
                 "signature":"wAwYBP7IuNh82p9uKRJipvdZGxWflNeIx2SYxw
     esfNvIQ7dVHzyFf9rvyyIALZsp6fVzaXSwqqiA6RQeWQIAMOhSy2Znh1K5c-qATSA
     JjrukejmhXmeKcOCHKUnt2yIrxAoEclTf0HzxfiNbSeoOzj4A"}
               ],
             "PayloadDigest":"2SWl6GfRY2649Q7jtEYkgRRZlUpR-lPA7rcl-q
     r69EWu6stHguJeD0rMNjE76rCCp5fzSYDi5AZBwKTjYq_4rA"}
           ],
         "EnvelopedConnectionUser":[{
             "dig":"S512",
             "ContentMetaData":"ewogICJNZXNzYWdlVHlwZSI6ICJDb25uZWN0
     aW9uRGV2aWNlIiwKICAiY3R5IjogImFwcGxpY2F0aW9uL21tbS9vYmplY3QiLAogI
     CJDcmVhdGVkIjogIjIwMjAtMTEtMDNUMDE6NTA6NDVaIn0"},
           "ewogICJDb25uZWN0aW9uRGV2aWNlIjogewogICAgIkRldmljZVNpZ25h
     dHVyZSI6IHsKICAgICAgIlVkZiI6ICJNQkhGLUdXSzItNktVTC1BNE1CLTI3SlMtU
     1k3My1DTFNIIiwKICAgICAgIlB1YmxpY1BhcmFtZXRlcnMiOiB7CiAgICAgICAgIl
     B1YmxpY0tleUVDREgiOiB7CiAgICAgICAgICAiY3J2IjogIkVkNDQ4IiwKICAgICA
     gICAgICJQdWJsaWMiOiAibkM3ek5yUDgyUnkwdkxaSGdDeF92bGlqTHdDam8yTUZJ
     eVpUMGcxbmk4dEh0N0p4TDhNLQogIDlzNmNPX3FPUnRWMkVpOW04UzM3MEl3QSJ9f
     X0sCiAgICAiRGV2aWNlRW5jcnlwdGlvbiI6IHsKICAgICAgIlVkZiI6ICJNQU40LV
     JPVU0tUU1GNS1WS09OLU5IRzItT1NMVS1DS05HIiwKICAgICAgIlB1YmxpY1BhcmF
     tZXRlcnMiOiB7CiAgICAgICAgIlB1YmxpY0tleUVDREgiOiB7CiAgICAgICAgICAi
     Y3J2IjogIlg0NDgiLAogICAgICAgICAgIlB1YmxpYyI6ICItcWEwczdTYnlYOG5QQ
     XFKdjVCUk5RaDN0S21IU25UamFrRlVNZWE0a3dEaHAzZU92TEd4CiAgdUJOZzBhY0
     lQZzZCQjN3NjJ6SzdTVzZBIn19fSwKICAgICJEZXZpY2VBdXRoZW50aWNhdGlvbiI
     6IHsKICAgICAgIlVkZiI6ICJNQUZNLUtNUkQtNUNXVS1ZR1RILVY1S1YtWlpGUC1O
     U0pZIiwKICAgICAgIlB1YmxpY1BhcmFtZXRlcnMiOiB7CiAgICAgICAgIlB1YmxpY
     0tleUVDREgiOiB7CiAgICAgICAgICAiY3J2IjogIlg0NDgiLAogICAgICAgICAgIl
     B1YmxpYyI6ICJaQ0RncEZNNGdPNUxTMEI1b21ncXJ2ZUpVeWJ5TWdFTVVWZTZMUkQ
     wRmpCejljWERQdFUzCiAgak9MNnRNS2ZqYklQNEFKeS1qQ0pMdlFBIn19fX19",
           {
             "signatures":[{
                 "alg":"S512",
                 "kid":"MCCS-PUBP-DRFI-3WKI-7O2T-7XBK-5E5H",
                 "signature":"173Om1h4ZlI5KiQ8cQgqNIn5iiiduBX3qngCay
     rFtQdeoRrt8QRY_E04ob-BD74pklveyLHaXHWAohgMXgtlDGDvtVOFrhn5yqUlAcS
     998exhjjO7Fysb8VtUbzADmGxGVOhRH5YOZegIU7rVhVOgigA"}
               ],



Hallam-Baker              Expires May 7, 2021                  [Page 42]

                         Mesh Schema Reference             November 2020

             "PayloadDigest":"YbllV_0OI_pJn3TZHWzcUz13M2WAeXkRlZT6HL
     2jzmOlPmb8hDGxxe6TFSpmEVY7XUfhAi6kPrbYgj-4lc7vsg"}
           ],
         "EnvelopedActivationDevice":[{
             "enc":"A256CBC",
             "dig":"S512",
             "kid":"EBQE-KGR6-NIZM-IKBK-ULWS-RTZK-GQZZ",
             "Salt":"4tj4IHw4GMFs8biZoNEsCA",
             "recipients":[{
                 "kid":"MDUR-HY25-VKUY-GDXA-JEJ3-EN6M-FEDL",
                 "epk":{
                   "PublicKeyECDH":{
                     "crv":"X448",
                     "Public":"-iseCGLiyKvvnflm6dkQIDMPdUHhOFRrgTZxP
     0NGXH0oKR0omezbyOzNAaG8A7GzI-KSNvjLmcOA"}},
                 "wmk":"5dw1s6It1OlqV2vfJbelyQ3hksgR9QiBBoPKbH7VCiIj
     lcwhuTHn0w"}
               ],
             "ContentMetaData":"ewogICJNZXNzYWdlVHlwZSI6ICJBY3RpdmF0
     aW9uRGV2aWNlIiwKICAiY3R5IjogImFwcGxpY2F0aW9uL21tbS9vYmplY3QiLAogI
     CJDcmVhdGVkIjogIjIwMjAtMTEtMDNUMDE6NTA6NDVaIn0"},
           "OWuAg6Xm0Eud6G62HzHz0yMVQgSpsQDbeC7Eo7oHfo6yKxtjLarBzBnJ
     sOimHOFKgm2Rn68ZVvY-t31rx0BggtxdVF3zcfUf6zVIJxWJ8C5nND1TUkHyqjJt6
     sy8fCJyMXhILrFAiOpJrwYlYnwDU_zLmi2koIHNQ2pPrm_4aqUfXoXSmWBnszl-N0
     OhgSKpmRSv9aHlvopS_s99TmCV6lItToXnYs3L5Cqi-T1Q3Nu0zM3H8ArIJ5eh5uV
     s6-sn",
           {
             "signatures":[{
                 "alg":"S512",
                 "kid":"MCCS-PUBP-DRFI-3WKI-7O2T-7XBK-5E5H",
                 "signature":"mB5AHR1vh-aPs9KQBkvlKd1AMg2uplrCQ7mER_
     glOBRNyVd24O1XxKV-xDlwcNDcwfPmTJ-3DkyA_eCWLZu8t2Gq7C0LUsF_SUFpmw8
     lPAasMD_pNiAnoZF44-eAinM-SbhjpEFltdP7jh4pzn-cuywA",
                 "witness":"DxKjIIu7fos_2S-x3mX1FRTPYPTFckxBR4G_iLex
     rnQ"}
               ],
             "PayloadDigest":"yABfny6laTKreLckSpcK63t-En2jyYnvyRHkDO
     53B1bdOxQ5iagb2ua7NcL0hGKxgDPTwjdiFwSPXCbRuPIy1g"}
           ],
         "EnvelopedActivationAccount":[{
             "dig":"S512",
             "ContentMetaData":"ewogICJNZXNzYWdlVHlwZSI6ICJBY3RpdmF0
     aW9uQWNjb3VudCIsCiAgImN0eSI6ICJhcHBsaWNhdGlvbi9tbW0vb2JqZWN0IiwKI
     CAiQ3JlYXRlZCI6ICIyMDIwLTExLTAzVDAxOjUwOjQ1WiJ9"},
           "ewogICJBY3RpdmF0aW9uQWNjb3VudCI6IHt9fQ",
           {
             "signatures":[{
                 "alg":"S512",
                 "kid":"MCCS-PUBP-DRFI-3WKI-7O2T-7XBK-5E5H",
                 "signature":"2PD98zPN4k_QdO8AbaJNlh56CaCFg3qej5LQer
     8ab6NDlPE5FvTF10gedJk67M0suNZBwJ28PBiAsgMIrtHOqxi7sJBqsQrYCJCj_nE



Hallam-Baker              Expires May 7, 2021                  [Page 43]

                         Mesh Schema Reference             November 2020

     8QUcQEEiiRi2d31w3pQ2dk0GvCrk-f27aLfzBRX8GWZDPtjIA"}
               ],
             "PayloadDigest":"xgR5j7NiUbDvKWjP7IjI4HuMAPLD8-ru3cMITm
     gIiPuX9gh1llky1cgZPc1zU0wwYGKucV6mGegsV5wg7ZGYoA"}
           ]}}}

9.4. Contact

   A contact request presents a proposed contact entry and requests that
   it be added to the Contacts catalog of the specified Mesh Service
   Account. A contact request is usually sent by the party requesting
   that their contact be added but this is not necessarily the case.

   The MessageContact contains a DARE Envelope containing the Contact
   information of the requester. If the request is accepted, this
   information will be added to the contact catalog of the relevant
   account. If the Reply field has the value 'true', this indicates that
   the sender is asking for the recipient to return their own
   credentials in reply.

   Since the sender requires the user's contact information before the
   request can be made, the MessageContact message MAY be encrypted
   under either the user's account encryption key (if known) or the Mesh
   Service encryption key (which may be obtained from the service on
   request.

   Bob asks Alice to send her contact details and sends his.

   {
     "MessageContact":{
       "MessageId":"NAEZ-UOXO-KBH7-MT7I-KKA2-S37A-RGEZ",
       "Sender":"bob@example.com",
       "Recipient":"alice@example.com",
       "AuthenticatedData":[{
           "dig":"S512",
           "ContentMetaData":"ewogICJNZXNzYWdlVHlwZSI6ICJDb250YWN0UG
     Vyc29uIiwKICAiY3R5IjogImFwcGxpY2F0aW9uL21tbS9vYmplY3QiLAogICJDcmV
     hdGVkIjogIjIwMjAtMTEtMDNUMDE6NTA6NDJaIn0"},
         "ewogICJDb250YWN0UGVyc29uIjogewogICAgIkFuY2hvcnMiOiBbewogIC
     AgICAgICJVZGYiOiAiTUNZVS1JTzJGLUpGRkItM0xDTi1VVVJELUFJNVUtNllJSiI
     sCiAgICAgICAgIlZhbGlkYXRpb24iOiAiU2VsZiJ9XSwKICAgICJOZXR3b3JrQWRk
     cmVzc2VzIjogW3sKICAgICAgICAiQWRkcmVzcyI6ICJib2JAZXhhbXBsZS5jb20iL
     AogICAgICAgICJFbnZlbG9wZWRQcm9maWxlQWNjb3VudCI6IFt7CiAgICAgICAgIC
     AgICJFbnZlbG9wZUlEIjogIk1DWVUtSU8yRi1KRkZCLTNMQ04tVVVSRC1BSTVVLTZ
     ZSUoiLAogICAgICAgICAgICAiZGlnIjogIlM1MTIiLAogICAgICAgICAgICAiQ29u
     dGVudE1ldGFEYXRhIjogImV3b2dJQ0pWYm1seGRXVkpSQ0k2SUNKTlExbFZMVWxQT
     WtZdFNrWkdRaTAKICB6VEVOT0xWVlZVa1F0UVVrMVZTMDJXVWxLSWl3S0lDQWlUV1
     Z6YzJGblpWUjVjR1VpT2lBaVVISnZabWxzWgogIFZWelpYSWlMQW9nSUNKamRIa2l
     PaUFpWVhCd2JHbGpZWFJwYjI0dmJXMXRMMjlpYW1WamRDSXNDaUFnSWtOCiAgeVpX
     RjBaV1FpT2lBaU1qQXlNQzB4TVMwd00xUXdNVG8xTURvME1sb2lmUSJ9LAogICAgI
     CAgICAgImV3b2dJQ0pRY205bWFXeGxWWE5sY2lJNklIc0tJQ0FnSUNKUWNtOW1hV3



Hallam-Baker              Expires May 7, 2021                  [Page 44]

                         Mesh Schema Reference             November 2020

     gKICBsVTJsbmJtRjBkWEpsSWpvZ2V3b2dJQ0FnSUNBaVZXUm1Jam9nSWsxRFdWVXR
     TVTh5UmkxS1JrWkNMVE5NUQogIDA0dFZWVlNSQzFCU1RWVkxUWlpTVW9pTEFvZ0lD
     QWdJQ0FpVUhWaWJHbGpVR0Z5WVcxbGRHVnljeUk2SUhzCiAgS0lDQWdJQ0FnSUNBa
     VVIVmliR2xqUzJWNVJVTkVTQ0k2SUhzS0lDQWdJQ0FnSUNBZ0lDSmpjbllpT2lBaV
     IKICBXUTBORGdpTEFvZ0lDQWdJQ0FnSUNBZ0lsQjFZbXhwWXlJNklDSjJVbGRvYlh
     OTFJGcEVWV0poWlZKbFNVTgogIExjWEIzUzFReFNHWnhTSGszTWxWNFJFdDZaMVpz
     VG5sTk4zWkxkalphWVVkVUNpQWdhVkZzTW1OSFVtTTBUCiAgbkJKUkdSek1tVkphb
     XBOYUZGQkluMTlmU3dLSUNBZ0lDSkJZMk52ZFc1MFFXUmtjbVZ6Y3lJNklDSmliMk
     oKICBBWlhoaGJYQnNaUzVqYjIwaUxBb2dJQ0FnSWxObGNuWnBZMlZWWkdZaU9pQWl
     UVVJSVHkxU05qWktMVTFXUgogIFU4dFFrUk1OaTFXTmxRM0xVWlFTVWt0VlRReVVT
     SXNDaUFnSUNBaVFXTmpiM1Z1ZEVWdVkzSjVjSFJwYjI0CiAgaU9pQjdDaUFnSUNBZ
     0lDSlZaR1lpT2lBaVRVRkdVUzAyU0U5Q0xVeENSRlV0V1ZCUVVDMWFWRnBDTFRJMV
     UKICBWTXRWVWhKVHlJc0NpQWdJQ0FnSUNKUWRXSnNhV05RWVhKaGJXVjBaWEp6SWp
     vZ2V3b2dJQ0FnSUNBZ0lDSgogIFFkV0pzYVdOTFpYbEZRMFJJSWpvZ2V3b2dJQ0Fn
     SUNBZ0lDQWdJbU55ZGlJNklDSllORFE0SWl3S0lDQWdJCiAgQ0FnSUNBZ0lDSlFkV
     0pzYVdNaU9pQWlZbVJGVlZJd1NXaEZiMWRWYTBKeWRIQllXazFYWDI1dFdYZGxTbm
     gKICBsVlRoMFQwTkViVVpxTVdaclpHNXRNbTVvWm5CR1V3b2dJRmhOY0RVME9HOWx
     TV3RRYUhreFJDMXBjbmx6UwogIFdsSFFTSjlmWDBzQ2lBZ0lDQWlRV1J0YVc1cGMz
     UnlZWFJ2Y2xOcFoyNWhkSFZ5WlNJNklIc0tJQ0FnSUNBCiAgZ0lsVmtaaUk2SUNKT
     lExbFZMVWxQTWtZdFNrWkdRaTB6VEVOT0xWVlZVa1F0UVVrMVZTMDJXVWxLSWl3S0
     kKICBDQWdJQ0FnSWxCMVlteHBZMUJoY21GdFpYUmxjbk1pT2lCN0NpQWdJQ0FnSUN
     BZ0lsQjFZbXhwWTB0bGVVVgogIERSRWdpT2lCN0NpQWdJQ0FnSUNBZ0lDQWlZM0oy
     SWpvZ0lrVmtORFE0SWl3S0lDQWdJQ0FnSUNBZ0lDSlFkCiAgV0pzYVdNaU9pQWlkb
     EpYYUcxelMwUmFSRlZpWVdWU1pVbERTM0Z3ZDB0VU1VaG1jVWg1TnpKVmVFUkxlbW
     QKICBXYkU1NVRUZDJTM1kyV21GSFZBb2dJR2xSYkRKalIxSmpORTV3U1VSa2N6Smx
     TV3BxVFdoUlFTSjlmWDBzQwogIGlBZ0lDQWlRV05qYjNWdWRFRjFkR2hsYm5ScFky
     RjBhVzl1SWpvZ2V3b2dJQ0FnSUNBaVZXUm1Jam9nSWsxCiAgQlZsY3RNalZXVEMxT
     1dVcEpMVFZEUXpNdFZGQk5XaTFETlZaR0xWUkJOa1lpTEFvZ0lDQWdJQ0FpVUhWaW
     IKICBHbGpVR0Z5WVcxbGRHVnljeUk2SUhzS0lDQWdJQ0FnSUNBaVVIVmliR2xqUzJ
     WNVJVTkVTQ0k2SUhzS0lDQQogIGdJQ0FnSUNBZ0lDSmpjbllpT2lBaVdEUTBPQ0lz
     Q2lBZ0lDQWdJQ0FnSUNBaVVIVmliR2xqSWpvZ0ltVTNVCiAgamxpVGxwQ1VuZHNla
     mxSU0RSWmEwRjVibVJUVkVwWFRYVk9kSE41YVhWc2FFaDNVMGh1VERKUFFYSkhkMl
     IKICB2ZGxJS0lDQlBUVEJ6UlUxWFFVYzNRa0pRVUVKSFNEbFdZV1Y1YVVFaWZYMTl
     MQW9nSUNBZ0lrRmpZMjkxYgogIG5SVGFXZHVZWFIxY21VaU9pQjdDaUFnSUNBZ0lD
     SlZaR1lpT2lBaVRVRTBWeTFUTTFWV0xVSTNVMVV0VUVwCiAgR1FTMVhVRW8yTFRWR
     FVGTXRNekpETnlJc0NpQWdJQ0FnSUNKUWRXSnNhV05RWVhKaGJXVjBaWEp6SWpvZ2
     UKICB3b2dJQ0FnSUNBZ0lDSlFkV0pzYVdOTFpYbEZRMFJJSWpvZ2V3b2dJQ0FnSUN
     BZ0lDQWdJbU55ZGlJNklDSgogIEZaRFEwT0NJc0NpQWdJQ0FnSUNBZ0lDQWlVSFZp
     Ykdsaklqb2dJa2wwWTE4MU4wNTZSREZyYVZoWlozbFZYCiAgM2M1Y0dGQk1YaHpkR
     Th3VWpjdFlubDBaa3RGWjNBeFZHbEZURk5wUmxaNGVXa0tJQ0JuZEhFeVV6a3lVaz
     EKICBJVmpRMFZFdDZiR3R3WDNSM1FVRWlmWDE5ZlgwIiwKICAgICAgICAgIHsKICA
     gICAgICAgICAgInNpZ25hdHVyZXMiOiBbewogICAgICAgICAgICAgICAgImFsZyI6
     ICJTNTEyIiwKICAgICAgICAgICAgICAgICJraWQiOiAiTUNZVS1JTzJGLUpGRkItM
     0xDTi1VVVJELUFJNVUtNllJSiIsCiAgICAgICAgICAgICAgICAic2lnbmF0dXJlIj
     ogIm1uWlZieTQ3RHVQdWhRTGR0dTQ1eUxRdllkNGNGM2dVT29UeXI0M0JQS2ptajN
     DSkMKICAwWHNudkcyNDdwcEw3eTVoUGtsVWI0NDRabUFpRGNpUHF6REtkUFZFY2VP
     N2R1cjFTb0Y1bV9Fa3NtSWxmNgogIEtPZlN3aHdpdHJDNXh6V01KTUdJWndNd2pfb
     mpSMmdsTGFwMmN5QnNBIn1dLAogICAgICAgICAgICAiUGF5bG9hZERpZ2VzdCI6IC
     J0UUltenFEdENIZkpRN2sxcTFvZzhQazMzcVNjb3NVNW1hdWppT3A0WHNDY2UKICB
     lNzJHM2M3Qm1BQmVidTRTMnZBaUVwUy15YmtDTUVFeUJkNXJxOVpQZyJ9XSwKICAg
     ICAgICAiUHJvdG9jb2xzIjogW3sKICAgICAgICAgICAgIlByb3RvY29sIjogIm1tb



Hallam-Baker              Expires May 7, 2021                  [Page 45]

                         Mesh Schema Reference             November 2020

     SJ9XX1dfX0",
         {
           "signatures":[{
               "alg":"S512",
               "kid":"MA4W-S3UV-B7SU-PJFA-WPJ6-5CPS-32C7",
               "signature":"Q94QMOeb4cGA96lu_PhlVgV3hB5dzXocBETMEZxP
     9N_X2qHVxlxZJqZBkXhdCFtN8pa9EKtYcF2ADNSs9GlkrsuOjXXAp_MLaFDdOYLOW
     MG22la68_nEV1lP9wX8jLOy2_Mhn5rBVISC0XRBFzUR1zMA"}
             ],
           "PayloadDigest":"kDQqkQFFp1vnlyendI8xdpS7k8Ut2zZPj1zZrx5e
     R7oQW3fURoEsautn3fG-DgaQ2Xb-A2ZrZaB87WNsSBW_zA"}
         ],
       "Reply":true,
       "Subject":"alice@example.com",
       "PIN":"AADZ-27RV-SGJA-5LIO-GHVA-2QPC-ORRA"}}

   Alice responds with her own contact information. Since she already
   has Bob's contact information, there is no need to request a response
   or provide a PIN code.

   The current protocol assumes that all contact management will be
   performed end-to-end through the Mesh Services themselves. If the
   number of Mesh users were to become exceptionally large, additional
   infrastructure to facilitate contact management will be required.
   These topics are discussed at a high level in .

   In situations where a user is well known and has a very large number
   of contacts, they are likely to make use of a tiered approach to
   contact management in which they keep separate accounts for their
   'public' and 'restricted' personas and delegate management of their
   public account to a subordinate or to their Mesh Service provider.

9.5. Confirmation

   Confirmation messages are used to provide an improved form of second
   factor authentication capability.

   Two confirmation messages are specified, a request and response.

   A confirmation request is initiated by sending a
   MessageConfirmationRequest to the Mesh Service hosting the recipient
   Mesh Service Account. The request specifies the question that is to
   be put to the user.

   To respond to a confirmation request, a user generates a
   MessageConfirmationResponse. This MUST be signed by a device
   authorized to respond to confirmation requests by a Device Connection
   Assertion with the Confirmation privilege.






Hallam-Baker              Expires May 7, 2021                  [Page 46]

                         Mesh Schema Reference             November 2020

   The console generates a confirmation request message:

   {
     "RequestConfirmation":{
       "MessageId":"NA3M-FCCF-P67J-CHXN-NUYJ-X267-RCH5",
       "Sender":"console@example.com",
       "Recipient":"alice@example.com",
       "Text":"start"}}

   Alice accepts the request and returns a ResponseConfirmation
   confirmation containing both the request and the response:

   Missing example 91

10. Publications

   Static QR codes MAY be used to allow contact exchange or device
   connection. In either case, the QR code contains an EARL providing
   the means of locating, decrypting and authenticating the published
   data.

10.1. Contact Exchange

   When used for contact exchange, the envelope payload is a
   CatalogedContact record.

   Besides allowing for exchange of contact information on a business
   card, a user might have their contact information printed on personal
   property to facilitate return of lost property.

10.2. Device Preconfiguration

   The static QR code device connection interaction allows a device with
   no keyboard, display or other user affordances to be connected to a
   Mesh account.

   The information necessary to establish communication with the device
   and to complete a device connection workflow is provided by means of
   a DevicePreconfiguration record accessed by means of an EARL.

   For example, Alice's coffee pot was preconfigured for connection to a
   Mesh account at the factory and the following DevicePreconfiguration
   record created:











Hallam-Baker              Expires May 7, 2021                  [Page 47]

                         Mesh Schema Reference             November 2020

   {
     "DevicePreconfiguration":{
       "EnvelopedProfileDevice":[{
           "EnvelopeID":"MC67-GVFM-B45X-D6AS-YAVS-TJ57-UKVY",
           "dig":"S512",
           "ContentMetaData":"ewogICJVbmlxdWVJRCI6ICJNQzY3LUdWRk0tQj
     Q1WC1ENkFTLVlBVlMtVEo1Ny1VS1ZZIiwKICAiTWVzc2FnZVR5cGUiOiAiUHJvZml
     sZURldmljZSIsCiAgImN0eSI6ICJhcHBsaWNhdGlvbi9tbW0vb2JqZWN0IiwKICAi
     Q3JlYXRlZCI6ICIyMDIwLTExLTAzVDAxOjUwOjQ3WiJ9"},
         "ewogICJQcm9maWxlRGV2aWNlIjogewogICAgIlByb2ZpbGVTaWduYXR1cm
     UiOiB7CiAgICAgICJVZGYiOiAiTUM2Ny1HVkZNLUI0NVgtRDZBUy1ZQVZTLVRKNTc
     tVUtWWSIsCiAgICAgICJQdWJsaWNQYXJhbWV0ZXJzIjogewogICAgICAgICJQdWJs
     aWNLZXlFQ0RIIjogewogICAgICAgICAgImNydiI6ICJFZDQ0OCIsCiAgICAgICAgI
     CAiUHVibGljIjogIk9kVHpOWnJUMWZHTnAzNzBDNEx1UVhHWUpJUFZiMmJSclRQcT
     I4SkNfU1hlNjNkeUphM24KICBScFZ5cjRleEYxcElGRTBXYWVNQlB0QUEifX19LAo
     gICAgIkJhc2VFbmNyeXB0aW9uIjogewogICAgICAiVWRmIjogIk1DWkUtWjdIQS1N
     Q0lMLTcyVVMtVkZGTC1RRklCLUFFNDciLAogICAgICAiUHVibGljUGFyYW1ldGVyc
     yI6IHsKICAgICAgICAiUHVibGljS2V5RUNESCI6IHsKICAgICAgICAgICJjcnYiOi
     AiWDQ0OCIsCiAgICAgICAgICAiUHVibGljIjogInBTemZIeHhkckY2QzZ4dHdyN0h
     nd0RxdTVDVmZOaDNvMkxGUzl0NnI2b0dYVE5NSnlpeWsKICAwbjR6Sl9JVXc5TDls
     MWk4R0puUF9JeUEifX19LAogICAgIkJhc2VBdXRoZW50aWNhdGlvbiI6IHsKICAgI
     CAgIlVkZiI6ICJNQVBVLU9DRFMtMjdaSC1UN0dCLU5UNjItWUVBWS1OTDM3IiwKIC
     AgICAgIlB1YmxpY1BhcmFtZXRlcnMiOiB7CiAgICAgICAgIlB1YmxpY0tleUVDREg
     iOiB7CiAgICAgICAgICAiY3J2IjogIlg0NDgiLAogICAgICAgICAgIlB1YmxpYyI6
     ICJBaGtacWdOb2JNMFBjbFl1Qlk2M3dVSjhVLVRnb2ZQSEp1R2ZscjRobGstU1hCV
     FlFdUhECiAgODFFd1RvSUtvTVNRbXkzMUhzVXV6YU1BIn19fSwKICAgICJCYXNlU2
     lnbmF0dXJlIjogewogICAgICAiVWRmIjogIk1CTkstQ0ZYRi1TNTdXLUdGVlEtSE8
     1SC1CQkpPLVQ0SkQiLAogICAgICAiUHVibGljUGFyYW1ldGVycyI6IHsKICAgICAg
     ICAiUHVibGljS2V5RUNESCI6IHsKICAgICAgICAgICJjcnYiOiAiRWQ0NDgiLAogI
     CAgICAgICAgIlB1YmxpYyI6ICJLRkVBclgwZThsMHpfSGtteE9uZVlXa3oyQ3NueG
     NqaG1QUjV0UjVPeGRJU20yQjQwNzVQCiAganQ2YnZoY1h3Z1BQNkRjZGFsTC1NTjB
     BIn19fX19",
         {
           "signatures":[{
               "alg":"S512",
               "kid":"MC67-GVFM-B45X-D6AS-YAVS-TJ57-UKVY",
               "signature":"S84XRCL44RpT_hGxrLEG9PzoyWHu7GZQpYmuMyAO
     I2UPrUWbj03fSxloEh-xld82eaRQSnybPbEAAvCEfFQIoDYchaKvNgD0mGEOWk8XD
     ZfRGd4ZLZbi1uBv4l6h4u6bSrfgzjoDW5tW4IhxKg6wFRIA"}
             ],
           "PayloadDigest":"_nb8duNIPDGJT3HWXSC1mj56zqIvvqIpA6TLyjBT
     DFf0hzmteInfDIfKJhtZL8SPKpLabKVf3VaEt_hU_vAS-Q"}
         ],
       "EnvelopedConnectionDevice":[{
           "dig":"S512",
           "ContentMetaData":"ewogICJNZXNzYWdlVHlwZSI6ICJDb25uZWN0aW
     9uRGV2aWNlIiwKICAiY3R5IjogImFwcGxpY2F0aW9uL21tbS9vYmplY3QiLAogICJ
     DcmVhdGVkIjogIjIwMjAtMTEtMDNUMDE6NTA6NDdaIn0"},
         "ewogICJDb25uZWN0aW9uRGV2aWNlIjogewogICAgIkRldmljZVNpZ25hdH
     VyZSI6IHsKICAgICAgIlVkZiI6ICJNQk5LLUNGWEYtUzU3Vy1HRlZRLUhPNUgtQkJ
     KTy1UNEpEIiwKICAgICAgIlB1YmxpY1BhcmFtZXRlcnMiOiB7CiAgICAgICAgIlB1



Hallam-Baker              Expires May 7, 2021                  [Page 48]

                         Mesh Schema Reference             November 2020
     YmxpY0tleUVDREgiOiB7CiAgICAgICAgICAiY3J2IjogIkVkNDQ4IiwKICAgICAgI
     CAgICJQdWJsaWMiOiAiS0ZFQXJYMGU4bDB6X0hrbXhPbmVZV2t6MkNzbnhjamhtUF
     I1dFI1T3hkSVNtMkI0MDc1UAogIGp0NmJ2aGNYd2dQUDZEY2RhbEwtTU4wQSJ9fX0
     sCiAgICAiRGV2aWNlRW5jcnlwdGlvbiI6IHsKICAgICAgIlVkZiI6ICJNQ1pFLVo3
     SEEtTUNJTC03MlVTLVZGRkwtUUZJQi1BRTQ3IiwKICAgICAgIlB1YmxpY1BhcmFtZ
     XRlcnMiOiB7CiAgICAgICAgIlB1YmxpY0tleUVDREgiOiB7CiAgICAgICAgICAiY3
     J2IjogIlg0NDgiLAogICAgICAgICAgIlB1YmxpYyI6ICJwU3pmSHh4ZHJGNkM2eHR
     3cjdIZ3dEcXU1Q1ZmTmgzbzJMRlM5dDZyNm9HWFROTUp5aXlrCiAgMG40ekpfSVV3
     OUw5bDFpOEdKblBfSXlBIn19fSwKICAgICJEZXZpY2VBdXRoZW50aWNhdGlvbiI6I
     HsKICAgICAgIlVkZiI6ICJNQ1pFLVo3SEEtTUNJTC03MlVTLVZGRkwtUUZJQi1BRT
     Q3IiwKICAgICAgIlB1YmxpY1BhcmFtZXRlcnMiOiB7CiAgICAgICAgIlB1YmxpY0t
     leUVDREgiOiB7CiAgICAgICAgICAiY3J2IjogIlg0NDgiLAogICAgICAgICAgIlB1
     YmxpYyI6ICJwU3pmSHh4ZHJGNkM2eHR3cjdIZ3dEcXU1Q1ZmTmgzbzJMRlM5dDZyN
     m9HWFROTUp5aXlrCiAgMG40ekpfSVV3OUw5bDFpOEdKblBfSXlBIn19fX19",
         {
           "signatures":[{
               "alg":"S512",
               "kid":"MC75-25RX-TCZ7-BVJW-ZIKQ-57Q3-EPKS",
               "signature":"-GWtfXbOMZrvJDC3Qaw2ag4nI4W02lpK06GiEGiH
     03SFvhUO6xPqL87RxPJ8YPfPsgSkN3L7n0AAJkYqEa75fxCNd3mNg4xU1-0GGIzx4
     eDoRcLButgdxxr4FmR6Pny-HgtecIVyKo1bCGhgtNviXAgA"}
             ],
           "PayloadDigest":"mp98W45jPnTo579iwhW6Xh4CgoOyEuTtymAhFgVb
     55dgLg2NLwf3kYShR-CTlXnnfIITyFmBav7ItfJCYe7OqQ"}
         ],
       "PrivateKey":{
         "PrivateKeyUDF":{
           "PrivateValue":"ZAAQ-AGWA-OA2N-4YTE-LVH6-TM26-WVHO-35CJ-TOY
   F-NUJZ-7D4V-IGUP-SF3P-M6T3",
           "KeyType":"MeshProfileDevice"}},
       "ConnectUri":"mcu://maker@example.com/EAQ6-22WS-DZIL-56OT-X4Q4-
   KMBW-MY6D-4K6O-6FWB-UQB7-5DZ4-PZHX-JQ5H-Q"}}

   To connect to the coffee pot, Alice first scans the QR code with her
   administrative device which uses the PIN code and service to
   retrieve, decrypt and authenticate the DevicePreconfiguration record.
   Future versions of the specification will allow this record to
   specify means by which the administration device can establish direct
   peer-to-peer communication to complete the connection process by any
   communication modality supported by both devices (e.g. IR, Bluetooth,
   WiFi-Direct, etc.)

11. Schema

11.1. Shared Classes

   The following classes are used as common elements in Mesh profile
   specifications.

11.1.1. Classes describing keys





Hallam-Baker              Expires May 7, 2021                  [Page 49]

                         Mesh Schema Reference             November 2020

11.1.2. Structure: KeyData

   The KeyData class is used to describe public key pairs and  trust
   assertions associated with a public key.

         Udf: String (Optional)

         X509Certificate: Binary (Optional)

         X509Chain: Binary [0..Many]

         X509CSR: Binary (Optional)

         NotBefore: DateTime (Optional)

         NotOnOrAfter: DateTime (Optional)

11.1.3. Structure: CompositePrivate

         Inherits: Key

         DeviceKeyUdf: String (Optional)

11.2. Assertion classes

   Classes that are derived from an assertion.

11.2.1. Structure: Assertion

   Parent class from which all assertion classes are derived

         Names: String [0..Many]

         Updated: DateTime (Optional)

         NotaryToken: String (Optional)

11.2.2. Structure: Condition

   Parent class from which all condition classes are derived.

   [No fields]

11.2.3. Base Classes

   Abstract classes from which the Profile, Activation and Connection
   classes are derrived.







Hallam-Baker              Expires May 7, 2021                  [Page 50]

                         Mesh Schema Reference             November 2020

11.2.4. Structure: Connection

         Inherits: Assertion

         SubjectUdf: String (Optional)

         AuthorityUdf: String (Optional)

11.2.5. Structure: Activation

         Inherits: Assertion

   Contains the private activation information for a Mesh application
   running on a specific device

         ActivationKey: String (Optional)

         Entries: ActivationEntry [0..Many]

11.2.6. Structure: ActivationEntry

         Resource: String (Optional)

         Key: KeyData (Optional)

11.2.7. Mesh Profile Classes

   Classes describing Mesh Profiles. All Profiles are Assertions
   derrived from Assertion.

11.2.8. Structure: Profile

         Inherits: Assertion

   Parent class from which all profile classes are derived

         ProfileSignature: KeyData (Optional)

















Hallam-Baker              Expires May 7, 2021                  [Page 51]

                         Mesh Schema Reference             November 2020

11.2.9. Structure: ProfileDevice

         Inherits: Profile

   Describes a mesh device.

         Description: String (Optional)

         BaseEncryption: KeyData (Optional)

         BaseAuthentication: KeyData (Optional)

         BaseSignature: KeyData (Optional)

11.2.10. Structure: ProfileAccount

   Base class for the account profiles ProfileUser and ProfileGroup.
   These subclasses may be merged at some future date.

         Inherits: Profile

         AccountAddress: String (Optional)

         ServiceUdf: String (Optional)

         EscrowEncryption: KeyData (Optional)

         AccountEncryption: KeyData (Optional)

         AdministratorSignature: KeyData (Optional)

11.2.11. Structure: ProfileUser

         Inherits: ProfileAccount

   Account assertion. This is signed by the service hosting the account.

         AccountAuthentication: KeyData (Optional)

         AccountSignature: KeyData (Optional)

11.2.12. Structure: ProfileGroup

         Inherits: ProfileAccount

   Describes a group. Note that while a group is created by one person
   who becomes its first administrator, control of the group may pass to
   other administrators over time.

   [No fields]




Hallam-Baker              Expires May 7, 2021                  [Page 52]

                         Mesh Schema Reference             November 2020

11.2.13. Structure: ProfileService

         Inherits: Profile

   Profile of a Mesh Service

         ServiceAuthentication: KeyData (Optional)

         ServiceEncryption: KeyData (Optional)

         ServiceSignature: KeyData (Optional)

11.2.14. Structure: ProfileHost

         Inherits: Profile

         KeyAuthentication: KeyData (Optional)

         KeyEncryption: KeyData (Optional)

11.2.15. Connection Assertions

   Connection assertions are used to authenticate and authorize
   interactions between devices and the service currently servicing the
   account. They SHOULD NOT be visible to external parties.

11.2.16. Structure: ConnectionDevice

         Inherits: Connection

   Connection assertion used to authenticate service requests made by a
   device.

         AccountAddress: String (Optional)

         DeviceSignature: KeyData (Optional)

         DeviceEncryption: KeyData (Optional)

         DeviceAuthentication: KeyData (Optional)

11.2.17. Structure: ConnectionApplication

         Inherits: Connection

   Connection assertion stating that a particular device is

   [No fields]






Hallam-Baker              Expires May 7, 2021                  [Page 53]

                         Mesh Schema Reference             November 2020

11.2.18. Structure: ConnectionGroup

   Describes the connection of a member to a group.

         Inherits: Connection

   [No fields]

11.2.19. Structure: ConnectionService

         Inherits: Connection

   [No fields]

11.2.20. Structure: ConnectionHost

         Inherits: Connection

   [No fields]

11.2.21. Activation Assertions

11.2.22. Structure: ActivationDevice

   Contains activation data for device specific keys used in the context
   of a  Mesh account.

         Inherits: Activation

         AccountUdf: String (Optional)

11.2.23. Structure: ActivationAccount

         Inherits: Activation

         ProfileSignature: KeyData (Optional)

         AdministratorSignature: KeyData (Optional)

         AccountEncryption: KeyData (Optional)

         AccountAuthentication: KeyData (Optional)

         AccountSignature: KeyData (Optional)

11.2.24. Structure: ActivationApplication

         Inherits: Activation

   [No fields]




Hallam-Baker              Expires May 7, 2021                  [Page 54]

                         Mesh Schema Reference             November 2020

11.3. Data Structures

   Classes describing data used in cataloged data.

11.3.1. Structure: Contact

         Inherits: Assertion

   Base class for contact entries.

         Id: String (Optional)

         Anchors: Anchor [0..Many]

         NetworkAddresses: NetworkAddress [0..Many]

         Locations: Location [0..Many]

         Roles: Role [0..Many]

         Bookmark: Bookmark [0..Many]

         Sources: TaggedSource [0..Many]

11.3.2. Structure: Anchor

   Trust anchor

         Udf: String (Optional)

         Validation: String (Optional)

11.3.3. Structure: TaggedSource

   Source from which contact information was obtained.

         LocalName: String (Optional)

         Validation: String (Optional)

         BinarySource: Binary (Optional)

         EnvelopedSource: Enveloped (Optional)











Hallam-Baker              Expires May 7, 2021                  [Page 55]

                         Mesh Schema Reference             November 2020

11.3.4. Structure: ContactGroup

         Inherits: Contact

   Contact for a group, including encryption groups.

   [No fields]

11.3.5. Structure: ContactPerson

         Inherits: Contact

         CommonNames: PersonName [0..Many]

11.3.6. Structure: ContactOrganization

         Inherits: Contact

         CommonNames: OrganizationName [0..Many]

11.3.7. Structure: OrganizationName

   The name of an organization

         Inactive: Boolean (Optional)

         RegisteredName: String (Optional)

         DBA: String (Optional)

11.3.8. Structure: PersonName

   The name of a natural person

         Inactive: Boolean (Optional)

         FullName: String (Optional)

         Prefix: String (Optional)

         First: String (Optional)

         Middle: String [0..Many]

         Last: String (Optional)

         Suffix: String (Optional)

         PostNominal: String (Optional)





Hallam-Baker              Expires May 7, 2021                  [Page 56]

                         Mesh Schema Reference             November 2020

11.3.9. Structure: NetworkAddress

   Provides all means of contacting the individual according to a
   particular network address

         Inactive: Boolean (Optional)

         Address: String (Optional)

         NetworkCapability: String [0..Many]

         EnvelopedProfileAccount: Enveloped (Optional)

         Protocols: NetworkProtocol [0..Many]

11.3.10. Structure: NetworkProtocol

         Protocol: String (Optional)

11.3.11. Structure: Role

         OrganizationName: String (Optional)

         Titles: String [0..Many]

         Locations: Location [0..Many]

11.3.12. Structure: Location

         Appartment: String (Optional)

         Street: String (Optional)

         District: String (Optional)

         Locality: String (Optional)

         County: String (Optional)

         Postcode: String (Optional)

         Country: String (Optional)

11.3.13. Structure: Bookmark

         Uri: String (Optional)

         Title: String (Optional)

         Role: String [0..Many]




Hallam-Baker              Expires May 7, 2021                  [Page 57]

                         Mesh Schema Reference             November 2020

11.3.14. Structure: Reference

         MessageId: String (Optional)

         ResponseId: String (Optional)

         Relationship: String (Optional)

11.3.15. Structure: Task

         Key: String (Optional)

         Start: DateTime (Optional)

         Finish: DateTime (Optional)

         StartTravel: String (Optional)

         FinishTravel: String (Optional)

         TimeZone: String (Optional)

         Title: String (Optional)

         Description: String (Optional)

         Location: String (Optional)

         Trigger: String [0..Many]

         Conference: String [0..Many]

         Repeat: String (Optional)

         Busy: Boolean (Optional)

11.4. Catalog Entries

11.4.1. Structure: CatalogedEntry

   Base class for cataloged Mesh data.

         Labels: String [0..Many]











Hallam-Baker              Expires May 7, 2021                  [Page 58]

                         Mesh Schema Reference             November 2020

11.4.2. Structure: CatalogedDevice

         Inherits: CatalogedEntry

   Public device entry, indexed under the device ID Hello

         Udf: String (Optional)

         DeviceUdf: String (Optional)

         SignatureUdf: String (Optional)

         EnvelopedProfileUser: Enveloped (Optional)

         EnvelopedProfileDevice: Enveloped (Optional)

         EnvelopedConnectionUser: Enveloped (Optional)

         EnvelopedActivationDevice: Enveloped (Optional)

         EnvelopedActivationAccount: Enveloped (Optional)

         EnvelopedActivationApplication: Enveloped [0..Many]

11.4.3. Structure: CatalogedPublication

         Inherits: CatalogedEntry

   A publication.

         Id: String (Optional)

         Authenticator: String (Optional)

         EnvelopedData: DareEnvelope (Optional)

         NotOnOrAfter: DateTime (Optional)

11.4.4. Structure: CatalogedCredential

         Inherits: CatalogedEntry

         Protocol: String (Optional)

         Service: String (Optional)

         Username: String (Optional)

         Password: String (Optional)





Hallam-Baker              Expires May 7, 2021                  [Page 59]

                         Mesh Schema Reference             November 2020

11.4.5. Structure: CatalogedNetwork

         Inherits: CatalogedEntry

         Protocol: String (Optional)

         Service: String (Optional)

         Username: String (Optional)

         Password: String (Optional)

11.4.6. Structure: CatalogedContact

         Inherits: CatalogedEntry

         Key: String (Optional)

         Self: Boolean (Optional)

11.4.7. Structure: CatalogedAccess

         Inherits: CatalogedEntry

   [No fields]

11.4.8. Structure: CryptographicCapability

         Id: String (Optional)

         KeyData: KeyData (Optional)

         EnvelopedKeyShares: Enveloped [0..Many]

         SubjectId: String (Optional)

         SubjectAddress: String (Optional)

11.4.9. Structure: CapabilityDecrypt

         Inherits: CryptographicCapability

   The corresponding key is a decryption key

   [No fields]









Hallam-Baker              Expires May 7, 2021                  [Page 60]

                         Mesh Schema Reference             November 2020

11.4.10. Structure: CapabilityDecryptPartial

         Inherits: CapabilityDecrypt

   The corresponding key is an encryption key

         ServiceId: String (Optional)

         ServiceAddress: String (Optional)

11.4.11. Structure: CapabilityDecryptServiced

         Inherits: CapabilityDecrypt

   The corresponding key is an encryption key

         AuthenticationId: String (Optional)

11.4.12. Structure: CapabilitySign

         Inherits: CryptographicCapability

   The corresponding key is an administration key

   [No fields]

11.4.13. Structure: CapabilityKeyGenerate

         Inherits: CryptographicCapability

   The corresponding key is a key that may be used to generate key
   shares.

   [No fields]

11.4.14. Structure: CapabilityFairExchange

         Inherits: CryptographicCapability

   The corresponding key is a decryption key to be used in accordance
   with the Micali Fair Electronic Exchange with Invisible Trusted
   Parties protocol.

   [No fields]










Hallam-Baker              Expires May 7, 2021                  [Page 61]

                         Mesh Schema Reference             November 2020

11.4.15. Structure: CatalogedBookmark

         Inherits: CatalogedEntry

         Uri: String (Optional)

         Title: String (Optional)

         Path: String (Optional)

11.4.16. Structure: CatalogedTask

         Inherits: CatalogedEntry

         EnvelopedTask: Enveloped (Optional)

         Title: String (Optional)

         Key: String (Optional)

11.4.17. Structure: CatalogedApplication

         Inherits: CatalogedEntry

         Key: String (Optional)

         EnvelopedCapabilities: DareEnvelope [0..Many]

11.4.18. Structure: CatalogedMember

         ContactAddress: String (Optional)

         MemberCapabilityId: String (Optional)

         ServiceCapabilityId: String (Optional)

         Inherits: CatalogedEntry

11.4.19. Structure: CatalogedGroup

         Inherits: CatalogedApplication

         EnvelopedProfileGroup: Enveloped (Optional)

         EnvelopedActivationAccount: Enveloped (Optional)









Hallam-Baker              Expires May 7, 2021                  [Page 62]

                         Mesh Schema Reference             November 2020

11.4.20. Structure: CatalogedApplicationSSH

         Inherits: CatalogedApplication

   [No fields]

11.4.21. Structure: CatalogedApplicationMail

         Inherits: CatalogedApplication

   [No fields]

11.4.22. Structure: CatalogedApplicationNetwork

         Inherits: CatalogedApplication

   [No fields]

11.5. Publications

11.5.1. Structure: DevicePreconfiguration

   A data structure that is passed

         EnvelopedProfileDevice: Enveloped (Optional)

         EnvelopedConnectionDevice: Enveloped (Optional)

         ConnectUri: String (Optional)

11.6. Messages

11.6.1. Structure: Message

         MessageId: String (Optional)

         Sender: String (Optional)

         Recipient: String (Optional)

11.6.2. Structure: MessageError

         Inherits: Message

         ErrorCode: String (Optional)









Hallam-Baker              Expires May 7, 2021                  [Page 63]

                         Mesh Schema Reference             November 2020

11.6.3. Structure: MessageComplete

         Inherits: Message

         References: Reference [0..Many]

11.6.4. Structure: MessagePinValidated

         Inherits: Message

         AuthenticatedData: DareEnvelope (Optional)

         ClientNonce: Binary (Optional)

         PinId: String (Optional)

         PinWitness: Binary (Optional)

11.6.5. Structure: MessagePin

         Account: String (Optional)

         Inherits: Message

         Expires: DateTime (Optional)

         Automatic: Boolean (Optional)

         SaltedPin: String (Optional)

         Action: String (Optional)

11.6.6. Structure: RequestConnection

   Connection request message. This message contains the information

         Inherits: MessagePinValidated

         AccountAddress: String (Optional)

11.6.7. Structure: AcknowledgeConnection

   Connection request message generated by a service on receipt of a
   valid MessageConnectionRequestClient










Hallam-Baker              Expires May 7, 2021                  [Page 64]

                         Mesh Schema Reference             November 2020

         Inherits: Message

         EnvelopedRequestConnection: Enveloped (Optional)

         ServerNonce: Binary (Optional)

         Witness: String (Optional)

11.6.8. Structure: RespondConnection

   Respond to RequestConnection message to grant or refuse the
   connection request.

         Inherits: Message

         Result: String (Optional)

         CatalogedDevice: CatalogedDevice (Optional)

11.6.9. Structure: MessageContact

         Inherits: MessagePinValidated

         Reply: Boolean (Optional)

         Subject: String (Optional)

         PIN: String (Optional)

11.6.10. Structure: GroupInvitation

         Inherits: Message

         Text: String (Optional)

11.6.11. Structure: RequestConfirmation

         Inherits: Message

         Text: String (Optional)

11.6.12. Structure: ResponseConfirmation

         Inherits: Message

         Request: Enveloped (Optional)

         Accept: Boolean (Optional)






Hallam-Baker              Expires May 7, 2021                  [Page 65]

                         Mesh Schema Reference             November 2020

11.6.13. Structure: RequestTask

         Inherits: Message

   [No fields]

11.6.14. Structure: MessageClaim

         Inherits: Message

         PublicationId: String (Optional)

         ServiceAuthenticate: String (Optional)

         DeviceAuthenticate: String (Optional)

         Expires: DateTime (Optional)

11.6.15. Structure: ProcessResult

   For future use, allows logging of operations and results

         Inherits: Message

         Success: Boolean (Optional)

         ErrorReport: String (Optional)

12. Security Considerations

   The security considerations for use and implementation of Mesh
   services and applications are described in the Mesh Security
   Considerations guide .

13. IANA Considerations

   All the IANA considerations for the Mesh documents are specified in
   this document

14. Acknowledgements

   A list of people who have contributed to the design of the Mesh is
   presented in .

15. Appendix A: Example Container Organization (not normative)

   The means by which profiles are stored on devices is outside the
   scope of the specification. Only catalogs that are required to be
   shared between machines by means of accounts need to be standardized.





Hallam-Baker              Expires May 7, 2021                  [Page 66]

                         Mesh Schema Reference             November 2020

15.1. Device

         Host Catalog: Host.dare

         MeshCatalog: [UDF-Mesh].dcat

         Account Catalogs: [UDF-Account]/mmm_Device.dcat

         Account Catalogs: [UDF-Account]/[Catalog name].dcat

15.1.1. Creating a new Mesh

   Create new Mesh Profile, Device Profile, Add to Host Catalog

   Create MeshCatalog

15.1.2. Adding an Account

   Create new Account Profile, Add to MeshCatalog

   Create new Account Device Catalog

   For each device to be added to the account: Create Account Connection
   Assertion, add to Account Device Catalog.

15.1.3. Adding a Device

   Create a Device Connection Assertion.

   For each account the device is to be added to: Create Account
   Connection Assertion, add to Account Device Catalog.

15.2. Service

         Master Catalog

         Service Catalog

15.2.1. Creating a Service

   Create a Service Description, add to Master Catalog

15.2.2. Adding an Account

   Create the account entry, add to Service Catalog

   Create the Account Directory







Hallam-Baker              Expires May 7, 2021                  [Page 67]

                         Mesh Schema Reference             November 2020

16. Appendix B: Collected Authentication and Encryption Requirements

16.1. Mesh Messaging

   +-----------------------+---------+------------------+
   | Message               | Signer  | Recipients       |
   +-----------------------+---------+------------------+
   | RequestConnection     | Device  | Service          |
   | AcknowledgeConnection | Service | Device, Receiver |
   | OfferGroup            | Sender  | Receiver         |
   | RequestContact        | Sender  | Receiver         |
   | ReplyContact          | Sender  | Receiver         |
   | RequestConfirmation   | Sender  | Receiver         |
   | ResponseConfirmation  | Sender  | Receiver         |
   | RequestTask           | Sender  | Receiver         |
   | ResponseTask          | Sender  | Receiver         |

References

Normative References

   [RFC2119]  Bradner, S., "Key words for use in RFCs to Indicate
              Requirement Levels", BCP 14, RFC 2119, DOI
              10.17487/RFC2119, March 1997.

   [draft-hallambaker-mesh-architecture]  Hallam-Baker, P, "Mathematical
              Mesh 3.0 Part I: Architecture Guide", Internet-Draft
              draft-hallambaker-mesh-architecture-14, 27 July 2020.

   [draft-hallambaker-mesh-protocol]  Hallam-Baker, P, "Mathematical
              Mesh 3.0 Part V: Protocol Reference", Internet-Draft
              draft-hallambaker-mesh-protocol-06, 27 July 2020.

   [draft-hallambaker-mesh-udf]  Hallam-Baker, P, "Mathematical Mesh 3.0
              Part II: Uniform Data Fingerprint.", Internet-Draft draft-
              hallambaker-mesh-udf-10, 27 July 2020.

   [draft-hallambaker-threshold]  Hallam-Baker, P, "Threshold Modes in
              Elliptic Curves", Internet-Draft draft-hallambaker-
              threshold-03, 3 September 2020.

   [draft-hallambaker-threshold-sigs]  Hallam-Baker, P, "Threshold
              Signatures in Elliptic Curves", Internet-Draft draft-
              hallambaker-threshold-sigs-04, 3 September 2020.

   [draft-hallambaker-mesh-cryptography]  Hallam-Baker, P, "Mathematical
              Mesh 3.0 Part VIII: Cryptographic Algorithms", Internet-
              Draft draft-hallambaker-mesh-cryptography-06, 27 July
              2020.





Hallam-Baker              Expires May 7, 2021                  [Page 68]

                         Mesh Schema Reference             November 2020

   [draft-hallambaker-mesh-security]  Hallam-Baker, P, "Mathematical
              Mesh 3.0 Part VII: Security Considerations", Internet-
              Draft draft-hallambaker-mesh-security-05, 27 July 2020.

   [draft-hallambaker-mesh-notary]  , "[Reference Not Found!]".

   [draft-hallambaker-mesh-discovery]  , "[Reference Not Found!]".

Informative References

   [RFC2426]  ,Dawson, F.,Howes, T., "vCard MIME Directory Profile", RFC
              2426, DOI 10.17487/RFC2426, September 1998.

   [RFC5545]  Desruisseaux, B., "Internet Calendaring and Scheduling
              Core Object Specification (iCalendar)", RFC 5545, DOI
              10.17487/RFC5545, September 2009.

   [draft-hallambaker-mesh-developer]  Hallam-Baker, P, "Mathematical
              Mesh: Reference Implementation", Internet-Draft draft-
              hallambaker-mesh-developer-10, 27 July 2020.

   [draft-hallambaker-mesh-trust]  Hallam-Baker, P, "Mathematical Mesh
              3.0 Part VI: The Trust Mesh", Internet-Draft draft-
              hallambaker-mesh-trust-06, 27 July 2020.

Author's Address

   Phillip Hallam-Baker
   ThresholdSecrets.com

   phill@hallambaker.com























Hallam-Baker              Expires May 7, 2021                  [Page 69]
